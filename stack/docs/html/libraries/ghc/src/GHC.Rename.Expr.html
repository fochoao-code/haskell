<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998

Renaming of expressions

Basically dependency analysis.

Handles @Match@, @GRHSs@, @HsExpr@, and @Qualifier@ datatypes.  In
general, all of these functions return a renamed thing, and a set of
free variables.
-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-record-updates #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns   #-}</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Rename.Expr</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier">rnLExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier">rnExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#rnStmts"><span class="hs-identifier">rnStmts</span></a></span><span>
</span><span id="line-25"></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#include &quot;HsVersions.h&quot;
</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html"><span class="hs-identifier">GHC.Rename.Bind</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#rnLocalBindsAndThen"><span class="hs-identifier">rnLocalBindsAndThen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#rnLocalValBindsLHS"><span class="hs-identifier">rnLocalValBindsLHS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#rnLocalValBindsRHS"><span class="hs-identifier">rnLocalValBindsRHS</span></a></span><span>
</span><span id="line-32"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#rnMatchGroup"><span class="hs-identifier">rnMatchGroup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#rnGRHS"><span class="hs-identifier">rnGRHS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#makeMiniFixityEnv"><span class="hs-identifier">makeMiniFixityEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Hs.html"><span class="hs-identifier">GHC.Hs</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html"><span class="hs-identifier">GHC.Tc.Utils.Env</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#isBrackStage"><span class="hs-identifier">isBrackStage</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html"><span class="hs-identifier">GHC.Tc.Utils.Monad</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html"><span class="hs-identifier">GHC.Unit.Module</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier">getModule</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Env.html"><span class="hs-identifier">GHC.Rename.Env</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Fixity.html"><span class="hs-identifier">GHC.Rename.Fixity</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html"><span class="hs-identifier">GHC.Rename.Utils</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#HsDocContext"><span class="hs-identifier">HsDocContext</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#bindLocalNamesFV"><span class="hs-identifier">bindLocalNamesFV</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#checkDupNames"><span class="hs-identifier">checkDupNames</span></a></span><span>
</span><span id="line-40"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#bindLocalNames"><span class="hs-identifier">bindLocalNames</span></a></span><span>
</span><span id="line-41"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#mapMaybeFvRn"><span class="hs-identifier">mapMaybeFvRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#mapFvRn"><span class="hs-identifier">mapFvRn</span></a></span><span>
</span><span id="line-42"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#warnUnusedLocalBinds"><span class="hs-identifier">warnUnusedLocalBinds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#typeAppErr"><span class="hs-identifier">typeAppErr</span></a></span><span>
</span><span id="line-43"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#checkUnusedRecordWildcard"><span class="hs-identifier">checkUnusedRecordWildcard</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html"><span class="hs-identifier">GHC.Rename.Unbound</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html#reportUnboundName"><span class="hs-identifier">reportUnboundName</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Splice.html"><span class="hs-identifier">GHC.Rename.Splice</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Rename.Splice.html#rnBracket"><span class="hs-identifier">rnBracket</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Splice.html#rnSpliceExpr"><span class="hs-identifier">rnSpliceExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Splice.html#checkThLocalName"><span class="hs-identifier">checkThLocalName</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html"><span class="hs-identifier">GHC.Rename.HsType</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Pat.html"><span class="hs-identifier">GHC.Rename.Pat</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html"><span class="hs-identifier">GHC.Types.Name.Set</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html"><span class="hs-identifier">GHC.Types.Name.Reader</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Set.html"><span class="hs-identifier">GHC.Types.Unique.Set</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base/src/Data.List.html#"><span class="hs-identifier">Data.List</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base/src/Data.Maybe.html#"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base/src/Data.Maybe.html#isJust"><span class="hs-identifier">isJust</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base/src/Data.Maybe.html#isNothing"><span class="hs-identifier">isNothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html"><span class="hs-identifier">GHC.Data.List.SetOps</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html#removeDups"><span class="hs-identifier">removeDups</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html"><span class="hs-identifier">GHC.Utils.Error</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Outputable</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base/src/Control.Monad.html#"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#nilDataConName"><span class="hs-identifier">nilDataConName</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../ghc-boot/src/GHC.LanguageExtensions.html#"><span class="hs-identifier">GHC.LanguageExtensions</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LangExt</span></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base/src/Control.Arrow.html#"><span class="hs-identifier">Control.Arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base/src/Control.Arrow.html#first"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base/src/Data.Ord.html#"><span class="hs-identifier">Data.Ord</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../array/src/Data.Array.html#"><span class="hs-identifier">Data.Array</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base/src/Data.List.NonEmpty.html#"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsubsection{Expressions}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExprs"><span class="hs-identifier hs-type">rnExprs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span id="rnExprs"><span class="annot"><span class="annottext">rnExprs :: [LHsExpr GhcPs] -&gt; RnM ([LHsExpr GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#rnExprs"><span class="hs-identifier hs-var hs-var">rnExprs</span></a></span></span><span> </span><span id="local-6989586621681132806"><span class="annot"><span class="annottext">[LHsExpr GhcPs]
</span><a href="#local-6989586621681132806"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LHsExpr GhcPs] -&gt; FreeVars -&gt; RnM ([LHsExpr GhcRn], FreeVars)
</span><a href="#local-6989586621681132805"><span class="hs-identifier hs-var">rnExprs'</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsExpr GhcPs]
</span><a href="#local-6989586621681132806"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-83"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621681132805"><span class="annot"><span class="annottext">rnExprs' :: [LHsExpr GhcPs] -&gt; FreeVars -&gt; RnM ([LHsExpr GhcRn], FreeVars)
</span><a href="#local-6989586621681132805"><span class="hs-identifier hs-var hs-var">rnExprs'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681132799"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132799"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([LHsExpr GhcRn], FreeVars) -&gt; RnM ([LHsExpr GhcRn], FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132799"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><a href="#local-6989586621681132805"><span class="hs-identifier hs-var">rnExprs'</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132798"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132798"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681132797"><span class="annot"><span class="annottext">[LHsExpr GhcPs]
</span><a href="#local-6989586621681132797"><span class="hs-identifier hs-var">exprs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681132796"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132796"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-86"></span><span>   </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132795"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132795"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132794"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132794"><span class="hs-identifier hs-var">fvExpr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132798"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-87"></span><span>        </span><span class="hs-comment">-- Now we do a &quot;seq&quot; on the free vars because typically it's small</span><span>
</span><span id="line-88"></span><span>        </span><span class="hs-comment">-- or empty, especially in very long lists of constants</span><span>
</span><span id="line-89"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span>  </span><span id="local-6989586621681132793"><span class="annot"><span class="annottext">acc' :: FreeVars
</span><a href="#local-6989586621681132793"><span class="hs-identifier hs-var hs-var">acc'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132796"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132794"><span class="hs-identifier hs-var">fvExpr</span></a></span><span>
</span><span id="line-90"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132791"><span class="annot"><span class="annottext">[LHsExpr GhcRn]
</span><a href="#local-6989586621681132791"><span class="hs-identifier hs-var">exprs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132790"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132790"><span class="hs-identifier hs-var">fvExprs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132793"><span class="hs-identifier hs-var">acc'</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
-&gt; RnM ([LHsExpr GhcRn], FreeVars)
-&gt; RnM ([LHsExpr GhcRn], FreeVars)
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">[LHsExpr GhcPs] -&gt; FreeVars -&gt; RnM ([LHsExpr GhcRn], FreeVars)
</span><a href="#local-6989586621681132805"><span class="hs-identifier hs-var">rnExprs'</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsExpr GhcPs]
</span><a href="#local-6989586621681132797"><span class="hs-identifier hs-var">exprs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132793"><span class="hs-identifier hs-var">acc'</span></a></span><span>
</span><span id="line-91"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">([LHsExpr GhcRn], FreeVars) -&gt; RnM ([LHsExpr GhcRn], FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132795"><span class="hs-identifier hs-var">expr'</span></a></span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; [LHsExpr GhcRn] -&gt; [LHsExpr GhcRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[LHsExpr GhcRn]
</span><a href="#local-6989586621681132791"><span class="hs-identifier hs-var">exprs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132790"><span class="hs-identifier hs-var">fvExprs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- Variables. We look up the variable and return the resulting name.</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-type">rnLExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span id="rnLExpr"><span class="annot"><span class="annottext">rnLExpr :: LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var hs-var">rnLExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcPs -&gt; TcM (HsExpr GhcRn, FreeVars))
-&gt; LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
forall a b c. (a -&gt; TcM (b, c)) -&gt; Located a -&gt; TcM (Located b, c)
</span><a href="GHC.Tc.Utils.Monad.html#wrapLocFstM"><span class="hs-identifier hs-var">wrapLocFstM</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-type">rnExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="annot"><a href="GHC.Rename.Expr.html#finishHsVar"><span class="hs-identifier hs-type">finishHsVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- Separated from rnExpr because it's also used</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- when renaming infix expressions</span><span>
</span><span id="line-103"></span><span id="finishHsVar"><span class="annot"><span class="annottext">finishHsVar :: Located Name -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#finishHsVar"><span class="hs-identifier hs-var hs-var">finishHsVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132786"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132786"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681132785"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132785"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681132784"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681132784"><span class="hs-identifier hs-var">this_mod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) Module
forall (m :: * -&gt; *). HasModule m =&gt; m Module
</span><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a></span><span>
</span><span id="line-105"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; Name -&gt; Bool
</span><a href="GHC.Types.Name.html#nameIsLocalOrFrom"><span class="hs-identifier hs-var">nameIsLocalOrFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681132784"><span class="hs-identifier hs-var">this_mod</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132785"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IOEnv (Env TcGblEnv TcLclEnv) ()
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) ())
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Splice.html#checkThLocalName"><span class="hs-identifier hs-var">checkThLocalName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132785"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-107"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XVar GhcRn -&gt; Located (IdP GhcRn) -&gt; HsExpr GhcRn
forall p. XVar p -&gt; Located (IdP p) -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XVar GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; Name -&gt; Located Name
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132786"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132785"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132785"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnUnboundVar"><span class="hs-identifier hs-type">rnUnboundVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span id="rnUnboundVar"><span class="annot"><span class="annottext">rnUnboundVar :: RdrName -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnUnboundVar"><span class="hs-identifier hs-var hs-var">rnUnboundVar</span></a></span></span><span> </span><span id="local-6989586621681132777"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681132777"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-111"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isUnqual"><span class="hs-identifier hs-var">isUnqual</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681132777"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-112"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- Treat this as a &quot;hole&quot;</span><span>
</span><span id="line-113"></span><span>             </span><span class="hs-comment">-- Do not fail right now; instead, return HsUnboundVar</span><span>
</span><span id="line-114"></span><span>             </span><span class="hs-comment">-- and let the type checker report the error</span><span>
</span><span id="line-115"></span><span>             </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XUnboundVar GhcRn -&gt; OccName -&gt; HsExpr GhcRn
forall p. XUnboundVar p -&gt; OccName -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsUnboundVar"><span class="hs-identifier hs-var">HsUnboundVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XUnboundVar GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681132777"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- Fail immediately (qualified name)</span><span>
</span><span id="line-118"></span><span>             </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681132772"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132772"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; RnM Name
</span><a href="GHC.Rename.Unbound.html#reportUnboundName"><span class="hs-identifier hs-var">reportUnboundName</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681132777"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-119"></span><span>                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XVar GhcRn -&gt; Located (IdP GhcRn) -&gt; HsExpr GhcRn
forall p. XVar p -&gt; Located (IdP p) -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XVar GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Located Name
forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132772"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="rnExpr"><span class="annot"><span class="annottext">rnExpr :: HsExpr GhcPs -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var hs-var">rnExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132770"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132770"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681132769"><span class="annot"><span class="annottext">IdP GhcPs
</span><a href="#local-6989586621681132769"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681132768"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132768"><span class="hs-identifier hs-var">opt_DuplicateRecordFields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#DuplicateRecordFields"><span class="hs-identifier hs-var">LangExt.DuplicateRecordFields</span></a></span><span>
</span><span id="line-123"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681132765"><span class="annot"><span class="annottext">Maybe (Either Name [Name])
</span><a href="#local-6989586621681132765"><span class="hs-identifier hs-var">mb_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RdrName -&gt; RnM (Maybe (Either Name [Name]))
</span><a href="GHC.Rename.Env.html#lookupOccRn_overloaded"><span class="hs-identifier hs-var">lookupOccRn_overloaded</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132768"><span class="hs-identifier hs-var">opt_DuplicateRecordFields</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
IdP GhcPs
</span><a href="#local-6989586621681132769"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-124"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681132763"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681132763"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-125"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Either Name [Name])
</span><a href="#local-6989586621681132765"><span class="hs-identifier hs-var">mb_name</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-126"></span><span>           </span><span class="annot"><span class="annottext">Maybe (Either Name [Name])
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnUnboundVar"><span class="hs-identifier hs-var">rnUnboundVar</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
IdP GhcPs
</span><a href="#local-6989586621681132769"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-127"></span><span>           </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621681132761"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132761"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132761"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.html#nilDataConName"><span class="hs-identifier hs-var">nilDataConName</span></a></span><span> </span><span class="hs-comment">-- Treat [] as an ExplicitList, so that</span><span>
</span><span id="line-129"></span><span>                                       </span><span class="hs-comment">-- OverloadedLists works correctly</span><span>
</span><span id="line-130"></span><span>                                       </span><span class="hs-comment">-- Note [Empty lists] in GHC.Hs.Expr</span><span>
</span><span id="line-131"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#xopt"><span class="hs-identifier hs-var">xopt</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#OverloadedLists"><span class="hs-identifier hs-var">LangExt.OverloadedLists</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681132763"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-132"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XExplicitList GhcPs
-&gt; Maybe (SyntaxExpr GhcPs) -&gt; [LHsExpr GhcPs] -&gt; HsExpr GhcPs
forall p.
XExplicitList p -&gt; Maybe (SyntaxExpr p) -&gt; [LHsExpr p] -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#ExplicitList"><span class="hs-identifier hs-var">ExplicitList</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XExplicitList GhcPs
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcPs)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-135"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Located Name -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#finishHsVar"><span class="hs-identifier hs-var">finishHsVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; Name -&gt; Located Name
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132770"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132761"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-136"></span><span>            </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681132757"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132757"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-137"></span><span>              </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">XRecFld GhcRn -&gt; AmbiguousFieldOcc GhcRn -&gt; HsExpr GhcRn
forall p. XRecFld p -&gt; AmbiguousFieldOcc p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsRecFld"><span class="hs-identifier hs-var">HsRecFld</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XRecFld GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XUnambiguous GhcRn -&gt; Located RdrName -&gt; AmbiguousFieldOcc GhcRn
forall pass.
XUnambiguous pass -&gt; Located RdrName -&gt; AmbiguousFieldOcc pass
</span><a href="GHC.Hs.Type.html#Unambiguous"><span class="hs-identifier hs-var">Unambiguous</span></a></span><span> </span><span class="annot"><span class="annottext">Name
XUnambiguous GhcRn
</span><a href="#local-6989586621681132757"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; RdrName -&gt; Located RdrName
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132770"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
IdP GhcPs
</span><a href="#local-6989586621681132769"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132757"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-138"></span><span>           </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621681132754"><span class="annot"><span class="annottext">fs :: [Name]
</span><a href="#local-6989586621681132754"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-139"></span><span>              </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">XRecFld GhcRn -&gt; AmbiguousFieldOcc GhcRn -&gt; HsExpr GhcRn
forall p. XRecFld p -&gt; AmbiguousFieldOcc p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsRecFld"><span class="hs-identifier hs-var">HsRecFld</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XRecFld GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XAmbiguous GhcRn -&gt; Located RdrName -&gt; AmbiguousFieldOcc GhcRn
forall pass.
XAmbiguous pass -&gt; Located RdrName -&gt; AmbiguousFieldOcc pass
</span><a href="GHC.Hs.Type.html#Ambiguous"><span class="hs-identifier hs-var">Ambiguous</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XAmbiguous GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; RdrName -&gt; Located RdrName
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132770"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
IdP GhcPs
</span><a href="#local-6989586621681132769"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#mkFVs"><span class="hs-identifier hs-var">mkFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681132754"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span>
</span><span id="line-141"></span><span>           </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TcM (HsExpr GhcRn, FreeVars)
forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;runExpr/HsVar&quot;</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsIPVar"><span class="hs-identifier hs-type">HsIPVar</span></a></span><span> </span><span id="local-6989586621681132749"><span class="annot"><span class="annottext">XIPVar GhcPs
</span><a href="#local-6989586621681132749"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132748"><span class="annot"><span class="annottext">HsIPName
</span><a href="#local-6989586621681132748"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XIPVar GhcRn -&gt; HsIPName -&gt; HsExpr GhcRn
forall p. XIPVar p -&gt; HsIPName -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsIPVar"><span class="hs-identifier hs-var">HsIPVar</span></a></span><span> </span><span class="annot"><span class="annottext">XIPVar GhcPs
XIPVar GhcRn
</span><a href="#local-6989586621681132749"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">HsIPName
</span><a href="#local-6989586621681132748"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsUnboundVar"><span class="hs-identifier hs-type">HsUnboundVar</span></a></span><span> </span><span id="local-6989586621681132747"><span class="annot"><span class="annottext">XUnboundVar GhcPs
</span><a href="#local-6989586621681132747"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132746"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681132746"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XUnboundVar GhcRn -&gt; OccName -&gt; HsExpr GhcRn
forall p. XUnboundVar p -&gt; OccName -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsUnboundVar"><span class="hs-identifier hs-var">HsUnboundVar</span></a></span><span> </span><span class="annot"><span class="annottext">XUnboundVar GhcPs
XUnboundVar GhcRn
</span><a href="#local-6989586621681132747"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681132746"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsOverLabel"><span class="hs-identifier hs-type">HsOverLabel</span></a></span><span> </span><span id="local-6989586621681132744"><span class="annot"><span class="annottext">XOverLabel GhcPs
</span><a href="#local-6989586621681132744"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (IdP GhcPs)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132743"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681132743"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681132742"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132742"><span class="hs-identifier hs-var">rebindable_on</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#RebindableSyntax"><span class="hs-identifier hs-var">LangExt.RebindableSyntax</span></a></span><span>
</span><span id="line-151"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132742"><span class="hs-identifier hs-var">rebindable_on</span></a></span><span>
</span><span id="line-152"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681132740"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132740"><span class="hs-identifier hs-var">fromLabel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; RnM Name
</span><a href="GHC.Rename.Env.html#lookupOccRn"><span class="hs-identifier hs-var">lookupOccRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; RdrName
</span><a href="GHC.Types.Name.Reader.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fromLabel&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>                 </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOverLabel GhcRn -&gt; Maybe (IdP GhcRn) -&gt; FastString -&gt; HsExpr GhcRn
forall p. XOverLabel p -&gt; Maybe (IdP p) -&gt; FastString -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsOverLabel"><span class="hs-identifier hs-var">HsOverLabel</span></a></span><span> </span><span class="annot"><span class="annottext">XOverLabel GhcPs
XOverLabel GhcRn
</span><a href="#local-6989586621681132744"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132740"><span class="hs-identifier hs-var">fromLabel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681132743"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132740"><span class="hs-identifier hs-var">fromLabel</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-154"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOverLabel GhcRn -&gt; Maybe (IdP GhcRn) -&gt; FastString -&gt; HsExpr GhcRn
forall p. XOverLabel p -&gt; Maybe (IdP p) -&gt; FastString -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsOverLabel"><span class="hs-identifier hs-var">HsOverLabel</span></a></span><span> </span><span class="annot"><span class="annottext">XOverLabel GhcPs
XOverLabel GhcRn
</span><a href="#local-6989586621681132744"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (IdP GhcRn)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681132743"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a></span><span> </span><span id="local-6989586621681132735"><span class="annot"><span class="annottext">XLitE GhcPs
</span><a href="#local-6989586621681132735"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132734"><span class="annot"><span class="annottext">lit :: HsLit GhcPs
</span><a href="#local-6989586621681132734"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Lit.html#HsString"><span class="hs-identifier hs-type">HsString</span></a></span><span> </span><span id="local-6989586621681132732"><span class="annot"><span class="annottext">XHsString GhcPs
</span><a href="#local-6989586621681132732"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621681132731"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681132731"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681132730"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132730"><span class="hs-identifier hs-var">opt_OverloadedStrings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#OverloadedStrings"><span class="hs-identifier hs-var">LangExt.OverloadedStrings</span></a></span><span>
</span><span id="line-158"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132730"><span class="hs-identifier hs-var">opt_OverloadedStrings</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-159"></span><span>            </span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOverLitE GhcPs -&gt; HsOverLit GhcPs -&gt; HsExpr GhcPs
forall p. XOverLitE p -&gt; HsOverLit p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">XLitE GhcPs
XOverLitE GhcPs
</span><a href="#local-6989586621681132735"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceText -&gt; FastString -&gt; HsOverLit GhcPs
</span><a href="GHC.Hs.Utils.html#mkHsIsString"><span class="hs-identifier hs-var">mkHsIsString</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
XHsString GhcPs
</span><a href="#local-6989586621681132732"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681132731"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-161"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsLit GhcPs -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall p. HsLit p -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Pat.html#rnLit"><span class="hs-identifier hs-var">rnLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcPs
</span><a href="#local-6989586621681132734"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-162"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLitE GhcRn -&gt; HsLit GhcRn -&gt; HsExpr GhcRn
forall p. XLitE p -&gt; HsLit p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a></span><span> </span><span class="annot"><span class="annottext">XLitE GhcPs
XLitE GhcRn
</span><a href="#local-6989586621681132735"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsLit GhcPs -&gt; HsLit GhcRn
forall (p1 :: Pass) (p2 :: Pass).
HsLit (GhcPass p1) -&gt; HsLit (GhcPass p2)
</span><a href="GHC.Hs.Lit.html#convertLit"><span class="hs-identifier hs-var">convertLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcPs
</span><a href="#local-6989586621681132734"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a></span><span> </span><span id="local-6989586621681132724"><span class="annot"><span class="annottext">XLitE GhcPs
</span><a href="#local-6989586621681132724"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132723"><span class="annot"><span class="annottext">HsLit GhcPs
</span><a href="#local-6989586621681132723"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">HsLit GhcPs -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall p. HsLit p -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Pat.html#rnLit"><span class="hs-identifier hs-var">rnLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcPs
</span><a href="#local-6989586621681132723"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-166"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLitE GhcRn -&gt; HsLit GhcRn -&gt; HsExpr GhcRn
forall p. XLitE p -&gt; HsLit p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a></span><span> </span><span class="annot"><span class="annottext">XLitE GhcPs
XLitE GhcRn
</span><a href="#local-6989586621681132724"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsLit GhcPs -&gt; HsLit GhcRn
forall (p1 :: Pass) (p2 :: Pass).
HsLit (GhcPass p1) -&gt; HsLit (GhcPass p2)
</span><a href="GHC.Hs.Lit.html#convertLit"><span class="hs-identifier hs-var">convertLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcPs
</span><a href="#local-6989586621681132723"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a></span><span> </span><span id="local-6989586621681132722"><span class="annot"><span class="annottext">XOverLitE GhcPs
</span><a href="#local-6989586621681132722"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132721"><span class="annot"><span class="annottext">HsOverLit GhcPs
</span><a href="#local-6989586621681132721"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681132720"><span class="annot"><span class="annottext">HsOverLit GhcRn
</span><a href="#local-6989586621681132720"><span class="hs-identifier hs-var">lit'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132719"><span class="annot"><span class="annottext">Maybe (HsExpr GhcRn)
</span><a href="#local-6989586621681132719"><span class="hs-identifier hs-var">mb_neg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132718"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132718"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcPs
-&gt; RnM ((HsOverLit GhcRn, Maybe (HsExpr GhcRn)), FreeVars)
forall t.
HsOverLit t
-&gt; RnM ((HsOverLit GhcRn, Maybe (HsExpr GhcRn)), FreeVars)
</span><a href="GHC.Rename.Pat.html#rnOverLit"><span class="hs-identifier hs-var">rnOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcPs
</span><a href="#local-6989586621681132721"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-comment">-- See Note [Negative zero]</span><span>
</span><span id="line-170"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcRn)
</span><a href="#local-6989586621681132719"><span class="hs-identifier hs-var">mb_neg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-171"></span><span>              </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcRn)
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOverLitE GhcRn -&gt; HsOverLit GhcRn -&gt; HsExpr GhcRn
forall p. XOverLitE p -&gt; HsOverLit p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">XOverLitE GhcPs
XOverLitE GhcRn
</span><a href="#local-6989586621681132722"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcRn
</span><a href="#local-6989586621681132720"><span class="hs-identifier hs-var">lit'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132718"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>              </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681132716"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681132716"><span class="hs-identifier hs-var">neg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XApp GhcRn -&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XApp p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">XApp GhcRn
XOverLitE GhcPs
</span><a href="#local-6989586621681132722"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcRn -&gt; LHsExpr GhcRn
forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681132716"><span class="hs-identifier hs-var">neg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcRn -&gt; LHsExpr GhcRn
forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOverLitE GhcRn -&gt; HsOverLit GhcRn -&gt; HsExpr GhcRn
forall p. XOverLitE p -&gt; HsOverLit p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">XOverLitE GhcPs
XOverLitE GhcRn
</span><a href="#local-6989586621681132722"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcRn
</span><a href="#local-6989586621681132720"><span class="hs-identifier hs-var">lit'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132718"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsApp"><span class="hs-identifier hs-type">HsApp</span></a></span><span> </span><span id="local-6989586621681132714"><span class="annot"><span class="annottext">XApp GhcPs
</span><a href="#local-6989586621681132714"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132713"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132713"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681132712"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132712"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132711"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132711"><span class="hs-identifier hs-var">fun'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132710"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132710"><span class="hs-identifier hs-var">fvFun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132713"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-177"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132709"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132709"><span class="hs-identifier hs-var">arg'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132708"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132708"><span class="hs-identifier hs-var">fvArg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132712"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-178"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XApp GhcRn -&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XApp p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">XApp GhcPs
XApp GhcRn
</span><a href="#local-6989586621681132714"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132711"><span class="hs-identifier hs-var">fun'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132709"><span class="hs-identifier hs-var">arg'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132710"><span class="hs-identifier hs-var">fvFun</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132708"><span class="hs-identifier hs-var">fvArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsAppType"><span class="hs-identifier hs-type">HsAppType</span></a></span><span> </span><span id="local-6989586621681132706"><span class="annot"><span class="annottext">XAppTypeE GhcPs
</span><a href="#local-6989586621681132706"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132705"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132705"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681132704"><span class="annot"><span class="annottext">LHsWcType (NoGhcTc GhcPs)
</span><a href="#local-6989586621681132704"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681132703"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132703"><span class="hs-identifier hs-var">type_app</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#TypeApplications"><span class="hs-identifier hs-var">LangExt.TypeApplications</span></a></span><span>
</span><span id="line-182"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132703"><span class="hs-identifier hs-var">type_app</span></a></span><span> </span><span class="annot"><span class="annottext">(IOEnv (Env TcGblEnv TcLclEnv) ()
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) ())
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="annot"><span class="annottext">(MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ())
-&gt; MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; LHsType GhcPs -&gt; MsgDoc
</span><a href="GHC.Rename.Utils.html#typeAppErr"><span class="hs-identifier hs-var">typeAppErr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LHsType GhcPs -&gt; MsgDoc) -&gt; LHsType GhcPs -&gt; MsgDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HsWildCardBndrs GhcPs (LHsType GhcPs) -&gt; LHsType GhcPs
forall pass thing. HsWildCardBndrs pass thing -&gt; thing
</span><a href="GHC.Hs.Type.html#hswc_body"><span class="hs-identifier hs-var hs-var">hswc_body</span></a></span><span> </span><span class="annot"><span class="annottext">HsWildCardBndrs GhcPs (LHsType GhcPs)
LHsWcType (NoGhcTc GhcPs)
</span><a href="#local-6989586621681132704"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-183"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132698"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132698"><span class="hs-identifier hs-var">fun'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132697"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132697"><span class="hs-identifier hs-var">fvFun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132705"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-184"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132696"><span class="annot"><span class="annottext">LHsWcType GhcRn
</span><a href="#local-6989586621681132696"><span class="hs-identifier hs-var">arg'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132695"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132695"><span class="hs-identifier hs-var">fvArg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; HsWildCardBndrs GhcPs (LHsType GhcPs)
-&gt; RnM (LHsWcType GhcRn, FreeVars)
</span><a href="GHC.Rename.HsType.html#rnHsWcType"><span class="hs-identifier hs-var">rnHsWcType</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="GHC.Rename.Utils.html#HsTypeCtx"><span class="hs-identifier hs-var">HsTypeCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HsWildCardBndrs GhcPs (LHsType GhcPs)
LHsWcType (NoGhcTc GhcPs)
</span><a href="#local-6989586621681132704"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-185"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XAppTypeE GhcRn
-&gt; LHsExpr GhcRn -&gt; LHsWcType (NoGhcTc GhcRn) -&gt; HsExpr GhcRn
forall p.
XAppTypeE p -&gt; LHsExpr p -&gt; LHsWcType (NoGhcTc p) -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsAppType"><span class="hs-identifier hs-var">HsAppType</span></a></span><span> </span><span class="annot"><span class="annottext">XAppTypeE GhcPs
XAppTypeE GhcRn
</span><a href="#local-6989586621681132706"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132698"><span class="hs-identifier hs-var">fun'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsWcType GhcRn
LHsWcType (NoGhcTc GhcRn)
</span><a href="#local-6989586621681132696"><span class="hs-identifier hs-var">arg'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132697"><span class="hs-identifier hs-var">fvFun</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132695"><span class="hs-identifier hs-var">fvArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#OpApp"><span class="hs-identifier hs-type">OpApp</span></a></span><span> </span><span class="annot"><span class="annottext">XOpApp GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132691"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132691"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621681132690"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132690"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621681132689"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132689"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132688"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132688"><span class="hs-identifier hs-var">e1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132687"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132687"><span class="hs-identifier hs-var">fv_e1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132691"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132686"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132686"><span class="hs-identifier hs-var">e2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132685"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132685"><span class="hs-identifier hs-var">fv_e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132689"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132684"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132684"><span class="hs-identifier hs-var">op'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132683"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132683"><span class="hs-identifier hs-var">fv_op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132690"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>        </span><span class="hs-comment">-- Deal with fixity</span><span>
</span><span id="line-193"></span><span>        </span><span class="hs-comment">-- When renaming code synthesised from &quot;deriving&quot; declarations</span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-comment">-- we used to avoid fixity stuff, but we can't easily tell any</span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-comment">-- more, so I've removed the test.  Adding HsPars in GHC.Tc.Deriv.Generate</span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-comment">-- should prevent bad things happening.</span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681132682"><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621681132682"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132684"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-198"></span><span>              </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132681"><span class="annot"><span class="annottext">IdP GhcRn
</span><a href="#local-6989586621681132681"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) Fixity
</span><a href="GHC.Rename.Fixity.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
IdP GhcRn
</span><a href="#local-6989586621681132681"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-199"></span><span>              </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsRecFld"><span class="hs-identifier hs-type">HsRecFld</span></a></span><span> </span><span class="annot"><span class="annottext">XRecFld GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132679"><span class="annot"><span class="annottext">AmbiguousFieldOcc GhcRn
</span><a href="#local-6989586621681132679"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AmbiguousFieldOcc GhcRn -&gt; IOEnv (Env TcGblEnv TcLclEnv) Fixity
</span><a href="GHC.Rename.Fixity.html#lookupFieldFixityRn"><span class="hs-identifier hs-var">lookupFieldFixityRn</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousFieldOcc GhcRn
</span><a href="#local-6989586621681132679"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-200"></span><span>              </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Fixity -&gt; IOEnv (Env TcGblEnv TcLclEnv) Fixity
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceText -&gt; Int -&gt; FixityDirection -&gt; Fixity
</span><a href="GHC.Types.Basic.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><a href="GHC.Types.Basic.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.Types.Basic.html#minPrecedence"><span class="hs-identifier hs-var">minPrecedence</span></a></span><span> </span><span class="annot"><span class="annottext">FixityDirection
</span><a href="GHC.Types.Basic.html#InfixL"><span class="hs-identifier hs-var">InfixL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>                   </span><span class="hs-comment">-- c.f. lookupFixity for unbound</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681132673"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132673"><span class="hs-identifier hs-var">lexical_negation</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#LexicalNegation"><span class="hs-identifier hs-var">LangExt.LexicalNegation</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681132671"><span class="annot"><span class="annottext">negation_handling :: NegationHandling
</span><a href="#local-6989586621681132671"><span class="hs-identifier hs-var hs-var">negation_handling</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132673"><span class="hs-identifier hs-var">lexical_negation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NegationHandling
</span><a href="GHC.Rename.HsType.html#KeepNegationIntact"><span class="hs-identifier hs-var">KeepNegationIntact</span></a></span><span>
</span><span id="line-205"></span><span>                                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NegationHandling
</span><a href="GHC.Rename.HsType.html#ReassociateNegation"><span class="hs-identifier hs-var">ReassociateNegation</span></a></span><span>
</span><span id="line-206"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681132668"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681132668"><span class="hs-identifier hs-var">final_e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NegationHandling
-&gt; LHsExpr GhcRn
-&gt; LHsExpr GhcRn
-&gt; Fixity
-&gt; LHsExpr GhcRn
-&gt; RnM (HsExpr GhcRn)
</span><a href="GHC.Rename.HsType.html#mkOpAppRn"><span class="hs-identifier hs-var">mkOpAppRn</span></a></span><span> </span><span class="annot"><span class="annottext">NegationHandling
</span><a href="#local-6989586621681132671"><span class="hs-identifier hs-var">negation_handling</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132688"><span class="hs-identifier hs-var">e1'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132684"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621681132682"><span class="hs-identifier hs-var">fixity</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132686"><span class="hs-identifier hs-var">e2'</span></a></span><span>
</span><span id="line-207"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681132668"><span class="hs-identifier hs-var">final_e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132687"><span class="hs-identifier hs-var">fv_e1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132683"><span class="hs-identifier hs-var">fv_op</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132685"><span class="hs-identifier hs-var">fv_e2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#NegApp"><span class="hs-identifier hs-type">NegApp</span></a></span><span> </span><span class="annot"><span class="annottext">XNegApp GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132665"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132665"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132664"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132664"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132663"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132663"><span class="hs-identifier hs-var">fv_e</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132665"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-211"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132662"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681132662"><span class="hs-identifier hs-var">neg_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132661"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132661"><span class="hs-identifier hs-var">fv_neg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupSyntax"><span class="hs-identifier hs-var">lookupSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#negateName"><span class="hs-identifier hs-var">negateName</span></a></span><span>
</span><span id="line-212"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681132658"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681132658"><span class="hs-identifier hs-var">final_e</span></a></span></span><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; SyntaxExpr GhcRn -&gt; RnM (HsExpr GhcRn)
forall (id :: Pass).
LHsExpr (GhcPass id)
-&gt; SyntaxExpr (GhcPass id) -&gt; RnM (HsExpr (GhcPass id))
</span><a href="GHC.Rename.HsType.html#mkNegAppRn"><span class="hs-identifier hs-var">mkNegAppRn</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132664"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681132662"><span class="hs-identifier hs-var">neg_name</span></a></span><span>
</span><span id="line-213"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681132658"><span class="hs-identifier hs-var">final_e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132663"><span class="hs-identifier hs-var">fv_e</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132661"><span class="hs-identifier hs-var">fv_neg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">------------------------------------------</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- Template Haskell extensions</span><span>
</span><span id="line-217"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span id="local-6989586621681132656"><span class="annot"><span class="annottext">e :: HsExpr GhcPs
</span><a href="#local-6989586621681132656"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsBracket"><span class="hs-identifier hs-type">HsBracket</span></a></span><span> </span><span class="annot"><span class="annottext">XBracket GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132654"><span class="annot"><span class="annottext">HsBracket GhcPs
</span><a href="#local-6989586621681132654"><span class="hs-identifier hs-var">br_body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; HsBracket GhcPs -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Splice.html#rnBracket"><span class="hs-identifier hs-var">rnBracket</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132656"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">HsBracket GhcPs
</span><a href="#local-6989586621681132654"><span class="hs-identifier hs-var">br_body</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsSpliceE"><span class="hs-identifier hs-type">HsSpliceE</span></a></span><span> </span><span class="annot"><span class="annottext">XSpliceE GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132652"><span class="annot"><span class="annottext">HsSplice GhcPs
</span><a href="#local-6989586621681132652"><span class="hs-identifier hs-var">splice</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsSplice GhcPs -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Splice.html#rnSpliceExpr"><span class="hs-identifier hs-var">rnSpliceExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsSplice GhcPs
</span><a href="#local-6989586621681132652"><span class="hs-identifier hs-var">splice</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">---------------------------------------------</span><span>
</span><span id="line-222"></span><span class="hs-comment">--      Sections</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- See Note [Parsing sections] in GHC.Parser</span><span>
</span><span id="line-224"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span id="local-6989586621681132650"><span class="annot"><span class="annottext">XPar GhcPs
</span><a href="#local-6989586621681132650"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132649"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132649"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132648"><span class="annot"><span class="annottext">section :: HsExpr GhcPs
</span><a href="#local-6989586621681132648"><span class="hs-identifier hs-var">section</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#SectionL"><span class="hs-identifier hs-type">SectionL</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132646"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681132646"><span class="hs-identifier hs-var">section'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132645"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132645"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnSection"><span class="hs-identifier hs-var">rnSection</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132648"><span class="hs-identifier hs-var">section</span></a></span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPar GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XPar p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar GhcPs
XPar GhcRn
</span><a href="#local-6989586621681132650"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; HsExpr GhcRn -&gt; LHsExpr GhcRn
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132649"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681132646"><span class="hs-identifier hs-var">section'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132645"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span id="local-6989586621681132643"><span class="annot"><span class="annottext">XPar GhcPs
</span><a href="#local-6989586621681132643"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132642"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132642"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132641"><span class="annot"><span class="annottext">section :: HsExpr GhcPs
</span><a href="#local-6989586621681132641"><span class="hs-identifier hs-var">section</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#SectionR"><span class="hs-identifier hs-type">SectionR</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132639"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681132639"><span class="hs-identifier hs-var">section'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132638"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132638"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnSection"><span class="hs-identifier hs-var">rnSection</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132641"><span class="hs-identifier hs-var">section</span></a></span><span>
</span><span id="line-230"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPar GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XPar p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar GhcPs
XPar GhcRn
</span><a href="#local-6989586621681132643"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; HsExpr GhcRn -&gt; LHsExpr GhcRn
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132642"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681132639"><span class="hs-identifier hs-var">section'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132638"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span id="local-6989586621681132637"><span class="annot"><span class="annottext">XPar GhcPs
</span><a href="#local-6989586621681132637"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132636"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132636"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132635"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132635"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132634"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132634"><span class="hs-identifier hs-var">fvs_e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132636"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPar GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XPar p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar GhcPs
XPar GhcRn
</span><a href="#local-6989586621681132637"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132635"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132634"><span class="hs-identifier hs-var">fvs_e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span id="local-6989586621681132633"><span class="annot"><span class="annottext">expr :: HsExpr GhcPs
</span><a href="#local-6989586621681132633"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#SectionL"><span class="hs-identifier hs-type">SectionL</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; MsgDoc
</span><a href="GHC.Rename.Expr.html#sectionErr"><span class="hs-identifier hs-var">sectionErr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132633"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnSection"><span class="hs-identifier hs-var">rnSection</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132633"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-238"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span id="local-6989586621681132631"><span class="annot"><span class="annottext">expr :: HsExpr GhcPs
</span><a href="#local-6989586621681132631"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#SectionR"><span class="hs-identifier hs-type">SectionR</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; MsgDoc
</span><a href="GHC.Rename.Expr.html#sectionErr"><span class="hs-identifier hs-var">sectionErr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132631"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnSection"><span class="hs-identifier hs-var">rnSection</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132631"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">---------------------------------------------</span><span>
</span><span id="line-242"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span id="local-6989586621681132629"><span class="annot"><span class="annottext">XPragE GhcPs
</span><a href="#local-6989586621681132629"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132628"><span class="annot"><span class="annottext">HsPragE GhcPs
</span><a href="#local-6989586621681132628"><span class="hs-identifier hs-var">prag</span></a></span></span><span> </span><span id="local-6989586621681132627"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132627"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132626"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132626"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132625"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132625"><span class="hs-identifier hs-var">fvs_expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132627"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-244"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPragE GhcRn -&gt; HsPragE GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XPragE p -&gt; HsPragE p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsPragE"><span class="hs-identifier hs-var">HsPragE</span></a></span><span> </span><span class="annot"><span class="annottext">XPragE GhcPs
XPragE GhcRn
</span><a href="#local-6989586621681132629"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsPragE GhcPs -&gt; HsPragE GhcRn
</span><a href="#local-6989586621681132624"><span class="hs-identifier hs-var">rn_prag</span></a></span><span> </span><span class="annot"><span class="annottext">HsPragE GhcPs
</span><a href="#local-6989586621681132628"><span class="hs-identifier hs-var">prag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132626"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132625"><span class="hs-identifier hs-var">fvs_expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="#local-6989586621681132624"><span class="hs-identifier hs-type">rn_prag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621681132624"><span class="annot"><span class="annottext">rn_prag :: HsPragE GhcPs -&gt; HsPragE GhcRn
</span><a href="#local-6989586621681132624"><span class="hs-identifier hs-var hs-var">rn_prag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsPragSCC"><span class="hs-identifier hs-type">HsPragSCC</span></a></span><span> </span><span id="local-6989586621681132622"><span class="annot"><span class="annottext">XSCC GhcPs
</span><a href="#local-6989586621681132622"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621681132621"><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621681132621"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621681132620"><span class="annot"><span class="annottext">StringLiteral
</span><a href="#local-6989586621681132620"><span class="hs-identifier hs-var">ann</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XSCC GhcRn -&gt; SourceText -&gt; StringLiteral -&gt; HsPragE GhcRn
forall p. XSCC p -&gt; SourceText -&gt; StringLiteral -&gt; HsPragE p
</span><a href="GHC.Hs.Expr.html#HsPragSCC"><span class="hs-identifier hs-var">HsPragSCC</span></a></span><span> </span><span class="annot"><span class="annottext">XSCC GhcPs
XSCC GhcRn
</span><a href="#local-6989586621681132622"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621681132621"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">StringLiteral
</span><a href="#local-6989586621681132620"><span class="hs-identifier hs-var">ann</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><a href="#local-6989586621681132624"><span class="hs-identifier hs-var">rn_prag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsPragTick"><span class="hs-identifier hs-type">HsPragTick</span></a></span><span> </span><span id="local-6989586621681132618"><span class="annot"><span class="annottext">XTickPragma GhcPs
</span><a href="#local-6989586621681132618"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621681132617"><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621681132617"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621681132616"><span class="annot"><span class="annottext">(StringLiteral, (Int, Int), (Int, Int))
</span><a href="#local-6989586621681132616"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621681132615"><span class="annot"><span class="annottext">((SourceText, SourceText), (SourceText, SourceText))
</span><a href="#local-6989586621681132615"><span class="hs-identifier hs-var">srcInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XTickPragma GhcRn
-&gt; SourceText
-&gt; (StringLiteral, (Int, Int), (Int, Int))
-&gt; ((SourceText, SourceText), (SourceText, SourceText))
-&gt; HsPragE GhcRn
forall p.
XTickPragma p
-&gt; SourceText
-&gt; (StringLiteral, (Int, Int), (Int, Int))
-&gt; ((SourceText, SourceText), (SourceText, SourceText))
-&gt; HsPragE p
</span><a href="GHC.Hs.Expr.html#HsPragTick"><span class="hs-identifier hs-var">HsPragTick</span></a></span><span> </span><span class="annot"><span class="annottext">XTickPragma GhcPs
XTickPragma GhcRn
</span><a href="#local-6989586621681132618"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621681132617"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">(StringLiteral, (Int, Int), (Int, Int))
</span><a href="#local-6989586621681132616"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">((SourceText, SourceText), (SourceText, SourceText))
</span><a href="#local-6989586621681132615"><span class="hs-identifier hs-var">srcInfo</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsLam"><span class="hs-identifier hs-type">HsLam</span></a></span><span> </span><span id="local-6989586621681132613"><span class="annot"><span class="annottext">XLam GhcPs
</span><a href="#local-6989586621681132613"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132612"><span class="annot"><span class="annottext">MatchGroup GhcPs (LHsExpr GhcPs)
</span><a href="#local-6989586621681132612"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132611"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621681132611"><span class="hs-identifier hs-var">matches'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132610"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132610"><span class="hs-identifier hs-var">fvMatch</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
-&gt; (LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars))
-&gt; MatchGroup GhcPs (LHsExpr GhcPs)
-&gt; RnM (MatchGroup GhcRn (LHsExpr GhcRn), FreeVars)
forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsMatchContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; MatchGroup GhcPs (Located (body GhcPs))
-&gt; RnM (MatchGroup GhcRn (Located (body GhcRn)), FreeVars)
</span><a href="GHC.Rename.Bind.html#rnMatchGroup"><span class="hs-identifier hs-var">rnMatchGroup</span></a></span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
forall p. HsMatchContext p
</span><a href="GHC.Hs.Expr.html#LambdaExpr"><span class="hs-identifier hs-var">LambdaExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcPs (LHsExpr GhcPs)
</span><a href="#local-6989586621681132612"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-252"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLam GhcRn -&gt; MatchGroup GhcRn (LHsExpr GhcRn) -&gt; HsExpr GhcRn
forall p. XLam p -&gt; MatchGroup p (LHsExpr p) -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a></span><span> </span><span class="annot"><span class="annottext">XLam GhcPs
XLam GhcRn
</span><a href="#local-6989586621681132613"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621681132611"><span class="hs-identifier hs-var">matches'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132610"><span class="hs-identifier hs-var">fvMatch</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsLamCase"><span class="hs-identifier hs-type">HsLamCase</span></a></span><span> </span><span id="local-6989586621681132607"><span class="annot"><span class="annottext">XLamCase GhcPs
</span><a href="#local-6989586621681132607"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132606"><span class="annot"><span class="annottext">MatchGroup GhcPs (LHsExpr GhcPs)
</span><a href="#local-6989586621681132606"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132605"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621681132605"><span class="hs-identifier hs-var">matches'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132604"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132604"><span class="hs-identifier hs-var">fvs_ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
-&gt; (LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars))
-&gt; MatchGroup GhcPs (LHsExpr GhcPs)
-&gt; RnM (MatchGroup GhcRn (LHsExpr GhcRn), FreeVars)
forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsMatchContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; MatchGroup GhcPs (Located (body GhcPs))
-&gt; RnM (MatchGroup GhcRn (Located (body GhcRn)), FreeVars)
</span><a href="GHC.Rename.Bind.html#rnMatchGroup"><span class="hs-identifier hs-var">rnMatchGroup</span></a></span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
forall p. HsMatchContext p
</span><a href="GHC.Hs.Expr.html#CaseAlt"><span class="hs-identifier hs-var">CaseAlt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcPs (LHsExpr GhcPs)
</span><a href="#local-6989586621681132606"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-256"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLamCase GhcRn -&gt; MatchGroup GhcRn (LHsExpr GhcRn) -&gt; HsExpr GhcRn
forall p. XLamCase p -&gt; MatchGroup p (LHsExpr p) -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsLamCase"><span class="hs-identifier hs-var">HsLamCase</span></a></span><span> </span><span class="annot"><span class="annottext">XLamCase GhcPs
XLamCase GhcRn
</span><a href="#local-6989586621681132607"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621681132605"><span class="hs-identifier hs-var">matches'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132604"><span class="hs-identifier hs-var">fvs_ms</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCase"><span class="hs-identifier hs-type">HsCase</span></a></span><span> </span><span id="local-6989586621681132601"><span class="annot"><span class="annottext">XCase GhcPs
</span><a href="#local-6989586621681132601"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132600"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132600"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621681132599"><span class="annot"><span class="annottext">MatchGroup GhcPs (LHsExpr GhcPs)
</span><a href="#local-6989586621681132599"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132598"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132598"><span class="hs-identifier hs-var">new_expr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132597"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132597"><span class="hs-identifier hs-var">e_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132600"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-260"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132596"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621681132596"><span class="hs-identifier hs-var">new_matches</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132595"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132595"><span class="hs-identifier hs-var">ms_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
-&gt; (LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars))
-&gt; MatchGroup GhcPs (LHsExpr GhcPs)
-&gt; RnM (MatchGroup GhcRn (LHsExpr GhcRn), FreeVars)
forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsMatchContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; MatchGroup GhcPs (Located (body GhcPs))
-&gt; RnM (MatchGroup GhcRn (Located (body GhcRn)), FreeVars)
</span><a href="GHC.Rename.Bind.html#rnMatchGroup"><span class="hs-identifier hs-var">rnMatchGroup</span></a></span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
forall p. HsMatchContext p
</span><a href="GHC.Hs.Expr.html#CaseAlt"><span class="hs-identifier hs-var">CaseAlt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcPs (LHsExpr GhcPs)
</span><a href="#local-6989586621681132599"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-261"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCase GhcRn
-&gt; LHsExpr GhcRn
-&gt; MatchGroup GhcRn (LHsExpr GhcRn)
-&gt; HsExpr GhcRn
forall p.
XCase p -&gt; LHsExpr p -&gt; MatchGroup p (LHsExpr p) -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsCase"><span class="hs-identifier hs-var">HsCase</span></a></span><span> </span><span class="annot"><span class="annottext">XCase GhcPs
XCase GhcRn
</span><a href="#local-6989586621681132601"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132598"><span class="hs-identifier hs-var">new_expr</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621681132596"><span class="hs-identifier hs-var">new_matches</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132597"><span class="hs-identifier hs-var">e_fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132595"><span class="hs-identifier hs-var">ms_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsLet"><span class="hs-identifier hs-type">HsLet</span></a></span><span> </span><span id="local-6989586621681132593"><span class="annot"><span class="annottext">XLet GhcPs
</span><a href="#local-6989586621681132593"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132592"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132592"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681132591"><span class="annot"><span class="annottext">HsLocalBinds GhcPs
</span><a href="#local-6989586621681132591"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681132590"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132590"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcPs
-&gt; (HsLocalBinds GhcRn -&gt; FreeVars -&gt; TcM (HsExpr GhcRn, FreeVars))
-&gt; TcM (HsExpr GhcRn, FreeVars)
forall result.
HsLocalBinds GhcPs
-&gt; (HsLocalBinds GhcRn -&gt; FreeVars -&gt; RnM (result, FreeVars))
-&gt; RnM (result, FreeVars)
</span><a href="GHC.Rename.Bind.html#rnLocalBindsAndThen"><span class="hs-identifier hs-var">rnLocalBindsAndThen</span></a></span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcPs
</span><a href="#local-6989586621681132591"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">((HsLocalBinds GhcRn -&gt; FreeVars -&gt; TcM (HsExpr GhcRn, FreeVars))
 -&gt; TcM (HsExpr GhcRn, FreeVars))
-&gt; (HsLocalBinds GhcRn -&gt; FreeVars -&gt; TcM (HsExpr GhcRn, FreeVars))
-&gt; TcM (HsExpr GhcRn, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681132589"><span class="annot"><span class="annottext">HsLocalBinds GhcRn
</span><a href="#local-6989586621681132589"><span class="hs-identifier hs-var">binds'</span></a></span></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-265"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132588"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132588"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132587"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132587"><span class="hs-identifier hs-var">fvExpr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132590"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLet GhcRn -&gt; LHsLocalBinds GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XLet p -&gt; LHsLocalBinds p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsLet"><span class="hs-identifier hs-var">HsLet</span></a></span><span> </span><span class="annot"><span class="annottext">XLet GhcPs
XLet GhcRn
</span><a href="#local-6989586621681132593"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; HsLocalBinds GhcRn -&gt; LHsLocalBinds GhcRn
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132592"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcRn
</span><a href="#local-6989586621681132589"><span class="hs-identifier hs-var">binds'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132588"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132587"><span class="hs-identifier hs-var">fvExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsDo"><span class="hs-identifier hs-type">HsDo</span></a></span><span> </span><span id="local-6989586621681132585"><span class="annot"><span class="annottext">XDo GhcPs
</span><a href="#local-6989586621681132585"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132584"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132584"><span class="hs-identifier hs-var">do_or_lc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132583"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132583"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681132582"><span class="annot"><span class="annottext">[ExprLStmt GhcPs]
</span><a href="#local-6989586621681132582"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681132581"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681132581"><span class="hs-identifier hs-var">stmts'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132580"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132580"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-270"></span><span>           </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars))
-&gt; (HsStmtContext GhcRn
    -&gt; [(ExprLStmt GhcRn, FreeVars)]
    -&gt; RnM ([ExprLStmt GhcRn], FreeVars))
-&gt; [ExprLStmt GhcPs]
-&gt; ([Name] -&gt; RnM ((), FreeVars))
-&gt; RnM (([ExprLStmt GhcRn], ()), FreeVars)
forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; (HsStmtContext GhcRn
    -&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
    -&gt; RnM ([LStmt GhcRn (Located (body GhcRn))], FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM (([LStmt GhcRn (Located (body GhcRn))], thing), FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmtsWithPostProcessing"><span class="hs-identifier hs-var">rnStmtsWithPostProcessing</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132584"><span class="hs-identifier hs-var">do_or_lc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span>
</span><span id="line-271"></span><span>             </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; [(ExprLStmt GhcRn, FreeVars)]
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#postProcessStmtsForApplicativeDo"><span class="hs-identifier hs-var">postProcessStmtsForApplicativeDo</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcPs]
</span><a href="#local-6989586621681132582"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-272"></span><span>             </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((), FreeVars) -&gt; RnM ((), FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">XDo GhcRn
-&gt; HsStmtContext GhcRn -&gt; Located [ExprLStmt GhcRn] -&gt; HsExpr GhcRn
forall p.
XDo p -&gt; HsStmtContext GhcRn -&gt; Located [ExprLStmt p] -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsDo"><span class="hs-identifier hs-var">HsDo</span></a></span><span> </span><span class="annot"><span class="annottext">XDo GhcPs
XDo GhcRn
</span><a href="#local-6989586621681132585"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132584"><span class="hs-identifier hs-var">do_or_lc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; [ExprLStmt GhcRn] -&gt; Located [ExprLStmt GhcRn]
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132583"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681132581"><span class="hs-identifier hs-var">stmts'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132580"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExplicitList"><span class="hs-identifier hs-type">ExplicitList</span></a></span><span> </span><span id="local-6989586621681132577"><span class="annot"><span class="annottext">XExplicitList GhcPs
</span><a href="#local-6989586621681132577"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcPs)
</span><span class="hs-identifier">_</span></span><span>  </span><span id="local-6989586621681132576"><span class="annot"><span class="annottext">[LHsExpr GhcPs]
</span><a href="#local-6989586621681132576"><span class="hs-identifier hs-var">exps</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681132575"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132575"><span class="hs-identifier hs-var">opt_OverloadedLists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#OverloadedLists"><span class="hs-identifier hs-var">LangExt.OverloadedLists</span></a></span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132574"><span class="annot"><span class="annottext">[LHsExpr GhcRn]
</span><a href="#local-6989586621681132574"><span class="hs-identifier hs-var">exps'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132573"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132573"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LHsExpr GhcPs] -&gt; RnM ([LHsExpr GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#rnExprs"><span class="hs-identifier hs-var">rnExprs</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsExpr GhcPs]
</span><a href="#local-6989586621681132576"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-278"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132575"><span class="hs-identifier hs-var">opt_OverloadedLists</span></a></span><span>
</span><span id="line-279"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-280"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132572"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681132572"><span class="hs-identifier hs-var">from_list_n_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132571"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132571"><span class="hs-identifier hs-var">fvs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupSyntax"><span class="hs-identifier hs-var">lookupSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#fromListNName"><span class="hs-identifier hs-var">fromListNName</span></a></span><span>
</span><span id="line-281"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XExplicitList GhcRn
-&gt; Maybe (SyntaxExpr GhcRn) -&gt; [LHsExpr GhcRn] -&gt; HsExpr GhcRn
forall p.
XExplicitList p -&gt; Maybe (SyntaxExpr p) -&gt; [LHsExpr p] -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#ExplicitList"><span class="hs-identifier hs-var">ExplicitList</span></a></span><span> </span><span class="annot"><span class="annottext">XExplicitList GhcPs
XExplicitList GhcRn
</span><a href="#local-6989586621681132577"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntaxExprRn -&gt; Maybe SyntaxExprRn
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681132572"><span class="hs-identifier hs-var">from_list_n_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsExpr GhcRn]
</span><a href="#local-6989586621681132574"><span class="hs-identifier hs-var">exps'</span></a></span><span>
</span><span id="line-282"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132573"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132571"><span class="hs-identifier hs-var">fvs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-283"></span><span>           </span><span class="hs-keyword">else</span><span>
</span><span id="line-284"></span><span>            </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XExplicitList GhcRn
-&gt; Maybe (SyntaxExpr GhcRn) -&gt; [LHsExpr GhcRn] -&gt; HsExpr GhcRn
forall p.
XExplicitList p -&gt; Maybe (SyntaxExpr p) -&gt; [LHsExpr p] -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#ExplicitList"><span class="hs-identifier hs-var">ExplicitList</span></a></span><span> </span><span class="annot"><span class="annottext">XExplicitList GhcPs
XExplicitList GhcRn
</span><a href="#local-6989586621681132577"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcRn)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsExpr GhcRn]
</span><a href="#local-6989586621681132574"><span class="hs-identifier hs-var">exps'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132573"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExplicitTuple"><span class="hs-identifier hs-type">ExplicitTuple</span></a></span><span> </span><span id="local-6989586621681132568"><span class="annot"><span class="annottext">XExplicitTuple GhcPs
</span><a href="#local-6989586621681132568"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132567"><span class="annot"><span class="annottext">[LHsTupArg GhcPs]
</span><a href="#local-6989586621681132567"><span class="hs-identifier hs-var">tup_args</span></a></span></span><span> </span><span id="local-6989586621681132566"><span class="annot"><span class="annottext">Boxity
</span><a href="#local-6989586621681132566"><span class="hs-identifier hs-var">boxity</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">[LHsTupArg GhcPs] -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Expr.html#checkTupleSection"><span class="hs-identifier hs-var">checkTupleSection</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsTupArg GhcPs]
</span><a href="#local-6989586621681132567"><span class="hs-identifier hs-var">tup_args</span></a></span><span>
</span><span id="line-288"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Utils.html#checkTupSize"><span class="hs-identifier hs-var">checkTupSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LHsTupArg GhcPs] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsTupArg GhcPs]
</span><a href="#local-6989586621681132567"><span class="hs-identifier hs-var">tup_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132562"><span class="annot"><span class="annottext">[GenLocated SrcSpan (HsTupArg GhcRn)]
</span><a href="#local-6989586621681132562"><span class="hs-identifier hs-var">tup_args'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132561"><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681132561"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LHsTupArg GhcPs
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv)
      (GenLocated SrcSpan (HsTupArg GhcRn), FreeVars))
-&gt; [LHsTupArg GhcPs]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     ([GenLocated SrcSpan (HsTupArg GhcRn)], [FreeVars])
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; m (b, c)) -&gt; [a] -&gt; m ([b], [c])
</span><a href="../../base/src/Control.Monad.html#mapAndUnzipM"><span class="hs-identifier hs-var">mapAndUnzipM</span></a></span><span> </span><span class="annot"><span class="annottext">LHsTupArg GhcPs
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated SrcSpan (HsTupArg GhcRn), FreeVars)
forall {l}.
GenLocated l (HsTupArg GhcPs)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated l (HsTupArg GhcRn), FreeVars)
</span><a href="#local-6989586621681132559"><span class="hs-identifier hs-var">rnTupArg</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsTupArg GhcPs]
</span><a href="#local-6989586621681132567"><span class="hs-identifier hs-var">tup_args</span></a></span><span>
</span><span id="line-290"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XExplicitTuple GhcRn
-&gt; [GenLocated SrcSpan (HsTupArg GhcRn)] -&gt; Boxity -&gt; HsExpr GhcRn
forall p. XExplicitTuple p -&gt; [LHsTupArg p] -&gt; Boxity -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#ExplicitTuple"><span class="hs-identifier hs-var">ExplicitTuple</span></a></span><span> </span><span class="annot"><span class="annottext">XExplicitTuple GhcPs
XExplicitTuple GhcRn
</span><a href="#local-6989586621681132568"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpan (HsTupArg GhcRn)]
</span><a href="#local-6989586621681132562"><span class="hs-identifier hs-var">tup_args'</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="#local-6989586621681132566"><span class="hs-identifier hs-var">boxity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681132561"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621681132559"><span class="annot"><span class="annottext">rnTupArg :: GenLocated l (HsTupArg GhcPs)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated l (HsTupArg GhcRn), FreeVars)
</span><a href="#local-6989586621681132559"><span class="hs-identifier hs-var hs-var">rnTupArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132554"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621681132554"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#Present"><span class="hs-identifier hs-type">Present</span></a></span><span> </span><span id="local-6989586621681132552"><span class="annot"><span class="annottext">XPresent GhcPs
</span><a href="#local-6989586621681132552"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132551"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132551"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132550"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132550"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132549"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132549"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132551"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-293"></span><span>                                      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(GenLocated l (HsTupArg GhcRn), FreeVars)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated l (HsTupArg GhcRn), FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l -&gt; HsTupArg GhcRn -&gt; GenLocated l (HsTupArg GhcRn)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621681132554"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPresent GhcRn -&gt; LHsExpr GhcRn -&gt; HsTupArg GhcRn
forall id. XPresent id -&gt; LHsExpr id -&gt; HsTupArg id
</span><a href="GHC.Hs.Expr.html#Present"><span class="hs-identifier hs-var">Present</span></a></span><span> </span><span class="annot"><span class="annottext">XPresent GhcPs
XPresent GhcRn
</span><a href="#local-6989586621681132552"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132550"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132549"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><a href="#local-6989586621681132559"><span class="hs-identifier hs-var">rnTupArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132548"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621681132548"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#Missing"><span class="hs-identifier hs-type">Missing</span></a></span><span> </span><span class="annot"><span class="annottext">XMissing GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated l (HsTupArg GhcRn), FreeVars)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated l (HsTupArg GhcRn), FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l -&gt; HsTupArg GhcRn -&gt; GenLocated l (HsTupArg GhcRn)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621681132548"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XMissing GhcRn -&gt; HsTupArg GhcRn
forall id. XMissing id -&gt; HsTupArg id
</span><a href="GHC.Hs.Expr.html#Missing"><span class="hs-identifier hs-var">Missing</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XMissing GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExplicitSum"><span class="hs-identifier hs-type">ExplicitSum</span></a></span><span> </span><span id="local-6989586621681132545"><span class="annot"><span class="annottext">XExplicitSum GhcPs
</span><a href="#local-6989586621681132545"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132544"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681132544"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621681132543"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681132543"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621681132542"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132542"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132541"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132541"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132540"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132540"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132542"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-299"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XExplicitSum GhcRn -&gt; Int -&gt; Int -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XExplicitSum p -&gt; Int -&gt; Int -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#ExplicitSum"><span class="hs-identifier hs-var">ExplicitSum</span></a></span><span> </span><span class="annot"><span class="annottext">XExplicitSum GhcPs
XExplicitSum GhcRn
</span><a href="#local-6989586621681132545"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681132544"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681132543"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132541"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132540"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#RecordCon"><span class="hs-identifier hs-type">RecordCon</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rcon_con_name :: forall p. HsExpr p -&gt; Located (IdP p)
</span><a href="GHC.Hs.Expr.html#rcon_con_name"><span class="hs-identifier hs-var">rcon_con_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681132537"><span class="annot"><span class="annottext">GenLocated SrcSpan (IdP GhcPs)
</span><a href="#local-6989586621681132537"><span class="hs-identifier hs-var">con_id</span></a></span></span><span>
</span><span id="line-302"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rcon_flds :: forall p. HsExpr p -&gt; HsRecordBinds p
</span><a href="GHC.Hs.Expr.html#rcon_flds"><span class="hs-identifier hs-var">rcon_flds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681132535"><span class="annot"><span class="annottext">rec_binds :: HsRecordBinds GhcPs
</span><a href="#local-6989586621681132535"><span class="hs-identifier hs-var">rec_binds</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Pat.html#HsRecFields"><span class="hs-identifier hs-type">HsRecFields</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rec_dotdot :: forall p arg. HsRecFields p arg -&gt; Maybe (Located Int)
</span><a href="GHC.Hs.Pat.html#rec_dotdot"><span class="hs-identifier hs-var">rec_dotdot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681132532"><span class="annot"><span class="annottext">Maybe (Located Int)
</span><a href="#local-6989586621681132532"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681132531"><span class="annot"><span class="annottext">con_lname :: Located Name
</span><a href="#local-6989586621681132531"><span class="hs-identifier hs-var">con_lname</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132530"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132530"><span class="hs-identifier hs-var">con_name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located RdrName -&gt; RnM (Located Name)
</span><a href="GHC.Rename.Env.html#lookupLocatedOccRn"><span class="hs-identifier hs-var">lookupLocatedOccRn</span></a></span><span> </span><span class="annot"><span class="annottext">Located RdrName
GenLocated SrcSpan (IdP GhcPs)
</span><a href="#local-6989586621681132537"><span class="hs-identifier hs-var">con_id</span></a></span><span>
</span><span id="line-304"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132528"><span class="annot"><span class="annottext">[LHsRecField GhcRn (LHsExpr GhcPs)]
</span><a href="#local-6989586621681132528"><span class="hs-identifier hs-var">flds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132527"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132527"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsRecFieldContext
-&gt; (SrcSpan -&gt; RdrName -&gt; HsExpr GhcPs)
-&gt; HsRecordBinds GhcPs
-&gt; RnM ([LHsRecField GhcRn (LHsExpr GhcPs)], FreeVars)
forall arg.
HsRecFieldContext
-&gt; (SrcSpan -&gt; RdrName -&gt; arg)
-&gt; HsRecFields GhcPs (Located arg)
-&gt; RnM ([LHsRecField GhcRn (Located arg)], FreeVars)
</span><a href="GHC.Rename.Pat.html#rnHsRecFields"><span class="hs-identifier hs-var">rnHsRecFields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; HsRecFieldContext
</span><a href="GHC.Rename.Pat.html#HsRecFieldCon"><span class="hs-identifier hs-var">HsRecFieldCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132530"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; RdrName -&gt; HsExpr GhcPs
forall {p}. (XVar p ~ NoExtField) =&gt; SrcSpan -&gt; IdP p -&gt; HsExpr p
</span><a href="#local-6989586621681132524"><span class="hs-identifier hs-var">mk_hs_var</span></a></span><span> </span><span class="annot"><span class="annottext">HsRecordBinds GhcPs
</span><a href="#local-6989586621681132535"><span class="hs-identifier hs-var">rec_binds</span></a></span><span>
</span><span id="line-305"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132523"><span class="annot"><span class="annottext">[GenLocated SrcSpan (HsRecField' (FieldOcc GhcRn) (LHsExpr GhcRn))]
</span><a href="#local-6989586621681132523"><span class="hs-identifier hs-var">flds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132522"><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681132522"><span class="hs-identifier hs-var">fvss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LHsRecField GhcRn (LHsExpr GhcPs)
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv)
      (GenLocated SrcSpan (HsRecField' (FieldOcc GhcRn) (LHsExpr GhcRn)),
       FreeVars))
-&gt; [LHsRecField GhcRn (LHsExpr GhcPs)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     ([GenLocated
         SrcSpan (HsRecField' (FieldOcc GhcRn) (LHsExpr GhcRn))],
      [FreeVars])
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; m (b, c)) -&gt; [a] -&gt; m ([b], [c])
</span><a href="../../base/src/Control.Monad.html#mapAndUnzipM"><span class="hs-identifier hs-var">mapAndUnzipM</span></a></span><span> </span><span class="annot"><span class="annottext">LHsRecField GhcRn (LHsExpr GhcPs)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated SrcSpan (HsRecField' (FieldOcc GhcRn) (LHsExpr GhcRn)),
      FreeVars)
forall {l} {id}.
GenLocated l (HsRecField' id (LHsExpr GhcPs))
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated l (HsRecField' id (LHsExpr GhcRn)), FreeVars)
</span><a href="#local-6989586621681132521"><span class="hs-identifier hs-var">rn_field</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsRecField GhcRn (LHsExpr GhcPs)]
</span><a href="#local-6989586621681132528"><span class="hs-identifier hs-var">flds</span></a></span><span>
</span><span id="line-306"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681132520"><span class="annot"><span class="annottext">rec_binds' :: HsRecFields GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621681132520"><span class="hs-identifier hs-var hs-var">rec_binds'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsRecFields :: forall p arg.
[LHsRecField p arg] -&gt; Maybe (Located Int) -&gt; HsRecFields p arg
</span><a href="GHC.Hs.Pat.html#HsRecFields"><span class="hs-identifier hs-type">HsRecFields</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rec_flds :: [GenLocated SrcSpan (HsRecField' (FieldOcc GhcRn) (LHsExpr GhcRn))]
</span><a href="GHC.Hs.Pat.html#rec_flds"><span class="hs-identifier hs-var">rec_flds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpan (HsRecField' (FieldOcc GhcRn) (LHsExpr GhcRn))]
</span><a href="#local-6989586621681132523"><span class="hs-identifier hs-var">flds'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rec_dotdot :: Maybe (Located Int)
</span><a href="GHC.Hs.Pat.html#rec_dotdot"><span class="hs-identifier hs-var">rec_dotdot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Located Int)
</span><a href="#local-6989586621681132532"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-307"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecordCon :: forall p.
XRecordCon p -&gt; Located (IdP p) -&gt; HsRecordBinds p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#RecordCon"><span class="hs-identifier hs-type">RecordCon</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rcon_ext :: XRecordCon GhcRn
</span><a href="GHC.Hs.Expr.html#rcon_ext"><span class="hs-identifier hs-var">rcon_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NoExtField
XRecordCon GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span>
</span><span id="line-308"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rcon_con_name :: Located (IdP GhcRn)
</span><a href="GHC.Hs.Expr.html#rcon_con_name"><span class="hs-identifier hs-var">rcon_con_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located Name
Located (IdP GhcRn)
</span><a href="#local-6989586621681132531"><span class="hs-identifier hs-var">con_lname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rcon_flds :: HsRecFields GhcRn (LHsExpr GhcRn)
</span><a href="GHC.Hs.Expr.html#rcon_flds"><span class="hs-identifier hs-var">rcon_flds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsRecFields GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621681132520"><span class="hs-identifier hs-var">rec_binds'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-309"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132527"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681132522"><span class="hs-identifier hs-var">fvss</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#addOneFV"><span class="hs-operator hs-var">`addOneFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681132530"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>    </span><span id="local-6989586621681132524"><span class="annot"><span class="annottext">mk_hs_var :: SrcSpan -&gt; IdP p -&gt; HsExpr p
</span><a href="#local-6989586621681132524"><span class="hs-identifier hs-var hs-var">mk_hs_var</span></a></span></span><span> </span><span id="local-6989586621681132512"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132512"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681132511"><span class="annot"><span class="annottext">IdP p
</span><a href="#local-6989586621681132511"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XVar p -&gt; Located (IdP p) -&gt; HsExpr p
forall p. XVar p -&gt; Located (IdP p) -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XVar p
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; IdP p -&gt; Located (IdP p)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132512"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IdP p
</span><a href="#local-6989586621681132511"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621681132521"><span class="annot"><span class="annottext">rn_field :: GenLocated l (HsRecField' id (LHsExpr GhcPs))
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated l (HsRecField' id (LHsExpr GhcRn)), FreeVars)
</span><a href="#local-6989586621681132521"><span class="hs-identifier hs-var hs-var">rn_field</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132508"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621681132508"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681132507"><span class="annot"><span class="annottext">HsRecField' id (LHsExpr GhcPs)
</span><a href="#local-6989586621681132507"><span class="hs-identifier hs-var">fld</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132506"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132506"><span class="hs-identifier hs-var">arg'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132505"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132505"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsRecField' id (LHsExpr GhcPs) -&gt; LHsExpr GhcPs
forall id arg. HsRecField' id arg -&gt; arg
</span><a href="GHC.Hs.Pat.html#hsRecFieldArg"><span class="hs-identifier hs-var hs-var">hsRecFieldArg</span></a></span><span> </span><span class="annot"><span class="annottext">HsRecField' id (LHsExpr GhcPs)
</span><a href="#local-6989586621681132507"><span class="hs-identifier hs-var">fld</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>                            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(GenLocated l (HsRecField' id (LHsExpr GhcRn)), FreeVars)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated l (HsRecField' id (LHsExpr GhcRn)), FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l
-&gt; HsRecField' id (LHsExpr GhcRn)
-&gt; GenLocated l (HsRecField' id (LHsExpr GhcRn))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621681132508"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsRecField' id (LHsExpr GhcPs)
</span><a href="#local-6989586621681132507"><span class="hs-identifier hs-var">fld</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hsRecFieldArg :: LHsExpr GhcRn
</span><a href="GHC.Hs.Pat.html#hsRecFieldArg"><span class="hs-identifier hs-var">hsRecFieldArg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132506"><span class="hs-identifier hs-var">arg'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132505"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#RecordUpd"><span class="hs-identifier hs-type">RecordUpd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rupd_expr :: forall p. HsExpr p -&gt; LHsExpr p
</span><a href="GHC.Hs.Expr.html#rupd_expr"><span class="hs-identifier hs-var">rupd_expr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681132501"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132501"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rupd_flds :: forall p. HsExpr p -&gt; [LHsRecUpdField p]
</span><a href="GHC.Hs.Expr.html#rupd_flds"><span class="hs-identifier hs-var">rupd_flds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681132499"><span class="annot"><span class="annottext">[LHsRecUpdField GhcPs]
</span><a href="#local-6989586621681132499"><span class="hs-identifier hs-var">rbinds</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132498"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132498"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132497"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132497"><span class="hs-identifier hs-var">fvExpr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132501"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-317"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132496"><span class="annot"><span class="annottext">[LHsRecUpdField GhcRn]
</span><a href="#local-6989586621681132496"><span class="hs-identifier hs-var">rbinds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132495"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132495"><span class="hs-identifier hs-var">fvRbinds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LHsRecUpdField GhcPs] -&gt; RnM ([LHsRecUpdField GhcRn], FreeVars)
</span><a href="GHC.Rename.Pat.html#rnHsRecUpdFields"><span class="hs-identifier hs-var">rnHsRecUpdFields</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsRecUpdField GhcPs]
</span><a href="#local-6989586621681132499"><span class="hs-identifier hs-var">rbinds</span></a></span><span>
</span><span id="line-318"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecordUpd :: forall p.
XRecordUpd p -&gt; LHsExpr p -&gt; [LHsRecUpdField p] -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#RecordUpd"><span class="hs-identifier hs-type">RecordUpd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rupd_ext :: XRecordUpd GhcRn
</span><a href="GHC.Hs.Expr.html#rupd_ext"><span class="hs-identifier hs-var">rupd_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NoExtField
XRecordUpd GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rupd_expr :: LHsExpr GhcRn
</span><a href="GHC.Hs.Expr.html#rupd_expr"><span class="hs-identifier hs-var">rupd_expr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132498"><span class="hs-identifier hs-var">expr'</span></a></span><span>
</span><span id="line-319"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rupd_flds :: [LHsRecUpdField GhcRn]
</span><a href="GHC.Hs.Expr.html#rupd_flds"><span class="hs-identifier hs-var">rupd_flds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LHsRecUpdField GhcRn]
</span><a href="#local-6989586621681132496"><span class="hs-identifier hs-var">rbinds'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-320"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132497"><span class="hs-identifier hs-var">fvExpr</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132495"><span class="hs-identifier hs-var">fvRbinds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprWithTySig"><span class="hs-identifier hs-type">ExprWithTySig</span></a></span><span> </span><span class="annot"><span class="annottext">XExprWithTySig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132491"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132491"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621681132490"><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc GhcPs)
</span><a href="#local-6989586621681132490"><span class="hs-identifier hs-var">pty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132489"><span class="annot"><span class="annottext">LHsSigWcType GhcRn
</span><a href="#local-6989586621681132489"><span class="hs-identifier hs-var">pty'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132488"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132488"><span class="hs-identifier hs-var">fvTy</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; LHsSigWcType GhcPs -&gt; RnM (LHsSigWcType GhcRn, FreeVars)
</span><a href="GHC.Rename.HsType.html#rnHsSigWcType"><span class="hs-identifier hs-var">rnHsSigWcType</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="GHC.Rename.Utils.html#ExprWithTySigCtx"><span class="hs-identifier hs-var">ExprWithTySigCtx</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcPs
LHsSigWcType (NoGhcTc GhcPs)
</span><a href="#local-6989586621681132490"><span class="hs-identifier hs-var">pty</span></a></span><span>
</span><span id="line-324"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132485"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132485"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132484"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132484"><span class="hs-identifier hs-var">fvExpr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name]
-&gt; RnM (LHsExpr GhcRn, FreeVars) -&gt; RnM (LHsExpr GhcRn, FreeVars)
forall a. [Name] -&gt; RnM (a, FreeVars) -&gt; RnM (a, FreeVars)
</span><a href="GHC.Rename.HsType.html#bindSigTyVarsFV"><span class="hs-identifier hs-var">bindSigTyVarsFV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsSigWcType GhcRn -&gt; [Name]
</span><a href="GHC.Hs.Type.html#hsWcScopedTvs"><span class="hs-identifier hs-var">hsWcScopedTvs</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcRn
</span><a href="#local-6989586621681132489"><span class="hs-identifier hs-var">pty'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RnM (LHsExpr GhcRn, FreeVars) -&gt; RnM (LHsExpr GhcRn, FreeVars))
-&gt; RnM (LHsExpr GhcRn, FreeVars) -&gt; RnM (LHsExpr GhcRn, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-325"></span><span>                             </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132491"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-326"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XExprWithTySig GhcRn
-&gt; LHsExpr GhcRn -&gt; LHsSigWcType (NoGhcTc GhcRn) -&gt; HsExpr GhcRn
forall p.
XExprWithTySig p
-&gt; LHsExpr p -&gt; LHsSigWcType (NoGhcTc p) -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#ExprWithTySig"><span class="hs-identifier hs-var">ExprWithTySig</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XExprWithTySig GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132485"><span class="hs-identifier hs-var">expr'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcRn
LHsSigWcType (NoGhcTc GhcRn)
</span><a href="#local-6989586621681132489"><span class="hs-identifier hs-var">pty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132484"><span class="hs-identifier hs-var">fvExpr</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132488"><span class="hs-identifier hs-var">fvTy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-327"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsIf"><span class="hs-identifier hs-type">HsIf</span></a></span><span> </span><span class="annot"><span class="annottext">XIf GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132480"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132480"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681132479"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132479"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span id="local-6989586621681132478"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132478"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132477"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132477"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132476"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132476"><span class="hs-identifier hs-var">fvP</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132480"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-329"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132475"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132475"><span class="hs-identifier hs-var">b1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132474"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132474"><span class="hs-identifier hs-var">fvB1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132479"><span class="hs-identifier hs-var">b1</span></a></span><span>
</span><span id="line-330"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132473"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132473"><span class="hs-identifier hs-var">b2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132472"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132472"><span class="hs-identifier hs-var">fvB2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132478"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-331"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681132471"><span class="annot"><span class="annottext">Maybe (Located Name)
</span><a href="#local-6989586621681132471"><span class="hs-identifier hs-var">mifteName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RnM (Maybe (Located Name))
</span><a href="GHC.Rename.Env.html#lookupReboundIf"><span class="hs-identifier hs-var">lookupReboundIf</span></a></span><span>
</span><span id="line-332"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681132469"><span class="annot"><span class="annottext">subFVs :: FreeVars
</span><a href="#local-6989586621681132469"><span class="hs-identifier hs-var hs-var">subFVs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132476"><span class="hs-identifier hs-var">fvP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132474"><span class="hs-identifier hs-var">fvB1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132472"><span class="hs-identifier hs-var">fvB2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-333"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">((HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars))
-&gt; (HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Located Name)
</span><a href="#local-6989586621681132471"><span class="hs-identifier hs-var">mifteName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-334"></span><span>           </span><span class="hs-comment">-- RS is off, we keep an 'HsIf' node around</span><span>
</span><span id="line-335"></span><span>           </span><span class="annot"><span class="annottext">Maybe (Located Name)
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-336"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XIf GhcRn
-&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XIf p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XIf GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span>  </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132477"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132475"><span class="hs-identifier hs-var">b1'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132473"><span class="hs-identifier hs-var">b2'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132469"><span class="hs-identifier hs-var">subFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>           </span><span class="hs-comment">-- See Note [Rebindable syntax and HsExpansion].</span><span>
</span><span id="line-338"></span><span>           </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681132468"><span class="annot"><span class="annottext">Located Name
</span><a href="#local-6989586621681132468"><span class="hs-identifier hs-var">ifteName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-339"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681132467"><span class="annot"><span class="annottext">ifteExpr :: HsExpr GhcRn
</span><a href="#local-6989586621681132467"><span class="hs-identifier hs-var hs-var">ifteExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located Name
-&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
</span><a href="GHC.Rename.Expr.html#rebindIf"><span class="hs-identifier hs-var">rebindIf</span></a></span><span> </span><span class="annot"><span class="annottext">Located Name
</span><a href="#local-6989586621681132468"><span class="hs-identifier hs-var">ifteName</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132477"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132475"><span class="hs-identifier hs-var">b1'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132473"><span class="hs-identifier hs-var">b2'</span></a></span><span>
</span><span id="line-340"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681132467"><span class="hs-identifier hs-var">ifteExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located Name -&gt; Name
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Located Name
</span><a href="#local-6989586621681132468"><span class="hs-identifier hs-var">ifteName</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132469"><span class="hs-identifier hs-var">subFVs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-342"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsMultiIf"><span class="hs-identifier hs-type">HsMultiIf</span></a></span><span> </span><span id="local-6989586621681132463"><span class="annot"><span class="annottext">XMultiIf GhcPs
</span><a href="#local-6989586621681132463"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132462"><span class="annot"><span class="annottext">[LGRHS GhcPs (LHsExpr GhcPs)]
</span><a href="#local-6989586621681132462"><span class="hs-identifier hs-var">alts</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132461"><span class="annot"><span class="annottext">[LGRHS GhcRn (LHsExpr GhcRn)]
</span><a href="#local-6989586621681132461"><span class="hs-identifier hs-var">alts'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132460"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132460"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LGRHS GhcPs (LHsExpr GhcPs)
 -&gt; RnM (LGRHS GhcRn (LHsExpr GhcRn), FreeVars))
-&gt; [LGRHS GhcPs (LHsExpr GhcPs)]
-&gt; RnM ([LGRHS GhcRn (LHsExpr GhcRn)], FreeVars)
forall a b. (a -&gt; RnM (b, FreeVars)) -&gt; [a] -&gt; RnM ([b], FreeVars)
</span><a href="GHC.Rename.Utils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsMatchContext GhcRn
-&gt; (LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars))
-&gt; LGRHS GhcPs (LHsExpr GhcPs)
-&gt; RnM (LGRHS GhcRn (LHsExpr GhcRn), FreeVars)
forall (body :: * -&gt; *).
HsMatchContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; LGRHS GhcPs (Located (body GhcPs))
-&gt; RnM (LGRHS GhcRn (Located (body GhcRn)), FreeVars)
</span><a href="GHC.Rename.Bind.html#rnGRHS"><span class="hs-identifier hs-var">rnGRHS</span></a></span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
forall p. HsMatchContext p
</span><a href="GHC.Hs.Expr.html#IfAlt"><span class="hs-identifier hs-var">IfAlt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LGRHS GhcPs (LHsExpr GhcPs)]
</span><a href="#local-6989586621681132462"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-344"></span><span>       </span><span class="hs-comment">-- ; return (HsMultiIf ty alts', fvs) }</span><span>
</span><span id="line-345"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XMultiIf GhcRn -&gt; [LGRHS GhcRn (LHsExpr GhcRn)] -&gt; HsExpr GhcRn
forall p. XMultiIf p -&gt; [LGRHS p (LHsExpr p)] -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsMultiIf"><span class="hs-identifier hs-var">HsMultiIf</span></a></span><span> </span><span class="annot"><span class="annottext">XMultiIf GhcPs
XMultiIf GhcRn
</span><a href="#local-6989586621681132463"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[LGRHS GhcRn (LHsExpr GhcRn)]
</span><a href="#local-6989586621681132461"><span class="hs-identifier hs-var">alts'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132460"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ArithSeq"><span class="hs-identifier hs-type">ArithSeq</span></a></span><span> </span><span id="local-6989586621681132457"><span class="annot"><span class="annottext">XArithSeq GhcPs
</span><a href="#local-6989586621681132457"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcPs)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132456"><span class="annot"><span class="annottext">ArithSeqInfo GhcPs
</span><a href="#local-6989586621681132456"><span class="hs-identifier hs-var">seq</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681132455"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132455"><span class="hs-identifier hs-var">opt_OverloadedLists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#OverloadedLists"><span class="hs-identifier hs-var">LangExt.OverloadedLists</span></a></span><span>
</span><span id="line-349"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132454"><span class="annot"><span class="annottext">ArithSeqInfo GhcRn
</span><a href="#local-6989586621681132454"><span class="hs-identifier hs-var">new_seq</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132453"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132453"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ArithSeqInfo GhcPs -&gt; RnM (ArithSeqInfo GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnArithSeq"><span class="hs-identifier hs-var">rnArithSeq</span></a></span><span> </span><span class="annot"><span class="annottext">ArithSeqInfo GhcPs
</span><a href="#local-6989586621681132456"><span class="hs-identifier hs-var">seq</span></a></span><span>
</span><span id="line-350"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132455"><span class="hs-identifier hs-var">opt_OverloadedLists</span></a></span><span>
</span><span id="line-351"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-352"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132451"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681132451"><span class="hs-identifier hs-var">from_list_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132450"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132450"><span class="hs-identifier hs-var">fvs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupSyntax"><span class="hs-identifier hs-var">lookupSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#fromListName"><span class="hs-identifier hs-var">fromListName</span></a></span><span>
</span><span id="line-353"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XArithSeq GhcRn
-&gt; Maybe (SyntaxExpr GhcRn) -&gt; ArithSeqInfo GhcRn -&gt; HsExpr GhcRn
forall p.
XArithSeq p -&gt; Maybe (SyntaxExpr p) -&gt; ArithSeqInfo p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#ArithSeq"><span class="hs-identifier hs-var">ArithSeq</span></a></span><span> </span><span class="annot"><span class="annottext">XArithSeq GhcPs
XArithSeq GhcRn
</span><a href="#local-6989586621681132457"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntaxExprRn -&gt; Maybe SyntaxExprRn
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681132451"><span class="hs-identifier hs-var">from_list_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ArithSeqInfo GhcRn
</span><a href="#local-6989586621681132454"><span class="hs-identifier hs-var">new_seq</span></a></span><span>
</span><span id="line-354"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132453"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132450"><span class="hs-identifier hs-var">fvs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-355"></span><span>           </span><span class="hs-keyword">else</span><span>
</span><span id="line-356"></span><span>            </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XArithSeq GhcRn
-&gt; Maybe (SyntaxExpr GhcRn) -&gt; ArithSeqInfo GhcRn -&gt; HsExpr GhcRn
forall p.
XArithSeq p -&gt; Maybe (SyntaxExpr p) -&gt; ArithSeqInfo p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#ArithSeq"><span class="hs-identifier hs-var">ArithSeq</span></a></span><span> </span><span class="annot"><span class="annottext">XArithSeq GhcPs
XArithSeq GhcRn
</span><a href="#local-6989586621681132457"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcRn)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ArithSeqInfo GhcRn
</span><a href="#local-6989586621681132454"><span class="hs-identifier hs-var">new_seq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132453"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Static values
*                                                                      *
************************************************************************

For the static form we check that it is not used in splices.
We also collect the free variables of the term which come from
this module. See Note [Grand plan for static forms] in GHC.Iface.Tidy.StaticPtrTable.
-}</span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span id="local-6989586621681132448"><span class="annot"><span class="annottext">e :: HsExpr GhcPs
</span><a href="#local-6989586621681132448"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsStatic"><span class="hs-identifier hs-type">HsStatic</span></a></span><span> </span><span class="annot"><span class="annottext">XStatic GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132446"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132446"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-comment">-- Normally, you wouldn't be able to construct a static expression without</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-comment">-- first enabling -XStaticPointers in the first place, since that extension</span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-comment">-- is what makes the parser treat `static` as a keyword. But this is not a</span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-comment">-- sufficient safeguard, as one can construct static expressions by another</span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-comment">-- mechanism: Template Haskell (see #14204). To ensure that GHC is</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-comment">-- absolutely prepared to cope with static forms, we check for</span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-comment">-- -XStaticPointers here as well.</span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><span class="annottext">Extension
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#unlessXOptM"><span class="hs-identifier hs-var">unlessXOptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#StaticPointers"><span class="hs-identifier hs-var">LangExt.StaticPointers</span></a></span><span> </span><span class="annot"><span class="annottext">(IOEnv (Env TcGblEnv TcLclEnv) ()
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) ())
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-379"></span><span>      </span><span class="annot"><span class="annottext">MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="annot"><span class="annottext">(MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ())
-&gt; MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; Int -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal static expression:&quot;</span></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132448"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>                  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Use StaticPointers to enable this extension&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681132439"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132439"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132438"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132438"><span class="hs-identifier hs-var">fvExpr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132446"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621681132437"><span class="annot"><span class="annottext">ThStage
</span><a href="#local-6989586621681132437"><span class="hs-identifier hs-var">stage</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM ThStage
</span><a href="GHC.Tc.Utils.Monad.html#getStage"><span class="hs-identifier hs-var">getStage</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ThStage
</span><a href="#local-6989586621681132437"><span class="hs-identifier hs-var">stage</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-384"></span><span>      </span><span class="annot"><a href="GHC.Tc.Types.html#Splice"><span class="hs-identifier hs-type">Splice</span></a></span><span> </span><span class="annot"><span class="annottext">SpliceType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="annot"><span class="annottext">(MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ())
-&gt; MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[MsgDoc] -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-385"></span><span>             </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;static forms cannot be used in splices:&quot;</span></span><span>
</span><span id="line-386"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(MsgDoc -&gt; MsgDoc) -&gt; MsgDoc -&gt; MsgDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132448"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-387"></span><span>             </span><span class="hs-special">]</span><span>
</span><span id="line-388"></span><span>      </span><span class="annot"><span class="annottext">ThStage
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>    </span><span id="local-6989586621681132432"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681132432"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) Module
forall (m :: * -&gt; *). HasModule m =&gt; m Module
</span><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681132431"><span class="annot"><span class="annottext">fvExpr' :: FreeVars
</span><a href="#local-6989586621681132431"><span class="hs-identifier hs-var hs-var">fvExpr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#filterNameSet"><span class="hs-identifier hs-var">filterNameSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; Name -&gt; Bool
</span><a href="GHC.Types.Name.html#nameIsLocalOrFrom"><span class="hs-identifier hs-var">nameIsLocalOrFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681132432"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132438"><span class="hs-identifier hs-var">fvExpr</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XStatic GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XStatic p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsStatic"><span class="hs-identifier hs-var">HsStatic</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
XStatic GhcRn
</span><a href="#local-6989586621681132431"><span class="hs-identifier hs-var">fvExpr'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132439"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132438"><span class="hs-identifier hs-var">fvExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Arrow notation
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsProc"><span class="hs-identifier hs-type">HsProc</span></a></span><span> </span><span id="local-6989586621681132428"><span class="annot"><span class="annottext">XProc GhcPs
</span><a href="#local-6989586621681132428"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132427"><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621681132427"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681132426"><span class="annot"><span class="annottext">LHsCmdTop GhcPs
</span><a href="#local-6989586621681132426"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcM (HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall a. TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#newArrowScope"><span class="hs-identifier hs-var">newArrowScope</span></a></span><span> </span><span class="annot"><span class="annottext">(TcM (HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars))
-&gt; TcM (HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
-&gt; LPat GhcPs
-&gt; (LPat GhcRn -&gt; TcM (HsExpr GhcRn, FreeVars))
-&gt; TcM (HsExpr GhcRn, FreeVars)
forall a.
HsMatchContext GhcRn
-&gt; LPat GhcPs
-&gt; (LPat GhcRn -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
</span><a href="GHC.Rename.Pat.html#rnPat"><span class="hs-identifier hs-var">rnPat</span></a></span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
forall p. HsMatchContext p
</span><a href="GHC.Hs.Expr.html#ProcExpr"><span class="hs-identifier hs-var">ProcExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621681132427"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">((LPat GhcRn -&gt; TcM (HsExpr GhcRn, FreeVars))
 -&gt; TcM (HsExpr GhcRn, FreeVars))
-&gt; (LPat GhcRn -&gt; TcM (HsExpr GhcRn, FreeVars))
-&gt; TcM (HsExpr GhcRn, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681132422"><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681132422"><span class="hs-identifier hs-var">pat'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-404"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132421"><span class="annot"><span class="annottext">LHsCmdTop GhcRn
</span><a href="#local-6989586621681132421"><span class="hs-identifier hs-var">body'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132420"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132420"><span class="hs-identifier hs-var">fvBody</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcPs -&gt; RnM (LHsCmdTop GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnCmdTop"><span class="hs-identifier hs-var">rnCmdTop</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcPs
</span><a href="#local-6989586621681132426"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-405"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XProc GhcRn -&gt; LPat GhcRn -&gt; LHsCmdTop GhcRn -&gt; HsExpr GhcRn
forall p. XProc p -&gt; LPat p -&gt; LHsCmdTop p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsProc"><span class="hs-identifier hs-var">HsProc</span></a></span><span> </span><span class="annot"><span class="annottext">XProc GhcPs
XProc GhcRn
</span><a href="#local-6989586621681132428"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681132422"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcRn
</span><a href="#local-6989586621681132421"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132420"><span class="hs-identifier hs-var">fvBody</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnExpr"><span class="hs-identifier hs-var">rnExpr</span></a></span><span> </span><span id="local-6989586621681132418"><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132418"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc -&gt; TcM (HsExpr GhcRn, FreeVars)
forall a. HasCallStack =&gt; String -&gt; MsgDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rnExpr: unexpected expression&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132418"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>        </span><span class="hs-comment">-- HsWrap</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="hs-comment">----------------------</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- See Note [Parsing sections] in GHC.Parser</span><span>
</span><span id="line-412"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnSection"><span class="hs-identifier hs-type">rnSection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span id="rnSection"><span class="annot"><span class="annottext">rnSection :: HsExpr GhcPs -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnSection"><span class="hs-identifier hs-var hs-var">rnSection</span></a></span></span><span> </span><span id="local-6989586621681132416"><span class="annot"><span class="annottext">section :: HsExpr GhcPs
</span><a href="#local-6989586621681132416"><span class="hs-identifier hs-var">section</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#SectionR"><span class="hs-identifier hs-type">SectionR</span></a></span><span> </span><span id="local-6989586621681132415"><span class="annot"><span class="annottext">XSectionR GhcPs
</span><a href="#local-6989586621681132415"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132414"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132414"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621681132413"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132413"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132412"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132412"><span class="hs-identifier hs-var">op'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132411"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132411"><span class="hs-identifier hs-var">fvs_op</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132414"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-415"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132410"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132410"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132409"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132409"><span class="hs-identifier hs-var">fvs_expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132413"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-416"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FixityDirection
-&gt; HsExpr GhcPs
-&gt; LHsExpr GhcRn
-&gt; LHsExpr GhcRn
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.HsType.html#checkSectionPrec"><span class="hs-identifier hs-var">checkSectionPrec</span></a></span><span> </span><span class="annot"><span class="annottext">FixityDirection
</span><a href="GHC.Types.Basic.html#InfixR"><span class="hs-identifier hs-var">InfixR</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132416"><span class="hs-identifier hs-var">section</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132412"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132410"><span class="hs-identifier hs-var">expr'</span></a></span><span>
</span><span id="line-417"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XSectionR GhcRn -&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XSectionR p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#SectionR"><span class="hs-identifier hs-var">SectionR</span></a></span><span> </span><span class="annot"><span class="annottext">XSectionR GhcPs
XSectionR GhcRn
</span><a href="#local-6989586621681132415"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132412"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132410"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132411"><span class="hs-identifier hs-var">fvs_op</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132409"><span class="hs-identifier hs-var">fvs_expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnSection"><span class="hs-identifier hs-var">rnSection</span></a></span><span> </span><span id="local-6989586621681132406"><span class="annot"><span class="annottext">section :: HsExpr GhcPs
</span><a href="#local-6989586621681132406"><span class="hs-identifier hs-var">section</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#SectionL"><span class="hs-identifier hs-type">SectionL</span></a></span><span> </span><span id="local-6989586621681132405"><span class="annot"><span class="annottext">XSectionL GhcPs
</span><a href="#local-6989586621681132405"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132404"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132404"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621681132403"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132403"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132402"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132402"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132401"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132401"><span class="hs-identifier hs-var">fvs_expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132404"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-421"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132400"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132400"><span class="hs-identifier hs-var">op'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132399"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132399"><span class="hs-identifier hs-var">fvs_op</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132403"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-422"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FixityDirection
-&gt; HsExpr GhcPs
-&gt; LHsExpr GhcRn
-&gt; LHsExpr GhcRn
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.HsType.html#checkSectionPrec"><span class="hs-identifier hs-var">checkSectionPrec</span></a></span><span> </span><span class="annot"><span class="annottext">FixityDirection
</span><a href="GHC.Types.Basic.html#InfixL"><span class="hs-identifier hs-var">InfixL</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132406"><span class="hs-identifier hs-var">section</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132400"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132402"><span class="hs-identifier hs-var">expr'</span></a></span><span>
</span><span id="line-423"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XSectionL GhcRn -&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XSectionL p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#SectionL"><span class="hs-identifier hs-var">SectionL</span></a></span><span> </span><span class="annot"><span class="annottext">XSectionL GhcPs
XSectionL GhcRn
</span><a href="#local-6989586621681132405"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132402"><span class="hs-identifier hs-var">expr'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132400"><span class="hs-identifier hs-var">op'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132399"><span class="hs-identifier hs-var">fvs_op</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132401"><span class="hs-identifier hs-var">fvs_expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnSection"><span class="hs-identifier hs-var">rnSection</span></a></span><span> </span><span id="local-6989586621681132398"><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132398"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc -&gt; TcM (HsExpr GhcRn, FreeVars)
forall a. HasCallStack =&gt; String -&gt; MsgDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rnSection&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681132398"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Arrow commands
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmdArgs"><span class="hs-identifier hs-type">rnCmdArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmdTop"><span class="hs-identifier hs-type">LHsCmdTop</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmdTop"><span class="hs-identifier hs-type">LHsCmdTop</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span id="rnCmdArgs"><span class="annot"><span class="annottext">rnCmdArgs :: [LHsCmdTop GhcPs] -&gt; RnM ([LHsCmdTop GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#rnCmdArgs"><span class="hs-identifier hs-var hs-var">rnCmdArgs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([LHsCmdTop GhcRn], FreeVars) -&gt; RnM ([LHsCmdTop GhcRn], FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmdArgs"><span class="hs-identifier hs-var">rnCmdArgs</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132396"><span class="annot"><span class="annottext">LHsCmdTop GhcPs
</span><a href="#local-6989586621681132396"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681132395"><span class="annot"><span class="annottext">[LHsCmdTop GhcPs]
</span><a href="#local-6989586621681132395"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132394"><span class="annot"><span class="annottext">LHsCmdTop GhcRn
</span><a href="#local-6989586621681132394"><span class="hs-identifier hs-var">arg'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132393"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132393"><span class="hs-identifier hs-var">fvArg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcPs -&gt; RnM (LHsCmdTop GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnCmdTop"><span class="hs-identifier hs-var">rnCmdTop</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcPs
</span><a href="#local-6989586621681132396"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-439"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132392"><span class="annot"><span class="annottext">[LHsCmdTop GhcRn]
</span><a href="#local-6989586621681132392"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132391"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132391"><span class="hs-identifier hs-var">fvArgs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LHsCmdTop GhcPs] -&gt; RnM ([LHsCmdTop GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#rnCmdArgs"><span class="hs-identifier hs-var">rnCmdArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsCmdTop GhcPs]
</span><a href="#local-6989586621681132395"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-440"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">([LHsCmdTop GhcRn], FreeVars) -&gt; RnM ([LHsCmdTop GhcRn], FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsCmdTop GhcRn
</span><a href="#local-6989586621681132394"><span class="hs-identifier hs-var">arg'</span></a></span><span class="annot"><span class="annottext">LHsCmdTop GhcRn -&gt; [LHsCmdTop GhcRn] -&gt; [LHsCmdTop GhcRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[LHsCmdTop GhcRn]
</span><a href="#local-6989586621681132392"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132393"><span class="hs-identifier hs-var">fvArg</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132391"><span class="hs-identifier hs-var">fvArgs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmdTop"><span class="hs-identifier hs-type">rnCmdTop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmdTop"><span class="hs-identifier hs-type">LHsCmdTop</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmdTop"><span class="hs-identifier hs-type">LHsCmdTop</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span id="rnCmdTop"><span class="annot"><span class="annottext">rnCmdTop :: LHsCmdTop GhcPs -&gt; RnM (LHsCmdTop GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnCmdTop"><span class="hs-identifier hs-var hs-var">rnCmdTop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HsCmdTop GhcPs -&gt; TcM (HsCmdTop GhcRn, FreeVars))
-&gt; LHsCmdTop GhcPs -&gt; RnM (LHsCmdTop GhcRn, FreeVars)
forall a b c. (a -&gt; TcM (b, c)) -&gt; Located a -&gt; TcM (Located b, c)
</span><a href="GHC.Tc.Utils.Monad.html#wrapLocFstM"><span class="hs-identifier hs-var">wrapLocFstM</span></a></span><span> </span><span class="annot"><span class="annottext">HsCmdTop GhcPs -&gt; TcM (HsCmdTop GhcRn, FreeVars)
</span><a href="#local-6989586621681132390"><span class="hs-identifier hs-var">rnCmdTop'</span></a></span><span>
</span><span id="line-444"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-445"></span><span>  </span><span id="local-6989586621681132390"><span class="annot"><span class="annottext">rnCmdTop' :: HsCmdTop GhcPs -&gt; TcM (HsCmdTop GhcRn, FreeVars)
</span><a href="#local-6989586621681132390"><span class="hs-identifier hs-var hs-var">rnCmdTop'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdTop"><span class="hs-identifier hs-type">HsCmdTop</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdTop GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132385"><span class="annot"><span class="annottext">LHsCmd GhcPs
</span><a href="#local-6989586621681132385"><span class="hs-identifier hs-var">cmd</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132384"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132384"><span class="hs-identifier hs-var">cmd'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132383"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132383"><span class="hs-identifier hs-var">fvCmd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLCmd"><span class="hs-identifier hs-var">rnLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs
</span><a href="#local-6989586621681132385"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-447"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681132381"><span class="annot"><span class="annottext">cmd_names :: [Name]
</span><a href="#local-6989586621681132381"><span class="hs-identifier hs-var hs-var">cmd_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#arrAName"><span class="hs-identifier hs-var">arrAName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#composeAName"><span class="hs-identifier hs-var">composeAName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#firstAName"><span class="hs-identifier hs-var">firstAName</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-448"></span><span>                          </span><span class="annot"><span class="annottext">FreeVars -&gt; [Name]
</span><a href="GHC.Types.Name.Set.html#nameSetElemsStable"><span class="hs-identifier hs-var">nameSetElemsStable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var">methodNamesCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsCmd GhcRn -&gt; HsCmd GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132384"><span class="hs-identifier hs-var">cmd'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>        </span><span class="hs-comment">-- Generate the rebindable syntax for the monad</span><span>
</span><span id="line-450"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132375"><span class="annot"><span class="annottext">[HsExpr GhcRn]
</span><a href="#local-6989586621681132375"><span class="hs-identifier hs-var">cmd_names'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132374"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132374"><span class="hs-identifier hs-var">cmd_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM ([HsExpr GhcRn], FreeVars)
</span><a href="GHC.Rename.Env.html#lookupSyntaxNames"><span class="hs-identifier hs-var">lookupSyntaxNames</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681132381"><span class="hs-identifier hs-var">cmd_names</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsCmdTop GhcRn, FreeVars) -&gt; TcM (HsCmdTop GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCmdTop GhcRn -&gt; LHsCmd GhcRn -&gt; HsCmdTop GhcRn
forall p. XCmdTop p -&gt; LHsCmd p -&gt; HsCmdTop p
</span><a href="GHC.Hs.Expr.html#HsCmdTop"><span class="hs-identifier hs-var">HsCmdTop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681132381"><span class="hs-identifier hs-var">cmd_names</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [HsExpr GhcRn] -&gt; [(Name, HsExpr GhcRn)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../base/src/GHC.List.html#zip"><span class="hs-operator hs-var">`zip`</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExpr GhcRn]
</span><a href="#local-6989586621681132375"><span class="hs-identifier hs-var">cmd_names'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132384"><span class="hs-identifier hs-var">cmd'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-453"></span><span>                  </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132383"><span class="hs-identifier hs-var">fvCmd</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132374"><span class="hs-identifier hs-var">cmd_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnLCmd"><span class="hs-identifier hs-type">rnLCmd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span id="rnLCmd"><span class="annot"><span class="annottext">rnLCmd :: LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLCmd"><span class="hs-identifier hs-var hs-var">rnLCmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcPs -&gt; TcM (HsCmd GhcRn, FreeVars))
-&gt; LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars)
forall a b c. (a -&gt; TcM (b, c)) -&gt; Located a -&gt; TcM (Located b, c)
</span><a href="GHC.Tc.Utils.Monad.html#wrapLocFstM"><span class="hs-identifier hs-var">wrapLocFstM</span></a></span><span> </span><span class="annot"><span class="annottext">HsCmd GhcPs -&gt; TcM (HsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-var">rnCmd</span></a></span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-type">rnCmd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span id="rnCmd"><span class="annot"><span class="annottext">rnCmd :: HsCmd GhcPs -&gt; TcM (HsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-var hs-var">rnCmd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdArrApp"><span class="hs-identifier hs-type">HsCmdArrApp</span></a></span><span> </span><span id="local-6989586621681132370"><span class="annot"><span class="annottext">XCmdArrApp GhcPs
</span><a href="#local-6989586621681132370"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132369"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132369"><span class="hs-identifier hs-var">arrow</span></a></span></span><span> </span><span id="local-6989586621681132368"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132368"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621681132367"><span class="annot"><span class="annottext">HsArrAppType
</span><a href="#local-6989586621681132367"><span class="hs-identifier hs-var">ho</span></a></span></span><span> </span><span id="local-6989586621681132366"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132366"><span class="hs-identifier hs-var">rtl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132365"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132365"><span class="hs-identifier hs-var">arrow'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132364"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132364"><span class="hs-identifier hs-var">fvArrow</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RnM (LHsExpr GhcRn, FreeVars) -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="#local-6989586621681132363"><span class="hs-identifier hs-var">select_arrow_scope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132369"><span class="hs-identifier hs-var">arrow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132362"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132362"><span class="hs-identifier hs-var">arg'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132361"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132361"><span class="hs-identifier hs-var">fvArg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132368"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-463"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcRn, FreeVars) -&gt; TcM (HsCmd GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCmdArrApp GhcRn
-&gt; LHsExpr GhcRn
-&gt; LHsExpr GhcRn
-&gt; HsArrAppType
-&gt; Bool
-&gt; HsCmd GhcRn
forall id.
XCmdArrApp id
-&gt; LHsExpr id -&gt; LHsExpr id -&gt; HsArrAppType -&gt; Bool -&gt; HsCmd id
</span><a href="GHC.Hs.Expr.html#HsCmdArrApp"><span class="hs-identifier hs-var">HsCmdArrApp</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdArrApp GhcPs
XCmdArrApp GhcRn
</span><a href="#local-6989586621681132370"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132365"><span class="hs-identifier hs-var">arrow'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132362"><span class="hs-identifier hs-var">arg'</span></a></span><span> </span><span class="annot"><span class="annottext">HsArrAppType
</span><a href="#local-6989586621681132367"><span class="hs-identifier hs-var">ho</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132366"><span class="hs-identifier hs-var">rtl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-464"></span><span>                 </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132364"><span class="hs-identifier hs-var">fvArrow</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132361"><span class="hs-identifier hs-var">fvArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-466"></span><span>    </span><span id="local-6989586621681132363"><span class="annot"><span class="annottext">select_arrow_scope :: RnM (LHsExpr GhcRn, FreeVars) -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="#local-6989586621681132363"><span class="hs-identifier hs-var hs-var">select_arrow_scope</span></a></span></span><span> </span><span id="local-6989586621681132360"><span class="annot"><span class="annottext">RnM (LHsExpr GhcRn, FreeVars)
</span><a href="#local-6989586621681132360"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsArrAppType
</span><a href="#local-6989586621681132367"><span class="hs-identifier hs-var">ho</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-467"></span><span>        </span><span class="annot"><span class="annottext">HsArrAppType
</span><a href="GHC.Hs.Expr.html#HsHigherOrderApp"><span class="hs-identifier hs-var">HsHigherOrderApp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RnM (LHsExpr GhcRn, FreeVars)
</span><a href="#local-6989586621681132360"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-468"></span><span>        </span><span class="annot"><span class="annottext">HsArrAppType
</span><a href="GHC.Hs.Expr.html#HsFirstOrderApp"><span class="hs-identifier hs-var">HsFirstOrderApp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RnM (LHsExpr GhcRn, FreeVars) -&gt; RnM (LHsExpr GhcRn, FreeVars)
forall a. TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#escapeArrowScope"><span class="hs-identifier hs-var">escapeArrowScope</span></a></span><span> </span><span class="annot"><span class="annottext">RnM (LHsExpr GhcRn, FreeVars)
</span><a href="#local-6989586621681132360"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-469"></span><span>        </span><span class="hs-comment">-- See Note [Escaping the arrow scope] in GHC.Tc.Types</span><span>
</span><span id="line-470"></span><span>        </span><span class="hs-comment">-- Before renaming 'arrow', use the environment of the enclosing</span><span>
</span><span id="line-471"></span><span>        </span><span class="hs-comment">-- proc for the (-&lt;) case.</span><span>
</span><span id="line-472"></span><span>        </span><span class="hs-comment">-- Local bindings, inside the enclosing proc, are not in scope</span><span>
</span><span id="line-473"></span><span>        </span><span class="hs-comment">-- inside 'arrow'.  In the higher-order case (-&lt;&lt;), they are.</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-comment">-- infix form</span><span>
</span><span id="line-476"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-var">rnCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdArrForm"><span class="hs-identifier hs-type">HsCmdArrForm</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdArrForm GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132355"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132355"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">LexicalFixity
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681132354"><span class="annot"><span class="annottext">LHsCmdTop GhcPs
</span><a href="#local-6989586621681132354"><span class="hs-identifier hs-var">arg1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132353"><span class="annot"><span class="annottext">LHsCmdTop GhcPs
</span><a href="#local-6989586621681132353"><span class="hs-identifier hs-var">arg2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132352"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132352"><span class="hs-identifier hs-var">op'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132351"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132351"><span class="hs-identifier hs-var">fv_op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RnM (LHsExpr GhcRn, FreeVars) -&gt; RnM (LHsExpr GhcRn, FreeVars)
forall a. TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#escapeArrowScope"><span class="hs-identifier hs-var">escapeArrowScope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132355"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132350"><span class="annot"><span class="annottext">IdP GhcRn
</span><a href="#local-6989586621681132350"><span class="hs-identifier hs-var">op_name</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132352"><span class="hs-identifier hs-var">op'</span></a></span><span>
</span><span id="line-479"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132349"><span class="annot"><span class="annottext">LHsCmdTop GhcRn
</span><a href="#local-6989586621681132349"><span class="hs-identifier hs-var">arg1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132348"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132348"><span class="hs-identifier hs-var">fv_arg1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcPs -&gt; RnM (LHsCmdTop GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnCmdTop"><span class="hs-identifier hs-var">rnCmdTop</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcPs
</span><a href="#local-6989586621681132354"><span class="hs-identifier hs-var">arg1</span></a></span><span>
</span><span id="line-480"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132347"><span class="annot"><span class="annottext">LHsCmdTop GhcRn
</span><a href="#local-6989586621681132347"><span class="hs-identifier hs-var">arg2'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132346"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132346"><span class="hs-identifier hs-var">fv_arg2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcPs -&gt; RnM (LHsCmdTop GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnCmdTop"><span class="hs-identifier hs-var">rnCmdTop</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcPs
</span><a href="#local-6989586621681132353"><span class="hs-identifier hs-var">arg2</span></a></span><span>
</span><span id="line-481"></span><span>        </span><span class="hs-comment">-- Deal with fixity</span><span>
</span><span id="line-482"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681132345"><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621681132345"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) Fixity
</span><a href="GHC.Rename.Fixity.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
IdP GhcRn
</span><a href="#local-6989586621681132350"><span class="hs-identifier hs-var">op_name</span></a></span><span>
</span><span id="line-483"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681132344"><span class="annot"><span class="annottext">HsCmd GhcRn
</span><a href="#local-6989586621681132344"><span class="hs-identifier hs-var">final_e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcRn
-&gt; LHsExpr GhcRn -&gt; Fixity -&gt; LHsCmdTop GhcRn -&gt; RnM (HsCmd GhcRn)
</span><a href="GHC.Rename.HsType.html#mkOpFormRn"><span class="hs-identifier hs-var">mkOpFormRn</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcRn
</span><a href="#local-6989586621681132349"><span class="hs-identifier hs-var">arg1'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132352"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621681132345"><span class="hs-identifier hs-var">fixity</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcRn
</span><a href="#local-6989586621681132347"><span class="hs-identifier hs-var">arg2'</span></a></span><span>
</span><span id="line-484"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcRn, FreeVars) -&gt; TcM (HsCmd GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsCmd GhcRn
</span><a href="#local-6989586621681132344"><span class="hs-identifier hs-var">final_e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132348"><span class="hs-identifier hs-var">fv_arg1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132351"><span class="hs-identifier hs-var">fv_op</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132346"><span class="hs-identifier hs-var">fv_arg2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-var">rnCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdArrForm"><span class="hs-identifier hs-type">HsCmdArrForm</span></a></span><span> </span><span id="local-6989586621681132342"><span class="annot"><span class="annottext">XCmdArrForm GhcPs
</span><a href="#local-6989586621681132342"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132341"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132341"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621681132340"><span class="annot"><span class="annottext">LexicalFixity
</span><a href="#local-6989586621681132340"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681132339"><span class="annot"><span class="annottext">Maybe Fixity
</span><a href="#local-6989586621681132339"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span id="local-6989586621681132338"><span class="annot"><span class="annottext">[LHsCmdTop GhcPs]
</span><a href="#local-6989586621681132338"><span class="hs-identifier hs-var">cmds</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132337"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132337"><span class="hs-identifier hs-var">op'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132336"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132336"><span class="hs-identifier hs-var">fvOp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RnM (LHsExpr GhcRn, FreeVars) -&gt; RnM (LHsExpr GhcRn, FreeVars)
forall a. TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#escapeArrowScope"><span class="hs-identifier hs-var">escapeArrowScope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132341"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132335"><span class="annot"><span class="annottext">[LHsCmdTop GhcRn]
</span><a href="#local-6989586621681132335"><span class="hs-identifier hs-var">cmds'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132334"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132334"><span class="hs-identifier hs-var">fvCmds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LHsCmdTop GhcPs] -&gt; RnM ([LHsCmdTop GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#rnCmdArgs"><span class="hs-identifier hs-var">rnCmdArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsCmdTop GhcPs]
</span><a href="#local-6989586621681132338"><span class="hs-identifier hs-var">cmds</span></a></span><span>
</span><span id="line-489"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcRn, FreeVars) -&gt; TcM (HsCmd GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCmdArrForm GhcRn
-&gt; LHsExpr GhcRn
-&gt; LexicalFixity
-&gt; Maybe Fixity
-&gt; [LHsCmdTop GhcRn]
-&gt; HsCmd GhcRn
forall id.
XCmdArrForm id
-&gt; LHsExpr id
-&gt; LexicalFixity
-&gt; Maybe Fixity
-&gt; [LHsCmdTop id]
-&gt; HsCmd id
</span><a href="GHC.Hs.Expr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdArrForm GhcPs
XCmdArrForm GhcRn
</span><a href="#local-6989586621681132342"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132337"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">LexicalFixity
</span><a href="#local-6989586621681132340"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Fixity
</span><a href="#local-6989586621681132339"><span class="hs-identifier hs-var">fixity</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsCmdTop GhcRn]
</span><a href="#local-6989586621681132335"><span class="hs-identifier hs-var">cmds'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132336"><span class="hs-identifier hs-var">fvOp</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132334"><span class="hs-identifier hs-var">fvCmds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-var">rnCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdApp"><span class="hs-identifier hs-type">HsCmdApp</span></a></span><span> </span><span id="local-6989586621681132332"><span class="annot"><span class="annottext">XCmdApp GhcPs
</span><a href="#local-6989586621681132332"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132331"><span class="annot"><span class="annottext">LHsCmd GhcPs
</span><a href="#local-6989586621681132331"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681132330"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132330"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132329"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132329"><span class="hs-identifier hs-var">fun'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132328"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132328"><span class="hs-identifier hs-var">fvFun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLCmd"><span class="hs-identifier hs-var">rnLCmd</span></a></span><span>  </span><span class="annot"><span class="annottext">LHsCmd GhcPs
</span><a href="#local-6989586621681132331"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-493"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132327"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132327"><span class="hs-identifier hs-var">arg'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132326"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132326"><span class="hs-identifier hs-var">fvArg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132330"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-494"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcRn, FreeVars) -&gt; TcM (HsCmd GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCmdApp GhcRn -&gt; LHsCmd GhcRn -&gt; LHsExpr GhcRn -&gt; HsCmd GhcRn
forall id. XCmdApp id -&gt; LHsCmd id -&gt; LHsExpr id -&gt; HsCmd id
</span><a href="GHC.Hs.Expr.html#HsCmdApp"><span class="hs-identifier hs-var">HsCmdApp</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdApp GhcPs
XCmdApp GhcRn
</span><a href="#local-6989586621681132332"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132329"><span class="hs-identifier hs-var">fun'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132327"><span class="hs-identifier hs-var">arg'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132328"><span class="hs-identifier hs-var">fvFun</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132326"><span class="hs-identifier hs-var">fvArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-var">rnCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdLam"><span class="hs-identifier hs-type">HsCmdLam</span></a></span><span> </span><span id="local-6989586621681132324"><span class="annot"><span class="annottext">XCmdLam GhcPs
</span><a href="#local-6989586621681132324"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132323"><span class="annot"><span class="annottext">MatchGroup GhcPs (LHsCmd GhcPs)
</span><a href="#local-6989586621681132323"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132322"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132322"><span class="hs-identifier hs-var">matches'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132321"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132321"><span class="hs-identifier hs-var">fvMatch</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
-&gt; (LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars))
-&gt; MatchGroup GhcPs (LHsCmd GhcPs)
-&gt; RnM (MatchGroup GhcRn (LHsCmd GhcRn), FreeVars)
forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsMatchContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; MatchGroup GhcPs (Located (body GhcPs))
-&gt; RnM (MatchGroup GhcRn (Located (body GhcRn)), FreeVars)
</span><a href="GHC.Rename.Bind.html#rnMatchGroup"><span class="hs-identifier hs-var">rnMatchGroup</span></a></span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
forall p. HsMatchContext p
</span><a href="GHC.Hs.Expr.html#LambdaExpr"><span class="hs-identifier hs-var">LambdaExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLCmd"><span class="hs-identifier hs-var">rnLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcPs (LHsCmd GhcPs)
</span><a href="#local-6989586621681132323"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-498"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcRn, FreeVars) -&gt; TcM (HsCmd GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCmdLam GhcRn -&gt; MatchGroup GhcRn (LHsCmd GhcRn) -&gt; HsCmd GhcRn
forall id. XCmdLam id -&gt; MatchGroup id (LHsCmd id) -&gt; HsCmd id
</span><a href="GHC.Hs.Expr.html#HsCmdLam"><span class="hs-identifier hs-var">HsCmdLam</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdLam GhcPs
XCmdLam GhcRn
</span><a href="#local-6989586621681132324"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132322"><span class="hs-identifier hs-var">matches'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132321"><span class="hs-identifier hs-var">fvMatch</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-var">rnCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdPar"><span class="hs-identifier hs-type">HsCmdPar</span></a></span><span> </span><span id="local-6989586621681132319"><span class="annot"><span class="annottext">XCmdPar GhcPs
</span><a href="#local-6989586621681132319"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132318"><span class="annot"><span class="annottext">LHsCmd GhcPs
</span><a href="#local-6989586621681132318"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132317"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132317"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132316"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132316"><span class="hs-identifier hs-var">fvs_e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLCmd"><span class="hs-identifier hs-var">rnLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs
</span><a href="#local-6989586621681132318"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-502"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcRn, FreeVars) -&gt; TcM (HsCmd GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCmdPar GhcRn -&gt; LHsCmd GhcRn -&gt; HsCmd GhcRn
forall id. XCmdPar id -&gt; LHsCmd id -&gt; HsCmd id
</span><a href="GHC.Hs.Expr.html#HsCmdPar"><span class="hs-identifier hs-var">HsCmdPar</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdPar GhcPs
XCmdPar GhcRn
</span><a href="#local-6989586621681132319"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132317"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132316"><span class="hs-identifier hs-var">fvs_e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-var">rnCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdCase"><span class="hs-identifier hs-type">HsCmdCase</span></a></span><span> </span><span id="local-6989586621681132314"><span class="annot"><span class="annottext">XCmdCase GhcPs
</span><a href="#local-6989586621681132314"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132313"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132313"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621681132312"><span class="annot"><span class="annottext">MatchGroup GhcPs (LHsCmd GhcPs)
</span><a href="#local-6989586621681132312"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132311"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132311"><span class="hs-identifier hs-var">new_expr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132310"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132310"><span class="hs-identifier hs-var">e_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132313"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-506"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132309"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132309"><span class="hs-identifier hs-var">new_matches</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132308"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132308"><span class="hs-identifier hs-var">ms_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
-&gt; (LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars))
-&gt; MatchGroup GhcPs (LHsCmd GhcPs)
-&gt; RnM (MatchGroup GhcRn (LHsCmd GhcRn), FreeVars)
forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsMatchContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; MatchGroup GhcPs (Located (body GhcPs))
-&gt; RnM (MatchGroup GhcRn (Located (body GhcRn)), FreeVars)
</span><a href="GHC.Rename.Bind.html#rnMatchGroup"><span class="hs-identifier hs-var">rnMatchGroup</span></a></span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
forall p. HsMatchContext p
</span><a href="GHC.Hs.Expr.html#CaseAlt"><span class="hs-identifier hs-var">CaseAlt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLCmd"><span class="hs-identifier hs-var">rnLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcPs (LHsCmd GhcPs)
</span><a href="#local-6989586621681132312"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-507"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcRn, FreeVars) -&gt; TcM (HsCmd GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCmdCase GhcRn
-&gt; LHsExpr GhcRn -&gt; MatchGroup GhcRn (LHsCmd GhcRn) -&gt; HsCmd GhcRn
forall id.
XCmdCase id -&gt; LHsExpr id -&gt; MatchGroup id (LHsCmd id) -&gt; HsCmd id
</span><a href="GHC.Hs.Expr.html#HsCmdCase"><span class="hs-identifier hs-var">HsCmdCase</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdCase GhcPs
XCmdCase GhcRn
</span><a href="#local-6989586621681132314"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132311"><span class="hs-identifier hs-var">new_expr</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132309"><span class="hs-identifier hs-var">new_matches</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132310"><span class="hs-identifier hs-var">e_fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132308"><span class="hs-identifier hs-var">ms_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-var">rnCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdLamCase"><span class="hs-identifier hs-type">HsCmdLamCase</span></a></span><span> </span><span id="local-6989586621681132306"><span class="annot"><span class="annottext">XCmdLamCase GhcPs
</span><a href="#local-6989586621681132306"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681132305"><span class="annot"><span class="annottext">MatchGroup GhcPs (LHsCmd GhcPs)
</span><a href="#local-6989586621681132305"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132304"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132304"><span class="hs-identifier hs-var">new_matches</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132303"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132303"><span class="hs-identifier hs-var">ms_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
-&gt; (LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars))
-&gt; MatchGroup GhcPs (LHsCmd GhcPs)
-&gt; RnM (MatchGroup GhcRn (LHsCmd GhcRn), FreeVars)
forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsMatchContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; MatchGroup GhcPs (Located (body GhcPs))
-&gt; RnM (MatchGroup GhcRn (Located (body GhcRn)), FreeVars)
</span><a href="GHC.Rename.Bind.html#rnMatchGroup"><span class="hs-identifier hs-var">rnMatchGroup</span></a></span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
forall p. HsMatchContext p
</span><a href="GHC.Hs.Expr.html#CaseAlt"><span class="hs-identifier hs-var">CaseAlt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLCmd"><span class="hs-identifier hs-var">rnLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcPs (LHsCmd GhcPs)
</span><a href="#local-6989586621681132305"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-511"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcRn, FreeVars) -&gt; TcM (HsCmd GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCmdLamCase GhcRn -&gt; MatchGroup GhcRn (LHsCmd GhcRn) -&gt; HsCmd GhcRn
forall id. XCmdLamCase id -&gt; MatchGroup id (LHsCmd id) -&gt; HsCmd id
</span><a href="GHC.Hs.Expr.html#HsCmdLamCase"><span class="hs-identifier hs-var">HsCmdLamCase</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdLamCase GhcPs
XCmdLamCase GhcRn
</span><a href="#local-6989586621681132306"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132304"><span class="hs-identifier hs-var">new_matches</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132303"><span class="hs-identifier hs-var">ms_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-var">rnCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdIf"><span class="hs-identifier hs-type">HsCmdIf</span></a></span><span> </span><span id="local-6989586621681132301"><span class="annot"><span class="annottext">XCmdIf GhcPs
</span><a href="#local-6989586621681132301"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132300"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132300"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681132299"><span class="annot"><span class="annottext">LHsCmd GhcPs
</span><a href="#local-6989586621681132299"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span id="local-6989586621681132298"><span class="annot"><span class="annottext">LHsCmd GhcPs
</span><a href="#local-6989586621681132298"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132297"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132297"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132296"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132296"><span class="hs-identifier hs-var">fvP</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132300"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-515"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132295"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132295"><span class="hs-identifier hs-var">b1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132294"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132294"><span class="hs-identifier hs-var">fvB1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLCmd"><span class="hs-identifier hs-var">rnLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs
</span><a href="#local-6989586621681132299"><span class="hs-identifier hs-var">b1</span></a></span><span>
</span><span id="line-516"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132293"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132293"><span class="hs-identifier hs-var">b2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132292"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132292"><span class="hs-identifier hs-var">fvB2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLCmd"><span class="hs-identifier hs-var">rnLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs
</span><a href="#local-6989586621681132298"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-517"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132291"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681132291"><span class="hs-identifier hs-var">mb_ite</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132290"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132290"><span class="hs-identifier hs-var">fvITE</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupIfThenElse"><span class="hs-identifier hs-var">lookupIfThenElse</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-518"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcRn, FreeVars) -&gt; TcM (HsCmd GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCmdIf GhcRn
-&gt; SyntaxExpr GhcRn
-&gt; LHsExpr GhcRn
-&gt; LHsCmd GhcRn
-&gt; LHsCmd GhcRn
-&gt; HsCmd GhcRn
forall id.
XCmdIf id
-&gt; SyntaxExpr id
-&gt; LHsExpr id
-&gt; LHsCmd id
-&gt; LHsCmd id
-&gt; HsCmd id
</span><a href="GHC.Hs.Expr.html#HsCmdIf"><span class="hs-identifier hs-var">HsCmdIf</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdIf GhcPs
XCmdIf GhcRn
</span><a href="#local-6989586621681132301"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681132291"><span class="hs-identifier hs-var">mb_ite</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132297"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132295"><span class="hs-identifier hs-var">b1'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132293"><span class="hs-identifier hs-var">b2'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132290"><span class="hs-identifier hs-var">fvITE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132296"><span class="hs-identifier hs-var">fvP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132294"><span class="hs-identifier hs-var">fvB1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132292"><span class="hs-identifier hs-var">fvB2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-var">rnCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdLet"><span class="hs-identifier hs-type">HsCmdLet</span></a></span><span> </span><span id="local-6989586621681132287"><span class="annot"><span class="annottext">XCmdLet GhcPs
</span><a href="#local-6989586621681132287"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132286"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132286"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681132285"><span class="annot"><span class="annottext">HsLocalBinds GhcPs
</span><a href="#local-6989586621681132285"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681132284"><span class="annot"><span class="annottext">LHsCmd GhcPs
</span><a href="#local-6989586621681132284"><span class="hs-identifier hs-var">cmd</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcPs
-&gt; (HsLocalBinds GhcRn -&gt; FreeVars -&gt; TcM (HsCmd GhcRn, FreeVars))
-&gt; TcM (HsCmd GhcRn, FreeVars)
forall result.
HsLocalBinds GhcPs
-&gt; (HsLocalBinds GhcRn -&gt; FreeVars -&gt; RnM (result, FreeVars))
-&gt; RnM (result, FreeVars)
</span><a href="GHC.Rename.Bind.html#rnLocalBindsAndThen"><span class="hs-identifier hs-var">rnLocalBindsAndThen</span></a></span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcPs
</span><a href="#local-6989586621681132285"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">((HsLocalBinds GhcRn -&gt; FreeVars -&gt; TcM (HsCmd GhcRn, FreeVars))
 -&gt; TcM (HsCmd GhcRn, FreeVars))
-&gt; (HsLocalBinds GhcRn -&gt; FreeVars -&gt; TcM (HsCmd GhcRn, FreeVars))
-&gt; TcM (HsCmd GhcRn, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681132283"><span class="annot"><span class="annottext">HsLocalBinds GhcRn
</span><a href="#local-6989586621681132283"><span class="hs-identifier hs-var">binds'</span></a></span></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-522"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132282"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132282"><span class="hs-identifier hs-var">cmd'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681132281"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132281"><span class="hs-identifier hs-var">fvExpr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLCmd"><span class="hs-identifier hs-var">rnLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs
</span><a href="#local-6989586621681132284"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-523"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcRn, FreeVars) -&gt; TcM (HsCmd GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCmdLet GhcRn -&gt; LHsLocalBinds GhcRn -&gt; LHsCmd GhcRn -&gt; HsCmd GhcRn
forall id. XCmdLet id -&gt; LHsLocalBinds id -&gt; LHsCmd id -&gt; HsCmd id
</span><a href="GHC.Hs.Expr.html#HsCmdLet"><span class="hs-identifier hs-var">HsCmdLet</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdLet GhcPs
XCmdLet GhcRn
</span><a href="#local-6989586621681132287"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; HsLocalBinds GhcRn -&gt; LHsLocalBinds GhcRn
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132286"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcRn
</span><a href="#local-6989586621681132283"><span class="hs-identifier hs-var">binds'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132282"><span class="hs-identifier hs-var">cmd'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132281"><span class="hs-identifier hs-var">fvExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnCmd"><span class="hs-identifier hs-var">rnCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdDo"><span class="hs-identifier hs-type">HsCmdDo</span></a></span><span> </span><span id="local-6989586621681132279"><span class="annot"><span class="annottext">XCmdDo GhcPs
</span><a href="#local-6989586621681132279"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132278"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132278"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681132277"><span class="annot"><span class="annottext">[CmdLStmt GhcPs]
</span><a href="#local-6989586621681132277"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681132276"><span class="annot"><span class="annottext">[LStmt GhcRn (LHsCmd GhcRn)]
</span><a href="#local-6989586621681132276"><span class="hs-identifier hs-var">stmts'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132275"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132275"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-527"></span><span>            </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars))
-&gt; [CmdLStmt GhcPs]
-&gt; ([Name] -&gt; RnM ((), FreeVars))
-&gt; RnM (([LStmt GhcRn (LHsCmd GhcRn)], ()), FreeVars)
forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM (([LStmt GhcRn (Located (body GhcRn))], thing), FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmts"><span class="hs-identifier hs-var">rnStmts</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
forall p. HsStmtContext p
</span><a href="GHC.Hs.Expr.html#ArrowExpr"><span class="hs-identifier hs-var">ArrowExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcPs -&gt; RnM (LHsCmd GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLCmd"><span class="hs-identifier hs-var">rnLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">[CmdLStmt GhcPs]
</span><a href="#local-6989586621681132277"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((), FreeVars) -&gt; RnM ((), FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcRn, FreeVars) -&gt; TcM (HsCmd GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">XCmdDo GhcRn -&gt; Located [LStmt GhcRn (LHsCmd GhcRn)] -&gt; HsCmd GhcRn
forall id. XCmdDo id -&gt; Located [CmdLStmt id] -&gt; HsCmd id
</span><a href="GHC.Hs.Expr.html#HsCmdDo"><span class="hs-identifier hs-var">HsCmdDo</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdDo GhcPs
XCmdDo GhcRn
</span><a href="#local-6989586621681132279"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
-&gt; [LStmt GhcRn (LHsCmd GhcRn)]
-&gt; Located [LStmt GhcRn (LHsCmd GhcRn)]
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132278"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn (LHsCmd GhcRn)]
</span><a href="#local-6989586621681132276"><span class="hs-identifier hs-var">stmts'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132275"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span class="hs-comment">---------------------------------------------------</span><span>
</span><span id="line-531"></span><span class="hs-keyword">type</span><span> </span><span id="CmdNeeds"><span class="annot"><a href="GHC.Rename.Expr.html#CmdNeeds"><span class="hs-identifier hs-var">CmdNeeds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span>        </span><span class="hs-comment">-- Only inhabitants are</span><span>
</span><span id="line-532"></span><span>                                </span><span class="hs-comment">--      appAName, choiceAName, loopAName</span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span class="hs-comment">-- find what methods the Cmd needs (loop, choice, apply)</span><span>
</span><span id="line-535"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesLCmd"><span class="hs-identifier hs-type">methodNamesLCmd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#CmdNeeds"><span class="hs-identifier hs-type">CmdNeeds</span></a></span><span>
</span><span id="line-536"></span><span id="methodNamesLCmd"><span class="annot"><span class="annottext">methodNamesLCmd :: LHsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesLCmd"><span class="hs-identifier hs-var hs-var">methodNamesLCmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var">methodNamesCmd</span></a></span><span> </span><span class="annot"><span class="annottext">(HsCmd GhcRn -&gt; FreeVars)
-&gt; (LHsCmd GhcRn -&gt; HsCmd GhcRn) -&gt; LHsCmd GhcRn -&gt; FreeVars
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn -&gt; HsCmd GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-type">methodNamesCmd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#CmdNeeds"><span class="hs-identifier hs-type">CmdNeeds</span></a></span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span id="methodNamesCmd"><span class="annot"><span class="annottext">methodNamesCmd :: HsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var hs-var">methodNamesCmd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdArrApp"><span class="hs-identifier hs-type">HsCmdArrApp</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdArrApp GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132270"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132270"><span class="hs-identifier hs-var">_arrow</span></a></span></span><span> </span><span id="local-6989586621681132269"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132269"><span class="hs-identifier hs-var">_arg</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsArrAppType
</span><a href="GHC.Hs.Expr.html#HsFirstOrderApp"><span class="hs-identifier hs-var">HsFirstOrderApp</span></a></span><span> </span><span id="local-6989586621681132268"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132268"><span class="hs-identifier hs-var">_rtl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span>
</span><span id="line-542"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var">methodNamesCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdArrApp"><span class="hs-identifier hs-type">HsCmdArrApp</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdArrApp GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132267"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132267"><span class="hs-identifier hs-var">_arrow</span></a></span></span><span> </span><span id="local-6989586621681132266"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132266"><span class="hs-identifier hs-var">_arg</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsArrAppType
</span><a href="GHC.Hs.Expr.html#HsHigherOrderApp"><span class="hs-identifier hs-var">HsHigherOrderApp</span></a></span><span> </span><span id="local-6989586621681132265"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132265"><span class="hs-identifier hs-var">_rtl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#appAName"><span class="hs-identifier hs-var">appAName</span></a></span><span>
</span><span id="line-544"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var">methodNamesCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdArrForm"><span class="hs-identifier hs-type">HsCmdArrForm</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var">methodNamesCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdPar"><span class="hs-identifier hs-type">HsCmdPar</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdPar GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132263"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132263"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesLCmd"><span class="hs-identifier hs-var">methodNamesLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132263"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var">methodNamesCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdIf"><span class="hs-identifier hs-type">HsCmdIf</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdIf GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132262"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132262"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621681132261"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132261"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesLCmd"><span class="hs-identifier hs-var">methodNamesLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132262"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesLCmd"><span class="hs-identifier hs-var">methodNamesLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132261"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#addOneFV"><span class="hs-operator hs-var">`addOneFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#choiceAName"><span class="hs-identifier hs-var">choiceAName</span></a></span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var">methodNamesCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdLet"><span class="hs-identifier hs-type">HsCmdLet</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdLet GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsLocalBinds GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132259"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132259"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesLCmd"><span class="hs-identifier hs-var">methodNamesLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132259"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-552"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var">methodNamesCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdDo"><span class="hs-identifier hs-type">HsCmdDo</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdDo GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132258"><span class="annot"><span class="annottext">[LStmt GhcRn (LHsCmd GhcRn)]
</span><a href="#local-6989586621681132258"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn (LHsCmd GhcRn)] -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesStmts"><span class="hs-identifier hs-var">methodNamesStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn (LHsCmd GhcRn)]
</span><a href="#local-6989586621681132258"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-553"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var">methodNamesCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdApp"><span class="hs-identifier hs-type">HsCmdApp</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdApp GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132256"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132256"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesLCmd"><span class="hs-identifier hs-var">methodNamesLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132256"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-554"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var">methodNamesCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdLam"><span class="hs-identifier hs-type">HsCmdLam</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdLam GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132255"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132255"><span class="hs-identifier hs-var">match</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn) -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesMatch"><span class="hs-identifier hs-var">methodNamesMatch</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132255"><span class="hs-identifier hs-var">match</span></a></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var">methodNamesCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdCase"><span class="hs-identifier hs-type">HsCmdCase</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdCase GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132253"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132253"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn) -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesMatch"><span class="hs-identifier hs-var">methodNamesMatch</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132253"><span class="hs-identifier hs-var">matches</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#addOneFV"><span class="hs-operator hs-var">`addOneFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#choiceAName"><span class="hs-identifier hs-var">choiceAName</span></a></span><span>
</span><span id="line-558"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesCmd"><span class="hs-identifier hs-var">methodNamesCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsCmdLamCase"><span class="hs-identifier hs-type">HsCmdLamCase</span></a></span><span> </span><span class="annot"><span class="annottext">XCmdLamCase GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132252"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132252"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn) -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesMatch"><span class="hs-identifier hs-var">methodNamesMatch</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132252"><span class="hs-identifier hs-var">matches</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#addOneFV"><span class="hs-operator hs-var">`addOneFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#choiceAName"><span class="hs-identifier hs-var">choiceAName</span></a></span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-comment">--methodNamesCmd _ = emptyFVs</span><span>
</span><span id="line-562"></span><span>   </span><span class="hs-comment">-- Other forms can't occur in commands, but it's not convenient</span><span>
</span><span id="line-563"></span><span>   </span><span class="hs-comment">-- to error here so we just do what's convenient.</span><span>
</span><span id="line-564"></span><span>   </span><span class="hs-comment">-- The type checker will complain later</span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span class="hs-comment">---------------------------------------------------</span><span>
</span><span id="line-567"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesMatch"><span class="hs-identifier hs-type">methodNamesMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span>
</span><span id="line-568"></span><span id="methodNamesMatch"><span class="annot"><span class="annottext">methodNamesMatch :: MatchGroup GhcRn (LHsCmd GhcRn) -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesMatch"><span class="hs-identifier hs-var hs-var">methodNamesMatch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#MG"><span class="hs-identifier hs-type">MG</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mg_alts :: forall p body. MatchGroup p body -&gt; Located [LMatch p body]
</span><a href="GHC.Hs.Expr.html#mg_alts"><span class="hs-identifier hs-var">mg_alts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132249"><span class="annot"><span class="annottext">[LMatch GhcRn (LHsCmd GhcRn)]
</span><a href="#local-6989586621681132249"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LMatch GhcRn (LHsCmd GhcRn) -&gt; FreeVars)
-&gt; [LMatch GhcRn (LHsCmd GhcRn)] -&gt; [FreeVars]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">LMatch GhcRn (LHsCmd GhcRn) -&gt; FreeVars
forall {l}. GenLocated l (Match GhcRn (LHsCmd GhcRn)) -&gt; FreeVars
</span><a href="#local-6989586621681132248"><span class="hs-identifier hs-var">do_one</span></a></span><span> </span><span class="annot"><span class="annottext">[LMatch GhcRn (LHsCmd GhcRn)]
</span><a href="#local-6989586621681132249"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-571"></span><span>    </span><span id="local-6989586621681132248"><span class="annot"><span class="annottext">do_one :: GenLocated l (Match GhcRn (LHsCmd GhcRn)) -&gt; FreeVars
</span><a href="#local-6989586621681132248"><span class="hs-identifier hs-var hs-var">do_one</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">m_grhss :: forall p body. Match p body -&gt; GRHSs p body
</span><a href="GHC.Hs.Expr.html#m_grhss"><span class="hs-identifier hs-var">m_grhss</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681132245"><span class="annot"><span class="annottext">GRHSs GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132245"><span class="hs-identifier hs-var">grhss</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GRHSs GhcRn (LHsCmd GhcRn) -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesGRHSs"><span class="hs-identifier hs-var">methodNamesGRHSs</span></a></span><span> </span><span class="annot"><span class="annottext">GRHSs GhcRn (LHsCmd GhcRn)
</span><a href="#local-6989586621681132245"><span class="hs-identifier hs-var">grhss</span></a></span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span class="hs-comment">-------------------------------------------------</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- gaw 2004</span><span>
</span><span id="line-575"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesGRHSs"><span class="hs-identifier hs-type">methodNamesGRHSs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span>
</span><span id="line-576"></span><span id="methodNamesGRHSs"><span class="annot"><span class="annottext">methodNamesGRHSs :: GRHSs GhcRn (LHsCmd GhcRn) -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesGRHSs"><span class="hs-identifier hs-var hs-var">methodNamesGRHSs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a></span><span> </span><span class="annot"><span class="annottext">XCGRHSs GhcRn (LHsCmd GhcRn)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132242"><span class="annot"><span class="annottext">[LGRHS GhcRn (LHsCmd GhcRn)]
</span><a href="#local-6989586621681132242"><span class="hs-identifier hs-var">grhss</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsLocalBinds GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LGRHS GhcRn (LHsCmd GhcRn) -&gt; FreeVars)
-&gt; [LGRHS GhcRn (LHsCmd GhcRn)] -&gt; [FreeVars]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">LGRHS GhcRn (LHsCmd GhcRn) -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesGRHS"><span class="hs-identifier hs-var">methodNamesGRHS</span></a></span><span> </span><span class="annot"><span class="annottext">[LGRHS GhcRn (LHsCmd GhcRn)]
</span><a href="#local-6989586621681132242"><span class="hs-identifier hs-var">grhss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="hs-comment">-------------------------------------------------</span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesGRHS"><span class="hs-identifier hs-type">methodNamesGRHS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#GRHS"><span class="hs-identifier hs-type">GRHS</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#CmdNeeds"><span class="hs-identifier hs-type">CmdNeeds</span></a></span><span>
</span><span id="line-581"></span><span id="methodNamesGRHS"><span class="annot"><span class="annottext">methodNamesGRHS :: LGRHS GhcRn (LHsCmd GhcRn) -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesGRHS"><span class="hs-identifier hs-var hs-var">methodNamesGRHS</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#GRHS"><span class="hs-identifier hs-type">GRHS</span></a></span><span> </span><span class="annot"><span class="annottext">XCGRHS GhcRn (LHsCmd GhcRn)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132239"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132239"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesLCmd"><span class="hs-identifier hs-var">methodNamesLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132239"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span class="hs-comment">---------------------------------------------------</span><span>
</span><span id="line-584"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesStmts"><span class="hs-identifier hs-type">methodNamesStmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span>
</span><span id="line-585"></span><span id="methodNamesStmts"><span class="annot"><span class="annottext">methodNamesStmts :: [LStmt GhcRn (LHsCmd GhcRn)] -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesStmts"><span class="hs-identifier hs-var hs-var">methodNamesStmts</span></a></span></span><span> </span><span id="local-6989586621681132238"><span class="annot"><span class="annottext">[LStmt GhcRn (LHsCmd GhcRn)]
</span><a href="#local-6989586621681132238"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LStmt GhcRn (LHsCmd GhcRn) -&gt; FreeVars)
-&gt; [LStmt GhcRn (LHsCmd GhcRn)] -&gt; [FreeVars]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcRn (LHsCmd GhcRn) -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesLStmt"><span class="hs-identifier hs-var">methodNamesLStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn (LHsCmd GhcRn)]
</span><a href="#local-6989586621681132238"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="hs-comment">---------------------------------------------------</span><span>
</span><span id="line-588"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesLStmt"><span class="hs-identifier hs-type">methodNamesLStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span>
</span><span id="line-589"></span><span id="methodNamesLStmt"><span class="annot"><span class="annottext">methodNamesLStmt :: LStmt GhcRn (LHsCmd GhcRn) -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesLStmt"><span class="hs-identifier hs-var hs-var">methodNamesLStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StmtLR GhcRn GhcRn (LHsCmd GhcRn) -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesStmt"><span class="hs-identifier hs-var">methodNamesStmt</span></a></span><span> </span><span class="annot"><span class="annottext">(StmtLR GhcRn GhcRn (LHsCmd GhcRn) -&gt; FreeVars)
-&gt; (LStmt GhcRn (LHsCmd GhcRn)
    -&gt; StmtLR GhcRn GhcRn (LHsCmd GhcRn))
-&gt; LStmt GhcRn (LHsCmd GhcRn)
-&gt; FreeVars
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcRn (LHsCmd GhcRn) -&gt; StmtLR GhcRn GhcRn (LHsCmd GhcRn)
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesStmt"><span class="hs-identifier hs-type">methodNamesStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span>
</span><span id="line-592"></span><span id="methodNamesStmt"><span class="annot"><span class="annottext">methodNamesStmt :: StmtLR GhcRn GhcRn (LHsCmd GhcRn) -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesStmt"><span class="hs-identifier hs-var hs-var">methodNamesStmt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-type">LastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLastStmt GhcRn GhcRn (LHsCmd GhcRn)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132234"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132234"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesLCmd"><span class="hs-identifier hs-var">methodNamesLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132234"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-593"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesStmt"><span class="hs-identifier hs-var">methodNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-type">BodyStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBodyStmt GhcRn GhcRn (LHsCmd GhcRn)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132232"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132232"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesLCmd"><span class="hs-identifier hs-var">methodNamesLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132232"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-594"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesStmt"><span class="hs-identifier hs-var">methodNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBindStmt GhcRn GhcRn (LHsCmd GhcRn)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132230"><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132230"><span class="hs-identifier hs-var">cmd</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesLCmd"><span class="hs-identifier hs-var">methodNamesLCmd</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmd GhcRn
</span><a href="#local-6989586621681132230"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-595"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesStmt"><span class="hs-identifier hs-var">methodNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#RecStmt"><span class="hs-identifier hs-type">RecStmt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recS_stmts :: forall idL idR body. StmtLR idL idR body -&gt; [LStmtLR idL idR body]
</span><a href="GHC.Hs.Expr.html#recS_stmts"><span class="hs-identifier hs-var">recS_stmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681132227"><span class="annot"><span class="annottext">[LStmt GhcRn (LHsCmd GhcRn)]
</span><a href="#local-6989586621681132227"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-596"></span><span>  </span><span class="annot"><span class="annottext">[LStmt GhcRn (LHsCmd GhcRn)] -&gt; FreeVars
</span><a href="GHC.Rename.Expr.html#methodNamesStmts"><span class="hs-identifier hs-var">methodNamesStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn (LHsCmd GhcRn)]
</span><a href="#local-6989586621681132227"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#addOneFV"><span class="hs-operator hs-var">`addOneFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#loopAName"><span class="hs-identifier hs-var">loopAName</span></a></span><span>
</span><span id="line-597"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesStmt"><span class="hs-identifier hs-var">methodNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span>
</span><span id="line-598"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesStmt"><span class="hs-identifier hs-var">methodNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmt"><span class="hs-identifier hs-type">ParStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span>
</span><span id="line-599"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesStmt"><span class="hs-identifier hs-var">methodNamesStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#TransStmt"><span class="hs-identifier hs-type">TransStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span>
</span><span id="line-600"></span><span class="annot"><a href="GHC.Rename.Expr.html#methodNamesStmt"><span class="hs-identifier hs-var">methodNamesStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeStmt"><span class="hs-identifier hs-type">ApplicativeStmt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span>
</span><span id="line-601"></span><span>   </span><span class="hs-comment">-- ParStmt and TransStmt can't occur in commands, but it's not</span><span>
</span><span id="line-602"></span><span>   </span><span class="hs-comment">-- convenient to error here so we just do what's convenient</span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Arithmetic sequences
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnArithSeq"><span class="hs-identifier hs-type">rnArithSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#ArithSeqInfo"><span class="hs-identifier hs-type">ArithSeqInfo</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ArithSeqInfo"><span class="hs-identifier hs-type">ArithSeqInfo</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span id="rnArithSeq"><span class="annot"><span class="annottext">rnArithSeq :: ArithSeqInfo GhcPs -&gt; RnM (ArithSeqInfo GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnArithSeq"><span class="hs-identifier hs-var hs-var">rnArithSeq</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#From"><span class="hs-identifier hs-type">From</span></a></span><span> </span><span id="local-6989586621681132220"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132220"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132219"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132219"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132218"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132218"><span class="hs-identifier hs-var">fvExpr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132220"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-615"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(ArithSeqInfo GhcRn, FreeVars)
-&gt; RnM (ArithSeqInfo GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; ArithSeqInfo GhcRn
forall id. LHsExpr id -&gt; ArithSeqInfo id
</span><a href="GHC.Hs.Expr.html#From"><span class="hs-identifier hs-var">From</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132219"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132218"><span class="hs-identifier hs-var">fvExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnArithSeq"><span class="hs-identifier hs-var">rnArithSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#FromThen"><span class="hs-identifier hs-type">FromThen</span></a></span><span> </span><span id="local-6989586621681132216"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132216"><span class="hs-identifier hs-var">expr1</span></a></span></span><span> </span><span id="local-6989586621681132215"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132215"><span class="hs-identifier hs-var">expr2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132214"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132214"><span class="hs-identifier hs-var">expr1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132213"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132213"><span class="hs-identifier hs-var">fvExpr1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132216"><span class="hs-identifier hs-var">expr1</span></a></span><span>
</span><span id="line-619"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132212"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132212"><span class="hs-identifier hs-var">expr2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132211"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132211"><span class="hs-identifier hs-var">fvExpr2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132215"><span class="hs-identifier hs-var">expr2</span></a></span><span>
</span><span id="line-620"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(ArithSeqInfo GhcRn, FreeVars)
-&gt; RnM (ArithSeqInfo GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; ArithSeqInfo GhcRn
forall id. LHsExpr id -&gt; LHsExpr id -&gt; ArithSeqInfo id
</span><a href="GHC.Hs.Expr.html#FromThen"><span class="hs-identifier hs-var">FromThen</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132214"><span class="hs-identifier hs-var">expr1'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132212"><span class="hs-identifier hs-var">expr2'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132213"><span class="hs-identifier hs-var">fvExpr1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132211"><span class="hs-identifier hs-var">fvExpr2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnArithSeq"><span class="hs-identifier hs-var">rnArithSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#FromTo"><span class="hs-identifier hs-type">FromTo</span></a></span><span> </span><span id="local-6989586621681132209"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132209"><span class="hs-identifier hs-var">expr1</span></a></span></span><span> </span><span id="local-6989586621681132208"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132208"><span class="hs-identifier hs-var">expr2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132207"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132207"><span class="hs-identifier hs-var">expr1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132206"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132206"><span class="hs-identifier hs-var">fvExpr1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132209"><span class="hs-identifier hs-var">expr1</span></a></span><span>
</span><span id="line-624"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132205"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132205"><span class="hs-identifier hs-var">expr2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132204"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132204"><span class="hs-identifier hs-var">fvExpr2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132208"><span class="hs-identifier hs-var">expr2</span></a></span><span>
</span><span id="line-625"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(ArithSeqInfo GhcRn, FreeVars)
-&gt; RnM (ArithSeqInfo GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; ArithSeqInfo GhcRn
forall id. LHsExpr id -&gt; LHsExpr id -&gt; ArithSeqInfo id
</span><a href="GHC.Hs.Expr.html#FromTo"><span class="hs-identifier hs-var">FromTo</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132207"><span class="hs-identifier hs-var">expr1'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132205"><span class="hs-identifier hs-var">expr2'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132206"><span class="hs-identifier hs-var">fvExpr1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132204"><span class="hs-identifier hs-var">fvExpr2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnArithSeq"><span class="hs-identifier hs-var">rnArithSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#FromThenTo"><span class="hs-identifier hs-type">FromThenTo</span></a></span><span> </span><span id="local-6989586621681132202"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132202"><span class="hs-identifier hs-var">expr1</span></a></span></span><span> </span><span id="local-6989586621681132201"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132201"><span class="hs-identifier hs-var">expr2</span></a></span></span><span> </span><span id="local-6989586621681132200"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132200"><span class="hs-identifier hs-var">expr3</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132199"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132199"><span class="hs-identifier hs-var">expr1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132198"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132198"><span class="hs-identifier hs-var">fvExpr1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132202"><span class="hs-identifier hs-var">expr1</span></a></span><span>
</span><span id="line-629"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132197"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132197"><span class="hs-identifier hs-var">expr2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132196"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132196"><span class="hs-identifier hs-var">fvExpr2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132201"><span class="hs-identifier hs-var">expr2</span></a></span><span>
</span><span id="line-630"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132195"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132195"><span class="hs-identifier hs-var">expr3'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132194"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132194"><span class="hs-identifier hs-var">fvExpr3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681132200"><span class="hs-identifier hs-var">expr3</span></a></span><span>
</span><span id="line-631"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(ArithSeqInfo GhcRn, FreeVars)
-&gt; RnM (ArithSeqInfo GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcRn
-&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; ArithSeqInfo GhcRn
forall id.
LHsExpr id -&gt; LHsExpr id -&gt; LHsExpr id -&gt; ArithSeqInfo id
</span><a href="GHC.Hs.Expr.html#FromThenTo"><span class="hs-identifier hs-var">FromThenTo</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132199"><span class="hs-identifier hs-var">expr1'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132197"><span class="hs-identifier hs-var">expr2'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681132195"><span class="hs-identifier hs-var">expr3'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-632"></span><span>                </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132198"><span class="hs-identifier hs-var">fvExpr1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132196"><span class="hs-identifier hs-var">fvExpr2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132194"><span class="hs-identifier hs-var">fvExpr3</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsubsection{@Stmt@s: in @do@ expressions}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span class="hs-comment">{-
Note [Deterministic ApplicativeDo and RecursiveDo desugaring]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Both ApplicativeDo and RecursiveDo need to create tuples not
present in the source text.

For ApplicativeDo we create:

  (a,b,c) &lt;- (\c b a -&gt; (a,b,c)) &lt;$&gt;

For RecursiveDo we create:

  mfix (\ ~(a,b,c) -&gt; do ...; return (a',b',c'))

The order of the components in those tuples needs to be stable
across recompilations, otherwise they can get optimized differently
and we end up with incompatible binaries.
To get a stable order we use nameSetElemsStable.
See Note [Deterministic UniqFM] to learn more about nondeterminism.
-}</span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-comment">-- | Rename some Stmts</span><span>
</span><span id="line-664"></span><span id="local-6989586621681133523"><span id="local-6989586621681133524"><span class="annot"><a href="GHC.Rename.Expr.html#rnStmts"><span class="hs-identifier hs-type">rnStmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133524"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-666"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133524"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133524"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>           </span><span class="hs-comment">-- ^ How to rename the body of each statement (e.g. rnLExpr)</span><span>
</span><span id="line-668"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133524"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-669"></span><span>           </span><span class="hs-comment">-- ^ Statements</span><span>
</span><span id="line-670"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133523"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>           </span><span class="hs-comment">-- ^ if these statements scope over something, this renames it</span><span>
</span><span id="line-672"></span><span>           </span><span class="hs-comment">-- and returns the result.</span><span>
</span><span id="line-673"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133524"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681133523"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-674"></span><span id="rnStmts"><span class="annot"><span class="annottext">rnStmts :: forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM (([LStmt GhcRn (Located (body GhcRn))], thing), FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmts"><span class="hs-identifier hs-var hs-var">rnStmts</span></a></span></span><span> </span><span id="local-6989586621681132191"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132191"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681132190"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132190"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; (HsStmtContext GhcRn
    -&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
    -&gt; RnM ([LStmt GhcRn (Located (body GhcRn))], FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM (([LStmt GhcRn (Located (body GhcRn))], thing), FreeVars)
forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; (HsStmtContext GhcRn
    -&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
    -&gt; RnM ([LStmt GhcRn (Located (body GhcRn))], FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM (([LStmt GhcRn (Located (body GhcRn))], thing), FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmtsWithPostProcessing"><span class="hs-identifier hs-var">rnStmtsWithPostProcessing</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132191"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132190"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; RnM ([LStmt GhcRn (Located (body GhcRn))], FreeVars)
forall (body :: * -&gt; *).
HsStmtContext GhcRn
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; RnM ([LStmt GhcRn (Located (body GhcRn))], FreeVars)
</span><a href="GHC.Rename.Expr.html#noPostProcessStmts"><span class="hs-identifier hs-var">noPostProcessStmts</span></a></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-comment">-- | like 'rnStmts' but applies a post-processing step to the renamed Stmts</span><span>
</span><span id="line-677"></span><span id="local-6989586621681133611"><span id="local-6989586621681133613"><span class="annot"><a href="GHC.Rename.Expr.html#rnStmtsWithPostProcessing"><span class="hs-identifier hs-type">rnStmtsWithPostProcessing</span></a></span><span>
</span><span id="line-678"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133613"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-679"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-680"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133613"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133613"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span>           </span><span class="hs-comment">-- ^ How to rename the body of each statement (e.g. rnLExpr)</span><span>
</span><span id="line-682"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-683"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133613"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-684"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133613"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span>           </span><span class="hs-comment">-- ^ postprocess the statements</span><span>
</span><span id="line-686"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133613"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-687"></span><span>           </span><span class="hs-comment">-- ^ Statements</span><span>
</span><span id="line-688"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133611"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>           </span><span class="hs-comment">-- ^ if these statements scope over something, this renames it</span><span>
</span><span id="line-690"></span><span>           </span><span class="hs-comment">-- and returns the result.</span><span>
</span><span id="line-691"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133613"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681133611"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-692"></span><span id="rnStmtsWithPostProcessing"><span class="annot"><span class="annottext">rnStmtsWithPostProcessing :: forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; (HsStmtContext GhcRn
    -&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
    -&gt; RnM ([LStmt GhcRn (Located (body GhcRn))], FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM (([LStmt GhcRn (Located (body GhcRn))], thing), FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmtsWithPostProcessing"><span class="hs-identifier hs-var hs-var">rnStmtsWithPostProcessing</span></a></span></span><span> </span><span id="local-6989586621681132183"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132183"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681132182"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132182"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span id="local-6989586621681132181"><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; RnM ([LStmt GhcRn (Located (body GhcRn))], FreeVars)
</span><a href="#local-6989586621681132181"><span class="hs-identifier hs-var">ppStmts</span></a></span></span><span> </span><span id="local-6989586621681132180"><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
</span><a href="#local-6989586621681132180"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span id="local-6989586621681132179"><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132179"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-693"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681132178"><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681132178"><span class="hs-identifier hs-var">stmts'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132177"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132177"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132176"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132176"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-694"></span><span>          </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmtsWithFreeVars"><span class="hs-identifier hs-var">rnStmtsWithFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132183"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132182"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
</span><a href="#local-6989586621681132180"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132179"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-695"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132174"><span class="annot"><span class="annottext">[LStmt GhcRn (Located (body GhcRn))]
</span><a href="#local-6989586621681132174"><span class="hs-identifier hs-var">pp_stmts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132173"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132173"><span class="hs-identifier hs-var">fvs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; RnM ([LStmt GhcRn (Located (body GhcRn))], FreeVars)
</span><a href="#local-6989586621681132181"><span class="hs-identifier hs-var">ppStmts</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132183"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681132178"><span class="hs-identifier hs-var">stmts'</span></a></span><span>
</span><span id="line-696"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([LStmt GhcRn (Located (body GhcRn))], thing), FreeVars)
-&gt; RnM (([LStmt GhcRn (Located (body GhcRn))], thing), FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LStmt GhcRn (Located (body GhcRn))]
</span><a href="#local-6989586621681132174"><span class="hs-identifier hs-var">pp_stmts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132177"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132176"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132173"><span class="hs-identifier hs-var">fvs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="hs-comment">-- | maybe rearrange statements according to the ApplicativeDo transformation</span><span>
</span><span id="line-700"></span><span class="annot"><a href="GHC.Rename.Expr.html#postProcessStmtsForApplicativeDo"><span class="hs-identifier hs-type">postProcessStmtsForApplicativeDo</span></a></span><span>
</span><span id="line-701"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-702"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-703"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span id="postProcessStmtsForApplicativeDo"><span class="annot"><span class="annottext">postProcessStmtsForApplicativeDo :: HsStmtContext GhcRn
-&gt; [(ExprLStmt GhcRn, FreeVars)]
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#postProcessStmtsForApplicativeDo"><span class="hs-identifier hs-var hs-var">postProcessStmtsForApplicativeDo</span></a></span></span><span> </span><span id="local-6989586621681132172"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132172"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681132171"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681132171"><span class="hs-identifier hs-var">stmts</span></a></span></span><span>
</span><span id="line-705"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-706"></span><span>       </span><span class="hs-comment">-- rearrange the statements using ApplicativeStmt if</span><span>
</span><span id="line-707"></span><span>       </span><span class="hs-comment">-- -XApplicativeDo is on.  Also strip out the FreeVars attached</span><span>
</span><span id="line-708"></span><span>       </span><span class="hs-comment">-- to each Stmt body.</span><span>
</span><span id="line-709"></span><span>         </span><span id="local-6989586621681132170"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132170"><span class="hs-identifier hs-var">ado_is_on</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#ApplicativeDo"><span class="hs-identifier hs-var">LangExt.ApplicativeDo</span></a></span><span>
</span><span id="line-710"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681132168"><span class="annot"><span class="annottext">is_do_expr :: Bool
</span><a href="#local-6989586621681132168"><span class="hs-identifier hs-var hs-var">is_do_expr</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#DoExpr"><span class="hs-identifier hs-type">DoExpr</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132172"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-711"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-712"></span><span>       </span><span class="hs-comment">-- don't apply the transformation inside TH brackets, because</span><span>
</span><span id="line-713"></span><span>       </span><span class="hs-comment">-- GHC.HsToCore.Quote does not handle ApplicativeDo.</span><span>
</span><span id="line-714"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681132166"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132166"><span class="hs-identifier hs-var">in_th_bracket</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ThStage -&gt; Bool
</span><a href="GHC.Tc.Utils.Env.html#isBrackStage"><span class="hs-identifier hs-var">isBrackStage</span></a></span><span> </span><span class="annot"><span class="annottext">(ThStage -&gt; Bool) -&gt; TcM ThStage -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TcM ThStage
</span><a href="GHC.Tc.Utils.Monad.html#getStage"><span class="hs-identifier hs-var">getStage</span></a></span><span>
</span><span id="line-715"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132170"><span class="hs-identifier hs-var">ado_is_on</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132168"><span class="hs-identifier hs-var">is_do_expr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681132166"><span class="hs-identifier hs-var">in_th_bracket</span></a></span><span>
</span><span id="line-716"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ppsfa&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681132171"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>                    </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; [(ExprLStmt GhcRn, FreeVars)]
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#rearrangeForApplicativeDo"><span class="hs-identifier hs-var">rearrangeForApplicativeDo</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132172"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681132171"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-718"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; [(ExprLStmt GhcRn, FreeVars)]
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
forall (body :: * -&gt; *).
HsStmtContext GhcRn
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; RnM ([LStmt GhcRn (Located (body GhcRn))], FreeVars)
</span><a href="GHC.Rename.Expr.html#noPostProcessStmts"><span class="hs-identifier hs-var">noPostProcessStmts</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132172"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681132171"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-719"></span><span>
</span><span id="line-720"></span><span class="hs-comment">-- | strip the FreeVars annotations from statements</span><span>
</span><span id="line-721"></span><span id="local-6989586621681133495"><span class="annot"><a href="GHC.Rename.Expr.html#noPostProcessStmts"><span class="hs-identifier hs-type">noPostProcessStmts</span></a></span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-723"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133495"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-724"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133495"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-725"></span><span id="noPostProcessStmts"><span class="annot"><span class="annottext">noPostProcessStmts :: forall (body :: * -&gt; *).
HsStmtContext GhcRn
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; RnM ([LStmt GhcRn (Located (body GhcRn))], FreeVars)
</span><a href="GHC.Rename.Expr.html#noPostProcessStmts"><span class="hs-identifier hs-var hs-var">noPostProcessStmts</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132159"><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681132159"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([LStmt GhcRn (Located (body GhcRn))], FreeVars)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     ([LStmt GhcRn (Located (body GhcRn))], FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((LStmt GhcRn (Located (body GhcRn)), FreeVars)
 -&gt; LStmt GhcRn (Located (body GhcRn)))
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; [LStmt GhcRn (Located (body GhcRn))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(LStmt GhcRn (Located (body GhcRn)), FreeVars)
-&gt; LStmt GhcRn (Located (body GhcRn))
forall a b. (a, b) -&gt; a
</span><a href="../../base/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681132159"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span id="local-6989586621681133491"><span id="local-6989586621681133492"><span class="annot"><a href="GHC.Rename.Expr.html#rnStmtsWithFreeVars"><span class="hs-identifier hs-type">rnStmtsWithFreeVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133492"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-730"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133492"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133492"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-731"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133492"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-732"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133491"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133492"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681133491"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-734"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-735"></span><span class="hs-comment">-- Each Stmt body is annotated with its FreeVars, so that</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- we can rearrange statements for ApplicativeDo.</span><span>
</span><span id="line-737"></span><span class="hs-comment">--</span><span>
</span><span id="line-738"></span><span class="hs-comment">-- Variables bound by the Stmts, and mentioned in thing_inside,</span><span>
</span><span id="line-739"></span><span class="hs-comment">-- do not appear in the result FreeVars</span><span>
</span><span id="line-740"></span><span>
</span><span id="line-741"></span><span id="rnStmtsWithFreeVars"><span class="annot"><span class="annottext">rnStmtsWithFreeVars :: forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmtsWithFreeVars"><span class="hs-identifier hs-var hs-var">rnStmtsWithFreeVars</span></a></span></span><span> </span><span id="local-6989586621681132138"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132138"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681132137"><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132137"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-742"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Expr.html#checkEmptyStmts"><span class="hs-identifier hs-var">checkEmptyStmts</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132138"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-743"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132135"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132135"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132134"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132134"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132137"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-744"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
 FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132135"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132134"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnStmtsWithFreeVars"><span class="hs-identifier hs-var">rnStmtsWithFreeVars</span></a></span><span> </span><span id="local-6989586621681132133"><span class="annot"><span class="annottext">mDoExpr :: HsStmtContext GhcRn
</span><a href="#local-6989586621681132133"><span class="hs-identifier hs-var">mDoExpr</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Hs.Expr.html#MDoExpr"><span class="hs-identifier hs-type">MDoExpr</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621681132131"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132131"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span id="local-6989586621681132130"><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
</span><a href="#local-6989586621681132130"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span id="local-6989586621681132129"><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132129"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>    </span><span class="hs-comment">-- Deal with mdo</span><span>
</span><span id="line-747"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- Behave like do { rec { ...all but last... }; last }</span><span>
</span><span id="line-748"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681132128"><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681132128"><span class="hs-identifier hs-var">stmts1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132127"><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681132127"><span class="hs-identifier hs-var">stmts2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132126"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132126"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132125"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132125"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-749"></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; ([Name]
    -&gt; RnM
         (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
          FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
       ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing)),
      FreeVars)
forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-var">rnStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132133"><span class="hs-identifier hs-var">mDoExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132131"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs))
-&gt; LStmt GhcPs (Located (body GhcPs))
forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">(StmtLR GhcPs GhcPs (Located (body GhcPs))
 -&gt; LStmt GhcPs (Located (body GhcPs)))
-&gt; StmtLR GhcPs GhcPs (Located (body GhcPs))
-&gt; LStmt GhcPs (Located (body GhcPs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
-&gt; StmtLR GhcPs GhcPs (Located (body GhcPs))
forall (idL :: Pass) bodyR.
[LStmtLR (GhcPass idL) GhcPs bodyR]
-&gt; StmtLR (GhcPass idL) GhcPs bodyR
</span><a href="GHC.Hs.Utils.html#mkRecStmt"><span class="hs-identifier hs-var">mkRecStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
</span><a href="#local-6989586621681132122"><span class="hs-identifier hs-var">all_but_last</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Name]
  -&gt; RnM
       (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
        FreeVars))
 -&gt; RnM
      (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
        ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing)),
       FreeVars))
-&gt; ([Name]
    -&gt; RnM
         (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
          FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
       ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing)),
      FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-750"></span><span>              </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681132121"><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681132121"><span class="hs-identifier hs-var">last_stmt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; RnM (LStmt GhcPs (Located (body GhcPs)))
forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; RnM (LStmt GhcPs (Located (body GhcPs)))
</span><a href="GHC.Rename.Expr.html#checkLastStmt"><span class="hs-identifier hs-var">checkLastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132133"><span class="hs-identifier hs-var">mDoExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681132119"><span class="hs-identifier hs-var">last_stmt</span></a></span><span>
</span><span id="line-751"></span><span>                 </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-var">rnStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132133"><span class="hs-identifier hs-var">mDoExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132131"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681132121"><span class="hs-identifier hs-var">last_stmt'</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132129"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-752"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
 FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681132128"><span class="hs-identifier hs-var">stmts1</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681132127"><span class="hs-identifier hs-var">stmts2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132126"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132125"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-754"></span><span>    </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132122"><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
</span><a href="#local-6989586621681132122"><span class="hs-identifier hs-var">all_but_last</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132119"><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681132119"><span class="hs-identifier hs-var">last_stmt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
-&gt; Maybe
     ([LStmt GhcPs (Located (body GhcPs))],
      LStmt GhcPs (Located (body GhcPs)))
forall a. [a] -&gt; Maybe ([a], a)
</span><a href="GHC.Utils.Misc.html#snocView"><span class="hs-identifier hs-var">snocView</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
</span><a href="#local-6989586621681132130"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-755"></span><span>
</span><span id="line-756"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnStmtsWithFreeVars"><span class="hs-identifier hs-var">rnStmtsWithFreeVars</span></a></span><span> </span><span id="local-6989586621681132117"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132117"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681132116"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132116"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132115"><span class="annot"><span class="annottext">lstmt :: LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681132115"><span class="hs-identifier hs-var">lstmt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132114"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132114"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681132113"><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
</span><a href="#local-6989586621681132113"><span class="hs-identifier hs-var">lstmts</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681132112"><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132112"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-757"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
</span><a href="#local-6989586621681132113"><span class="hs-identifier hs-var">lstmts</span></a></span><span>
</span><span id="line-758"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132114"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(RnM
   (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
    FreeVars)
 -&gt; RnM
      (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
       FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-759"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681132109"><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681132109"><span class="hs-identifier hs-var">lstmt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; RnM (LStmt GhcPs (Located (body GhcPs)))
forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; RnM (LStmt GhcPs (Located (body GhcPs)))
</span><a href="GHC.Rename.Expr.html#checkLastStmt"><span class="hs-identifier hs-var">checkLastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132117"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681132115"><span class="hs-identifier hs-var">lstmt</span></a></span><span>
</span><span id="line-760"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-var">rnStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132117"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132116"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681132109"><span class="hs-identifier hs-var">lstmt'</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132112"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-761"></span><span>
</span><span id="line-762"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-763"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681132108"><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681132108"><span class="hs-identifier hs-var">stmts1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132107"><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681132107"><span class="hs-identifier hs-var">stmts2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132106"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132106"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132105"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132105"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-764"></span><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SrcSpan
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
       ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing)),
      FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
       ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing)),
      FreeVars)
forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132114"><span class="hs-identifier hs-var">loc</span></a></span><span>                         </span><span class="annot"><span class="annottext">(RnM
   (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
     ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing)),
    FreeVars)
 -&gt; RnM
      (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
        ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing)),
       FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
       ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing)),
      FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
       ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing)),
      FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-765"></span><span>               </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall (body :: * -&gt; *).
HsStmtContext GhcRn
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Expr.html#checkStmt"><span class="hs-identifier hs-var">checkStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132117"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681132115"><span class="hs-identifier hs-var">lstmt</span></a></span><span>
</span><span id="line-766"></span><span>                  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; ([Name]
    -&gt; RnM
         (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
          FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
       ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing)),
      FreeVars)
forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-var">rnStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132117"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132116"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681132115"><span class="hs-identifier hs-var">lstmt</span></a></span><span>    </span><span class="annot"><span class="annottext">(([Name]
  -&gt; RnM
       (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
        FreeVars))
 -&gt; RnM
      (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
        ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing)),
       FreeVars))
-&gt; ([Name]
    -&gt; RnM
         (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
          FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
       ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing)),
      FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681132103"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681132103"><span class="hs-identifier hs-var">bndrs1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-767"></span><span>                    </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmtsWithFreeVars"><span class="hs-identifier hs-var">rnStmtsWithFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132117"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132116"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
</span><a href="#local-6989586621681132113"><span class="hs-identifier hs-var">lstmts</span></a></span><span>  </span><span class="annot"><span class="annottext">(([Name] -&gt; RnM (thing, FreeVars))
 -&gt; RnM
      (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
       FreeVars))
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681132102"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681132102"><span class="hs-identifier hs-var">bndrs2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-768"></span><span>                    </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132112"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681132103"><span class="hs-identifier hs-var">bndrs1</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681132102"><span class="hs-identifier hs-var">bndrs2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-769"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
 FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681132108"><span class="hs-identifier hs-var">stmts1</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681132107"><span class="hs-identifier hs-var">stmts2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132106"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132105"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-770"></span><span>
</span><span id="line-771"></span><span class="hs-comment">----------------------</span><span>
</span><span id="line-772"></span><span>
</span><span id="line-773"></span><span class="hs-comment">{-
Note [Failing pattern matches in Stmts]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Many things desugar to HsStmts including monadic things like `do` and `mdo`
statements, pattern guards, and list comprehensions (see 'HsStmtContext' for an
exhaustive list). How we deal with pattern match failure is context-dependent.

 * In the case of list comprehensions and pattern guards we don't need any
   'fail' function; the desugarer ignores the fail function of 'BindStmt'
   entirely. So, for list comprehensions, the fail function is set to 'Nothing'
   for clarity.

 * In the case of monadic contexts (e.g. monad comprehensions, do, and mdo
   expressions) we want pattern match failure to be desugared to the appropriate
   'fail' function (either that of Monad or MonadFail, depending on whether
   -XMonadFailDesugaring is enabled.)

At one point we failed to make this distinction, leading to #11216.
-}</span><span>
</span><span id="line-793"></span><span>
</span><span id="line-794"></span><span id="local-6989586621681133481"><span id="local-6989586621681133482"><span class="annot"><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-type">rnStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133482"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-795"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-796"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133482"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133482"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span>          </span><span class="hs-comment">-- ^ How to rename the body of the statement</span><span>
</span><span id="line-798"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133482"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>          </span><span class="hs-comment">-- ^ The statement</span><span>
</span><span id="line-800"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133481"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>          </span><span class="hs-comment">-- ^ Rename the stuff that this statement scopes over</span><span>
</span><span id="line-802"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133482"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681133481"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-803"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-804"></span><span class="hs-comment">-- Variables bound by the Stmt, and mentioned in thing_inside,</span><span>
</span><span id="line-805"></span><span class="hs-comment">-- do not appear in the result FreeVars</span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span id="rnStmt"><span class="annot"><span class="annottext">rnStmt :: forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-var hs-var">rnStmt</span></a></span></span><span> </span><span id="local-6989586621681132052"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132052"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681132051"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132051"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132050"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132050"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-type">LastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLastStmt GhcPs GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132049"><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681132049"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621681132048"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621681132048"><span class="hs-identifier hs-var">noret</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681132047"><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132047"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-808"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132046"><span class="annot"><span class="annottext">Located (body GhcRn)
</span><a href="#local-6989586621681132046"><span class="hs-identifier hs-var">body'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132045"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132045"><span class="hs-identifier hs-var">fv_expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132051"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681132049"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-809"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132044"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681132044"><span class="hs-identifier hs-var">ret_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132043"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132043"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Bool
forall id. HsStmtContext id -&gt; Bool
</span><a href="GHC.Hs.Expr.html#isMonadCompContext"><span class="hs-identifier hs-var">isMonadCompContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132052"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-810"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupStmtName"><span class="hs-identifier hs-var">lookupStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132052"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#returnMName"><span class="hs-identifier hs-var">returnMName</span></a></span><span>
</span><span id="line-811"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(SyntaxExprRn, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (SyntaxExprRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntaxExprRn
forall (p :: Pass). IsPass p =&gt; SyntaxExpr (GhcPass p)
</span><a href="GHC.Hs.Expr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-812"></span><span>                            </span><span class="hs-comment">-- The 'return' in a LastStmt is used only</span><span>
</span><span id="line-813"></span><span>                            </span><span class="hs-comment">-- for MonadComp; and we don't want to report</span><span>
</span><span id="line-814"></span><span>                            </span><span class="hs-comment">-- &quot;non in scope: return&quot; in other cases</span><span>
</span><span id="line-815"></span><span>                            </span><span class="hs-comment">-- #15607</span><span>
</span><span id="line-816"></span><span>
</span><span id="line-817"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132038"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132038"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span>  </span><span id="local-6989586621681132037"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132037"><span class="hs-identifier hs-var">fvs3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132047"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-818"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
 FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
-&gt; LStmt GhcRn (Located (body GhcRn))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132050"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLastStmt GhcRn GhcRn (Located (body GhcRn))
-&gt; Located (body GhcRn)
-&gt; Maybe Bool
-&gt; SyntaxExpr GhcRn
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
forall idL idR body.
XLastStmt idL idR body
-&gt; body -&gt; Maybe Bool -&gt; SyntaxExpr idR -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XLastStmt GhcRn GhcRn (Located (body GhcRn))
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcRn)
</span><a href="#local-6989586621681132046"><span class="hs-identifier hs-var">body'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621681132048"><span class="hs-identifier hs-var">noret</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681132044"><span class="hs-identifier hs-var">ret_op</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132045"><span class="hs-identifier hs-var">fv_expr</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-819"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132038"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132045"><span class="hs-identifier hs-var">fv_expr</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132043"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132037"><span class="hs-identifier hs-var">fvs3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-var">rnStmt</span></a></span><span> </span><span id="local-6989586621681132036"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132036"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681132035"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132035"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132034"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132034"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-type">BodyStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBodyStmt GhcPs GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132033"><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681132033"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681132032"><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132032"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-822"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132031"><span class="annot"><span class="annottext">Located (body GhcRn)
</span><a href="#local-6989586621681132031"><span class="hs-identifier hs-var">body'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132030"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132030"><span class="hs-identifier hs-var">fv_expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132035"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681132033"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-823"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132029"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681132029"><span class="hs-identifier hs-var">then_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132028"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132028"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupQualifiedDoStmtName"><span class="hs-identifier hs-var">lookupQualifiedDoStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132036"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#thenMName"><span class="hs-identifier hs-var">thenMName</span></a></span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132025"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681132025"><span class="hs-identifier hs-var">guard_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132024"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132024"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Bool
forall id. HsStmtContext id -&gt; Bool
</span><a href="GHC.Hs.Expr.html#isComprehensionContext"><span class="hs-identifier hs-var">isComprehensionContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132036"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-826"></span><span>                              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupStmtName"><span class="hs-identifier hs-var">lookupStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132036"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#guardMName"><span class="hs-identifier hs-var">guardMName</span></a></span><span>
</span><span id="line-827"></span><span>                              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(SyntaxExprRn, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (SyntaxExprRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntaxExprRn
forall (p :: Pass). IsPass p =&gt; SyntaxExpr (GhcPass p)
</span><a href="GHC.Hs.Expr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-828"></span><span>                              </span><span class="hs-comment">-- Only list/monad comprehensions use 'guard'</span><span>
</span><span id="line-829"></span><span>                              </span><span class="hs-comment">-- Also for sub-stmts of same eg [ e | x&lt;-xs, gd | blah ]</span><span>
</span><span id="line-830"></span><span>                              </span><span class="hs-comment">-- Here &quot;gd&quot; is a guard</span><span>
</span><span id="line-831"></span><span>
</span><span id="line-832"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132021"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132021"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132020"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132020"><span class="hs-identifier hs-var">fvs3</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132032"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-833"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
 FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
-&gt; LStmt GhcRn (Located (body GhcRn))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132034"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XBodyStmt GhcRn GhcRn (Located (body GhcRn))
-&gt; Located (body GhcRn)
-&gt; SyntaxExpr GhcRn
-&gt; SyntaxExpr GhcRn
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
forall idL idR body.
XBodyStmt idL idR body
-&gt; body -&gt; SyntaxExpr idR -&gt; SyntaxExpr idR -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XBodyStmt GhcRn GhcRn (Located (body GhcRn))
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcRn)
</span><a href="#local-6989586621681132031"><span class="hs-identifier hs-var">body'</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681132029"><span class="hs-identifier hs-var">then_op</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681132025"><span class="hs-identifier hs-var">guard_op</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132030"><span class="hs-identifier hs-var">fv_expr</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-834"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132021"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132030"><span class="hs-identifier hs-var">fv_expr</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132028"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132024"><span class="hs-identifier hs-var">fvs2</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132020"><span class="hs-identifier hs-var">fvs3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-835"></span><span>
</span><span id="line-836"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-var">rnStmt</span></a></span><span> </span><span id="local-6989586621681132019"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132019"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681132018"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132018"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681132017"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132017"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBindStmt GhcPs GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681132016"><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621681132016"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681132015"><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681132015"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681132014"><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132014"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-837"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132013"><span class="annot"><span class="annottext">Located (body GhcRn)
</span><a href="#local-6989586621681132013"><span class="hs-identifier hs-var">body'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132012"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132012"><span class="hs-identifier hs-var">fv_expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681132018"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681132015"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-838"></span><span>                </span><span class="hs-comment">-- The binders do not scope over the expression</span><span>
</span><span id="line-839"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132011"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681132011"><span class="hs-identifier hs-var">bind_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132010"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132010"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupQualifiedDoStmtName"><span class="hs-identifier hs-var">lookupQualifiedDoStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132019"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#bindMName"><span class="hs-identifier hs-var">bindMName</span></a></span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132008"><span class="annot"><span class="annottext">Maybe SyntaxExprRn
</span><a href="#local-6989586621681132008"><span class="hs-identifier hs-var">fail_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132007"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132007"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
-&gt; HsStmtContext GhcRn -&gt; RnM (Maybe (SyntaxExpr GhcRn), FreeVars)
</span><a href="GHC.Rename.Expr.html#monadFailOp"><span class="hs-identifier hs-var">monadFailOp</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621681132016"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132019"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-842"></span><span>
</span><span id="line-843"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcRn
-&gt; LPat GhcPs
-&gt; (LPat GhcRn
    -&gt; RnM
         (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
          FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall a.
HsMatchContext GhcRn
-&gt; LPat GhcPs
-&gt; (LPat GhcRn -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
</span><a href="GHC.Rename.Pat.html#rnPat"><span class="hs-identifier hs-var">rnPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; HsMatchContext GhcRn
forall p. HsStmtContext p -&gt; HsMatchContext p
</span><a href="GHC.Hs.Expr.html#StmtCtxt"><span class="hs-identifier hs-var">StmtCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681132019"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621681132016"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">((LPat GhcRn
  -&gt; RnM
       (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
        FreeVars))
 -&gt; RnM
      (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
       FreeVars))
-&gt; (LPat GhcRn
    -&gt; RnM
         (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
          FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681132004"><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681132004"><span class="hs-identifier hs-var">pat'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-844"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681132003"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132003"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681132002"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132002"><span class="hs-identifier hs-var">fvs3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681132014"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LPat GhcRn -&gt; [IdP GhcRn]
forall p. CollectPass p =&gt; LPat p -&gt; [IdP p]
</span><a href="GHC.Hs.Utils.html#collectPatBinders"><span class="hs-identifier hs-var">collectPatBinders</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681132004"><span class="hs-identifier hs-var">pat'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-845"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681132000"><span class="annot"><span class="annottext">xbsrn :: XBindStmtRn
</span><a href="#local-6989586621681132000"><span class="hs-identifier hs-var hs-var">xbsrn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XBindStmtRn :: SyntaxExpr GhcRn -&gt; Maybe (SyntaxExpr GhcRn) -&gt; XBindStmtRn
</span><a href="GHC.Hs.Expr.html#XBindStmtRn"><span class="hs-identifier hs-type">XBindStmtRn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">xbsrn_bindOp :: SyntaxExpr GhcRn
</span><a href="GHC.Hs.Expr.html#xbsrn_bindOp"><span class="hs-identifier hs-var">xbsrn_bindOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681132011"><span class="hs-identifier hs-var">bind_op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">xbsrn_failOp :: Maybe (SyntaxExpr GhcRn)
</span><a href="GHC.Hs.Expr.html#xbsrn_failOp"><span class="hs-identifier hs-var">xbsrn_failOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcRn)
Maybe SyntaxExprRn
</span><a href="#local-6989586621681132008"><span class="hs-identifier hs-var">fail_op</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-846"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
 FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
-&gt; LStmt GhcRn (Located (body GhcRn))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681132017"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XBindStmt GhcRn GhcRn (Located (body GhcRn))
-&gt; LPat GhcRn
-&gt; Located (body GhcRn)
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
forall idL idR body.
XBindStmt idL idR body -&gt; LPat idL -&gt; body -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBindStmt GhcRn GhcRn (Located (body GhcRn))
XBindStmtRn
</span><a href="#local-6989586621681132000"><span class="hs-identifier hs-var">xbsrn</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681132004"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcRn)
</span><a href="#local-6989586621681132013"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132012"><span class="hs-identifier hs-var">fv_expr</span></a></span><span> </span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-847"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681132003"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-848"></span><span>                  </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132012"><span class="hs-identifier hs-var">fv_expr</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132010"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132007"><span class="hs-identifier hs-var">fvs2</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681132002"><span class="hs-identifier hs-var">fvs3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-849"></span><span>       </span><span class="hs-comment">-- fv_expr shouldn't really be filtered by the rnPatsAndThen</span><span>
</span><span id="line-850"></span><span>        </span><span class="hs-comment">-- but it does not matter because the names are unique</span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-var">rnStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131996"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131996"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLetStmt GhcPs GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131995"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131995"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681131994"><span class="annot"><span class="annottext">HsLocalBinds GhcPs
</span><a href="#local-6989586621681131994"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681131993"><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681131993"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-853"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcPs
-&gt; (HsLocalBinds GhcRn
    -&gt; FreeVars
    -&gt; RnM
         (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
          FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall result.
HsLocalBinds GhcPs
-&gt; (HsLocalBinds GhcRn -&gt; FreeVars -&gt; RnM (result, FreeVars))
-&gt; RnM (result, FreeVars)
</span><a href="GHC.Rename.Bind.html#rnLocalBindsAndThen"><span class="hs-identifier hs-var">rnLocalBindsAndThen</span></a></span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcPs
</span><a href="#local-6989586621681131994"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">((HsLocalBinds GhcRn
  -&gt; FreeVars
  -&gt; RnM
       (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
        FreeVars))
 -&gt; RnM
      (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
       FreeVars))
-&gt; (HsLocalBinds GhcRn
    -&gt; FreeVars
    -&gt; RnM
         (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
          FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681131992"><span class="annot"><span class="annottext">HsLocalBinds GhcRn
</span><a href="#local-6989586621681131992"><span class="hs-identifier hs-var">binds'</span></a></span></span><span> </span><span id="local-6989586621681131991"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131991"><span class="hs-identifier hs-var">bind_fvs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-854"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131990"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131990"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131989"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131989"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681131993"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsLocalBinds GhcRn -&gt; [IdP GhcRn]
forall (idL :: Pass) (idR :: Pass).
CollectPass (GhcPass idL) =&gt;
HsLocalBindsLR (GhcPass idL) (GhcPass idR) -&gt; [IdP (GhcPass idL)]
</span><a href="GHC.Hs.Utils.html#collectLocalBinders"><span class="hs-identifier hs-var">collectLocalBinders</span></a></span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcRn
</span><a href="#local-6989586621681131992"><span class="hs-identifier hs-var">binds'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-855"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
 FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
-&gt; LStmt GhcRn (Located (body GhcRn))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131996"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLetStmt GhcRn GhcRn (Located (body GhcRn))
-&gt; LHsLocalBinds GhcRn -&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
forall idL idR body.
XLetStmt idL idR body
-&gt; LHsLocalBindsLR idL idR -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XLetStmt GhcRn GhcRn (Located (body GhcRn))
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; HsLocalBinds GhcRn -&gt; LHsLocalBinds GhcRn
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131995"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcRn
</span><a href="#local-6989586621681131992"><span class="hs-identifier hs-var">binds'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131991"><span class="hs-identifier hs-var">bind_fvs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131990"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-856"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131989"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-var">rnStmt</span></a></span><span> </span><span id="local-6989586621681131987"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131987"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131986"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681131986"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131985"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131985"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#RecStmt"><span class="hs-identifier hs-type">RecStmt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recS_stmts :: forall idL idR body. StmtLR idL idR body -&gt; [LStmtLR idL idR body]
</span><a href="GHC.Hs.Expr.html#recS_stmts"><span class="hs-identifier hs-var">recS_stmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681131984"><span class="annot"><span class="annottext">[GenLocated SrcSpan (StmtLR GhcPs GhcPs (Located (body GhcPs)))]
</span><a href="#local-6989586621681131984"><span class="hs-identifier hs-var">rec_stmts</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681131983"><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681131983"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-859"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131982"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131982"><span class="hs-identifier hs-var">return_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131981"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131981"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupQualifiedDoStmtName"><span class="hs-identifier hs-var">lookupQualifiedDoStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131987"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#returnMName"><span class="hs-identifier hs-var">returnMName</span></a></span><span>
</span><span id="line-860"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131980"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131980"><span class="hs-identifier hs-var">mfix_op</span></a></span></span><span class="hs-special">,</span><span>   </span><span id="local-6989586621681131979"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131979"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupQualifiedDoStmtName"><span class="hs-identifier hs-var">lookupQualifiedDoStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131987"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#mfixName"><span class="hs-identifier hs-var">mfixName</span></a></span><span>
</span><span id="line-861"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131977"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131977"><span class="hs-identifier hs-var">bind_op</span></a></span></span><span class="hs-special">,</span><span>   </span><span id="local-6989586621681131976"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131976"><span class="hs-identifier hs-var">fvs3</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupQualifiedDoStmtName"><span class="hs-identifier hs-var">lookupQualifiedDoStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131987"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#bindMName"><span class="hs-identifier hs-var">bindMName</span></a></span><span>
</span><span id="line-862"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131975"><span class="annot"><span class="annottext">empty_rec_stmt :: StmtLR GhcRn GhcRn (Located (body GhcRn))
</span><a href="#local-6989586621681131975"><span class="hs-identifier hs-var hs-var">empty_rec_stmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StmtLR GhcRn GhcRn (Located (body GhcRn))
forall bodyR. StmtLR GhcRn GhcRn bodyR
</span><a href="GHC.Hs.Utils.html#emptyRecStmtName"><span class="hs-identifier hs-var">emptyRecStmtName</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recS_ret_fn :: SyntaxExpr GhcRn
</span><a href="GHC.Hs.Expr.html#recS_ret_fn"><span class="hs-identifier hs-var">recS_ret_fn</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681131982"><span class="hs-identifier hs-var">return_op</span></a></span><span>
</span><span id="line-863"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_mfix_fn :: SyntaxExpr GhcRn
</span><a href="GHC.Hs.Expr.html#recS_mfix_fn"><span class="hs-identifier hs-var">recS_mfix_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681131980"><span class="hs-identifier hs-var">mfix_op</span></a></span><span>
</span><span id="line-864"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_bind_fn :: SyntaxExpr GhcRn
</span><a href="GHC.Hs.Expr.html#recS_bind_fn"><span class="hs-identifier hs-var">recS_bind_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681131977"><span class="hs-identifier hs-var">bind_op</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-865"></span><span>
</span><span id="line-866"></span><span>        </span><span class="hs-comment">-- Step1: Bring all the binders of the mdo into scope</span><span>
</span><span id="line-867"></span><span>        </span><span class="hs-comment">-- (Remember that this also removes the binders from the</span><span>
</span><span id="line-868"></span><span>        </span><span class="hs-comment">-- finally-returned free-vars.)</span><span>
</span><span id="line-869"></span><span>        </span><span class="hs-comment">-- And rename each individual stmt, making a</span><span>
</span><span id="line-870"></span><span>        </span><span class="hs-comment">-- singleton segment.  At this stage the FwdRefs field</span><span>
</span><span id="line-871"></span><span>        </span><span class="hs-comment">-- isn't finished: it's empty for all except a BindStmt</span><span>
</span><span id="line-872"></span><span>        </span><span class="hs-comment">-- for which it's the fwd refs within the bind itself</span><span>
</span><span id="line-873"></span><span>        </span><span class="hs-comment">-- (This set may not be empty, because we're in a recursive</span><span>
</span><span id="line-874"></span><span>        </span><span class="hs-comment">-- context.)</span><span>
</span><span id="line-875"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [GenLocated SrcSpan (StmtLR GhcPs GhcPs (Located (body GhcPs)))]
-&gt; ([Segment (LStmt GhcRn (Located (body GhcRn)))]
    -&gt; RnM
         (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
          FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (body :: * -&gt; *) a.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Segment (LStmt GhcRn (Located (body GhcRn)))]
    -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnRecStmtsAndThen"><span class="hs-identifier hs-var">rnRecStmtsAndThen</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131987"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681131986"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpan (StmtLR GhcPs GhcPs (Located (body GhcPs)))]
</span><a href="#local-6989586621681131984"><span class="hs-identifier hs-var">rec_stmts</span></a></span><span>   </span><span class="annot"><span class="annottext">(([Segment (LStmt GhcRn (Located (body GhcRn)))]
  -&gt; RnM
       (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
        FreeVars))
 -&gt; RnM
      (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
       FreeVars))
-&gt; ([Segment (LStmt GhcRn (Located (body GhcRn)))]
    -&gt; RnM
         (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
          FreeVars))
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681131969"><span class="annot"><span class="annottext">[Segment (LStmt GhcRn (Located (body GhcRn)))]
</span><a href="#local-6989586621681131969"><span class="hs-identifier hs-var">segs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-876"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131968"><span class="annot"><span class="annottext">bndrs :: [Name]
</span><a href="#local-6989586621681131968"><span class="hs-identifier hs-var hs-var">bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; [Name]
</span><a href="GHC.Types.Name.Set.html#nameSetElemsStable"><span class="hs-identifier hs-var">nameSetElemsStable</span></a></span><span> </span><span class="annot"><span class="annottext">(FreeVars -&gt; [Name]) -&gt; FreeVars -&gt; [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-877"></span><span>                        </span><span class="annot"><span class="annottext">(Segment (LStmt GhcRn (Located (body GhcRn)))
 -&gt; FreeVars -&gt; FreeVars)
-&gt; FreeVars
-&gt; [Segment (LStmt GhcRn (Located (body GhcRn)))]
-&gt; FreeVars
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">(FreeVars -&gt; FreeVars -&gt; FreeVars)
-&gt; (Segment (LStmt GhcRn (Located (body GhcRn))) -&gt; FreeVars)
-&gt; Segment (LStmt GhcRn (Located (body GhcRn)))
-&gt; FreeVars
-&gt; FreeVars
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681131965"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131965"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">LStmt GhcRn (Located (body GhcRn))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131965"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-878"></span><span>                              </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span>
</span><span id="line-879"></span><span>                              </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn (Located (body GhcRn)))]
</span><a href="#local-6989586621681131969"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-880"></span><span>          </span><span class="hs-comment">-- See Note [Deterministic ApplicativeDo and RecursiveDo desugaring]</span><span>
</span><span id="line-881"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131964"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131964"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131963"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131963"><span class="hs-identifier hs-var">fvs_later</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681131983"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131968"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-882"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131962"><span class="annot"><span class="annottext">[LStmt GhcRn (Located (body GhcRn))]
</span><a href="#local-6989586621681131962"><span class="hs-identifier hs-var">rec_stmts'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131961"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131961"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan
-&gt; HsStmtContext GhcRn
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
-&gt; [Segment (LStmt GhcRn (Located (body GhcRn)))]
-&gt; FreeVars
-&gt; ([LStmt GhcRn (Located (body GhcRn))], FreeVars)
forall body.
SrcSpan
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcRn body
-&gt; [Segment (LStmt GhcRn body)]
-&gt; FreeVars
-&gt; ([LStmt GhcRn body], FreeVars)
</span><a href="GHC.Rename.Expr.html#segmentRecStmts"><span class="hs-identifier hs-var">segmentRecStmts</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131985"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131987"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">StmtLR GhcRn GhcRn (Located (body GhcRn))
</span><a href="#local-6989586621681131975"><span class="hs-identifier hs-var">empty_rec_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn (Located (body GhcRn)))]
</span><a href="#local-6989586621681131969"><span class="hs-identifier hs-var">segs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131963"><span class="hs-identifier hs-var">fvs_later</span></a></span><span>
</span><span id="line-883"></span><span>        </span><span class="hs-comment">-- We aren't going to try to group RecStmts with</span><span>
</span><span id="line-884"></span><span>        </span><span class="hs-comment">-- ApplicativeDo, so attaching empty FVs is fine.</span><span>
</span><span id="line-885"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
 FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LStmt GhcRn (Located (body GhcRn))]
-&gt; [FreeVars] -&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../base/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn (Located (body GhcRn))]
</span><a href="#local-6989586621681131962"><span class="hs-identifier hs-var">rec_stmts'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars -&gt; [FreeVars]
forall a. a -&gt; [a]
</span><a href="../../base/src/GHC.List.html#repeat"><span class="hs-identifier hs-var">repeat</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131964"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-886"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131961"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131981"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131979"><span class="hs-identifier hs-var">fvs2</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131976"><span class="hs-identifier hs-var">fvs3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-887"></span><span>
</span><span id="line-888"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-var">rnStmt</span></a></span><span> </span><span id="local-6989586621681131958"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131958"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131957"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131957"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmt"><span class="hs-identifier hs-type">ParStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XParStmt GhcPs GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131956"><span class="annot"><span class="annottext">[ParStmtBlock GhcPs GhcPs]
</span><a href="#local-6989586621681131956"><span class="hs-identifier hs-var">segs</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681131955"><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681131955"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-889"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131954"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131954"><span class="hs-identifier hs-var">mzip_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131953"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131953"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupStmtNamePoly"><span class="hs-identifier hs-var">lookupStmtNamePoly</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131958"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#mzipName"><span class="hs-identifier hs-var">mzipName</span></a></span><span>
</span><span id="line-890"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131950"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131950"><span class="hs-identifier hs-var">bind_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131949"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131949"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupStmtName"><span class="hs-identifier hs-var">lookupStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131958"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#bindMName"><span class="hs-identifier hs-var">bindMName</span></a></span><span>
</span><span id="line-891"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131948"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131948"><span class="hs-identifier hs-var">return_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131947"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131947"><span class="hs-identifier hs-var">fvs3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupStmtName"><span class="hs-identifier hs-var">lookupStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131958"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#returnMName"><span class="hs-identifier hs-var">returnMName</span></a></span><span>
</span><span id="line-892"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681131946"><span class="annot"><span class="annottext">[ParStmtBlock GhcRn GhcRn]
</span><a href="#local-6989586621681131946"><span class="hs-identifier hs-var">segs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131945"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131945"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131944"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131944"><span class="hs-identifier hs-var">fvs4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; SyntaxExpr GhcRn
-&gt; [ParStmtBlock GhcPs GhcPs]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM (([ParStmtBlock GhcRn GhcRn], thing), FreeVars)
forall thing.
HsStmtContext GhcRn
-&gt; SyntaxExpr GhcRn
-&gt; [ParStmtBlock GhcPs GhcPs]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM (([ParStmtBlock GhcRn GhcRn], thing), FreeVars)
</span><a href="GHC.Rename.Expr.html#rnParallelStmts"><span class="hs-identifier hs-var">rnParallelStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; HsStmtContext GhcRn
forall p. HsStmtContext p -&gt; HsStmtContext p
</span><a href="GHC.Hs.Expr.html#ParStmtCtxt"><span class="hs-identifier hs-var">ParStmtCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131958"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681131948"><span class="hs-identifier hs-var">return_op</span></a></span><span> </span><span class="annot"><span class="annottext">[ParStmtBlock GhcPs GhcPs]
</span><a href="#local-6989586621681131956"><span class="hs-identifier hs-var">segs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681131955"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-893"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
 FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
-&gt; LStmt GhcRn (Located (body GhcRn))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131957"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XParStmt GhcRn GhcRn (Located (body GhcRn))
-&gt; [ParStmtBlock GhcRn GhcRn]
-&gt; HsExpr GhcRn
-&gt; SyntaxExpr GhcRn
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
forall idL idR body.
XParStmt idL idR body
-&gt; [ParStmtBlock idL idR]
-&gt; HsExpr idR
-&gt; SyntaxExpr idR
-&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#ParStmt"><span class="hs-identifier hs-var">ParStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XParStmt GhcRn GhcRn (Located (body GhcRn))
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">[ParStmtBlock GhcRn GhcRn]
</span><a href="#local-6989586621681131946"><span class="hs-identifier hs-var">segs'</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131954"><span class="hs-identifier hs-var">mzip_op</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681131950"><span class="hs-identifier hs-var">bind_op</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131944"><span class="hs-identifier hs-var">fvs4</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131945"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-894"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131953"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131949"><span class="hs-identifier hs-var">fvs2</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131947"><span class="hs-identifier hs-var">fvs3</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131944"><span class="hs-identifier hs-var">fvs4</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-895"></span><span>
</span><span id="line-896"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-var">rnStmt</span></a></span><span> </span><span id="local-6989586621681131941"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131941"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131940"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131940"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#TransStmt"><span class="hs-identifier hs-type">TransStmt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">trS_stmts :: forall idL idR body. StmtLR idL idR body -&gt; [ExprLStmt idL]
</span><a href="GHC.Hs.Expr.html#trS_stmts"><span class="hs-identifier hs-var">trS_stmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681131938"><span class="annot"><span class="annottext">[ExprLStmt GhcPs]
</span><a href="#local-6989586621681131938"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">trS_by :: forall idL idR body. StmtLR idL idR body -&gt; Maybe (LHsExpr idR)
</span><a href="GHC.Hs.Expr.html#trS_by"><span class="hs-identifier hs-var">trS_by</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681131936"><span class="annot"><span class="annottext">Maybe (LHsExpr GhcPs)
</span><a href="#local-6989586621681131936"><span class="hs-identifier hs-var">by</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">trS_form :: forall idL idR body. StmtLR idL idR body -&gt; TransForm
</span><a href="GHC.Hs.Expr.html#trS_form"><span class="hs-identifier hs-var">trS_form</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681131934"><span class="annot"><span class="annottext">TransForm
</span><a href="#local-6989586621681131934"><span class="hs-identifier hs-var">form</span></a></span></span><span>
</span><span id="line-897"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">trS_using :: forall idL idR body. StmtLR idL idR body -&gt; LHsExpr idR
</span><a href="GHC.Hs.Expr.html#trS_using"><span class="hs-identifier hs-var">trS_using</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681131932"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681131932"><span class="hs-identifier hs-var">using</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681131931"><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681131931"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-898"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Rename the 'using' expression in the context before the transform is begun</span><span>
</span><span id="line-899"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621681131930"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131930"><span class="hs-identifier hs-var">using'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131929"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131929"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621681131932"><span class="hs-identifier hs-var">using</span></a></span><span>
</span><span id="line-900"></span><span>
</span><span id="line-901"></span><span>         </span><span class="hs-comment">-- Rename the stmts and the 'by' expression</span><span>
</span><span id="line-902"></span><span>         </span><span class="hs-comment">-- Keep track of the variables mentioned in the 'by' expression</span><span>
</span><span id="line-903"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681131928"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131928"><span class="hs-identifier hs-var">stmts'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131927"><span class="annot"><span class="annottext">Maybe (LHsExpr GhcRn)
</span><a href="#local-6989586621681131927"><span class="hs-identifier hs-var">by'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131926"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131926"><span class="hs-identifier hs-var">used_bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131925"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131925"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131924"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131924"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-904"></span><span>             </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars))
-&gt; [ExprLStmt GhcPs]
-&gt; ([Name]
    -&gt; RnM ((Maybe (LHsExpr GhcRn), [Name], thing), FreeVars))
-&gt; RnM
     (([ExprLStmt GhcRn], (Maybe (LHsExpr GhcRn), [Name], thing)),
      FreeVars)
forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM (([LStmt GhcRn (Located (body GhcRn))], thing), FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmts"><span class="hs-identifier hs-var">rnStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; HsStmtContext GhcRn
forall p. HsStmtContext p -&gt; HsStmtContext p
</span><a href="GHC.Hs.Expr.html#TransStmtCtxt"><span class="hs-identifier hs-var">TransStmtCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131941"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcPs]
</span><a href="#local-6989586621681131938"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">(([Name] -&gt; RnM ((Maybe (LHsExpr GhcRn), [Name], thing), FreeVars))
 -&gt; RnM
      (([ExprLStmt GhcRn], (Maybe (LHsExpr GhcRn), [Name], thing)),
       FreeVars))
-&gt; ([Name]
    -&gt; RnM ((Maybe (LHsExpr GhcRn), [Name], thing), FreeVars))
-&gt; RnM
     (([ExprLStmt GhcRn], (Maybe (LHsExpr GhcRn), [Name], thing)),
      FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681131922"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131922"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-905"></span><span>                </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131921"><span class="annot"><span class="annottext">Maybe (LHsExpr GhcRn)
</span><a href="#local-6989586621681131921"><span class="hs-identifier hs-var">by'</span></a></span></span><span class="hs-special">,</span><span>   </span><span id="local-6989586621681131920"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131920"><span class="hs-identifier hs-var">fvs_by</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars))
-&gt; Maybe (LHsExpr GhcPs) -&gt; RnM (Maybe (LHsExpr GhcRn), FreeVars)
forall a b.
(a -&gt; RnM (b, FreeVars)) -&gt; Maybe a -&gt; RnM (Maybe b, FreeVars)
</span><a href="GHC.Rename.Utils.html#mapMaybeFvRn"><span class="hs-identifier hs-var">mapMaybeFvRn</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsExpr GhcPs)
</span><a href="#local-6989586621681131936"><span class="hs-identifier hs-var">by</span></a></span><span>
</span><span id="line-906"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131919"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131919"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131918"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131918"><span class="hs-identifier hs-var">fvs_thing</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681131931"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131922"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-907"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131917"><span class="annot"><span class="annottext">fvs :: FreeVars
</span><a href="#local-6989586621681131917"><span class="hs-identifier hs-var hs-var">fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131920"><span class="hs-identifier hs-var">fvs_by</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131918"><span class="hs-identifier hs-var">fvs_thing</span></a></span><span>
</span><span id="line-908"></span><span>                         </span><span id="local-6989586621681131916"><span class="annot"><span class="annottext">used_bndrs :: [Name]
</span><a href="#local-6989586621681131916"><span class="hs-identifier hs-var hs-var">used_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; [Name] -&gt; [Name]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; FreeVars -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131917"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131922"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-909"></span><span>                         </span><span class="hs-comment">-- The paper (Fig 5) has a bug here; we must treat any free variable</span><span>
</span><span id="line-910"></span><span>                         </span><span class="hs-comment">-- of the &quot;thing inside&quot;, **or of the by-expression**, as used</span><span>
</span><span id="line-911"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">((Maybe (LHsExpr GhcRn), [Name], thing), FreeVars)
-&gt; RnM ((Maybe (LHsExpr GhcRn), [Name], thing), FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (LHsExpr GhcRn)
</span><a href="#local-6989586621681131921"><span class="hs-identifier hs-var">by'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131916"><span class="hs-identifier hs-var">used_bndrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131919"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131917"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-912"></span><span>
</span><span id="line-913"></span><span>       </span><span class="hs-comment">-- Lookup `return`, `(&gt;&gt;=)` and `liftM` for monad comprehensions</span><span>
</span><span id="line-914"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131914"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131914"><span class="hs-identifier hs-var">return_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131913"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131913"><span class="hs-identifier hs-var">fvs3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupStmtName"><span class="hs-identifier hs-var">lookupStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131941"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#returnMName"><span class="hs-identifier hs-var">returnMName</span></a></span><span>
</span><span id="line-915"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131912"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131912"><span class="hs-identifier hs-var">bind_op</span></a></span></span><span class="hs-special">,</span><span>   </span><span id="local-6989586621681131911"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131911"><span class="hs-identifier hs-var">fvs4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupStmtName"><span class="hs-identifier hs-var">lookupStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131941"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#bindMName"><span class="hs-identifier hs-var">bindMName</span></a></span><span>
</span><span id="line-916"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131910"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131910"><span class="hs-identifier hs-var">fmap_op</span></a></span></span><span class="hs-special">,</span><span>   </span><span id="local-6989586621681131909"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131909"><span class="hs-identifier hs-var">fvs5</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TransForm
</span><a href="#local-6989586621681131934"><span class="hs-identifier hs-var">form</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-917"></span><span>                                </span><span class="annot"><span class="annottext">TransForm
</span><a href="GHC.Hs.Expr.html#ThenForm"><span class="hs-identifier hs-var">ThenForm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcRn
forall (p :: Pass). HsExpr (GhcPass p)
</span><a href="GHC.Hs.Expr.html#noExpr"><span class="hs-identifier hs-var">noExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-918"></span><span>                                </span><span class="annot"><span class="annottext">TransForm
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupStmtNamePoly"><span class="hs-identifier hs-var">lookupStmtNamePoly</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131941"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#fmapName"><span class="hs-identifier hs-var">fmapName</span></a></span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131905"><span class="annot"><span class="annottext">all_fvs :: FreeVars
</span><a href="#local-6989586621681131905"><span class="hs-identifier hs-var hs-var">all_fvs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131929"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131924"><span class="hs-identifier hs-var">fvs2</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131913"><span class="hs-identifier hs-var">fvs3</span></a></span><span>
</span><span id="line-921"></span><span>                             </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131911"><span class="hs-identifier hs-var">fvs4</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131909"><span class="hs-identifier hs-var">fvs5</span></a></span><span>
</span><span id="line-922"></span><span>             </span><span id="local-6989586621681131904"><span class="annot"><span class="annottext">bndr_map :: [(Name, Name)]
</span><a href="#local-6989586621681131904"><span class="hs-identifier hs-var hs-var">bndr_map</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131926"><span class="hs-identifier hs-var">used_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [(Name, Name)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../base/src/GHC.List.html#zip"><span class="hs-operator hs-var">`zip`</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131926"><span class="hs-identifier hs-var">used_bndrs</span></a></span><span>
</span><span id="line-923"></span><span>             </span><span class="hs-comment">-- See Note [TransStmt binder map] in GHC.Hs.Expr</span><span>
</span><span id="line-924"></span><span>
</span><span id="line-925"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rnStmt: implicitly rebound these used binders:&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Name, Name)] -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, Name)]
</span><a href="#local-6989586621681131904"><span class="hs-identifier hs-var">bndr_map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-926"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
 FreeVars)
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
-&gt; LStmt GhcRn (Located (body GhcRn))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131940"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TransStmt :: forall idL idR body.
XTransStmt idL idR body
-&gt; TransForm
-&gt; [ExprLStmt idL]
-&gt; [(IdP idR, IdP idR)]
-&gt; LHsExpr idR
-&gt; Maybe (LHsExpr idR)
-&gt; SyntaxExpr idR
-&gt; SyntaxExpr idR
-&gt; HsExpr idR
-&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#TransStmt"><span class="hs-identifier hs-type">TransStmt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">trS_ext :: XTransStmt GhcRn GhcRn (Located (body GhcRn))
</span><a href="GHC.Hs.Expr.html#trS_ext"><span class="hs-identifier hs-var">trS_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NoExtField
XTransStmt GhcRn GhcRn (Located (body GhcRn))
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span>
</span><span id="line-927"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">trS_stmts :: [ExprLStmt GhcRn]
</span><a href="GHC.Hs.Expr.html#trS_stmts"><span class="hs-identifier hs-var">trS_stmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131928"><span class="hs-identifier hs-var">stmts'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">trS_bndrs :: [(IdP GhcRn, IdP GhcRn)]
</span><a href="GHC.Hs.Expr.html#trS_bndrs"><span class="hs-identifier hs-var">trS_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Name)]
[(IdP GhcRn, IdP GhcRn)]
</span><a href="#local-6989586621681131904"><span class="hs-identifier hs-var">bndr_map</span></a></span><span>
</span><span id="line-928"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">trS_by :: Maybe (LHsExpr GhcRn)
</span><a href="GHC.Hs.Expr.html#trS_by"><span class="hs-identifier hs-var">trS_by</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (LHsExpr GhcRn)
</span><a href="#local-6989586621681131927"><span class="hs-identifier hs-var">by'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">trS_using :: LHsExpr GhcRn
</span><a href="GHC.Hs.Expr.html#trS_using"><span class="hs-identifier hs-var">trS_using</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131930"><span class="hs-identifier hs-var">using'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">trS_form :: TransForm
</span><a href="GHC.Hs.Expr.html#trS_form"><span class="hs-identifier hs-var">trS_form</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TransForm
</span><a href="#local-6989586621681131934"><span class="hs-identifier hs-var">form</span></a></span><span>
</span><span id="line-929"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">trS_ret :: SyntaxExpr GhcRn
</span><a href="GHC.Hs.Expr.html#trS_ret"><span class="hs-identifier hs-var">trS_ret</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681131914"><span class="hs-identifier hs-var">return_op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">trS_bind :: SyntaxExpr GhcRn
</span><a href="GHC.Hs.Expr.html#trS_bind"><span class="hs-identifier hs-var">trS_bind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681131912"><span class="hs-identifier hs-var">bind_op</span></a></span><span>
</span><span id="line-930"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">trS_fmap :: HsExpr GhcRn
</span><a href="GHC.Hs.Expr.html#trS_fmap"><span class="hs-identifier hs-var">trS_fmap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131910"><span class="hs-identifier hs-var">fmap_op</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131924"><span class="hs-identifier hs-var">fvs2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131925"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131905"><span class="hs-identifier hs-var">all_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-931"></span><span>
</span><span id="line-932"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnStmt"><span class="hs-identifier hs-var">rnStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeStmt"><span class="hs-identifier hs-type">ApplicativeStmt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-933"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; RnM
     (([(LStmt GhcRn (Located (body GhcRn)), FreeVars)], thing),
      FreeVars)
forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rnStmt: ApplicativeStmt&quot;</span></span><span>
</span><span id="line-934"></span><span>
</span><span id="line-935"></span><span class="annot"><a href="GHC.Rename.Expr.html#rnParallelStmts"><span class="hs-identifier hs-type">rnParallelStmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681133447"><span class="annot"><a href="#local-6989586621681133447"><span class="hs-identifier hs-type">thing</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-936"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-937"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmtBlock"><span class="hs-identifier hs-type">ParStmtBlock</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-938"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133447"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-939"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmtBlock"><span class="hs-identifier hs-type">ParStmtBlock</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681133447"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-940"></span><span class="hs-comment">-- Note [Renaming parallel Stmts]</span><span>
</span><span id="line-941"></span><span id="rnParallelStmts"><span class="annot"><span class="annottext">rnParallelStmts :: forall thing.
HsStmtContext GhcRn
-&gt; SyntaxExpr GhcRn
-&gt; [ParStmtBlock GhcPs GhcPs]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM (([ParStmtBlock GhcRn GhcRn], thing), FreeVars)
</span><a href="GHC.Rename.Expr.html#rnParallelStmts"><span class="hs-identifier hs-var hs-var">rnParallelStmts</span></a></span></span><span> </span><span id="local-6989586621681131886"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131886"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131885"><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><a href="#local-6989586621681131885"><span class="hs-identifier hs-var">return_op</span></a></span></span><span> </span><span id="local-6989586621681131884"><span class="annot"><span class="annottext">[ParStmtBlock GhcPs GhcPs]
</span><a href="#local-6989586621681131884"><span class="hs-identifier hs-var">segs</span></a></span></span><span> </span><span id="local-6989586621681131883"><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681131883"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-942"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681131882"><span class="annot"><span class="annottext">LocalRdrEnv
</span><a href="#local-6989586621681131882"><span class="hs-identifier hs-var">orig_lcl_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RnM LocalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a></span><span>
</span><span id="line-943"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">LocalRdrEnv
-&gt; [Name]
-&gt; [ParStmtBlock GhcPs GhcPs]
-&gt; RnM (([ParStmtBlock GhcRn GhcRn], thing), FreeVars)
</span><a href="#local-6989586621681131880"><span class="hs-identifier hs-var">rn_segs</span></a></span><span> </span><span class="annot"><span class="annottext">LocalRdrEnv
</span><a href="#local-6989586621681131882"><span class="hs-identifier hs-var">orig_lcl_env</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[ParStmtBlock GhcPs GhcPs]
</span><a href="#local-6989586621681131884"><span class="hs-identifier hs-var">segs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-944"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-945"></span><span>    </span><span class="annot"><a href="#local-6989586621681131880"><span class="hs-identifier hs-type">rn_segs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a></span><span>
</span><span id="line-946"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmtBlock"><span class="hs-identifier hs-type">ParStmtBlock</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-947"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmtBlock"><span class="hs-identifier hs-type">ParStmtBlock</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681133447"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-948"></span><span>    </span><span id="local-6989586621681131880"><span class="annot"><span class="annottext">rn_segs :: LocalRdrEnv
-&gt; [Name]
-&gt; [ParStmtBlock GhcPs GhcPs]
-&gt; RnM (([ParStmtBlock GhcRn GhcRn], thing), FreeVars)
</span><a href="#local-6989586621681131880"><span class="hs-identifier hs-var hs-var">rn_segs</span></a></span></span><span> </span><span class="annot"><span class="annottext">LocalRdrEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131879"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131879"><span class="hs-identifier hs-var">bndrs_so_far</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-949"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131878"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131878"><span class="hs-identifier hs-var">bndrs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131877"><span class="annot"><span class="annottext">[NonEmpty Name]
</span><a href="#local-6989586621681131877"><span class="hs-identifier hs-var">dups</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Name -&gt; Ordering) -&gt; [Name] -&gt; ([Name], [NonEmpty Name])
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; ([a], [NonEmpty a])
</span><a href="GHC.Data.List.SetOps.html#removeDups"><span class="hs-identifier hs-var">removeDups</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Ordering
</span><a href="#local-6989586621681131876"><span class="hs-identifier hs-var">cmpByOcc</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131879"><span class="hs-identifier hs-var">bndrs_so_far</span></a></span><span>
</span><span id="line-950"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(NonEmpty Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) ())
-&gt; [NonEmpty Name] -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall {a}.
Outputable a =&gt;
NonEmpty a -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681131874"><span class="hs-identifier hs-var">dupErr</span></a></span><span> </span><span class="annot"><span class="annottext">[NonEmpty Name]
</span><a href="#local-6989586621681131877"><span class="hs-identifier hs-var">dups</span></a></span><span>
</span><span id="line-951"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131873"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131873"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131872"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131872"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars) -&gt; RnM (thing, FreeVars)
forall a. [Name] -&gt; RnM a -&gt; RnM a
</span><a href="GHC.Rename.Utils.html#bindLocalNames"><span class="hs-identifier hs-var">bindLocalNames</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131878"><span class="hs-identifier hs-var">bndrs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; RnM (thing, FreeVars)
</span><a href="#local-6989586621681131883"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131878"><span class="hs-identifier hs-var">bndrs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-952"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([ParStmtBlock GhcRn GhcRn], thing), FreeVars)
-&gt; RnM (([ParStmtBlock GhcRn GhcRn], thing), FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131873"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131872"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-953"></span><span>
</span><span id="line-954"></span><span>    </span><span class="annot"><a href="#local-6989586621681131880"><span class="hs-identifier hs-var">rn_segs</span></a></span><span> </span><span id="local-6989586621681131871"><span class="annot"><span class="annottext">LocalRdrEnv
</span><a href="#local-6989586621681131871"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621681131870"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131870"><span class="hs-identifier hs-var">bndrs_so_far</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmtBlock"><span class="hs-identifier hs-type">ParStmtBlock</span></a></span><span> </span><span id="local-6989586621681131868"><span class="annot"><span class="annottext">XParStmtBlock GhcPs GhcPs
</span><a href="#local-6989586621681131868"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681131867"><span class="annot"><span class="annottext">[ExprLStmt GhcPs]
</span><a href="#local-6989586621681131867"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="annot"><span class="annottext">[IdP GhcPs]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681131866"><span class="annot"><span class="annottext">[ParStmtBlock GhcPs GhcPs]
</span><a href="#local-6989586621681131866"><span class="hs-identifier hs-var">segs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-955"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681131865"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131865"><span class="hs-identifier hs-var">stmts'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131864"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131864"><span class="hs-identifier hs-var">used_bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131863"><span class="annot"><span class="annottext">[ParStmtBlock GhcRn GhcRn]
</span><a href="#local-6989586621681131863"><span class="hs-identifier hs-var">segs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131862"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131862"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131861"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131861"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-956"></span><span>                    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars))
-&gt; [ExprLStmt GhcPs]
-&gt; ([Name]
    -&gt; RnM (([Name], [ParStmtBlock GhcRn GhcRn], thing), FreeVars))
-&gt; RnM
     (([ExprLStmt GhcRn], ([Name], [ParStmtBlock GhcRn GhcRn], thing)),
      FreeVars)
forall (body :: * -&gt; *) thing.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Name] -&gt; RnM (thing, FreeVars))
-&gt; RnM (([LStmt GhcRn (Located (body GhcRn))], thing), FreeVars)
</span><a href="GHC.Rename.Expr.html#rnStmts"><span class="hs-identifier hs-var">rnStmts</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131886"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; RnM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcPs]
</span><a href="#local-6989586621681131867"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">(([Name]
  -&gt; RnM (([Name], [ParStmtBlock GhcRn GhcRn], thing), FreeVars))
 -&gt; RnM
      (([ExprLStmt GhcRn], ([Name], [ParStmtBlock GhcRn GhcRn], thing)),
       FreeVars))
-&gt; ([Name]
    -&gt; RnM (([Name], [ParStmtBlock GhcRn GhcRn], thing), FreeVars))
-&gt; RnM
     (([ExprLStmt GhcRn], ([Name], [ParStmtBlock GhcRn GhcRn], thing)),
      FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681131860"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131860"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-957"></span><span>                       </span><span class="annot"><span class="annottext">LocalRdrEnv
-&gt; RnM (([Name], [ParStmtBlock GhcRn GhcRn], thing), FreeVars)
-&gt; RnM (([Name], [ParStmtBlock GhcRn GhcRn], thing), FreeVars)
forall a. LocalRdrEnv -&gt; RnM a -&gt; RnM a
</span><a href="GHC.Tc.Utils.Monad.html#setLocalRdrEnv"><span class="hs-identifier hs-var">setLocalRdrEnv</span></a></span><span> </span><span class="annot"><span class="annottext">LocalRdrEnv
</span><a href="#local-6989586621681131871"><span class="hs-identifier hs-var">env</span></a></span><span>       </span><span class="annot"><span class="annottext">(RnM (([Name], [ParStmtBlock GhcRn GhcRn], thing), FreeVars)
 -&gt; RnM (([Name], [ParStmtBlock GhcRn GhcRn], thing), FreeVars))
-&gt; RnM (([Name], [ParStmtBlock GhcRn GhcRn], thing), FreeVars)
-&gt; RnM (([Name], [ParStmtBlock GhcRn GhcRn], thing), FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-958"></span><span>                       </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681131858"><span class="annot"><span class="annottext">[ParStmtBlock GhcRn GhcRn]
</span><a href="#local-6989586621681131858"><span class="hs-identifier hs-var">segs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131857"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131857"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131856"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131856"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LocalRdrEnv
-&gt; [Name]
-&gt; [ParStmtBlock GhcPs GhcPs]
-&gt; RnM (([ParStmtBlock GhcRn GhcRn], thing), FreeVars)
</span><a href="#local-6989586621681131880"><span class="hs-identifier hs-var">rn_segs</span></a></span><span> </span><span class="annot"><span class="annottext">LocalRdrEnv
</span><a href="#local-6989586621681131871"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131860"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131870"><span class="hs-identifier hs-var">bndrs_so_far</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ParStmtBlock GhcPs GhcPs]
</span><a href="#local-6989586621681131866"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-959"></span><span>                       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131855"><span class="annot"><span class="annottext">used_bndrs :: [Name]
</span><a href="#local-6989586621681131855"><span class="hs-identifier hs-var hs-var">used_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; [Name] -&gt; [Name]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; FreeVars -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131856"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131860"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-960"></span><span>                       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([Name], [ParStmtBlock GhcRn GhcRn], thing), FreeVars)
-&gt; RnM (([Name], [ParStmtBlock GhcRn GhcRn], thing), FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131855"><span class="hs-identifier hs-var">used_bndrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ParStmtBlock GhcRn GhcRn]
</span><a href="#local-6989586621681131858"><span class="hs-identifier hs-var">segs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131857"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131856"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-961"></span><span>
</span><span id="line-962"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131854"><span class="annot"><span class="annottext">seg' :: ParStmtBlock GhcRn GhcRn
</span><a href="#local-6989586621681131854"><span class="hs-identifier hs-var hs-var">seg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XParStmtBlock GhcRn GhcRn
-&gt; [ExprLStmt GhcRn]
-&gt; [IdP GhcRn]
-&gt; SyntaxExpr GhcRn
-&gt; ParStmtBlock GhcRn GhcRn
forall idL idR.
XParStmtBlock idL idR
-&gt; [ExprLStmt idL]
-&gt; [IdP idR]
-&gt; SyntaxExpr idR
-&gt; ParStmtBlock idL idR
</span><a href="GHC.Hs.Expr.html#ParStmtBlock"><span class="hs-identifier hs-var">ParStmtBlock</span></a></span><span> </span><span class="annot"><span class="annottext">XParStmtBlock GhcPs GhcPs
XParStmtBlock GhcRn GhcRn
</span><a href="#local-6989586621681131868"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131865"><span class="hs-identifier hs-var">stmts'</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
[IdP GhcRn]
</span><a href="#local-6989586621681131864"><span class="hs-identifier hs-var">used_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><a href="#local-6989586621681131885"><span class="hs-identifier hs-var">return_op</span></a></span><span>
</span><span id="line-963"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(([ParStmtBlock GhcRn GhcRn], thing), FreeVars)
-&gt; RnM (([ParStmtBlock GhcRn GhcRn], thing), FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParStmtBlock GhcRn GhcRn
</span><a href="#local-6989586621681131854"><span class="hs-identifier hs-var">seg'</span></a></span><span class="annot"><span class="annottext">ParStmtBlock GhcRn GhcRn
-&gt; [ParStmtBlock GhcRn GhcRn] -&gt; [ParStmtBlock GhcRn GhcRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[ParStmtBlock GhcRn GhcRn]
</span><a href="#local-6989586621681131863"><span class="hs-identifier hs-var">segs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621681131862"><span class="hs-identifier hs-var">thing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131861"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-964"></span><span>
</span><span id="line-965"></span><span>    </span><span id="local-6989586621681131876"><span class="annot"><span class="annottext">cmpByOcc :: Name -&gt; Name -&gt; Ordering
</span><a href="#local-6989586621681131876"><span class="hs-identifier hs-var hs-var">cmpByOcc</span></a></span></span><span> </span><span id="local-6989586621681131851"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131851"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621681131850"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131850"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131851"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; OccName -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131850"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-966"></span><span>    </span><span id="local-6989586621681131874"><span class="annot"><span class="annottext">dupErr :: NonEmpty a -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681131874"><span class="hs-identifier hs-var hs-var">dupErr</span></a></span></span><span> </span><span id="local-6989586621681131845"><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621681131845"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Duplicate binding in parallel list comprehension for:&quot;</span></span><span>
</span><span id="line-967"></span><span>                    </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty a -&gt; a
forall a. NonEmpty a -&gt; a
</span><a href="../../base/src/Data.List.NonEmpty.html#head"><span class="hs-identifier hs-var">NE.head</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621681131845"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-968"></span><span>
</span><span id="line-969"></span><span class="annot"><a href="GHC.Rename.Expr.html#lookupQualifiedDoStmtName"><span class="hs-identifier hs-type">lookupQualifiedDoStmtName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-970"></span><span class="hs-comment">-- Like lookupStmtName, but respects QualifiedDo</span><span>
</span><span id="line-971"></span><span id="lookupQualifiedDoStmtName"><span class="annot"><span class="annottext">lookupQualifiedDoStmtName :: HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupQualifiedDoStmtName"><span class="hs-identifier hs-var hs-var">lookupQualifiedDoStmtName</span></a></span></span><span> </span><span id="local-6989586621681131842"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131842"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131841"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131841"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-972"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Maybe ModuleName
forall p. HsStmtContext p -&gt; Maybe ModuleName
</span><a href="GHC.Hs.Expr.html#qualifiedDoModuleName_maybe"><span class="hs-identifier hs-var">qualifiedDoModuleName_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131842"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-973"></span><span>      </span><span class="annot"><span class="annottext">Maybe ModuleName
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupStmtName"><span class="hs-identifier hs-var">lookupStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131842"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131841"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-974"></span><span>      </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681131839"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681131839"><span class="hs-identifier hs-var">modName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-975"></span><span>        </span><span class="annot"><span class="annottext">(Name -&gt; SyntaxExprRn)
-&gt; (Name, FreeVars) -&gt; (SyntaxExprRn, FreeVars)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><a href="../../base/src/Control.Arrow.html#first"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcRn -&gt; SyntaxExprRn
</span><a href="GHC.Hs.Expr.html#mkSyntaxExpr"><span class="hs-identifier hs-var">mkSyntaxExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn -&gt; SyntaxExprRn)
-&gt; (Name -&gt; HsExpr GhcRn) -&gt; Name -&gt; SyntaxExprRn
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; HsExpr GhcRn
forall (id :: Pass). IdP (GhcPass id) -&gt; HsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nl_HsVar"><span class="hs-identifier hs-var">nl_HsVar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Name, FreeVars) -&gt; (SyntaxExprRn, FreeVars))
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Name, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (SyntaxExprRn, FreeVars)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; ModuleName -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Name, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupNameWithQualifier"><span class="hs-identifier hs-var">lookupNameWithQualifier</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131841"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681131839"><span class="hs-identifier hs-var">modName</span></a></span><span>
</span><span id="line-976"></span><span>
</span><span id="line-977"></span><span class="annot"><a href="GHC.Rename.Expr.html#lookupStmtName"><span class="hs-identifier hs-type">lookupStmtName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-978"></span><span class="hs-comment">-- Like lookupSyntax, but respects contexts</span><span>
</span><span id="line-979"></span><span id="lookupStmtName"><span class="annot"><span class="annottext">lookupStmtName :: HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupStmtName"><span class="hs-identifier hs-var hs-var">lookupStmtName</span></a></span></span><span> </span><span id="local-6989586621681131835"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131835"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131834"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131834"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-980"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Bool
</span><a href="GHC.Rename.Expr.html#rebindableContext"><span class="hs-identifier hs-var">rebindableContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131835"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-981"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupSyntax"><span class="hs-identifier hs-var">lookupSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131834"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-982"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-983"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SyntaxExprRn, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (SyntaxExprRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SyntaxExprRn
</span><a href="GHC.Hs.Expr.html#mkRnSyntaxExpr"><span class="hs-identifier hs-var">mkRnSyntaxExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131834"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-984"></span><span>
</span><span id="line-985"></span><span class="annot"><a href="GHC.Rename.Expr.html#lookupStmtNamePoly"><span class="hs-identifier hs-type">lookupStmtNamePoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-986"></span><span id="lookupStmtNamePoly"><span class="annot"><span class="annottext">lookupStmtNamePoly :: HsStmtContext GhcRn -&gt; Name -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupStmtNamePoly"><span class="hs-identifier hs-var hs-var">lookupStmtNamePoly</span></a></span></span><span> </span><span id="local-6989586621681131831"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131831"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131830"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131830"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-987"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Bool
</span><a href="GHC.Rename.Expr.html#rebindableContext"><span class="hs-identifier hs-var">rebindableContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131831"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-988"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681131829"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131829"><span class="hs-identifier hs-var">rebindable_on</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#RebindableSyntax"><span class="hs-identifier hs-var">LangExt.RebindableSyntax</span></a></span><span>
</span><span id="line-989"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131829"><span class="hs-identifier hs-var">rebindable_on</span></a></span><span>
</span><span id="line-990"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681131828"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131828"><span class="hs-identifier hs-var">fm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; RnM Name
</span><a href="GHC.Rename.Env.html#lookupOccRn"><span class="hs-identifier hs-var">lookupOccRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; RdrName
</span><a href="GHC.Types.Name.Reader.html#nameRdrName"><span class="hs-identifier hs-var">nameRdrName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131830"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-991"></span><span>                 </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XVar GhcRn -&gt; Located (IdP GhcRn) -&gt; HsExpr GhcRn
forall p. XVar p -&gt; Located (IdP p) -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XVar GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Located Name
forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131828"><span class="hs-identifier hs-var">fm</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131828"><span class="hs-identifier hs-var">fm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-992"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TcM (HsExpr GhcRn, FreeVars)
</span><a href="#local-6989586621681131826"><span class="hs-identifier hs-var">not_rebindable</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-993"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-994"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcM (HsExpr GhcRn, FreeVars)
</span><a href="#local-6989586621681131826"><span class="hs-identifier hs-var">not_rebindable</span></a></span><span>
</span><span id="line-995"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-996"></span><span>    </span><span id="local-6989586621681131826"><span class="annot"><span class="annottext">not_rebindable :: TcM (HsExpr GhcRn, FreeVars)
</span><a href="#local-6989586621681131826"><span class="hs-identifier hs-var hs-var">not_rebindable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XVar GhcRn -&gt; Located (IdP GhcRn) -&gt; HsExpr GhcRn
forall p. XVar p -&gt; Located (IdP p) -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XVar GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Located Name
forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131830"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-997"></span><span>
</span><span id="line-998"></span><span class="hs-comment">-- | Is this a context where we respect RebindableSyntax?</span><span>
</span><span id="line-999"></span><span class="hs-comment">-- but ListComp are never rebindable</span><span>
</span><span id="line-1000"></span><span class="hs-comment">-- Neither is ArrowExpr, which has its own desugarer in GHC.HsToCore.Arrows</span><span>
</span><span id="line-1001"></span><span class="annot"><a href="GHC.Rename.Expr.html#rebindableContext"><span class="hs-identifier hs-type">rebindableContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1002"></span><span id="rebindableContext"><span class="annot"><span class="annottext">rebindableContext :: HsStmtContext GhcRn -&gt; Bool
</span><a href="GHC.Rename.Expr.html#rebindableContext"><span class="hs-identifier hs-var hs-var">rebindableContext</span></a></span></span><span> </span><span id="local-6989586621681131825"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131825"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131825"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1003"></span><span>  </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#ListComp"><span class="hs-identifier hs-var">ListComp</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1004"></span><span>  </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#ArrowExpr"><span class="hs-identifier hs-var">ArrowExpr</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1005"></span><span>  </span><span class="annot"><a href="GHC.Hs.Expr.html#PatGuard"><span class="hs-identifier hs-type">PatGuard</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1006"></span><span>
</span><span id="line-1007"></span><span>  </span><span class="annot"><a href="GHC.Hs.Expr.html#DoExpr"><span class="hs-identifier hs-type">DoExpr</span></a></span><span> </span><span id="local-6989586621681131822"><span class="annot"><span class="annottext">Maybe ModuleName
</span><a href="#local-6989586621681131822"><span class="hs-identifier hs-var">m</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../base/src/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
</span><a href="#local-6989586621681131822"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1008"></span><span>  </span><span class="annot"><a href="GHC.Hs.Expr.html#MDoExpr"><span class="hs-identifier hs-type">MDoExpr</span></a></span><span> </span><span id="local-6989586621681131821"><span class="annot"><span class="annottext">Maybe ModuleName
</span><a href="#local-6989586621681131821"><span class="hs-identifier hs-var">m</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../base/src/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
</span><a href="#local-6989586621681131821"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1009"></span><span>  </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#MonadComp"><span class="hs-identifier hs-var">MonadComp</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1010"></span><span>  </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#GhciStmtCtxt"><span class="hs-identifier hs-var">GhciStmtCtxt</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>   </span><span class="hs-comment">-- I suppose?</span><span>
</span><span id="line-1011"></span><span>
</span><span id="line-1012"></span><span>  </span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmtCtxt"><span class="hs-identifier hs-type">ParStmtCtxt</span></a></span><span>   </span><span id="local-6989586621681131818"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131818"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Bool
</span><a href="GHC.Rename.Expr.html#rebindableContext"><span class="hs-identifier hs-var">rebindableContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131818"><span class="hs-identifier hs-var">c</span></a></span><span>     </span><span class="hs-comment">-- Look inside to</span><span>
</span><span id="line-1013"></span><span>  </span><span class="annot"><a href="GHC.Hs.Expr.html#TransStmtCtxt"><span class="hs-identifier hs-type">TransStmtCtxt</span></a></span><span> </span><span id="local-6989586621681131817"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131817"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Bool
</span><a href="GHC.Rename.Expr.html#rebindableContext"><span class="hs-identifier hs-var">rebindableContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131817"><span class="hs-identifier hs-var">c</span></a></span><span>     </span><span class="hs-comment">-- the parent context</span><span>
</span><span id="line-1014"></span><span>
</span><span id="line-1015"></span><span class="hs-comment">{-
Note [Renaming parallel Stmts]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Renaming parallel statements is painful.  Given, say
     [ a+c | a &lt;- as, bs &lt;- bss
           | c &lt;- bs, a &lt;- ds ]
Note that
  (a) In order to report &quot;Defined but not used&quot; about 'bs', we must
      rename each group of Stmts with a thing_inside whose FreeVars
      include at least {a,c}

  (b) We want to report that 'a' is illegally bound in both branches

  (c) The 'bs' in the second group must obviously not be captured by
      the binding in the first group

To satisfy (a) we nest the segements.
To satisfy (b) we check for duplicates just before thing_inside.
To satisfy (c) we reset the LocalRdrEnv each time.

************************************************************************
*                                                                      *
\subsubsection{mdo expressions}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1041"></span><span>
</span><span id="line-1042"></span><span class="hs-keyword">type</span><span> </span><span id="FwdRefs"><span class="annot"><a href="GHC.Rename.Expr.html#FwdRefs"><span class="hs-identifier hs-var">FwdRefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span>
</span><span id="line-1043"></span><span class="hs-keyword">type</span><span> </span><span id="Segment"><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-var">Segment</span></a></span></span><span> </span><span id="local-6989586621681131814"><span class="annot"><a href="#local-6989586621681131814"><span class="hs-identifier hs-type">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Set.html#Defs"><span class="hs-identifier hs-type">Defs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1044"></span><span>                      </span><span class="annot"><a href="GHC.Types.Name.Set.html#Uses"><span class="hs-identifier hs-type">Uses</span></a></span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- May include defs</span><span>
</span><span id="line-1045"></span><span>                      </span><span class="annot"><a href="GHC.Rename.Expr.html#FwdRefs"><span class="hs-identifier hs-type">FwdRefs</span></a></span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- A subset of uses that are</span><span>
</span><span id="line-1046"></span><span>                                </span><span class="hs-comment">--   (a) used before they are bound in this segment, or</span><span>
</span><span id="line-1047"></span><span>                                </span><span class="hs-comment">--   (b) used here, and bound in subsequent segments</span><span>
</span><span id="line-1048"></span><span>                      </span><span class="annot"><a href="#local-6989586621681131814"><span class="hs-identifier hs-type">stmts</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Either Stmt or [Stmt]</span><span>
</span><span id="line-1049"></span><span>
</span><span id="line-1050"></span><span>
</span><span id="line-1051"></span><span class="hs-comment">-- wrapper that does both the left- and right-hand sides</span><span>
</span><span id="line-1052"></span><span id="local-6989586621681133455"><span id="local-6989586621681133456"><span class="annot"><a href="GHC.Rename.Expr.html#rnRecStmtsAndThen"><span class="hs-identifier hs-type">rnRecStmtsAndThen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133456"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1053"></span><span>                     </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-1054"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133456"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1055"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133456"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1056"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133456"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1057"></span><span>                         </span><span class="hs-comment">-- assumes that the FreeVars returned includes</span><span>
</span><span id="line-1058"></span><span>                         </span><span class="hs-comment">-- the FreeVars of the Segments</span><span>
</span><span id="line-1059"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-type">Segment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133456"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1060"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133455"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1061"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133455"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1062"></span><span id="rnRecStmtsAndThen"><span class="annot"><span class="annottext">rnRecStmtsAndThen :: forall (body :: * -&gt; *) a.
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; ([Segment (LStmt GhcRn (Located (body GhcRn)))]
    -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnRecStmtsAndThen"><span class="hs-identifier hs-var hs-var">rnRecStmtsAndThen</span></a></span></span><span> </span><span id="local-6989586621681131797"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131797"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131796"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681131796"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span id="local-6989586621681131795"><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
</span><a href="#local-6989586621681131795"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621681131794"><span class="annot"><span class="annottext">[Segment (LStmt GhcRn (Located (body GhcRn)))] -&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621681131794"><span class="hs-identifier hs-var">cont</span></a></span></span><span>
</span><span id="line-1063"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- (A) Make the mini fixity env for all of the stmts</span><span>
</span><span id="line-1064"></span><span>          </span><span id="local-6989586621681131793"><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681131793"><span class="hs-identifier hs-var">fix_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LFixitySig GhcPs] -&gt; RnM MiniFixityEnv
</span><a href="GHC.Rename.Bind.html#makeMiniFixityEnv"><span class="hs-identifier hs-var">makeMiniFixityEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))] -&gt; [LFixitySig GhcPs]
forall body. [LStmtLR GhcPs GhcPs body] -&gt; [LFixitySig GhcPs]
</span><a href="GHC.Rename.Expr.html#collectRecStmtsFixities"><span class="hs-identifier hs-var">collectRecStmtsFixities</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
</span><a href="#local-6989586621681131795"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1065"></span><span>
</span><span id="line-1066"></span><span>          </span><span class="hs-comment">-- (B) Do the LHSes</span><span>
</span><span id="line-1067"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681131791"><span class="annot"><span class="annottext">[(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
</span><a href="#local-6989586621681131791"><span class="hs-identifier hs-var">new_lhs_and_fv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
-&gt; [LStmt GhcPs (Located (body GhcPs))]
-&gt; RnM [(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
forall body.
Outputable body =&gt;
MiniFixityEnv
-&gt; [LStmt GhcPs body] -&gt; RnM [(LStmtLR GhcRn GhcPs body, FreeVars)]
</span><a href="GHC.Rename.Expr.html#rn_rec_stmts_lhs"><span class="hs-identifier hs-var">rn_rec_stmts_lhs</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681131793"><span class="hs-identifier hs-var">fix_env</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcPs (Located (body GhcPs))]
</span><a href="#local-6989586621681131795"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1068"></span><span>
</span><span id="line-1069"></span><span>          </span><span class="hs-comment">--    ...bring them and their fixities into scope</span><span>
</span><span id="line-1070"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131789"><span class="annot"><span class="annottext">bound_names :: [IdP GhcRn]
</span><a href="#local-6989586621681131789"><span class="hs-identifier hs-var hs-var">bound_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LStmtLR GhcRn GhcPs (Located (body GhcPs))] -&gt; [IdP GhcRn]
forall (idL :: Pass) (idR :: Pass) body.
CollectPass (GhcPass idL) =&gt;
[LStmtLR (GhcPass idL) (GhcPass idR) body] -&gt; [IdP (GhcPass idL)]
</span><a href="GHC.Hs.Utils.html#collectLStmtsBinders"><span class="hs-identifier hs-var">collectLStmtsBinders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
 -&gt; LStmtLR GhcRn GhcPs (Located (body GhcPs)))
-&gt; [(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
-&gt; [LStmtLR GhcRn GhcPs (Located (body GhcPs))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
-&gt; LStmtLR GhcRn GhcPs (Located (body GhcPs))
forall a b. (a, b) -&gt; a
</span><a href="../../base/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
</span><a href="#local-6989586621681131791"><span class="hs-identifier hs-var">new_lhs_and_fv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1071"></span><span>              </span><span class="hs-comment">-- Fake uses of variables introduced implicitly (warning suppression, see #4404)</span><span>
</span><span id="line-1072"></span><span>              </span><span id="local-6989586621681131787"><span class="annot"><span class="annottext">rec_uses :: [(SrcSpan, [Name])]
</span><a href="#local-6989586621681131787"><span class="hs-identifier hs-var hs-var">rec_uses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LStmtLR GhcRn GhcPs (Located (body GhcPs))] -&gt; [(SrcSpan, [Name])]
forall (idR :: Pass) (body :: * -&gt; *).
[LStmtLR GhcRn (GhcPass idR) (Located (body (GhcPass idR)))]
-&gt; [(SrcSpan, [Name])]
</span><a href="GHC.Hs.Utils.html#lStmtsImplicits"><span class="hs-identifier hs-var">lStmtsImplicits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
 -&gt; LStmtLR GhcRn GhcPs (Located (body GhcPs)))
-&gt; [(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
-&gt; [LStmtLR GhcRn GhcPs (Located (body GhcPs))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
-&gt; LStmtLR GhcRn GhcPs (Located (body GhcPs))
forall a b. (a, b) -&gt; a
</span><a href="../../base/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
</span><a href="#local-6989586621681131791"><span class="hs-identifier hs-var">new_lhs_and_fv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1073"></span><span>              </span><span id="local-6989586621681131785"><span class="annot"><span class="annottext">implicit_uses :: FreeVars
</span><a href="#local-6989586621681131785"><span class="hs-identifier hs-var hs-var">implicit_uses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; FreeVars) -&gt; [Name] -&gt; FreeVars
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((SrcSpan, [Name]) -&gt; [Name]) -&gt; [(SrcSpan, [Name])] -&gt; [Name]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">(SrcSpan, [Name]) -&gt; [Name]
forall a b. (a, b) -&gt; b
</span><a href="../../base/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">([(SrcSpan, [Name])] -&gt; [Name]) -&gt; [(SrcSpan, [Name])] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(SrcSpan, [Name])]
</span><a href="#local-6989586621681131787"><span class="hs-identifier hs-var">rec_uses</span></a></span><span>
</span><span id="line-1074"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (a, FreeVars) -&gt; RnM (a, FreeVars)
forall a. [Name] -&gt; RnM (a, FreeVars) -&gt; RnM (a, FreeVars)
</span><a href="GHC.Rename.Utils.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
[IdP GhcRn]
</span><a href="#local-6989586621681131789"><span class="hs-identifier hs-var">bound_names</span></a></span><span> </span><span class="annot"><span class="annottext">(RnM (a, FreeVars) -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars) -&gt; RnM (a, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1075"></span><span>          </span><span class="annot"><span class="annottext">MiniFixityEnv -&gt; [Name] -&gt; RnM (a, FreeVars) -&gt; RnM (a, FreeVars)
forall a. MiniFixityEnv -&gt; [Name] -&gt; RnM a -&gt; RnM a
</span><a href="GHC.Rename.Fixity.html#addLocalFixities"><span class="hs-identifier hs-var">addLocalFixities</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681131793"><span class="hs-identifier hs-var">fix_env</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
[IdP GhcRn]
</span><a href="#local-6989586621681131789"><span class="hs-identifier hs-var">bound_names</span></a></span><span> </span><span class="annot"><span class="annottext">(RnM (a, FreeVars) -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars) -&gt; RnM (a, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1076"></span><span>
</span><span id="line-1077"></span><span>          </span><span class="hs-comment">-- (C) do the right-hand-sides and thing-inside</span><span>
</span><span id="line-1078"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681131781"><span class="annot"><span class="annottext">[Segment (LStmt GhcRn (Located (body GhcRn)))]
</span><a href="#local-6989586621681131781"><span class="hs-identifier hs-var">segs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [Name]
-&gt; [(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
-&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [Name]
-&gt; [(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
-&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
</span><a href="GHC.Rename.Expr.html#rn_rec_stmts"><span class="hs-identifier hs-var">rn_rec_stmts</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131797"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681131796"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
[IdP GhcRn]
</span><a href="#local-6989586621681131789"><span class="hs-identifier hs-var">bound_names</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
</span><a href="#local-6989586621681131791"><span class="hs-identifier hs-var">new_lhs_and_fv</span></a></span><span>
</span><span id="line-1079"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131779"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131779"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131778"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131778"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn (Located (body GhcRn)))] -&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621681131794"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn (Located (body GhcRn)))]
</span><a href="#local-6989586621681131781"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-1080"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">((SrcSpan, [Name]) -&gt; IOEnv (Env TcGblEnv TcLclEnv) ())
-&gt; [(SrcSpan, [Name])] -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681131777"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131777"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131776"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131776"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpan
-&gt; FreeVars -&gt; Maybe [Name] -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Utils.html#checkUnusedRecordWildcard"><span class="hs-identifier hs-var">checkUnusedRecordWildcard</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131777"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131778"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; Maybe [Name]
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131776"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1081"></span><span>                </span><span class="annot"><span class="annottext">[(SrcSpan, [Name])]
</span><a href="#local-6989586621681131787"><span class="hs-identifier hs-var">rec_uses</span></a></span><span>
</span><span id="line-1082"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Utils.html#warnUnusedLocalBinds"><span class="hs-identifier hs-var">warnUnusedLocalBinds</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
[IdP GhcRn]
</span><a href="#local-6989586621681131789"><span class="hs-identifier hs-var">bound_names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131778"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unionNameSet"><span class="hs-operator hs-var">`unionNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131785"><span class="hs-identifier hs-var">implicit_uses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1083"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, FreeVars) -&gt; RnM (a, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131779"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131778"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-1084"></span><span>
</span><span id="line-1085"></span><span class="hs-comment">-- get all the fixity decls in any Let stmt</span><span>
</span><span id="line-1086"></span><span id="local-6989586621681133400"><span class="annot"><a href="GHC.Rename.Expr.html#collectRecStmtsFixities"><span class="hs-identifier hs-type">collectRecStmtsFixities</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133400"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Binds.html#LFixitySig"><span class="hs-identifier hs-type">LFixitySig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1087"></span><span id="collectRecStmtsFixities"><span class="annot"><span class="annottext">collectRecStmtsFixities :: forall body. [LStmtLR GhcPs GhcPs body] -&gt; [LFixitySig GhcPs]
</span><a href="GHC.Rename.Expr.html#collectRecStmtsFixities"><span class="hs-identifier hs-var hs-var">collectRecStmtsFixities</span></a></span></span><span> </span><span id="local-6989586621681131773"><span class="annot"><span class="annottext">[LStmtLR GhcPs GhcPs body]
</span><a href="#local-6989586621681131773"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1088"></span><span>    </span><span class="annot"><span class="annottext">(LStmtLR GhcPs GhcPs body
 -&gt; [LFixitySig GhcPs] -&gt; [LFixitySig GhcPs])
-&gt; [LFixitySig GhcPs]
-&gt; [LStmtLR GhcPs GhcPs body]
-&gt; [LFixitySig GhcPs]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681131772"><span class="annot"><span class="annottext">LStmtLR GhcPs GhcPs body
</span><a href="#local-6989586621681131772"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681131771"><span class="annot"><span class="annottext">[LFixitySig GhcPs]
</span><a href="#local-6989586621681131771"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LStmtLR GhcPs GhcPs body
</span><a href="#local-6989586621681131772"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1089"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLetStmt GhcPs GhcPs body
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XHsValBinds GhcPs GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#ValBinds"><span class="hs-identifier hs-type">ValBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XValBinds GhcPs GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsBindsLR GhcPs GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131768"><span class="annot"><span class="annottext">[LSig GhcPs]
</span><a href="#local-6989586621681131768"><span class="hs-identifier hs-var">sigs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1090"></span><span>              </span><span class="annot"><span class="annottext">(LSig GhcPs -&gt; [LFixitySig GhcPs] -&gt; [LFixitySig GhcPs])
-&gt; [LFixitySig GhcPs] -&gt; [LSig GhcPs] -&gt; [LFixitySig GhcPs]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681131767"><span class="annot"><span class="annottext">LSig GhcPs
</span><a href="#local-6989586621681131767"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681131766"><span class="annot"><span class="annottext">[LFixitySig GhcPs]
</span><a href="#local-6989586621681131766"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LSig GhcPs
</span><a href="#local-6989586621681131767"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1091"></span><span>                                         </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131765"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131765"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#FixSig"><span class="hs-identifier hs-type">FixSig</span></a></span><span> </span><span class="annot"><span class="annottext">XFixSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131763"><span class="annot"><span class="annottext">FixitySig GhcPs
</span><a href="#local-6989586621681131763"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; FixitySig GhcPs -&gt; LFixitySig GhcPs
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131765"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">FixitySig GhcPs
</span><a href="#local-6989586621681131763"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LFixitySig GhcPs -&gt; [LFixitySig GhcPs] -&gt; [LFixitySig GhcPs]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[LFixitySig GhcPs]
</span><a href="#local-6989586621681131766"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1092"></span><span>                                         </span><span class="annot"><span class="annottext">LSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[LFixitySig GhcPs]
</span><a href="#local-6989586621681131766"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LFixitySig GhcPs]
</span><a href="#local-6989586621681131771"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[LSig GhcPs]
</span><a href="#local-6989586621681131768"><span class="hs-identifier hs-var">sigs</span></a></span><span>
</span><span id="line-1093"></span><span>            </span><span class="annot"><span class="annottext">LStmtLR GhcPs GhcPs body
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[LFixitySig GhcPs]
</span><a href="#local-6989586621681131771"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[LStmtLR GhcPs GhcPs body]
</span><a href="#local-6989586621681131773"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1094"></span><span>
</span><span id="line-1095"></span><span class="hs-comment">-- left-hand sides</span><span>
</span><span id="line-1096"></span><span>
</span><span id="line-1097"></span><span id="local-6989586621681133377"><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt_lhs"><span class="hs-identifier hs-type">rn_rec_stmt_lhs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133377"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Fixity.html#MiniFixityEnv"><span class="hs-identifier hs-type">MiniFixityEnv</span></a></span><span>
</span><span id="line-1098"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133377"><span class="hs-identifier hs-type">body</span></a></span><span>
</span><span id="line-1099"></span><span>                   </span><span class="hs-comment">-- rename LHS, and return its FVs</span><span>
</span><span id="line-1100"></span><span>                   </span><span class="hs-comment">-- Warning: we will only need the FreeVars below in the case of a BindStmt,</span><span>
</span><span id="line-1101"></span><span>                   </span><span class="hs-comment">-- so we don't bother to compute it accurately in the other cases</span><span>
</span><span id="line-1102"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133377"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-1103"></span><span>
</span><span id="line-1104"></span><span id="rn_rec_stmt_lhs"><span class="annot"><span class="annottext">rn_rec_stmt_lhs :: forall body.
Outputable body =&gt;
MiniFixityEnv
-&gt; LStmt GhcPs body -&gt; RnM [(LStmtLR GhcRn GhcPs body, FreeVars)]
</span><a href="GHC.Rename.Expr.html#rn_rec_stmt_lhs"><span class="hs-identifier hs-var hs-var">rn_rec_stmt_lhs</span></a></span></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131737"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131737"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-type">BodyStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBodyStmt GhcPs GhcPs body
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131736"><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621681131736"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621681131735"><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><a href="#local-6989586621681131735"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681131734"><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><a href="#local-6989586621681131734"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1105"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcPs body
-&gt; GenLocated SrcSpan (StmtLR GhcRn GhcPs body)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131737"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XBodyStmt GhcRn GhcPs body
-&gt; body
-&gt; SyntaxExpr GhcPs
-&gt; SyntaxExpr GhcPs
-&gt; StmtLR GhcRn GhcPs body
forall idL idR body.
XBodyStmt idL idR body
-&gt; body -&gt; SyntaxExpr idR -&gt; SyntaxExpr idR -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XBodyStmt GhcRn GhcPs body
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621681131736"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><a href="#local-6989586621681131735"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><a href="#local-6989586621681131734"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1106"></span><span>
</span><span id="line-1107"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt_lhs"><span class="hs-identifier hs-var">rn_rec_stmt_lhs</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131733"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131733"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-type">LastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLastStmt GhcPs GhcPs body
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131732"><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621681131732"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621681131731"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621681131731"><span class="hs-identifier hs-var">noret</span></a></span></span><span> </span><span id="local-6989586621681131730"><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><a href="#local-6989586621681131730"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcPs body
-&gt; GenLocated SrcSpan (StmtLR GhcRn GhcPs body)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131733"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLastStmt GhcRn GhcPs body
-&gt; body
-&gt; Maybe Bool
-&gt; SyntaxExpr GhcPs
-&gt; StmtLR GhcRn GhcPs body
forall idL idR body.
XLastStmt idL idR body
-&gt; body -&gt; Maybe Bool -&gt; SyntaxExpr idR -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XLastStmt GhcRn GhcPs body
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621681131732"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621681131731"><span class="hs-identifier hs-var">noret</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><a href="#local-6989586621681131730"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1109"></span><span>
</span><span id="line-1110"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt_lhs"><span class="hs-identifier hs-var">rn_rec_stmt_lhs</span></a></span><span> </span><span id="local-6989586621681131729"><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681131729"><span class="hs-identifier hs-var">fix_env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131728"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131728"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBindStmt GhcPs GhcPs body
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131727"><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621681131727"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681131726"><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621681131726"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1111"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1112"></span><span>      </span><span class="hs-comment">-- should the ctxt be MDo instead?</span><span>
</span><span id="line-1113"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681131725"><span class="annot"><span class="annottext">Located (Pat GhcRn)
</span><a href="#local-6989586621681131725"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131724"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131724"><span class="hs-identifier hs-var">fv_pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameMaker -&gt; LPat GhcPs -&gt; RnM (LPat GhcRn, FreeVars)
</span><a href="GHC.Rename.Pat.html#rnBindPat"><span class="hs-identifier hs-var">rnBindPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MiniFixityEnv -&gt; NameMaker
</span><a href="GHC.Rename.Pat.html#localRecNameMaker"><span class="hs-identifier hs-var">localRecNameMaker</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681131729"><span class="hs-identifier hs-var">fix_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621681131727"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1114"></span><span>      </span><span class="annot"><span class="annottext">[(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcPs body
-&gt; GenLocated SrcSpan (StmtLR GhcRn GhcPs body)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131728"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XBindStmt GhcRn GhcPs body
-&gt; LPat GhcRn -&gt; body -&gt; StmtLR GhcRn GhcPs body
forall idL idR body.
XBindStmt idL idR body -&gt; LPat idL -&gt; body -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XBindStmt GhcRn GhcPs body
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Pat GhcRn)
LPat GhcRn
</span><a href="#local-6989586621681131725"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621681131726"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131724"><span class="hs-identifier hs-var">fv_pat</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1115"></span><span>
</span><span id="line-1116"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt_lhs"><span class="hs-identifier hs-var">rn_rec_stmt_lhs</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLetStmt GhcPs GhcPs body
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131721"><span class="annot"><span class="annottext">binds :: HsLocalBinds GhcPs
</span><a href="#local-6989586621681131721"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#HsIPBinds"><span class="hs-identifier hs-type">HsIPBinds</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1117"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MsgDoc
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
forall a. MsgDoc -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#failWith"><span class="hs-identifier hs-var">failWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MsgDoc -&gt; HsLocalBinds GhcPs -&gt; MsgDoc
forall a. Outputable a =&gt; MsgDoc -&gt; a -&gt; MsgDoc
</span><a href="GHC.Rename.Expr.html#badIpBinds"><span class="hs-identifier hs-var">badIpBinds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;an mdo expression&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcPs
</span><a href="#local-6989586621681131721"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1118"></span><span>
</span><span id="line-1119"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt_lhs"><span class="hs-identifier hs-var">rn_rec_stmt_lhs</span></a></span><span> </span><span id="local-6989586621681131717"><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681131717"><span class="hs-identifier hs-var">fix_env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131716"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131716"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLetStmt GhcPs GhcPs body
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131715"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131715"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a></span><span> </span><span id="local-6989586621681131714"><span class="annot"><span class="annottext">XHsValBinds GhcPs GhcPs
</span><a href="#local-6989586621681131714"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681131713"><span class="annot"><span class="annottext">HsValBindsLR GhcPs GhcPs
</span><a href="#local-6989586621681131713"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1120"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131712"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131712"><span class="hs-identifier hs-var">_bound_names</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131711"><span class="annot"><span class="annottext">HsValBindsLR GhcRn GhcPs
</span><a href="#local-6989586621681131711"><span class="hs-identifier hs-var">binds'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
-&gt; HsValBindsLR GhcPs GhcPs
-&gt; RnM ([Name], HsValBindsLR GhcRn GhcPs)
</span><a href="GHC.Rename.Bind.html#rnLocalValBindsLHS"><span class="hs-identifier hs-var">rnLocalValBindsLHS</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681131717"><span class="hs-identifier hs-var">fix_env</span></a></span><span> </span><span class="annot"><span class="annottext">HsValBindsLR GhcPs GhcPs
</span><a href="#local-6989586621681131713"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-1121"></span><span>         </span><span class="annot"><span class="annottext">[(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcPs body
-&gt; GenLocated SrcSpan (StmtLR GhcRn GhcPs body)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131716"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLetStmt GhcRn GhcPs body
-&gt; LHsLocalBindsLR GhcRn GhcPs -&gt; StmtLR GhcRn GhcPs body
forall idL idR body.
XLetStmt idL idR body
-&gt; LHsLocalBindsLR idL idR -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XLetStmt GhcRn GhcPs body
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
-&gt; HsLocalBindsLR GhcRn GhcPs -&gt; LHsLocalBindsLR GhcRn GhcPs
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131715"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XHsValBinds GhcRn GhcPs
-&gt; HsValBindsLR GhcRn GhcPs -&gt; HsLocalBindsLR GhcRn GhcPs
forall idL idR.
XHsValBinds idL idR
-&gt; HsValBindsLR idL idR -&gt; HsLocalBindsLR idL idR
</span><a href="GHC.Hs.Binds.html#HsValBinds"><span class="hs-identifier hs-var">HsValBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XHsValBinds GhcPs GhcPs
XHsValBinds GhcRn GhcPs
</span><a href="#local-6989586621681131714"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">HsValBindsLR GhcRn GhcPs
</span><a href="#local-6989586621681131711"><span class="hs-identifier hs-var">binds'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1122"></span><span>                 </span><span class="hs-comment">-- Warning: this is bogus; see function invariant</span><span>
</span><span id="line-1123"></span><span>                 </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span>
</span><span id="line-1124"></span><span>                 </span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1125"></span><span>
</span><span id="line-1126"></span><span class="hs-comment">-- XXX Do we need to do something with the return and mfix names?</span><span>
</span><span id="line-1127"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt_lhs"><span class="hs-identifier hs-var">rn_rec_stmt_lhs</span></a></span><span> </span><span id="local-6989586621681131710"><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681131710"><span class="hs-identifier hs-var">fix_env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#RecStmt"><span class="hs-identifier hs-type">RecStmt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recS_stmts :: forall idL idR body. StmtLR idL idR body -&gt; [LStmtLR idL idR body]
</span><a href="GHC.Hs.Expr.html#recS_stmts"><span class="hs-identifier hs-var">recS_stmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681131709"><span class="annot"><span class="annottext">[LStmt GhcPs body]
</span><a href="#local-6989586621681131709"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Flatten Rec inside Rec</span><span>
</span><span id="line-1128"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
-&gt; [LStmt GhcPs body]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
forall body.
Outputable body =&gt;
MiniFixityEnv
-&gt; [LStmt GhcPs body] -&gt; RnM [(LStmtLR GhcRn GhcPs body, FreeVars)]
</span><a href="GHC.Rename.Expr.html#rn_rec_stmts_lhs"><span class="hs-identifier hs-var">rn_rec_stmts_lhs</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681131710"><span class="hs-identifier hs-var">fix_env</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcPs body]
</span><a href="#local-6989586621681131709"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-1129"></span><span>
</span><span id="line-1130"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt_lhs"><span class="hs-identifier hs-var">rn_rec_stmt_lhs</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131708"><span class="annot"><span class="annottext">stmt :: LStmt GhcPs body
</span><a href="#local-6989586621681131708"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmt"><span class="hs-identifier hs-type">ParStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- Syntactically illegal in mdo</span><span>
</span><span id="line-1131"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; MsgDoc
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
forall a. HasCallStack =&gt; String -&gt; MsgDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rn_rec_stmt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LStmt GhcPs body -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs body
</span><a href="#local-6989586621681131708"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1132"></span><span>
</span><span id="line-1133"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt_lhs"><span class="hs-identifier hs-var">rn_rec_stmt_lhs</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131707"><span class="annot"><span class="annottext">stmt :: LStmt GhcPs body
</span><a href="#local-6989586621681131707"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#TransStmt"><span class="hs-identifier hs-type">TransStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- Syntactically illegal in mdo</span><span>
</span><span id="line-1134"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; MsgDoc
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
forall a. HasCallStack =&gt; String -&gt; MsgDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rn_rec_stmt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LStmt GhcPs body -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs body
</span><a href="#local-6989586621681131707"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1135"></span><span>
</span><span id="line-1136"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt_lhs"><span class="hs-identifier hs-var">rn_rec_stmt_lhs</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131706"><span class="annot"><span class="annottext">stmt :: LStmt GhcPs body
</span><a href="#local-6989586621681131706"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeStmt"><span class="hs-identifier hs-type">ApplicativeStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Shouldn't appear yet</span><span>
</span><span id="line-1137"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; MsgDoc
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
forall a. HasCallStack =&gt; String -&gt; MsgDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rn_rec_stmt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LStmt GhcPs body -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs body
</span><a href="#local-6989586621681131706"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1138"></span><span>
</span><span id="line-1139"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt_lhs"><span class="hs-identifier hs-var">rn_rec_stmt_lhs</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLetStmt GhcPs GhcPs body
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#EmptyLocalBinds"><span class="hs-identifier hs-type">EmptyLocalBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XEmptyLocalBinds GhcPs GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1140"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpan (StmtLR GhcRn GhcPs body), FreeVars)]
forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rn_rec_stmt LetStmt EmptyLocalBinds&quot;</span></span><span>
</span><span id="line-1141"></span><span>
</span><span id="line-1142"></span><span id="local-6989586621681133399"><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmts_lhs"><span class="hs-identifier hs-type">rn_rec_stmts_lhs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133399"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Fixity.html#MiniFixityEnv"><span class="hs-identifier hs-type">MiniFixityEnv</span></a></span><span>
</span><span id="line-1143"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133399"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1144"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133399"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-1145"></span><span id="rn_rec_stmts_lhs"><span class="annot"><span class="annottext">rn_rec_stmts_lhs :: forall body.
Outputable body =&gt;
MiniFixityEnv
-&gt; [LStmt GhcPs body] -&gt; RnM [(LStmtLR GhcRn GhcPs body, FreeVars)]
</span><a href="GHC.Rename.Expr.html#rn_rec_stmts_lhs"><span class="hs-identifier hs-var hs-var">rn_rec_stmts_lhs</span></a></span></span><span> </span><span id="local-6989586621681131697"><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681131697"><span class="hs-identifier hs-var">fix_env</span></a></span></span><span> </span><span id="local-6989586621681131696"><span class="annot"><span class="annottext">[LStmt GhcPs body]
</span><a href="#local-6989586621681131696"><span class="hs-identifier hs-var">stmts</span></a></span></span><span>
</span><span id="line-1146"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681131695"><span class="annot"><span class="annottext">[(LStmtLR GhcRn GhcPs body, FreeVars)]
</span><a href="#local-6989586621681131695"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LStmt GhcPs body -&gt; RnM [(LStmtLR GhcRn GhcPs body, FreeVars)])
-&gt; [LStmt GhcPs body] -&gt; RnM [(LStmtLR GhcRn GhcPs body, FreeVars)]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m [b]) -&gt; [a] -&gt; m [b]
</span><a href="GHC.Utils.Monad.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MiniFixityEnv
-&gt; LStmt GhcPs body -&gt; RnM [(LStmtLR GhcRn GhcPs body, FreeVars)]
forall body.
Outputable body =&gt;
MiniFixityEnv
-&gt; LStmt GhcPs body -&gt; RnM [(LStmtLR GhcRn GhcPs body, FreeVars)]
</span><a href="GHC.Rename.Expr.html#rn_rec_stmt_lhs"><span class="hs-identifier hs-var">rn_rec_stmt_lhs</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681131697"><span class="hs-identifier hs-var">fix_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LStmt GhcPs body]
</span><a href="#local-6989586621681131696"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-1147"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131693"><span class="annot"><span class="annottext">boundNames :: [IdP GhcRn]
</span><a href="#local-6989586621681131693"><span class="hs-identifier hs-var hs-var">boundNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LStmtLR GhcRn GhcPs body] -&gt; [IdP GhcRn]
forall (idL :: Pass) (idR :: Pass) body.
CollectPass (GhcPass idL) =&gt;
[LStmtLR (GhcPass idL) (GhcPass idR) body] -&gt; [IdP (GhcPass idL)]
</span><a href="GHC.Hs.Utils.html#collectLStmtsBinders"><span class="hs-identifier hs-var">collectLStmtsBinders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((LStmtLR GhcRn GhcPs body, FreeVars) -&gt; LStmtLR GhcRn GhcPs body)
-&gt; [(LStmtLR GhcRn GhcPs body, FreeVars)]
-&gt; [LStmtLR GhcRn GhcPs body]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(LStmtLR GhcRn GhcPs body, FreeVars) -&gt; LStmtLR GhcRn GhcPs body
forall a b. (a, b) -&gt; a
</span><a href="../../base/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmtLR GhcRn GhcPs body, FreeVars)]
</span><a href="#local-6989586621681131695"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1148"></span><span>            </span><span class="hs-comment">-- First do error checking: we need to check for dups here because we</span><span>
</span><span id="line-1149"></span><span>            </span><span class="hs-comment">-- don't bind all of the variables from the Stmt at once</span><span>
</span><span id="line-1150"></span><span>            </span><span class="hs-comment">-- with bindLocatedLocals.</span><span>
</span><span id="line-1151"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Utils.html#checkDupNames"><span class="hs-identifier hs-var">checkDupNames</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
[IdP GhcRn]
</span><a href="#local-6989586621681131693"><span class="hs-identifier hs-var">boundNames</span></a></span><span>
</span><span id="line-1152"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[(LStmtLR GhcRn GhcPs body, FreeVars)]
-&gt; RnM [(LStmtLR GhcRn GhcPs body, FreeVars)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmtLR GhcRn GhcPs body, FreeVars)]
</span><a href="#local-6989586621681131695"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1153"></span><span>
</span><span id="line-1154"></span><span>
</span><span id="line-1155"></span><span class="hs-comment">-- right-hand-sides</span><span>
</span><span id="line-1156"></span><span>
</span><span id="line-1157"></span><span id="local-6989586621681133362"><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt"><span class="hs-identifier hs-type">rn_rec_stmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133362"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1158"></span><span>               </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-1159"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133362"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133362"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1160"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1161"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133362"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1162"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-type">Segment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133362"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-1163"></span><span>        </span><span class="hs-comment">-- Rename a Stmt that is inside a RecStmt (or mdo)</span><span>
</span><span id="line-1164"></span><span>        </span><span class="hs-comment">-- Assumes all binders are already in scope</span><span>
</span><span id="line-1165"></span><span>        </span><span class="hs-comment">-- Turns each stmt into a singleton Stmt</span><span>
</span><span id="line-1166"></span><span id="rn_rec_stmt"><span class="annot"><span class="annottext">rn_rec_stmt :: forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [Name]
-&gt; (LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
-&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
</span><a href="GHC.Rename.Expr.html#rn_rec_stmt"><span class="hs-identifier hs-var hs-var">rn_rec_stmt</span></a></span></span><span> </span><span id="local-6989586621681131656"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131656"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131655"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681131655"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131654"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131654"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-type">LastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLastStmt GhcRn GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131653"><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681131653"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621681131652"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621681131652"><span class="hs-identifier hs-var">noret</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1167"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131651"><span class="annot"><span class="annottext">Located (body GhcRn)
</span><a href="#local-6989586621681131651"><span class="hs-identifier hs-var">body'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131650"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131650"><span class="hs-identifier hs-var">fv_expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681131655"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681131653"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-1168"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131649"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131649"><span class="hs-identifier hs-var">ret_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131648"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131648"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
forall p.
HsStmtContext p -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupQualifiedDo"><span class="hs-identifier hs-var">lookupQualifiedDo</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131656"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#returnMName"><span class="hs-identifier hs-var">returnMName</span></a></span><span>
</span><span id="line-1169"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn (Located (body GhcRn)))]
-&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131650"><span class="hs-identifier hs-var">fv_expr</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131648"><span class="hs-identifier hs-var">fvs1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1170"></span><span>                   </span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
-&gt; LStmt GhcRn (Located (body GhcRn))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131654"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLastStmt GhcRn GhcRn (Located (body GhcRn))
-&gt; Located (body GhcRn)
-&gt; Maybe Bool
-&gt; SyntaxExpr GhcRn
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
forall idL idR body.
XLastStmt idL idR body
-&gt; body -&gt; Maybe Bool -&gt; SyntaxExpr idR -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XLastStmt GhcRn GhcRn (Located (body GhcRn))
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcRn)
</span><a href="#local-6989586621681131651"><span class="hs-identifier hs-var">body'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621681131652"><span class="hs-identifier hs-var">noret</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681131649"><span class="hs-identifier hs-var">ret_op</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1171"></span><span>
</span><span id="line-1172"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt"><span class="hs-identifier hs-var">rn_rec_stmt</span></a></span><span> </span><span id="local-6989586621681131646"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131646"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131645"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681131645"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131644"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131644"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-type">BodyStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBodyStmt GhcRn GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131643"><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681131643"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1173"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131642"><span class="annot"><span class="annottext">Located (body GhcRn)
</span><a href="#local-6989586621681131642"><span class="hs-identifier hs-var">body'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131641"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131641"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681131645"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681131643"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-1174"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131640"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131640"><span class="hs-identifier hs-var">then_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131639"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131639"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
forall p.
HsStmtContext p -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupQualifiedDo"><span class="hs-identifier hs-var">lookupQualifiedDo</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131646"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#thenMName"><span class="hs-identifier hs-var">thenMName</span></a></span><span>
</span><span id="line-1175"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn (Located (body GhcRn)))]
-&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131641"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131639"><span class="hs-identifier hs-var">fvs1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1176"></span><span>                 </span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
-&gt; LStmt GhcRn (Located (body GhcRn))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131644"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XBodyStmt GhcRn GhcRn (Located (body GhcRn))
-&gt; Located (body GhcRn)
-&gt; SyntaxExpr GhcRn
-&gt; SyntaxExpr GhcRn
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
forall idL idR body.
XBodyStmt idL idR body
-&gt; body -&gt; SyntaxExpr idR -&gt; SyntaxExpr idR -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XBodyStmt GhcRn GhcRn (Located (body GhcRn))
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcRn)
</span><a href="#local-6989586621681131642"><span class="hs-identifier hs-var">body'</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681131640"><span class="hs-identifier hs-var">then_op</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
forall (p :: Pass). IsPass p =&gt; SyntaxExpr (GhcPass p)
</span><a href="GHC.Hs.Expr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1177"></span><span>
</span><span id="line-1178"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt"><span class="hs-identifier hs-var">rn_rec_stmt</span></a></span><span> </span><span id="local-6989586621681131638"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131638"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131637"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681131637"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131636"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131636"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBindStmt GhcRn GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131635"><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131635"><span class="hs-identifier hs-var">pat'</span></a></span></span><span> </span><span id="local-6989586621681131634"><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681131634"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131633"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131633"><span class="hs-identifier hs-var">fv_pat</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1179"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131632"><span class="annot"><span class="annottext">Located (body GhcRn)
</span><a href="#local-6989586621681131632"><span class="hs-identifier hs-var">body'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131631"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131631"><span class="hs-identifier hs-var">fv_expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681131637"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681131634"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-1180"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131630"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131630"><span class="hs-identifier hs-var">bind_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131629"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131629"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
forall p.
HsStmtContext p -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupQualifiedDo"><span class="hs-identifier hs-var">lookupQualifiedDo</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131638"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#bindMName"><span class="hs-identifier hs-var">bindMName</span></a></span><span>
</span><span id="line-1181"></span><span>
</span><span id="line-1182"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131628"><span class="annot"><span class="annottext">Maybe SyntaxExprRn
</span><a href="#local-6989586621681131628"><span class="hs-identifier hs-var">fail_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131627"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131627"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; RnM (Maybe (SyntaxExpr GhcRn), FreeVars)
forall p.
HsStmtContext p -&gt; RnM (Maybe (SyntaxExpr GhcRn), FreeVars)
</span><a href="GHC.Rename.Expr.html#getMonadFailOp"><span class="hs-identifier hs-var">getMonadFailOp</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131638"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1183"></span><span>
</span><span id="line-1184"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131625"><span class="annot"><span class="annottext">bndrs :: FreeVars
</span><a href="#local-6989586621681131625"><span class="hs-identifier hs-var hs-var">bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LPat GhcRn -&gt; [IdP GhcRn]
forall p. CollectPass p =&gt; LPat p -&gt; [IdP p]
</span><a href="GHC.Hs.Utils.html#collectPatBinders"><span class="hs-identifier hs-var">collectPatBinders</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131635"><span class="hs-identifier hs-var">pat'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1185"></span><span>             </span><span id="local-6989586621681131624"><span class="annot"><span class="annottext">fvs :: FreeVars
</span><a href="#local-6989586621681131624"><span class="hs-identifier hs-var hs-var">fvs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131631"><span class="hs-identifier hs-var">fv_expr</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131633"><span class="hs-identifier hs-var">fv_pat</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131629"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131627"><span class="hs-identifier hs-var">fvs2</span></a></span><span>
</span><span id="line-1186"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131623"><span class="annot"><span class="annottext">xbsrn :: XBindStmtRn
</span><a href="#local-6989586621681131623"><span class="hs-identifier hs-var hs-var">xbsrn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XBindStmtRn :: SyntaxExpr GhcRn -&gt; Maybe (SyntaxExpr GhcRn) -&gt; XBindStmtRn
</span><a href="GHC.Hs.Expr.html#XBindStmtRn"><span class="hs-identifier hs-type">XBindStmtRn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">xbsrn_bindOp :: SyntaxExpr GhcRn
</span><a href="GHC.Hs.Expr.html#xbsrn_bindOp"><span class="hs-identifier hs-var">xbsrn_bindOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681131630"><span class="hs-identifier hs-var">bind_op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">xbsrn_failOp :: Maybe (SyntaxExpr GhcRn)
</span><a href="GHC.Hs.Expr.html#xbsrn_failOp"><span class="hs-identifier hs-var">xbsrn_failOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcRn)
Maybe SyntaxExprRn
</span><a href="#local-6989586621681131628"><span class="hs-identifier hs-var">fail_op</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1187"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn (Located (body GhcRn)))]
-&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131625"><span class="hs-identifier hs-var">bndrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131624"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131625"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#intersectNameSet"><span class="hs-operator hs-var">`intersectNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131624"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1188"></span><span>                  </span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
-&gt; LStmt GhcRn (Located (body GhcRn))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131636"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XBindStmt GhcRn GhcRn (Located (body GhcRn))
-&gt; LPat GhcRn
-&gt; Located (body GhcRn)
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
forall idL idR body.
XBindStmt idL idR body -&gt; LPat idL -&gt; body -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBindStmt GhcRn GhcRn (Located (body GhcRn))
XBindStmtRn
</span><a href="#local-6989586621681131623"><span class="hs-identifier hs-var">xbsrn</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131635"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcRn)
</span><a href="#local-6989586621681131632"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1189"></span><span>
</span><span id="line-1190"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt"><span class="hs-identifier hs-var">rn_rec_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLetStmt GhcRn GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131621"><span class="annot"><span class="annottext">binds :: HsLocalBindsLR GhcRn GhcPs
</span><a href="#local-6989586621681131621"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#HsIPBinds"><span class="hs-identifier hs-type">HsIPBinds</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1191"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall a. MsgDoc -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#failWith"><span class="hs-identifier hs-var">failWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MsgDoc -&gt; HsLocalBindsLR GhcRn GhcPs -&gt; MsgDoc
forall a. Outputable a =&gt; MsgDoc -&gt; a -&gt; MsgDoc
</span><a href="GHC.Rename.Expr.html#badIpBinds"><span class="hs-identifier hs-var">badIpBinds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;an mdo expression&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsLocalBindsLR GhcRn GhcPs
</span><a href="#local-6989586621681131621"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1192"></span><span>
</span><span id="line-1193"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt"><span class="hs-identifier hs-var">rn_rec_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131620"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131620"><span class="hs-identifier hs-var">all_bndrs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131619"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131619"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLetStmt GhcRn GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131618"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131618"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a></span><span> </span><span id="local-6989586621681131617"><span class="annot"><span class="annottext">XHsValBinds GhcRn GhcPs
</span><a href="#local-6989586621681131617"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681131616"><span class="annot"><span class="annottext">HsValBindsLR GhcRn GhcPs
</span><a href="#local-6989586621681131616"><span class="hs-identifier hs-var">binds'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1194"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131615"><span class="annot"><span class="annottext">HsValBinds GhcRn
</span><a href="#local-6989586621681131615"><span class="hs-identifier hs-var">binds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131614"><span class="annot"><span class="annottext">DefUses
</span><a href="#local-6989586621681131614"><span class="hs-identifier hs-var">du_binds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FreeVars
-&gt; HsValBindsLR GhcRn GhcPs -&gt; RnM (HsValBinds GhcRn, DefUses)
</span><a href="GHC.Rename.Bind.html#rnLocalValBindsRHS"><span class="hs-identifier hs-var">rnLocalValBindsRHS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131620"><span class="hs-identifier hs-var">all_bndrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsValBindsLR GhcRn GhcPs
</span><a href="#local-6989586621681131616"><span class="hs-identifier hs-var">binds'</span></a></span><span>
</span><span id="line-1195"></span><span>           </span><span class="hs-comment">-- fixities and unused are handled above in rnRecStmtsAndThen</span><span>
</span><span id="line-1196"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131613"><span class="annot"><span class="annottext">fvs :: FreeVars
</span><a href="#local-6989586621681131613"><span class="hs-identifier hs-var hs-var">fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefUses -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#allUses"><span class="hs-identifier hs-var">allUses</span></a></span><span> </span><span class="annot"><span class="annottext">DefUses
</span><a href="#local-6989586621681131614"><span class="hs-identifier hs-var">du_binds</span></a></span><span>
</span><span id="line-1197"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn (Located (body GhcRn)))]
-&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefUses -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#duDefs"><span class="hs-identifier hs-var">duDefs</span></a></span><span> </span><span class="annot"><span class="annottext">DefUses
</span><a href="#local-6989586621681131614"><span class="hs-identifier hs-var">du_binds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131613"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1198"></span><span>                 </span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
-&gt; LStmt GhcRn (Located (body GhcRn))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131619"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLetStmt GhcRn GhcRn (Located (body GhcRn))
-&gt; LHsLocalBinds GhcRn -&gt; StmtLR GhcRn GhcRn (Located (body GhcRn))
forall idL idR body.
XLetStmt idL idR body
-&gt; LHsLocalBindsLR idL idR -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XLetStmt GhcRn GhcRn (Located (body GhcRn))
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; HsLocalBinds GhcRn -&gt; LHsLocalBinds GhcRn
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131618"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XHsValBinds GhcRn GhcRn -&gt; HsValBinds GhcRn -&gt; HsLocalBinds GhcRn
forall idL idR.
XHsValBinds idL idR
-&gt; HsValBindsLR idL idR -&gt; HsLocalBindsLR idL idR
</span><a href="GHC.Hs.Binds.html#HsValBinds"><span class="hs-identifier hs-var">HsValBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XHsValBinds GhcRn GhcPs
XHsValBinds GhcRn GhcRn
</span><a href="#local-6989586621681131617"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">HsValBinds GhcRn
</span><a href="#local-6989586621681131615"><span class="hs-identifier hs-var">binds'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1199"></span><span>
</span><span id="line-1200"></span><span class="hs-comment">-- no RecStmt case because they get flattened above when doing the LHSes</span><span>
</span><span id="line-1201"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt"><span class="hs-identifier hs-var">rn_rec_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131610"><span class="annot"><span class="annottext">stmt :: (LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
</span><a href="#local-6989586621681131610"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#RecStmt"><span class="hs-identifier hs-type">RecStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1202"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; MsgDoc -&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall a. HasCallStack =&gt; String -&gt; MsgDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rn_rec_stmt: RecStmt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars) -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
</span><a href="#local-6989586621681131610"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1203"></span><span>
</span><span id="line-1204"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt"><span class="hs-identifier hs-var">rn_rec_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131609"><span class="annot"><span class="annottext">stmt :: (LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
</span><a href="#local-6989586621681131609"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmt"><span class="hs-identifier hs-type">ParStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- Syntactically illegal in mdo</span><span>
</span><span id="line-1205"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; MsgDoc -&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall a. HasCallStack =&gt; String -&gt; MsgDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rn_rec_stmt: ParStmt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars) -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
</span><a href="#local-6989586621681131609"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1206"></span><span>
</span><span id="line-1207"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt"><span class="hs-identifier hs-var">rn_rec_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131608"><span class="annot"><span class="annottext">stmt :: (LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
</span><a href="#local-6989586621681131608"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#TransStmt"><span class="hs-identifier hs-type">TransStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- Syntactically illegal in mdo</span><span>
</span><span id="line-1208"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; MsgDoc -&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall a. HasCallStack =&gt; String -&gt; MsgDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rn_rec_stmt: TransStmt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars) -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
</span><a href="#local-6989586621681131608"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1209"></span><span>
</span><span id="line-1210"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt"><span class="hs-identifier hs-var">rn_rec_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLetStmt GhcRn GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#EmptyLocalBinds"><span class="hs-identifier hs-type">EmptyLocalBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XEmptyLocalBinds GhcRn GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1211"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rn_rec_stmt: LetStmt EmptyLocalBinds&quot;</span></span><span>
</span><span id="line-1212"></span><span>
</span><span id="line-1213"></span><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmt"><span class="hs-identifier hs-var">rn_rec_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131607"><span class="annot"><span class="annottext">stmt :: (LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
</span><a href="#local-6989586621681131607"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeStmt"><span class="hs-identifier hs-type">ApplicativeStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1214"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; MsgDoc -&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall a. HasCallStack =&gt; String -&gt; MsgDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rn_rec_stmt: ApplicativeStmt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars) -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
</span><a href="#local-6989586621681131607"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1215"></span><span>
</span><span id="line-1216"></span><span id="local-6989586621681133387"><span class="annot"><a href="GHC.Rename.Expr.html#rn_rec_stmts"><span class="hs-identifier hs-type">rn_rec_stmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133387"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1217"></span><span>                </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-1218"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133387"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133387"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1219"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1220"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133387"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1221"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-type">Segment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133387"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-1222"></span><span id="rn_rec_stmts"><span class="annot"><span class="annottext">rn_rec_stmts :: forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [Name]
-&gt; [(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
-&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
</span><a href="GHC.Rename.Expr.html#rn_rec_stmts"><span class="hs-identifier hs-var hs-var">rn_rec_stmts</span></a></span></span><span> </span><span id="local-6989586621681131599"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131599"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131598"><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681131598"><span class="hs-identifier hs-var">rnBody</span></a></span></span><span> </span><span id="local-6989586621681131597"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131597"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span id="local-6989586621681131596"><span class="annot"><span class="annottext">[(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
</span><a href="#local-6989586621681131596"><span class="hs-identifier hs-var">stmts</span></a></span></span><span>
</span><span id="line-1223"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681131595"><span class="annot"><span class="annottext">[[Segment (LStmt GhcRn (Located (body GhcRn)))]]
</span><a href="#local-6989586621681131595"><span class="hs-identifier hs-var">segs_s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
 -&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))])
-&gt; [(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [[Segment (LStmt GhcRn (Located (body GhcRn)))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [Name]
-&gt; (LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
-&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; (Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars))
-&gt; [Name]
-&gt; (LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)
-&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
</span><a href="GHC.Rename.Expr.html#rn_rec_stmt"><span class="hs-identifier hs-var">rn_rec_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131599"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; RnM (Located (body GhcRn), FreeVars)
</span><a href="#local-6989586621681131598"><span class="hs-identifier hs-var">rnBody</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681131597"><span class="hs-identifier hs-var">bndrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(LStmtLR GhcRn GhcPs (Located (body GhcPs)), FreeVars)]
</span><a href="#local-6989586621681131596"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-1224"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn (Located (body GhcRn)))]
-&gt; RnM [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Segment (LStmt GhcRn (Located (body GhcRn)))]]
-&gt; [Segment (LStmt GhcRn (Located (body GhcRn)))]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[Segment (LStmt GhcRn (Located (body GhcRn)))]]
</span><a href="#local-6989586621681131595"><span class="hs-identifier hs-var">segs_s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1225"></span><span>
</span><span id="line-1226"></span><span class="hs-comment">---------------------------------------------</span><span>
</span><span id="line-1227"></span><span id="local-6989586621681133452"><span class="annot"><a href="GHC.Rename.Expr.html#segmentRecStmts"><span class="hs-identifier hs-type">segmentRecStmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-1228"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133452"><span class="hs-identifier hs-type">body</span></a></span><span>
</span><span id="line-1229"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-type">Segment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133452"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span>
</span><span id="line-1230"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133452"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1231"></span><span>
</span><span id="line-1232"></span><span id="segmentRecStmts"><span class="annot"><span class="annottext">segmentRecStmts :: forall body.
SrcSpan
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcRn body
-&gt; [Segment (LStmt GhcRn body)]
-&gt; FreeVars
-&gt; ([LStmt GhcRn body], FreeVars)
</span><a href="GHC.Rename.Expr.html#segmentRecStmts"><span class="hs-identifier hs-var hs-var">segmentRecStmts</span></a></span></span><span> </span><span id="local-6989586621681131591"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131591"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681131590"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131590"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131589"><span class="annot"><span class="annottext">Stmt GhcRn body
</span><a href="#local-6989586621681131589"><span class="hs-identifier hs-var">empty_rec_stmt</span></a></span></span><span> </span><span id="local-6989586621681131588"><span class="annot"><span class="annottext">[Segment (LStmt GhcRn body)]
</span><a href="#local-6989586621681131588"><span class="hs-identifier hs-var">segs</span></a></span></span><span> </span><span id="local-6989586621681131587"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131587"><span class="hs-identifier hs-var">fvs_later</span></a></span></span><span>
</span><span id="line-1233"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn body)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn body)]
</span><a href="#local-6989586621681131588"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-1234"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131587"><span class="hs-identifier hs-var">fvs_later</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1235"></span><span>
</span><span id="line-1236"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#MDoExpr"><span class="hs-identifier hs-type">MDoExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131590"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1237"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stmt GhcRn body
-&gt; [Segment [LStmt GhcRn body]]
-&gt; FreeVars
-&gt; ([LStmt GhcRn body], FreeVars)
forall body.
Stmt GhcRn body
-&gt; [Segment [LStmt GhcRn body]]
-&gt; FreeVars
-&gt; ([LStmt GhcRn body], FreeVars)
</span><a href="GHC.Rename.Expr.html#segsToStmts"><span class="hs-identifier hs-var">segsToStmts</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt GhcRn body
</span><a href="#local-6989586621681131589"><span class="hs-identifier hs-var">empty_rec_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment [LStmt GhcRn body]]
</span><a href="#local-6989586621681131585"><span class="hs-identifier hs-var">grouped_segs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131587"><span class="hs-identifier hs-var">fvs_later</span></a></span><span>
</span><span id="line-1238"></span><span>               </span><span class="hs-comment">-- Step 4: Turn the segments into Stmts</span><span>
</span><span id="line-1239"></span><span>                </span><span class="hs-comment">--         Use RecStmt when and only when there are fwd refs</span><span>
</span><span id="line-1240"></span><span>                </span><span class="hs-comment">--         Also gather up the uses from the end towards the</span><span>
</span><span id="line-1241"></span><span>                </span><span class="hs-comment">--         start, so we can tell the RecStmt which things are</span><span>
</span><span id="line-1242"></span><span>                </span><span class="hs-comment">--         used 'after' the RecStmt</span><span>
</span><span id="line-1243"></span><span>
</span><span id="line-1244"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1245"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; Stmt GhcRn body -&gt; LStmt GhcRn body
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131591"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(Stmt GhcRn body -&gt; LStmt GhcRn body)
-&gt; Stmt GhcRn body -&gt; LStmt GhcRn body
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1246"></span><span>       </span><span class="annot"><span class="annottext">Stmt GhcRn body
</span><a href="#local-6989586621681131589"><span class="hs-identifier hs-var">empty_rec_stmt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recS_stmts :: [LStmt GhcRn body]
</span><a href="GHC.Hs.Expr.html#recS_stmts"><span class="hs-identifier hs-var">recS_stmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn body]
</span><a href="#local-6989586621681131584"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-1247"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_later_ids :: [IdP GhcRn]
</span><a href="GHC.Hs.Expr.html#recS_later_ids"><span class="hs-identifier hs-var">recS_later_ids</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; [Name]
</span><a href="GHC.Types.Name.Set.html#nameSetElemsStable"><span class="hs-identifier hs-var">nameSetElemsStable</span></a></span><span>
</span><span id="line-1248"></span><span>                                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131582"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#intersectNameSet"><span class="hs-operator hs-var">`intersectNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131587"><span class="hs-identifier hs-var">fvs_later</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1249"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_rec_ids :: [IdP GhcRn]
</span><a href="GHC.Hs.Expr.html#recS_rec_ids"><span class="hs-identifier hs-var">recS_rec_ids</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; [Name]
</span><a href="GHC.Types.Name.Set.html#nameSetElemsStable"><span class="hs-identifier hs-var">nameSetElemsStable</span></a></span><span>
</span><span id="line-1250"></span><span>                                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131582"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#intersectNameSet"><span class="hs-operator hs-var">`intersectNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131580"><span class="hs-identifier hs-var">uses</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><span id="line-1251"></span><span>          </span><span class="hs-comment">-- See Note [Deterministic ApplicativeDo and RecursiveDo desugaring]</span><span>
</span><span id="line-1252"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131580"><span class="hs-identifier hs-var">uses</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131587"><span class="hs-identifier hs-var">fvs_later</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1253"></span><span>
</span><span id="line-1254"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1255"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681131579"><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681131579"><span class="hs-identifier hs-var">defs_s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131578"><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681131578"><span class="hs-identifier hs-var">uses_s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[FreeVars]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131584"><span class="annot"><span class="annottext">[LStmt GhcRn body]
</span><a href="#local-6989586621681131584"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn body)]
-&gt; ([FreeVars], [FreeVars], [FreeVars], [LStmt GhcRn body])
forall a b c d. [(a, b, c, d)] -&gt; ([a], [b], [c], [d])
</span><a href="../../base/src/Data.OldList.html#unzip4"><span class="hs-identifier hs-var">unzip4</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn body)]
</span><a href="#local-6989586621681131588"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-1256"></span><span>    </span><span id="local-6989586621681131582"><span class="annot"><span class="annottext">defs :: FreeVars
</span><a href="#local-6989586621681131582"><span class="hs-identifier hs-var hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681131579"><span class="hs-identifier hs-var">defs_s</span></a></span><span>
</span><span id="line-1257"></span><span>    </span><span id="local-6989586621681131580"><span class="annot"><span class="annottext">uses :: FreeVars
</span><a href="#local-6989586621681131580"><span class="hs-identifier hs-var hs-var">uses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681131578"><span class="hs-identifier hs-var">uses_s</span></a></span><span>
</span><span id="line-1258"></span><span>
</span><span id="line-1259"></span><span>                </span><span class="hs-comment">-- Step 2: Fill in the fwd refs.</span><span>
</span><span id="line-1260"></span><span>                </span><span class="hs-comment">--         The segments are all singletons, but their fwd-ref</span><span>
</span><span id="line-1261"></span><span>                </span><span class="hs-comment">--         field mentions all the things used by the segment</span><span>
</span><span id="line-1262"></span><span>                </span><span class="hs-comment">--         that are bound after their use</span><span>
</span><span id="line-1263"></span><span>    </span><span id="local-6989586621681131576"><span class="annot"><span class="annottext">segs_w_fwd_refs :: [Segment (LStmt GhcRn body)]
</span><a href="#local-6989586621681131576"><span class="hs-identifier hs-var hs-var">segs_w_fwd_refs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn body)] -&gt; [Segment (LStmt GhcRn body)]
forall a. [Segment a] -&gt; [Segment a]
</span><a href="GHC.Rename.Expr.html#addFwdRefs"><span class="hs-identifier hs-var">addFwdRefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn body)]
</span><a href="#local-6989586621681131588"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-1264"></span><span>
</span><span id="line-1265"></span><span>                </span><span class="hs-comment">-- Step 3: Group together the segments to make bigger segments</span><span>
</span><span id="line-1266"></span><span>                </span><span class="hs-comment">--         Invariant: in the result, no segment uses a variable</span><span>
</span><span id="line-1267"></span><span>                </span><span class="hs-comment">--                    bound in a later segment</span><span>
</span><span id="line-1268"></span><span>    </span><span id="local-6989586621681131585"><span class="annot"><span class="annottext">grouped_segs :: [Segment [LStmt GhcRn body]]
</span><a href="#local-6989586621681131585"><span class="hs-identifier hs-var hs-var">grouped_segs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; [Segment (LStmt GhcRn body)] -&gt; [Segment [LStmt GhcRn body]]
forall body.
HsStmtContext GhcRn
-&gt; [Segment (LStmt GhcRn body)] -&gt; [Segment [LStmt GhcRn body]]
</span><a href="GHC.Rename.Expr.html#glomSegments"><span class="hs-identifier hs-var">glomSegments</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131590"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn body)]
</span><a href="#local-6989586621681131576"><span class="hs-identifier hs-var">segs_w_fwd_refs</span></a></span><span>
</span><span id="line-1269"></span><span>
</span><span id="line-1270"></span><span class="hs-comment">----------------------------</span><span>
</span><span id="line-1271"></span><span id="local-6989586621681133343"><span class="annot"><a href="GHC.Rename.Expr.html#addFwdRefs"><span class="hs-identifier hs-type">addFwdRefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-type">Segment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133343"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-type">Segment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133343"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1272"></span><span class="hs-comment">-- So far the segments only have forward refs *within* the Stmt</span><span>
</span><span id="line-1273"></span><span class="hs-comment">--      (which happens for bind:  x &lt;- ...x...)</span><span>
</span><span id="line-1274"></span><span class="hs-comment">-- This function adds the cross-seg fwd ref info</span><span>
</span><span id="line-1275"></span><span>
</span><span id="line-1276"></span><span id="addFwdRefs"><span class="annot"><span class="annottext">addFwdRefs :: forall a. [Segment a] -&gt; [Segment a]
</span><a href="GHC.Rename.Expr.html#addFwdRefs"><span class="hs-identifier hs-var hs-var">addFwdRefs</span></a></span></span><span> </span><span id="local-6989586621681131572"><span class="annot"><span class="annottext">[Segment a]
</span><a href="#local-6989586621681131572"><span class="hs-identifier hs-var">segs</span></a></span></span><span>
</span><span id="line-1277"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Segment a], FreeVars) -&gt; [Segment a]
forall a b. (a, b) -&gt; a
</span><a href="../../base/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Segment a -&gt; ([Segment a], FreeVars) -&gt; ([Segment a], FreeVars))
-&gt; ([Segment a], FreeVars)
-&gt; [Segment a]
-&gt; ([Segment a], FreeVars)
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Segment a -&gt; ([Segment a], FreeVars) -&gt; ([Segment a], FreeVars)
forall {d}.
(FreeVars, FreeVars, FreeVars, d)
-&gt; ([(FreeVars, FreeVars, FreeVars, d)], FreeVars)
-&gt; ([(FreeVars, FreeVars, FreeVars, d)], FreeVars)
</span><a href="#local-6989586621681131571"><span class="hs-identifier hs-var">mk_seg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Segment a]
</span><a href="#local-6989586621681131572"><span class="hs-identifier hs-var">segs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1278"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1279"></span><span>    </span><span id="local-6989586621681131571"><span class="annot"><span class="annottext">mk_seg :: (FreeVars, FreeVars, FreeVars, d)
-&gt; ([(FreeVars, FreeVars, FreeVars, d)], FreeVars)
-&gt; ([(FreeVars, FreeVars, FreeVars, d)], FreeVars)
</span><a href="#local-6989586621681131571"><span class="hs-identifier hs-var hs-var">mk_seg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131570"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131570"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131569"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131569"><span class="hs-identifier hs-var">uses</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131568"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131568"><span class="hs-identifier hs-var">fwds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131567"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621681131567"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131566"><span class="annot"><span class="annottext">[(FreeVars, FreeVars, FreeVars, d)]
</span><a href="#local-6989586621681131566"><span class="hs-identifier hs-var">segs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131565"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131565"><span class="hs-identifier hs-var">later_defs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1280"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FreeVars, FreeVars, FreeVars, d)
</span><a href="#local-6989586621681131564"><span class="hs-identifier hs-var">new_seg</span></a></span><span> </span><span class="annot"><span class="annottext">(FreeVars, FreeVars, FreeVars, d)
-&gt; [(FreeVars, FreeVars, FreeVars, d)]
-&gt; [(FreeVars, FreeVars, FreeVars, d)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(FreeVars, FreeVars, FreeVars, d)]
</span><a href="#local-6989586621681131566"><span class="hs-identifier hs-var">segs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131563"><span class="hs-identifier hs-var">all_defs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1281"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1282"></span><span>          </span><span id="local-6989586621681131564"><span class="annot"><span class="annottext">new_seg :: (FreeVars, FreeVars, FreeVars, d)
</span><a href="#local-6989586621681131564"><span class="hs-identifier hs-var hs-var">new_seg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131570"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131569"><span class="hs-identifier hs-var">uses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131562"><span class="hs-identifier hs-var">new_fwds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621681131567"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1283"></span><span>          </span><span id="local-6989586621681131563"><span class="annot"><span class="annottext">all_defs :: FreeVars
</span><a href="#local-6989586621681131563"><span class="hs-identifier hs-var hs-var">all_defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131565"><span class="hs-identifier hs-var">later_defs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unionNameSet"><span class="hs-operator hs-var">`unionNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131570"><span class="hs-identifier hs-var">defs</span></a></span><span>
</span><span id="line-1284"></span><span>          </span><span id="local-6989586621681131562"><span class="annot"><span class="annottext">new_fwds :: FreeVars
</span><a href="#local-6989586621681131562"><span class="hs-identifier hs-var hs-var">new_fwds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131568"><span class="hs-identifier hs-var">fwds</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unionNameSet"><span class="hs-operator hs-var">`unionNameSet`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131569"><span class="hs-identifier hs-var">uses</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#intersectNameSet"><span class="hs-operator hs-var">`intersectNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131565"><span class="hs-identifier hs-var">later_defs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1285"></span><span>                </span><span class="hs-comment">-- Add the downstream fwd refs here</span><span>
</span><span id="line-1286"></span><span>
</span><span id="line-1287"></span><span class="hs-comment">{-
Note [Segmenting mdo]
~~~~~~~~~~~~~~~~~~~~~
NB. June 7 2012: We only glom segments that appear in an explicit mdo;
and leave those found in &quot;do rec&quot;'s intact.  See
https://gitlab.haskell.org/ghc/ghc/issues/4148 for the discussion
leading to this design choice.  Hence the test in segmentRecStmts.

Note [Glomming segments]
~~~~~~~~~~~~~~~~~~~~~~~~
Glomming the singleton segments of an mdo into minimal recursive groups.

At first I thought this was just strongly connected components, but
there's an important constraint: the order of the stmts must not change.

Consider
     mdo { x &lt;- ...y...
           p &lt;- z
           y &lt;- ...x...
           q &lt;- x
           z &lt;- y
           r &lt;- x }

Here, the first stmt mention 'y', which is bound in the third.
But that means that the innocent second stmt (p &lt;- z) gets caught
up in the recursion.  And that in turn means that the binding for
'z' has to be included... and so on.

Start at the tail { r &lt;- x }
Now add the next one { z &lt;- y ; r &lt;- x }
Now add one more     { q &lt;- x ; z &lt;- y ; r &lt;- x }
Now one more... but this time we have to group a bunch into rec
     { rec { y &lt;- ...x... ; q &lt;- x ; z &lt;- y } ; r &lt;- x }
Now one more, which we can add on without a rec
     { p &lt;- z ;
       rec { y &lt;- ...x... ; q &lt;- x ; z &lt;- y } ;
       r &lt;- x }
Finally we add the last one; since it mentions y we have to
glom it together with the first two groups
     { rec { x &lt;- ...y...; p &lt;- z ; y &lt;- ...x... ;
             q &lt;- x ; z &lt;- y } ;
       r &lt;- x }
-}</span><span>
</span><span id="line-1330"></span><span>
</span><span id="line-1331"></span><span id="local-6989586621681133342"><span class="annot"><a href="GHC.Rename.Expr.html#glomSegments"><span class="hs-identifier hs-type">glomSegments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-1332"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-type">Segment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133342"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1333"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-type">Segment</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133342"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-1334"></span><span>                                  </span><span class="hs-comment">-- Each segment has a non-empty list of Stmts</span><span>
</span><span id="line-1335"></span><span class="hs-comment">-- See Note [Glomming segments]</span><span>
</span><span id="line-1336"></span><span>
</span><span id="line-1337"></span><span id="glomSegments"><span class="annot"><span class="annottext">glomSegments :: forall body.
HsStmtContext GhcRn
-&gt; [Segment (LStmt GhcRn body)] -&gt; [Segment [LStmt GhcRn body]]
</span><a href="GHC.Rename.Expr.html#glomSegments"><span class="hs-identifier hs-var hs-var">glomSegments</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1338"></span><span class="annot"><a href="GHC.Rename.Expr.html#glomSegments"><span class="hs-identifier hs-var">glomSegments</span></a></span><span> </span><span id="local-6989586621681131560"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131560"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681131559"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131559"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131558"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131558"><span class="hs-identifier hs-var">uses</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131557"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131557"><span class="hs-identifier hs-var">fwds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131556"><span class="annot"><span class="annottext">LStmt GhcRn body
</span><a href="#local-6989586621681131556"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681131555"><span class="annot"><span class="annottext">[Segment (LStmt GhcRn body)]
</span><a href="#local-6989586621681131555"><span class="hs-identifier hs-var">segs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1339"></span><span>        </span><span class="hs-comment">-- Actually stmts will always be a singleton</span><span>
</span><span id="line-1340"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131554"><span class="hs-identifier hs-var">seg_defs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131553"><span class="hs-identifier hs-var">seg_uses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131552"><span class="hs-identifier hs-var">seg_fwds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn body]
</span><a href="#local-6989586621681131551"><span class="hs-identifier hs-var">seg_stmts</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Segment [LStmt GhcRn body]
-&gt; [Segment [LStmt GhcRn body]] -&gt; [Segment [LStmt GhcRn body]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Segment [LStmt GhcRn body]]
</span><a href="#local-6989586621681131550"><span class="hs-identifier hs-var">others</span></a></span><span>
</span><span id="line-1341"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1342"></span><span>    </span><span id="local-6989586621681131549"><span class="annot"><span class="annottext">segs' :: [Segment [LStmt GhcRn body]]
</span><a href="#local-6989586621681131549"><span class="hs-identifier hs-var hs-var">segs'</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; [Segment (LStmt GhcRn body)] -&gt; [Segment [LStmt GhcRn body]]
forall body.
HsStmtContext GhcRn
-&gt; [Segment (LStmt GhcRn body)] -&gt; [Segment [LStmt GhcRn body]]
</span><a href="GHC.Rename.Expr.html#glomSegments"><span class="hs-identifier hs-var">glomSegments</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131560"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment (LStmt GhcRn body)]
</span><a href="#local-6989586621681131555"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-1343"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681131548"><span class="annot"><span class="annottext">[Segment [LStmt GhcRn body]]
</span><a href="#local-6989586621681131548"><span class="hs-identifier hs-var">extras</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131550"><span class="annot"><span class="annottext">[Segment [LStmt GhcRn body]]
</span><a href="#local-6989586621681131550"><span class="hs-identifier hs-var">others</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
-&gt; [Segment [LStmt GhcRn body]]
-&gt; ([Segment [LStmt GhcRn body]], [Segment [LStmt GhcRn body]])
forall a. FreeVars -&gt; [Segment a] -&gt; ([Segment a], [Segment a])
</span><a href="#local-6989586621681131547"><span class="hs-identifier hs-var">grab</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131558"><span class="hs-identifier hs-var">uses</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment [LStmt GhcRn body]]
</span><a href="#local-6989586621681131549"><span class="hs-identifier hs-var">segs'</span></a></span><span>
</span><span id="line-1344"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681131546"><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681131546"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131545"><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681131545"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131544"><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681131544"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131543"><span class="annot"><span class="annottext">[[LStmt GhcRn body]]
</span><a href="#local-6989586621681131543"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Segment [LStmt GhcRn body]]
-&gt; ([FreeVars], [FreeVars], [FreeVars], [[LStmt GhcRn body]])
forall a b c d. [(a, b, c, d)] -&gt; ([a], [b], [c], [d])
</span><a href="../../base/src/Data.OldList.html#unzip4"><span class="hs-identifier hs-var">unzip4</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment [LStmt GhcRn body]]
</span><a href="#local-6989586621681131548"><span class="hs-identifier hs-var">extras</span></a></span><span>
</span><span id="line-1345"></span><span>
</span><span id="line-1346"></span><span>    </span><span id="local-6989586621681131554"><span class="annot"><span class="annottext">seg_defs :: FreeVars
</span><a href="#local-6989586621681131554"><span class="hs-identifier hs-var hs-var">seg_defs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681131546"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131559"><span class="hs-identifier hs-var">defs</span></a></span><span>
</span><span id="line-1347"></span><span>    </span><span id="local-6989586621681131553"><span class="annot"><span class="annottext">seg_uses :: FreeVars
</span><a href="#local-6989586621681131553"><span class="hs-identifier hs-var hs-var">seg_uses</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681131545"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131558"><span class="hs-identifier hs-var">uses</span></a></span><span>
</span><span id="line-1348"></span><span>    </span><span id="local-6989586621681131552"><span class="annot"><span class="annottext">seg_fwds :: FreeVars
</span><a href="#local-6989586621681131552"><span class="hs-identifier hs-var hs-var">seg_fwds</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681131544"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131557"><span class="hs-identifier hs-var">fwds</span></a></span><span>
</span><span id="line-1349"></span><span>    </span><span id="local-6989586621681131551"><span class="annot"><span class="annottext">seg_stmts :: [LStmt GhcRn body]
</span><a href="#local-6989586621681131551"><span class="hs-identifier hs-var hs-var">seg_stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LStmt GhcRn body
</span><a href="#local-6989586621681131556"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcRn body -&gt; [LStmt GhcRn body] -&gt; [LStmt GhcRn body]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[LStmt GhcRn body]] -&gt; [LStmt GhcRn body]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[LStmt GhcRn body]]
</span><a href="#local-6989586621681131543"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-1350"></span><span>
</span><span id="line-1351"></span><span>    </span><span id="local-6989586621681133338"><span class="annot"><a href="#local-6989586621681131547"><span class="hs-identifier hs-type">grab</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span>             </span><span class="hs-comment">-- The client</span><span>
</span><span id="line-1352"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-type">Segment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133338"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1353"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-type">Segment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133338"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- Needed by the 'client'</span><span>
</span><span id="line-1354"></span><span>             </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-type">Segment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133338"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>       </span><span class="hs-comment">-- Not needed by the client</span><span>
</span><span id="line-1355"></span><span>        </span><span class="hs-comment">-- The result is simply a split of the input</span><span>
</span><span id="line-1356"></span><span>    </span><span id="local-6989586621681131547"><span class="annot"><span class="annottext">grab :: forall a. FreeVars -&gt; [Segment a] -&gt; ([Segment a], [Segment a])
</span><a href="#local-6989586621681131547"><span class="hs-identifier hs-var hs-var">grab</span></a></span></span><span> </span><span id="local-6989586621681131542"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131542"><span class="hs-identifier hs-var">uses</span></a></span></span><span> </span><span id="local-6989586621681131541"><span class="annot"><span class="annottext">[Segment a]
</span><a href="#local-6989586621681131541"><span class="hs-identifier hs-var">dus</span></a></span></span><span>
</span><span id="line-1357"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Segment a] -&gt; [Segment a]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment a]
</span><a href="#local-6989586621681131539"><span class="hs-identifier hs-var">yeses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Segment a] -&gt; [Segment a]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment a]
</span><a href="#local-6989586621681131538"><span class="hs-identifier hs-var">noes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1358"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1359"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621681131538"><span class="annot"><span class="annottext">[Segment a]
</span><a href="#local-6989586621681131538"><span class="hs-identifier hs-var">noes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131539"><span class="annot"><span class="annottext">[Segment a]
</span><a href="#local-6989586621681131539"><span class="hs-identifier hs-var">yeses</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Segment a -&gt; Bool) -&gt; [Segment a] -&gt; ([Segment a], [Segment a])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="../../base/src/GHC.List.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="annot"><span class="annottext">Segment a -&gt; Bool
</span><a href="#local-6989586621681131536"><span class="hs-identifier hs-var">not_needed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Segment a] -&gt; [Segment a]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment a]
</span><a href="#local-6989586621681131541"><span class="hs-identifier hs-var">dus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1360"></span><span>          </span><span id="local-6989586621681131536"><span class="annot"><span class="annottext">not_needed :: Segment a -&gt; Bool
</span><a href="#local-6989586621681131536"><span class="hs-identifier hs-var hs-var">not_needed</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131535"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131535"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#disjointNameSet"><span class="hs-identifier hs-var">disjointNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131535"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131542"><span class="hs-identifier hs-var">uses</span></a></span><span>
</span><span id="line-1361"></span><span>
</span><span id="line-1362"></span><span class="hs-comment">----------------------------------------------------</span><span>
</span><span id="line-1363"></span><span id="local-6989586621681133348"><span class="annot"><a href="GHC.Rename.Expr.html#segsToStmts"><span class="hs-identifier hs-type">segsToStmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133348"><span class="hs-identifier hs-type">body</span></a></span><span>
</span><span id="line-1364"></span><span>                                  </span><span class="hs-comment">-- A RecStmt with the SyntaxOps filled in</span><span>
</span><span id="line-1365"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#Segment"><span class="hs-identifier hs-type">Segment</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133348"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1366"></span><span>                                  </span><span class="hs-comment">-- Each Segment has a non-empty list of Stmts</span><span>
</span><span id="line-1367"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span>           </span><span class="hs-comment">-- Free vars used 'later'</span><span>
</span><span id="line-1368"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133348"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1369"></span><span>
</span><span id="line-1370"></span><span id="segsToStmts"><span class="annot"><span class="annottext">segsToStmts :: forall body.
Stmt GhcRn body
-&gt; [Segment [LStmt GhcRn body]]
-&gt; FreeVars
-&gt; ([LStmt GhcRn body], FreeVars)
</span><a href="GHC.Rename.Expr.html#segsToStmts"><span class="hs-identifier hs-var hs-var">segsToStmts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Stmt GhcRn body
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681131532"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131532"><span class="hs-identifier hs-var">fvs_later</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131532"><span class="hs-identifier hs-var">fvs_later</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1371"></span><span class="annot"><a href="GHC.Rename.Expr.html#segsToStmts"><span class="hs-identifier hs-var">segsToStmts</span></a></span><span> </span><span id="local-6989586621681131531"><span class="annot"><span class="annottext">Stmt GhcRn body
</span><a href="#local-6989586621681131531"><span class="hs-identifier hs-var">empty_rec_stmt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681131530"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131530"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131529"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131529"><span class="hs-identifier hs-var">uses</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131528"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131528"><span class="hs-identifier hs-var">fwds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131527"><span class="annot"><span class="annottext">[LStmt GhcRn body]
</span><a href="#local-6989586621681131527"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681131526"><span class="annot"><span class="annottext">[Segment [LStmt GhcRn body]]
</span><a href="#local-6989586621681131526"><span class="hs-identifier hs-var">segs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681131525"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131525"><span class="hs-identifier hs-var">fvs_later</span></a></span></span><span>
</span><span id="line-1372"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">ss</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1373"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LStmt GhcRn body
</span><a href="#local-6989586621681131522"><span class="hs-identifier hs-var">new_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcRn body -&gt; [LStmt GhcRn body] -&gt; [LStmt GhcRn body]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn body]
</span><a href="#local-6989586621681131521"><span class="hs-identifier hs-var">later_stmts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131520"><span class="hs-identifier hs-var">later_uses</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131529"><span class="hs-identifier hs-var">uses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1374"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1375"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681131521"><span class="annot"><span class="annottext">[LStmt GhcRn body]
</span><a href="#local-6989586621681131521"><span class="hs-identifier hs-var">later_stmts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131520"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131520"><span class="hs-identifier hs-var">later_uses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stmt GhcRn body
-&gt; [Segment [LStmt GhcRn body]]
-&gt; FreeVars
-&gt; ([LStmt GhcRn body], FreeVars)
forall body.
Stmt GhcRn body
-&gt; [Segment [LStmt GhcRn body]]
-&gt; FreeVars
-&gt; ([LStmt GhcRn body], FreeVars)
</span><a href="GHC.Rename.Expr.html#segsToStmts"><span class="hs-identifier hs-var">segsToStmts</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt GhcRn body
</span><a href="#local-6989586621681131531"><span class="hs-identifier hs-var">empty_rec_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Segment [LStmt GhcRn body]]
</span><a href="#local-6989586621681131526"><span class="hs-identifier hs-var">segs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131525"><span class="hs-identifier hs-var">fvs_later</span></a></span><span>
</span><span id="line-1376"></span><span>    </span><span id="local-6989586621681131522"><span class="annot"><span class="annottext">new_stmt :: LStmt GhcRn body
</span><a href="#local-6989586621681131522"><span class="hs-identifier hs-var hs-var">new_stmt</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131519"><span class="hs-identifier hs-var">non_rec</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn body] -&gt; LStmt GhcRn body
forall a. [a] -&gt; a
</span><a href="../../base/src/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn body]
</span><a href="#local-6989586621681131527"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-1377"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; Stmt GhcRn body -&gt; LStmt GhcRn body
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LStmt GhcRn body -&gt; SrcSpan
forall l e. GenLocated l e -&gt; l
</span><a href="GHC.Types.SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LStmt GhcRn body] -&gt; LStmt GhcRn body
forall a. [a] -&gt; a
</span><a href="../../base/src/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn body]
</span><a href="#local-6989586621681131527"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stmt GhcRn body
</span><a href="#local-6989586621681131516"><span class="hs-identifier hs-var">rec_stmt</span></a></span><span>
</span><span id="line-1378"></span><span>    </span><span id="local-6989586621681131516"><span class="annot"><span class="annottext">rec_stmt :: Stmt GhcRn body
</span><a href="#local-6989586621681131516"><span class="hs-identifier hs-var hs-var">rec_stmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stmt GhcRn body
</span><a href="#local-6989586621681131531"><span class="hs-identifier hs-var">empty_rec_stmt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recS_stmts :: [LStmt GhcRn body]
</span><a href="GHC.Hs.Expr.html#recS_stmts"><span class="hs-identifier hs-var">recS_stmts</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn body]
</span><a href="#local-6989586621681131527"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-1379"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_later_ids :: [IdP GhcRn]
</span><a href="GHC.Hs.Expr.html#recS_later_ids"><span class="hs-identifier hs-var">recS_later_ids</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; [Name]
</span><a href="GHC.Types.Name.Set.html#nameSetElemsStable"><span class="hs-identifier hs-var">nameSetElemsStable</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131515"><span class="hs-identifier hs-var">used_later</span></a></span><span>
</span><span id="line-1380"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_rec_ids :: [IdP GhcRn]
</span><a href="GHC.Hs.Expr.html#recS_rec_ids"><span class="hs-identifier hs-var">recS_rec_ids</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; [Name]
</span><a href="GHC.Types.Name.Set.html#nameSetElemsStable"><span class="hs-identifier hs-var">nameSetElemsStable</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131528"><span class="hs-identifier hs-var">fwds</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1381"></span><span>          </span><span class="hs-comment">-- See Note [Deterministic ApplicativeDo and RecursiveDo desugaring]</span><span>
</span><span id="line-1382"></span><span>    </span><span id="local-6989586621681131519"><span class="annot"><span class="annottext">non_rec :: Bool
</span><a href="#local-6989586621681131519"><span class="hs-identifier hs-var hs-var">non_rec</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn body] -&gt; Bool
forall a. [a] -&gt; Bool
</span><a href="GHC.Utils.Misc.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">[LStmt GhcRn body]
</span><a href="#local-6989586621681131527"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#isEmptyNameSet"><span class="hs-identifier hs-var">isEmptyNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131528"><span class="hs-identifier hs-var">fwds</span></a></span><span>
</span><span id="line-1383"></span><span>    </span><span id="local-6989586621681131515"><span class="annot"><span class="annottext">used_later :: FreeVars
</span><a href="#local-6989586621681131515"><span class="hs-identifier hs-var hs-var">used_later</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131530"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#intersectNameSet"><span class="hs-operator hs-var">`intersectNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131520"><span class="hs-identifier hs-var">later_uses</span></a></span><span>
</span><span id="line-1384"></span><span>                                </span><span class="hs-comment">-- The ones needed after the RecStmt</span><span>
</span><span id="line-1385"></span><span>
</span><span id="line-1386"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
ApplicativeDo
*                                                                      *
************************************************************************

Note [ApplicativeDo]

= Example =

For a sequence of statements

 do
     x &lt;- A
     y &lt;- B x
     z &lt;- C
     return (f x y z)

We want to transform this to

  (\(x,y) z -&gt; f x y z) &lt;$&gt; (do x &lt;- A; y &lt;- B x; return (x,y)) &lt;*&gt; C

It would be easy to notice that &quot;y &lt;- B x&quot; and &quot;z &lt;- C&quot; are
independent and do something like this:

 do
     x &lt;- A
     (y,z) &lt;- (,) &lt;$&gt; B x &lt;*&gt; C
     return (f x y z)

But this isn't enough! A and C were also independent, and this
transformation loses the ability to do A and C in parallel.

The algorithm works by first splitting the sequence of statements into
independent &quot;segments&quot;, and a separate &quot;tail&quot; (the final statement). In
our example above, the segements would be

     [ x &lt;- A
     , y &lt;- B x ]

     [ z &lt;- C ]

and the tail is:

     return (f x y z)

Then we take these segments and make an Applicative expression from them:

     (\(x,y) z -&gt; return (f x y z))
       &lt;$&gt; do { x &lt;- A; y &lt;- B x; return (x,y) }
       &lt;*&gt; C

Finally, we recursively apply the transformation to each segment, to
discover any nested parallelism.

= Syntax &amp; spec =

  expr ::= ... | do {stmt_1; ..; stmt_n} expr | ...

  stmt ::= pat &lt;- expr
         | (arg_1 | ... | arg_n)  -- applicative composition, n&gt;=1
         | ...                    -- other kinds of statement (e.g. let)

  arg ::= pat &lt;- expr
        | {stmt_1; ..; stmt_n} {var_1..var_n}

(note that in the actual implementation,the expr in a do statement is
represented by a LastStmt as the final stmt, this is just a
representational issue and may change later.)

== Transformation to introduce applicative stmts ==

ado {} tail = tail
ado {pat &lt;- expr} {return expr'} = (mkArg(pat &lt;- expr)); return expr'
ado {one} tail = one : tail
ado stmts tail
  | n == 1 = ado before (ado after tail)
    where (before,after) = split(stmts_1)
  | n &gt; 1  = (mkArg(stmts_1) | ... | mkArg(stmts_n)); tail
  where
    {stmts_1 .. stmts_n} = segments(stmts)

segments(stmts) =
  -- divide stmts into segments with no interdependencies

mkArg({pat &lt;- expr}) = (pat &lt;- expr)
mkArg({stmt_1; ...; stmt_n}) =
  {stmt_1; ...; stmt_n} {vars(stmt_1) u .. u vars(stmt_n)}

split({stmt_1; ..; stmt_n) =
  ({stmt_1; ..; stmt_i}, {stmt_i+1; ..; stmt_n})
  -- 1 &lt;= i &lt;= n
  -- i is a good place to insert a bind

== Desugaring for do ==

dsDo {} expr = expr

dsDo {pat &lt;- rhs; stmts} expr =
   rhs &gt;&gt;= \pat -&gt; dsDo stmts expr

dsDo {(arg_1 | ... | arg_n)} (return expr) =
  (\argpat (arg_1) .. argpat(arg_n) -&gt; expr)
     &lt;$&gt; argexpr(arg_1)
     &lt;*&gt; ...
     &lt;*&gt; argexpr(arg_n)

dsDo {(arg_1 | ... | arg_n); stmts} expr =
  join (\argpat (arg_1) .. argpat(arg_n) -&gt; dsDo stmts expr)
     &lt;$&gt; argexpr(arg_1)
     &lt;*&gt; ...
     &lt;*&gt; argexpr(arg_n)

= Relevant modules in the rest of the compiler =

ApplicativeDo touches a few phases in the compiler:

* Renamer: The journey begins here in the renamer, where do-blocks are
  scheduled as outlined above and transformed into applicative
  combinators.  However, the code is still represented as a do-block
  with special forms of applicative statements. This allows us to
  recover the original do-block when e.g. printing type errors, where
  we don't want to show any of the applicative combinators since they
  don't exist in the source code.
  See ApplicativeStmt and ApplicativeArg in HsExpr.

* Typechecker: ApplicativeDo passes through the typechecker much like any
  other form of expression. The only crux is that the typechecker has to
  be aware of the special ApplicativeDo statements in the do-notation, and
  typecheck them appropriately.
  Relevant module: GHC.Tc.Gen.Match

* Desugarer: Any do-block which contains applicative statements is desugared
  as outlined above, to use the Applicative combinators.
  Relevant module: GHC.HsToCore.Expr

-}</span><span>
</span><span id="line-1524"></span><span>
</span><span id="line-1525"></span><span class="hs-comment">-- | The 'Name's of @return@ and @pure@. These may not be 'returnName' and</span><span>
</span><span id="line-1526"></span><span class="hs-comment">-- 'pureName' due to @QualifiedDo@ or @RebindableSyntax@.</span><span>
</span><span id="line-1527"></span><span class="hs-keyword">data</span><span> </span><span id="MonadNames"><span class="annot"><a href="GHC.Rename.Expr.html#MonadNames"><span class="hs-identifier hs-var">MonadNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MonadNames"><span class="annot"><a href="GHC.Rename.Expr.html#MonadNames"><span class="hs-identifier hs-var">MonadNames</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="return_name"><span class="annot"><span class="annottext">MonadNames -&gt; Name
</span><a href="GHC.Rename.Expr.html#return_name"><span class="hs-identifier hs-var hs-var">return_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="pure_name"><span class="annot"><span class="annottext">MonadNames -&gt; Name
</span><a href="GHC.Rename.Expr.html#pure_name"><span class="hs-identifier hs-var hs-var">pure_name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1528"></span><span>
</span><span id="line-1529"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681131507"><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#MonadNames"><span class="hs-identifier hs-type">MonadNames</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1530"></span><span>  </span><span id="local-6989586621681131503"><span class="annot"><span class="annottext">ppr :: MonadNames -&gt; MsgDoc
</span><a href="#local-6989586621681131503"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#MonadNames"><span class="hs-identifier hs-type">MonadNames</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">return_name :: MonadNames -&gt; Name
</span><a href="GHC.Rename.Expr.html#return_name"><span class="hs-identifier hs-var">return_name</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621681131502"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131502"><span class="hs-identifier hs-var">return_name</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">pure_name :: MonadNames -&gt; Name
</span><a href="GHC.Rename.Expr.html#pure_name"><span class="hs-identifier hs-var">pure_name</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621681131501"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131501"><span class="hs-identifier hs-var">pure_name</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1531"></span><span>    </span><span class="annot"><span class="annottext">[MsgDoc] -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#hcat"><span class="hs-identifier hs-var">hcat</span></a></span><span>
</span><span id="line-1532"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MonadNames { return_name = &quot;</span></span><span>
</span><span id="line-1533"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Name -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131502"><span class="hs-identifier hs-var">return_name</span></a></span><span>
</span><span id="line-1534"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, pure_name = &quot;</span></span><span>
</span><span id="line-1535"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Name -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131501"><span class="hs-identifier hs-var">pure_name</span></a></span><span>
</span><span id="line-1536"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-1537"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1538"></span><span>
</span><span id="line-1539"></span><span class="hs-comment">-- | rearrange a list of statements using ApplicativeDoStmt.  See</span><span>
</span><span id="line-1540"></span><span class="hs-comment">-- Note [ApplicativeDo].</span><span>
</span><span id="line-1541"></span><span class="annot"><a href="GHC.Rename.Expr.html#rearrangeForApplicativeDo"><span class="hs-identifier hs-type">rearrangeForApplicativeDo</span></a></span><span>
</span><span id="line-1542"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-1543"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1544"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1545"></span><span>
</span><span id="line-1546"></span><span id="rearrangeForApplicativeDo"><span class="annot"><span class="annottext">rearrangeForApplicativeDo :: HsStmtContext GhcRn
-&gt; [(ExprLStmt GhcRn, FreeVars)]
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#rearrangeForApplicativeDo"><span class="hs-identifier hs-var hs-var">rearrangeForApplicativeDo</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([ExprLStmt GhcRn], FreeVars) -&gt; RnM ([ExprLStmt GhcRn], FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1547"></span><span class="annot"><a href="GHC.Rename.Expr.html#rearrangeForApplicativeDo"><span class="hs-identifier hs-var">rearrangeForApplicativeDo</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621681131499"><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131499"><span class="hs-identifier hs-var">one</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([ExprLStmt GhcRn], FreeVars) -&gt; RnM ([ExprLStmt GhcRn], FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131499"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1548"></span><span class="annot"><a href="GHC.Rename.Expr.html#rearrangeForApplicativeDo"><span class="hs-identifier hs-var">rearrangeForApplicativeDo</span></a></span><span> </span><span id="local-6989586621681131498"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131498"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131497"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131497"><span class="hs-identifier hs-var">stmts0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1549"></span><span>  </span><span id="local-6989586621681131496"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131496"><span class="hs-identifier hs-var">optimal_ado</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. GeneralFlag -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#goptM"><span class="hs-identifier hs-var">goptM</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_OptimalApplicativeDo"><span class="hs-identifier hs-var">Opt_OptimalApplicativeDo</span></a></span><span>
</span><span id="line-1550"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131493"><span class="annot"><span class="annottext">stmt_tree :: ExprStmtTree
</span><a href="#local-6989586621681131493"><span class="hs-identifier hs-var hs-var">stmt_tree</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131496"><span class="hs-identifier hs-var">optimal_ado</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; ExprStmtTree
</span><a href="GHC.Rename.Expr.html#mkStmtTreeOptimal"><span class="hs-identifier hs-var">mkStmtTreeOptimal</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131491"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-1551"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; ExprStmtTree
</span><a href="GHC.Rename.Expr.html#mkStmtTreeHeuristic"><span class="hs-identifier hs-var">mkStmtTreeHeuristic</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131491"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-1552"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rearrangeForADo&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprStmtTree -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131493"><span class="hs-identifier hs-var">stmt_tree</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1553"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681131489"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131489"><span class="hs-identifier hs-var">return_name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Name, FreeVars)
forall p.
HsStmtContext p
-&gt; Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Name, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupQualifiedDoName"><span class="hs-identifier hs-var">lookupQualifiedDoName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131498"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#returnMName"><span class="hs-identifier hs-var">returnMName</span></a></span><span>
</span><span id="line-1554"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681131487"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131487"><span class="hs-identifier hs-var">pure_name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Name, FreeVars)
forall p.
HsStmtContext p
-&gt; Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Name, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupQualifiedDoName"><span class="hs-identifier hs-var">lookupQualifiedDoName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131498"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#pureAName"><span class="hs-identifier hs-var">pureAName</span></a></span><span>
</span><span id="line-1555"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131485"><span class="annot"><span class="annottext">monad_names :: MonadNames
</span><a href="#local-6989586621681131485"><span class="hs-identifier hs-var hs-var">monad_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonadNames :: Name -&gt; Name -&gt; MonadNames
</span><a href="GHC.Rename.Expr.html#MonadNames"><span class="hs-identifier hs-type">MonadNames</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">return_name :: Name
</span><a href="GHC.Rename.Expr.html#return_name"><span class="hs-identifier hs-var">return_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131489"><span class="hs-identifier hs-var">return_name</span></a></span><span>
</span><span id="line-1556"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pure_name :: Name
</span><a href="GHC.Rename.Expr.html#pure_name"><span class="hs-identifier hs-var">pure_name</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681131487"><span class="hs-identifier hs-var">pure_name</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1557"></span><span>  </span><span class="annot"><span class="annottext">MonadNames
-&gt; HsStmtContext GhcRn
-&gt; ExprStmtTree
-&gt; [ExprLStmt GhcRn]
-&gt; FreeVars
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#stmtTreeToStmts"><span class="hs-identifier hs-var">stmtTreeToStmts</span></a></span><span> </span><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131485"><span class="hs-identifier hs-var">monad_names</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131498"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131493"><span class="hs-identifier hs-var">stmt_tree</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131483"><span class="hs-identifier hs-var">last</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131482"><span class="hs-identifier hs-var">last_fvs</span></a></span><span>
</span><span id="line-1558"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1559"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681131491"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131491"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621681131483"><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131483"><span class="hs-identifier hs-var">last</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131482"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131482"><span class="hs-identifier hs-var">last_fvs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
-&gt; ([(ExprLStmt GhcRn, FreeVars)], (ExprLStmt GhcRn, FreeVars))
forall {a}. [a] -&gt; ([a], a)
</span><a href="#local-6989586621681131481"><span class="hs-identifier hs-var">findLast</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131497"><span class="hs-identifier hs-var">stmts0</span></a></span><span>
</span><span id="line-1560"></span><span>    </span><span id="local-6989586621681131481"><span class="annot"><span class="annottext">findLast :: [a] -&gt; ([a], a)
</span><a href="#local-6989586621681131481"><span class="hs-identifier hs-var hs-var">findLast</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ([a], a)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../base/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;findLast&quot;</span></span><span>
</span><span id="line-1561"></span><span>    </span><span class="annot"><a href="#local-6989586621681131481"><span class="hs-identifier hs-var">findLast</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681131477"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131477"><span class="hs-identifier hs-var">last</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131477"><span class="hs-identifier hs-var">last</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1562"></span><span>    </span><span class="annot"><a href="#local-6989586621681131481"><span class="hs-identifier hs-var">findLast</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131476"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131476"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681131475"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681131475"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131476"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681131474"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131473"><span class="hs-identifier hs-var">last</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131474"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681131474"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131473"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131473"><span class="hs-identifier hs-var">last</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ([a], a)
</span><a href="#local-6989586621681131481"><span class="hs-identifier hs-var">findLast</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681131475"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1563"></span><span>
</span><span id="line-1564"></span><span class="hs-comment">-- | A tree of statements using a mixture of applicative and bind constructs.</span><span>
</span><span id="line-1565"></span><span class="hs-keyword">data</span><span> </span><span id="StmtTree"><span class="annot"><a href="GHC.Rename.Expr.html#StmtTree"><span class="hs-identifier hs-var">StmtTree</span></a></span></span><span> </span><span id="local-6989586621681133318"><span class="annot"><a href="#local-6989586621681133318"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1566"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="StmtTreeOne"><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-var">StmtTreeOne</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621681133318"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1567"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="StmtTreeBind"><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeBind"><span class="hs-identifier hs-var">StmtTreeBind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTree"><span class="hs-identifier hs-type">StmtTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133318"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTree"><span class="hs-identifier hs-type">StmtTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133318"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1568"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="StmtTreeApplicative"><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeApplicative"><span class="hs-identifier hs-var">StmtTreeApplicative</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTree"><span class="hs-identifier hs-type">StmtTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133318"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1569"></span><span>
</span><span id="line-1570"></span><span id="local-6989586621681133708"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681131467"><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133708"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTree"><span class="hs-identifier hs-type">StmtTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133708"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1571"></span><span>  </span><span id="local-6989586621681131462"><span class="annot"><span class="annottext">ppr :: StmtTree a -&gt; MsgDoc
</span><a href="#local-6989586621681131462"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-type">StmtTreeOne</span></a></span><span> </span><span id="local-6989586621681131461"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131461"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;StmtTreeOne&quot;</span></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131461"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1572"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeBind"><span class="hs-identifier hs-type">StmtTreeBind</span></a></span><span> </span><span id="local-6989586621681131459"><span class="annot"><span class="annottext">StmtTree a
</span><a href="#local-6989586621681131459"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681131458"><span class="annot"><span class="annottext">StmtTree a
</span><a href="#local-6989586621681131458"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MsgDoc -&gt; Int -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;StmtTreeBind&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1573"></span><span>                                            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MsgDoc] -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StmtTree a -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">StmtTree a
</span><a href="#local-6989586621681131459"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StmtTree a -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">StmtTree a
</span><a href="#local-6989586621681131458"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1574"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeApplicative"><span class="hs-identifier hs-type">StmtTreeApplicative</span></a></span><span> </span><span id="local-6989586621681131457"><span class="annot"><span class="annottext">[StmtTree a]
</span><a href="#local-6989586621681131457"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MsgDoc -&gt; Int -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;StmtTreeApplicative&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1575"></span><span>                                            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MsgDoc] -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StmtTree a -&gt; MsgDoc) -&gt; [StmtTree a] -&gt; [MsgDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">StmtTree a -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[StmtTree a]
</span><a href="#local-6989586621681131457"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-1576"></span><span>
</span><span id="line-1577"></span><span id="local-6989586621681133321"><span class="annot"><a href="GHC.Rename.Expr.html#flattenStmtTree"><span class="hs-identifier hs-type">flattenStmtTree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTree"><span class="hs-identifier hs-type">StmtTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133321"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681133321"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1578"></span><span id="flattenStmtTree"><span class="annot"><span class="annottext">flattenStmtTree :: forall a. StmtTree a -&gt; [a]
</span><a href="GHC.Rename.Expr.html#flattenStmtTree"><span class="hs-identifier hs-var hs-var">flattenStmtTree</span></a></span></span><span> </span><span id="local-6989586621681131454"><span class="annot"><span class="annottext">StmtTree a
</span><a href="#local-6989586621681131454"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StmtTree a -&gt; [a] -&gt; [a]
forall {a}. StmtTree a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681131453"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StmtTree a
</span><a href="#local-6989586621681131454"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1579"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1580"></span><span>  </span><span id="local-6989586621681131453"><span class="annot"><span class="annottext">go :: StmtTree a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681131453"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-type">StmtTreeOne</span></a></span><span> </span><span id="local-6989586621681131451"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131451"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681131450"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681131450"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131451"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681131450"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1581"></span><span>  </span><span class="annot"><a href="#local-6989586621681131453"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeBind"><span class="hs-identifier hs-type">StmtTreeBind</span></a></span><span> </span><span id="local-6989586621681131449"><span class="annot"><span class="annottext">StmtTree a
</span><a href="#local-6989586621681131449"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681131448"><span class="annot"><span class="annottext">StmtTree a
</span><a href="#local-6989586621681131448"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681131447"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681131447"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StmtTree a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681131453"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StmtTree a
</span><a href="#local-6989586621681131449"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StmtTree a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681131453"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StmtTree a
</span><a href="#local-6989586621681131448"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681131447"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1582"></span><span>  </span><span class="annot"><a href="#local-6989586621681131453"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeApplicative"><span class="hs-identifier hs-type">StmtTreeApplicative</span></a></span><span> </span><span id="local-6989586621681131446"><span class="annot"><span class="annottext">[StmtTree a]
</span><a href="#local-6989586621681131446"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681131445"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681131445"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StmtTree a -&gt; [a] -&gt; [a]) -&gt; [a] -&gt; [StmtTree a] -&gt; [a]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">StmtTree a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681131453"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681131445"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[StmtTree a]
</span><a href="#local-6989586621681131446"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-1583"></span><span>
</span><span id="line-1584"></span><span class="hs-keyword">type</span><span> </span><span id="ExprStmtTree"><span class="annot"><a href="GHC.Rename.Expr.html#ExprStmtTree"><span class="hs-identifier hs-var">ExprStmtTree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTree"><span class="hs-identifier hs-type">StmtTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1585"></span><span class="hs-keyword">type</span><span> </span><span id="Cost"><span class="annot"><a href="GHC.Rename.Expr.html#Cost"><span class="hs-identifier hs-var">Cost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1586"></span><span>
</span><span id="line-1587"></span><span class="hs-comment">-- | Turn a sequence of statements into an ExprStmtTree using a</span><span>
</span><span id="line-1588"></span><span class="hs-comment">-- heuristic algorithm.  /O(n^2)/</span><span>
</span><span id="line-1589"></span><span class="annot"><a href="GHC.Rename.Expr.html#mkStmtTreeHeuristic"><span class="hs-identifier hs-type">mkStmtTreeHeuristic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#ExprStmtTree"><span class="hs-identifier hs-type">ExprStmtTree</span></a></span><span>
</span><span id="line-1590"></span><span id="mkStmtTreeHeuristic"><span class="annot"><span class="annottext">mkStmtTreeHeuristic :: [(ExprLStmt GhcRn, FreeVars)] -&gt; ExprStmtTree
</span><a href="GHC.Rename.Expr.html#mkStmtTreeHeuristic"><span class="hs-identifier hs-var hs-var">mkStmtTreeHeuristic</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681131443"><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131443"><span class="hs-identifier hs-var">one</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars) -&gt; ExprStmtTree
forall a. a -&gt; StmtTree a
</span><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-var">StmtTreeOne</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131443"><span class="hs-identifier hs-var">one</span></a></span><span>
</span><span id="line-1591"></span><span class="annot"><a href="GHC.Rename.Expr.html#mkStmtTreeHeuristic"><span class="hs-identifier hs-var">mkStmtTreeHeuristic</span></a></span><span> </span><span id="local-6989586621681131442"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131442"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1592"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; [[(ExprLStmt GhcRn, FreeVars)]]
</span><a href="GHC.Rename.Expr.html#segments"><span class="hs-identifier hs-var">segments</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131442"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1593"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621681131440"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131440"><span class="hs-identifier hs-var">one</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; ExprStmtTree
</span><a href="#local-6989586621681131439"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131440"><span class="hs-identifier hs-var">one</span></a></span><span>
</span><span id="line-1594"></span><span>    </span><span id="local-6989586621681131438"><span class="annot"><span class="annottext">[[(ExprLStmt GhcRn, FreeVars)]]
</span><a href="#local-6989586621681131438"><span class="hs-identifier hs-var">segs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ExprStmtTree] -&gt; ExprStmtTree
forall a. [StmtTree a] -&gt; StmtTree a
</span><a href="GHC.Rename.Expr.html#StmtTreeApplicative"><span class="hs-identifier hs-var">StmtTreeApplicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(ExprLStmt GhcRn, FreeVars)] -&gt; ExprStmtTree)
-&gt; [[(ExprLStmt GhcRn, FreeVars)]] -&gt; [ExprStmtTree]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; ExprStmtTree
</span><a href="#local-6989586621681131439"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">[[(ExprLStmt GhcRn, FreeVars)]]
</span><a href="#local-6989586621681131438"><span class="hs-identifier hs-var">segs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1595"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1596"></span><span>  </span><span id="local-6989586621681131439"><span class="annot"><span class="annottext">split :: [(ExprLStmt GhcRn, FreeVars)] -&gt; ExprStmtTree
</span><a href="#local-6989586621681131439"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681131437"><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131437"><span class="hs-identifier hs-var">one</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars) -&gt; ExprStmtTree
forall a. a -&gt; StmtTree a
</span><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-var">StmtTreeOne</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131437"><span class="hs-identifier hs-var">one</span></a></span><span>
</span><span id="line-1597"></span><span>  </span><span class="annot"><a href="#local-6989586621681131439"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621681131436"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131436"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1598"></span><span>    </span><span class="annot"><span class="annottext">ExprStmtTree -&gt; ExprStmtTree -&gt; ExprStmtTree
forall a. StmtTree a -&gt; StmtTree a -&gt; StmtTree a
</span><a href="GHC.Rename.Expr.html#StmtTreeBind"><span class="hs-identifier hs-var">StmtTreeBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; ExprStmtTree
</span><a href="GHC.Rename.Expr.html#mkStmtTreeHeuristic"><span class="hs-identifier hs-var">mkStmtTreeHeuristic</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131435"><span class="hs-identifier hs-var">before</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; ExprStmtTree
</span><a href="GHC.Rename.Expr.html#mkStmtTreeHeuristic"><span class="hs-identifier hs-var">mkStmtTreeHeuristic</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131434"><span class="hs-identifier hs-var">after</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1599"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131435"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131435"><span class="hs-identifier hs-var">before</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131434"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131434"><span class="hs-identifier hs-var">after</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
-&gt; ([(ExprLStmt GhcRn, FreeVars)], [(ExprLStmt GhcRn, FreeVars)])
</span><a href="GHC.Rename.Expr.html#splitSegment"><span class="hs-identifier hs-var">splitSegment</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131436"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-1600"></span><span>
</span><span id="line-1601"></span><span class="hs-comment">-- | Turn a sequence of statements into an ExprStmtTree optimally,</span><span>
</span><span id="line-1602"></span><span class="hs-comment">-- using dynamic programming.  /O(n^3)/</span><span>
</span><span id="line-1603"></span><span class="annot"><a href="GHC.Rename.Expr.html#mkStmtTreeOptimal"><span class="hs-identifier hs-type">mkStmtTreeOptimal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#ExprStmtTree"><span class="hs-identifier hs-type">ExprStmtTree</span></a></span><span>
</span><span id="line-1604"></span><span id="mkStmtTreeOptimal"><span class="annot"><span class="annottext">mkStmtTreeOptimal :: [(ExprLStmt GhcRn, FreeVars)] -&gt; ExprStmtTree
</span><a href="GHC.Rename.Expr.html#mkStmtTreeOptimal"><span class="hs-identifier hs-var hs-var">mkStmtTreeOptimal</span></a></span></span><span> </span><span id="local-6989586621681131432"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131432"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1605"></span><span>  </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">stmts</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- the empty case is handled by the caller;</span><span>
</span><span id="line-1606"></span><span>                           </span><span class="hs-comment">-- we don't support empty StmtTrees.</span><span>
</span><span id="line-1607"></span><span>  </span><span class="annot"><span class="annottext">(ExprStmtTree, Int) -&gt; ExprStmtTree
forall a b. (a, b) -&gt; a
</span><a href="../../base/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array (Int, Int) (ExprStmtTree, Int)
</span><a href="#local-6989586621681131431"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) (ExprStmtTree, Int)
-&gt; (Int, Int) -&gt; (ExprStmtTree, Int)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><a href="../../base/src/GHC.Arr.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131429"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1608"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1609"></span><span>    </span><span id="local-6989586621681131429"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621681131429"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131432"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1610"></span><span>    </span><span id="local-6989586621681131428"><span class="annot"><span class="annottext">stmt_arr :: Array Int (ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131428"><span class="hs-identifier hs-var hs-var">stmt_arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
-&gt; [(ExprLStmt GhcRn, FreeVars)]
-&gt; Array Int (ExprLStmt GhcRn, FreeVars)
forall i e. Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e
</span><a href="../../base/src/GHC.Arr.html#listArray"><span class="hs-identifier hs-var">listArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131429"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131432"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-1611"></span><span>
</span><span id="line-1612"></span><span>    </span><span class="hs-comment">-- lazy cache of optimal trees for subsequences of the input</span><span>
</span><span id="line-1613"></span><span>    </span><span class="annot"><a href="#local-6989586621681131431"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base/src/GHC.Arr.html#Array"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#ExprStmtTree"><span class="hs-identifier hs-type">ExprStmtTree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1614"></span><span>    </span><span id="local-6989586621681131431"><span class="annot"><span class="annottext">arr :: Array (Int, Int) (ExprStmtTree, Int)
</span><a href="#local-6989586621681131431"><span class="hs-identifier hs-var hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int))
-&gt; [((Int, Int), (ExprStmtTree, Int))]
-&gt; Array (Int, Int) (ExprStmtTree, Int)
forall i e. Ix i =&gt; (i, i) -&gt; [(i, e)] -&gt; Array i e
</span><a href="../../base/src/GHC.Arr.html#array"><span class="hs-identifier hs-var">array</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131429"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131429"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1615"></span><span>             </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131425"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131424"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (ExprStmtTree, Int)
</span><a href="#local-6989586621681131423"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131425"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131424"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1616"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681131425"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131425"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131429"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1617"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131424"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131424"><span class="hs-identifier hs-var">hi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131425"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131429"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1618"></span><span>
</span><span id="line-1619"></span><span>    </span><span class="hs-comment">-- compute the optimal tree for the sequence [lo..hi]</span><span>
</span><span id="line-1620"></span><span>    </span><span id="local-6989586621681131423"><span class="annot"><span class="annottext">tree :: Int -&gt; Int -&gt; (ExprStmtTree, Int)
</span><a href="#local-6989586621681131423"><span class="hs-identifier hs-var hs-var">tree</span></a></span></span><span> </span><span id="local-6989586621681131422"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131422"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span id="local-6989586621681131421"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131421"><span class="hs-identifier hs-var">hi</span></a></span></span><span>
</span><span id="line-1621"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131421"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131422"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars) -&gt; ExprStmtTree
forall a. a -&gt; StmtTree a
</span><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-var">StmtTreeOne</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131428"><span class="hs-identifier hs-var">stmt_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
-&gt; Int -&gt; (ExprLStmt GhcRn, FreeVars)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><a href="../../base/src/GHC.Arr.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131422"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1622"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1623"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; [[(ExprLStmt GhcRn, FreeVars)]]
</span><a href="GHC.Rename.Expr.html#segments"><span class="hs-identifier hs-var">segments</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131428"><span class="hs-identifier hs-var">stmt_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
-&gt; Int -&gt; (ExprLStmt GhcRn, FreeVars)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><a href="../../base/src/GHC.Arr.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131420"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681131420"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131420"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131422"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131421"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1624"></span><span>           </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (ExprStmtTree, Int)
forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkStmtTree&quot;</span></span><span>
</span><span id="line-1625"></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621681131419"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131419"><span class="hs-identifier hs-var">_one</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (ExprStmtTree, Int)
</span><a href="#local-6989586621681131418"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131422"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131421"><span class="hs-identifier hs-var">hi</span></a></span><span>
</span><span id="line-1626"></span><span>           </span><span id="local-6989586621681131417"><span class="annot"><span class="annottext">[[(ExprLStmt GhcRn, FreeVars)]]
</span><a href="#local-6989586621681131417"><span class="hs-identifier hs-var">segs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ExprStmtTree] -&gt; ExprStmtTree
forall a. [StmtTree a] -&gt; StmtTree a
</span><a href="GHC.Rename.Expr.html#StmtTreeApplicative"><span class="hs-identifier hs-var">StmtTreeApplicative</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprStmtTree]
</span><a href="#local-6989586621681131416"><span class="hs-identifier hs-var">trees</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../../base/src/Data.Foldable.html#maximum"><span class="hs-identifier hs-var">maximum</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681131414"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1627"></span><span>             </span><span class="hs-keyword">where</span><span>
</span><span id="line-1628"></span><span>               </span><span id="local-6989586621681131413"><span class="annot"><span class="annottext">bounds :: [(Int, Int)]
</span><a href="#local-6989586621681131413"><span class="hs-identifier hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; [(ExprLStmt GhcRn, FreeVars)] -&gt; (Int, Int))
-&gt; (Int, Int) -&gt; [[(ExprLStmt GhcRn, FreeVars)]] -&gt; [(Int, Int)]
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.List.html#scanl"><span class="hs-identifier hs-var">scanl</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621681131411"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131411"><span class="hs-identifier hs-var">hi</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681131410"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131410"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131411"><span class="hs-identifier hs-var">hi</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131411"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131410"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131422"><span class="hs-identifier hs-var">lo</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[(ExprLStmt GhcRn, FreeVars)]]
</span><a href="#local-6989586621681131417"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-1629"></span><span>               </span><span class="hs-special">(</span><span id="local-6989586621681131416"><span class="annot"><span class="annottext">[ExprStmtTree]
</span><a href="#local-6989586621681131416"><span class="hs-identifier hs-var">trees</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131414"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681131414"><span class="hs-identifier hs-var">costs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ExprStmtTree, Int)] -&gt; ([ExprStmtTree], [Int])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../base/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, Int) -&gt; (ExprStmtTree, Int))
-&gt; [(Int, Int)] -&gt; [(ExprStmtTree, Int)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; (ExprStmtTree, Int))
-&gt; (Int, Int) -&gt; (ExprStmtTree, Int)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../base/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (ExprStmtTree, Int)
</span><a href="#local-6989586621681131418"><span class="hs-identifier hs-var">split</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Int, Int)] -&gt; [(Int, Int)]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#tail"><span class="hs-identifier hs-var">tail</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621681131413"><span class="hs-identifier hs-var">bounds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1630"></span><span>
</span><span id="line-1631"></span><span>    </span><span class="hs-comment">-- find the best place to split the segment [lo..hi]</span><span>
</span><span id="line-1632"></span><span>    </span><span class="annot"><a href="#local-6989586621681131418"><span class="hs-identifier hs-type">split</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#ExprStmtTree"><span class="hs-identifier hs-type">ExprStmtTree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1633"></span><span>    </span><span id="local-6989586621681131418"><span class="annot"><span class="annottext">split :: Int -&gt; Int -&gt; (ExprStmtTree, Int)
</span><a href="#local-6989586621681131418"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621681131405"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131405"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span id="local-6989586621681131404"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131404"><span class="hs-identifier hs-var">hi</span></a></span></span><span>
</span><span id="line-1634"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131404"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131405"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars) -&gt; ExprStmtTree
forall a. a -&gt; StmtTree a
</span><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-var">StmtTreeOne</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131428"><span class="hs-identifier hs-var">stmt_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
-&gt; Int -&gt; (ExprLStmt GhcRn, FreeVars)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><a href="../../base/src/GHC.Arr.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131405"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1635"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprStmtTree -&gt; ExprStmtTree -&gt; ExprStmtTree
forall a. StmtTree a -&gt; StmtTree a -&gt; StmtTree a
</span><a href="GHC.Rename.Expr.html#StmtTreeBind"><span class="hs-identifier hs-var">StmtTreeBind</span></a></span><span> </span><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131403"><span class="hs-identifier hs-var">before</span></a></span><span> </span><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131402"><span class="hs-identifier hs-var">after</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131401"><span class="hs-identifier hs-var">c1</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131400"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1636"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1637"></span><span>         </span><span class="hs-comment">-- As per the paper, for a sequence s1...sn, we want to find</span><span>
</span><span id="line-1638"></span><span>         </span><span class="hs-comment">-- the split with the minimum cost, where the cost is the</span><span>
</span><span id="line-1639"></span><span>         </span><span class="hs-comment">-- sum of the cost of the left and right subsequences.</span><span>
</span><span id="line-1640"></span><span>         </span><span class="hs-comment">--</span><span>
</span><span id="line-1641"></span><span>         </span><span class="hs-comment">-- As an optimisation (also in the paper) if the cost of</span><span>
</span><span id="line-1642"></span><span>         </span><span class="hs-comment">-- s1..s(n-1) is different from the cost of s2..sn, we know</span><span>
</span><span id="line-1643"></span><span>         </span><span class="hs-comment">-- that the optimal solution is the lower of the two.  Only</span><span>
</span><span id="line-1644"></span><span>         </span><span class="hs-comment">-- in the case that these two have the same cost do we need</span><span>
</span><span id="line-1645"></span><span>         </span><span class="hs-comment">-- to do the exhaustive search.</span><span>
</span><span id="line-1646"></span><span>         </span><span class="hs-comment">--</span><span>
</span><span id="line-1647"></span><span>         </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681131403"><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131403"><span class="hs-identifier hs-var">before</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131401"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131401"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621681131402"><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131402"><span class="hs-identifier hs-var">after</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131400"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131400"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1648"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131404"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131405"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1649"></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars) -&gt; ExprStmtTree
forall a. a -&gt; StmtTree a
</span><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-var">StmtTreeOne</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131428"><span class="hs-identifier hs-var">stmt_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
-&gt; Int -&gt; (ExprLStmt GhcRn, FreeVars)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><a href="../../base/src/GHC.Arr.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131405"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1650"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars) -&gt; ExprStmtTree
forall a. a -&gt; StmtTree a
</span><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-var">StmtTreeOne</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131428"><span class="hs-identifier hs-var">stmt_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
-&gt; Int -&gt; (ExprLStmt GhcRn, FreeVars)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><a href="../../base/src/GHC.Arr.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131404"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1651"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131399"><span class="hs-identifier hs-var">left_cost</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131397"><span class="hs-identifier hs-var">right_cost</span></a></span><span>
</span><span id="line-1652"></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131396"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131399"><span class="hs-identifier hs-var">left_cost</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars) -&gt; ExprStmtTree
forall a. a -&gt; StmtTree a
</span><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-var">StmtTreeOne</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131428"><span class="hs-identifier hs-var">stmt_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
-&gt; Int -&gt; (ExprLStmt GhcRn, FreeVars)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><a href="../../base/src/GHC.Arr.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131404"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1653"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131399"><span class="hs-identifier hs-var">left_cost</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131397"><span class="hs-identifier hs-var">right_cost</span></a></span><span>
</span><span id="line-1654"></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars) -&gt; ExprStmtTree
forall a. a -&gt; StmtTree a
</span><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-var">StmtTreeOne</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131428"><span class="hs-identifier hs-var">stmt_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Array Int (ExprLStmt GhcRn, FreeVars)
-&gt; Int -&gt; (ExprLStmt GhcRn, FreeVars)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><a href="../../base/src/GHC.Arr.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131405"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131394"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131397"><span class="hs-identifier hs-var">right_cost</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1655"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((ExprStmtTree, Int), (ExprStmtTree, Int))
 -&gt; ((ExprStmtTree, Int), (ExprStmtTree, Int)) -&gt; Ordering)
-&gt; [((ExprStmtTree, Int), (ExprStmtTree, Int))]
-&gt; ((ExprStmtTree, Int), (ExprStmtTree, Int))
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><a href="../../base/src/Data.Foldable.html#minimumBy"><span class="hs-identifier hs-var">minimumBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(((ExprStmtTree, Int), (ExprStmtTree, Int)) -&gt; Int)
-&gt; ((ExprStmtTree, Int), (ExprStmtTree, Int))
-&gt; ((ExprStmtTree, Int), (ExprStmtTree, Int))
-&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><a href="../../base/src/Data.Ord.html#comparing"><span class="hs-identifier hs-var">comparing</span></a></span><span> </span><span class="annot"><span class="annottext">((ExprStmtTree, Int), (ExprStmtTree, Int)) -&gt; Int
forall {a} {a} {a}. Num a =&gt; ((a, a), (a, a)) -&gt; a
</span><a href="#local-6989586621681131391"><span class="hs-identifier hs-var">cost</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[((ExprStmtTree, Int), (ExprStmtTree, Int))]
</span><a href="#local-6989586621681131390"><span class="hs-identifier hs-var">alternatives</span></a></span><span>
</span><span id="line-1656"></span><span>           </span><span class="hs-keyword">where</span><span>
</span><span id="line-1657"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621681131396"><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131396"><span class="hs-identifier hs-var">left</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131399"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131399"><span class="hs-identifier hs-var">left_cost</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) (ExprStmtTree, Int)
</span><a href="#local-6989586621681131431"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) (ExprStmtTree, Int)
-&gt; (Int, Int) -&gt; (ExprStmtTree, Int)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><a href="../../base/src/GHC.Arr.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131405"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131404"><span class="hs-identifier hs-var">hi</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1658"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621681131394"><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131394"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131397"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131397"><span class="hs-identifier hs-var">right_cost</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) (ExprStmtTree, Int)
</span><a href="#local-6989586621681131431"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) (ExprStmtTree, Int)
-&gt; (Int, Int) -&gt; (ExprStmtTree, Int)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><a href="../../base/src/GHC.Arr.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131405"><span class="hs-identifier hs-var">lo</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131404"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1659"></span><span>             </span><span id="local-6989586621681131391"><span class="annot"><span class="annottext">cost :: ((a, a), (a, a)) -&gt; a
</span><a href="#local-6989586621681131391"><span class="hs-identifier hs-var hs-var">cost</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621681131387"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131387"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621681131386"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131386"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131387"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131386"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-1660"></span><span>             </span><span id="local-6989586621681131390"><span class="annot"><span class="annottext">alternatives :: [((ExprStmtTree, Int), (ExprStmtTree, Int))]
</span><a href="#local-6989586621681131390"><span class="hs-identifier hs-var hs-var">alternatives</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array (Int, Int) (ExprStmtTree, Int)
</span><a href="#local-6989586621681131431"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) (ExprStmtTree, Int)
-&gt; (Int, Int) -&gt; (ExprStmtTree, Int)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><a href="../../base/src/GHC.Arr.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131405"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131385"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) (ExprStmtTree, Int)
</span><a href="#local-6989586621681131431"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) (ExprStmtTree, Int)
-&gt; (Int, Int) -&gt; (ExprStmtTree, Int)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><a href="../../base/src/GHC.Arr.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131385"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131404"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1661"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681131385"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131385"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131405"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681131404"><span class="hs-identifier hs-var">hi</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1662"></span><span>
</span><span id="line-1663"></span><span>
</span><span id="line-1664"></span><span class="hs-comment">-- | Turn the ExprStmtTree back into a sequence of statements, using</span><span>
</span><span id="line-1665"></span><span class="hs-comment">-- ApplicativeStmt where necessary.</span><span>
</span><span id="line-1666"></span><span class="annot"><a href="GHC.Rename.Expr.html#stmtTreeToStmts"><span class="hs-identifier hs-type">stmtTreeToStmts</span></a></span><span>
</span><span id="line-1667"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#MonadNames"><span class="hs-identifier hs-type">MonadNames</span></a></span><span>
</span><span id="line-1668"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-1669"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#ExprStmtTree"><span class="hs-identifier hs-type">ExprStmtTree</span></a></span><span>
</span><span id="line-1670"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>             </span><span class="hs-comment">-- ^ the &quot;tail&quot;</span><span>
</span><span id="line-1671"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span>                     </span><span class="hs-comment">-- ^ free variables of the tail</span><span>
</span><span id="line-1672"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>       </span><span class="hs-comment">-- ( output statements,</span><span>
</span><span id="line-1673"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span class="hs-special">)</span><span>             </span><span class="hs-comment">-- , things we needed</span><span>
</span><span id="line-1674"></span><span>
</span><span id="line-1675"></span><span class="hs-comment">-- If we have a single bind, and we can do it without a join, transform</span><span>
</span><span id="line-1676"></span><span class="hs-comment">-- to an ApplicativeStmt.  This corresponds to the rule</span><span>
</span><span id="line-1677"></span><span class="hs-comment">--   dsBlock [pat &lt;- rhs] (return expr) = expr &lt;$&gt; rhs</span><span>
</span><span id="line-1678"></span><span class="hs-comment">-- In the spec, but we do it here rather than in the desugarer,</span><span>
</span><span id="line-1679"></span><span class="hs-comment">-- because we need the typechecker to typecheck the &lt;$&gt; form rather than</span><span>
</span><span id="line-1680"></span><span class="hs-comment">-- the bind form, which would give rise to a Monad constraint.</span><span>
</span><span id="line-1681"></span><span id="stmtTreeToStmts"><span class="annot"><span class="annottext">stmtTreeToStmts :: MonadNames
-&gt; HsStmtContext GhcRn
-&gt; ExprStmtTree
-&gt; [ExprLStmt GhcRn]
-&gt; FreeVars
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#stmtTreeToStmts"><span class="hs-identifier hs-var hs-var">stmtTreeToStmts</span></a></span></span><span> </span><span id="local-6989586621681131384"><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131384"><span class="hs-identifier hs-var">monad_names</span></a></span></span><span> </span><span id="local-6989586621681131383"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131383"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-type">StmtTreeOne</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span id="local-6989586621681131382"><span class="annot"><span class="annottext">XBindStmt GhcRn GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621681131382"><span class="hs-identifier hs-var">xbs</span></a></span></span><span> </span><span id="local-6989586621681131381"><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131381"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681131380"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131380"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1682"></span><span>                </span><span id="local-6989586621681131379"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131379"><span class="hs-identifier hs-var">tail</span></a></span></span><span> </span><span id="local-6989586621681131378"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131378"><span class="hs-identifier hs-var">_tail_fvs</span></a></span></span><span>
</span><span id="line-1683"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LPat GhcRn -&gt; Bool
forall (p :: Pass). LPat (GhcPass p) -&gt; Bool
</span><a href="GHC.Rename.Expr.html#isStrictPattern"><span class="hs-identifier hs-var">isStrictPattern</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131381"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span id="local-6989586621681131376"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131376"><span class="hs-identifier hs-var">tail'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MonadNames -&gt; [ExprLStmt GhcRn] -&gt; (Bool, [ExprLStmt GhcRn])
</span><a href="GHC.Rename.Expr.html#needJoin"><span class="hs-identifier hs-var">needJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131384"><span class="hs-identifier hs-var">monad_names</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131379"><span class="hs-identifier hs-var">tail</span></a></span><span>
</span><span id="line-1684"></span><span>  </span><span class="hs-comment">-- See Note [ApplicativeDo and strict patterns]</span><span>
</span><span id="line-1685"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; [ApplicativeArg GhcRn]
-&gt; Bool
-&gt; [ExprLStmt GhcRn]
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#mkApplicativeStmt"><span class="hs-identifier hs-var">mkApplicativeStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131383"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ApplicativeArgOne :: forall idL.
XApplicativeArgOne idL
-&gt; LPat idL -&gt; LHsExpr idL -&gt; Bool -&gt; ApplicativeArg idL
</span><a href="GHC.Hs.Expr.html#ApplicativeArgOne"><span class="hs-identifier hs-type">ApplicativeArgOne</span></a></span><span>
</span><span id="line-1686"></span><span>                            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">xarg_app_arg_one :: XApplicativeArgOne GhcRn
</span><a href="GHC.Hs.Expr.html#xarg_app_arg_one"><span class="hs-identifier hs-var">xarg_app_arg_one</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XBindStmtRn -&gt; Maybe (SyntaxExpr GhcRn)
</span><a href="GHC.Hs.Expr.html#xbsrn_failOp"><span class="hs-identifier hs-var hs-var">xbsrn_failOp</span></a></span><span> </span><span class="annot"><span class="annottext">XBindStmt GhcRn GhcRn (LHsExpr GhcRn)
XBindStmtRn
</span><a href="#local-6989586621681131382"><span class="hs-identifier hs-var">xbs</span></a></span><span>
</span><span id="line-1687"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">app_arg_pattern :: LPat GhcRn
</span><a href="GHC.Hs.Expr.html#app_arg_pattern"><span class="hs-identifier hs-var">app_arg_pattern</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131381"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1688"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">arg_expr :: LHsExpr GhcRn
</span><a href="GHC.Hs.Expr.html#arg_expr"><span class="hs-identifier hs-var">arg_expr</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131380"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1689"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">is_body_stmt :: Bool
</span><a href="GHC.Hs.Expr.html#is_body_stmt"><span class="hs-identifier hs-var">is_body_stmt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1690"></span><span>                            </span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><span id="line-1691"></span><span>                      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131376"><span class="hs-identifier hs-var">tail'</span></a></span><span>
</span><span id="line-1692"></span><span class="annot"><a href="GHC.Rename.Expr.html#stmtTreeToStmts"><span class="hs-identifier hs-var">stmtTreeToStmts</span></a></span><span> </span><span id="local-6989586621681131368"><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131368"><span class="hs-identifier hs-var">monad_names</span></a></span></span><span> </span><span id="local-6989586621681131367"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131367"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-type">StmtTreeOne</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-type">BodyStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBodyStmt GhcRn GhcRn (LHsExpr GhcRn)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131366"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131366"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1693"></span><span>                </span><span id="local-6989586621681131365"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131365"><span class="hs-identifier hs-var">tail</span></a></span></span><span> </span><span id="local-6989586621681131364"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131364"><span class="hs-identifier hs-var">_tail_fvs</span></a></span></span><span>
</span><span id="line-1694"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span id="local-6989586621681131363"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131363"><span class="hs-identifier hs-var">tail'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MonadNames -&gt; [ExprLStmt GhcRn] -&gt; (Bool, [ExprLStmt GhcRn])
</span><a href="GHC.Rename.Expr.html#needJoin"><span class="hs-identifier hs-var">needJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131368"><span class="hs-identifier hs-var">monad_names</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131365"><span class="hs-identifier hs-var">tail</span></a></span><span>
</span><span id="line-1695"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; [ApplicativeArg GhcRn]
-&gt; Bool
-&gt; [ExprLStmt GhcRn]
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#mkApplicativeStmt"><span class="hs-identifier hs-var">mkApplicativeStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131367"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1696"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ApplicativeArgOne :: forall idL.
XApplicativeArgOne idL
-&gt; LPat idL -&gt; LHsExpr idL -&gt; Bool -&gt; ApplicativeArg idL
</span><a href="GHC.Hs.Expr.html#ApplicativeArgOne"><span class="hs-identifier hs-type">ApplicativeArgOne</span></a></span><span>
</span><span id="line-1697"></span><span>       </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">xarg_app_arg_one :: XApplicativeArgOne GhcRn
</span><a href="GHC.Hs.Expr.html#xarg_app_arg_one"><span class="hs-identifier hs-var">xarg_app_arg_one</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XApplicativeArgOne GhcRn
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1698"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">app_arg_pattern :: LPat GhcRn
</span><a href="GHC.Hs.Expr.html#app_arg_pattern"><span class="hs-identifier hs-var">app_arg_pattern</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="GHC.Hs.Utils.html#nlWildPatName"><span class="hs-identifier hs-var">nlWildPatName</span></a></span><span>
</span><span id="line-1699"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">arg_expr :: LHsExpr GhcRn
</span><a href="GHC.Hs.Expr.html#arg_expr"><span class="hs-identifier hs-var">arg_expr</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131366"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1700"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">is_body_stmt :: Bool
</span><a href="GHC.Hs.Expr.html#is_body_stmt"><span class="hs-identifier hs-var">is_body_stmt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1701"></span><span>       </span><span class="hs-special">}</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131363"><span class="hs-identifier hs-var">tail'</span></a></span><span>
</span><span id="line-1702"></span><span>
</span><span id="line-1703"></span><span class="annot"><a href="GHC.Rename.Expr.html#stmtTreeToStmts"><span class="hs-identifier hs-var">stmtTreeToStmts</span></a></span><span> </span><span id="local-6989586621681131361"><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131361"><span class="hs-identifier hs-var">_monad_names</span></a></span></span><span> </span><span id="local-6989586621681131360"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131360"><span class="hs-identifier hs-var">_ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-type">StmtTreeOne</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131359"><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131359"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681131358"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131358"><span class="hs-identifier hs-var">tail</span></a></span></span><span> </span><span id="local-6989586621681131357"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131357"><span class="hs-identifier hs-var">_tail_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1704"></span><span>  </span><span class="annot"><span class="annottext">([ExprLStmt GhcRn], FreeVars) -&gt; RnM ([ExprLStmt GhcRn], FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131359"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn -&gt; [ExprLStmt GhcRn] -&gt; [ExprLStmt GhcRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131358"><span class="hs-identifier hs-var">tail</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1705"></span><span>
</span><span id="line-1706"></span><span class="annot"><a href="GHC.Rename.Expr.html#stmtTreeToStmts"><span class="hs-identifier hs-var">stmtTreeToStmts</span></a></span><span> </span><span id="local-6989586621681131356"><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131356"><span class="hs-identifier hs-var">monad_names</span></a></span></span><span> </span><span id="local-6989586621681131355"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131355"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeBind"><span class="hs-identifier hs-type">StmtTreeBind</span></a></span><span> </span><span id="local-6989586621681131354"><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131354"><span class="hs-identifier hs-var">before</span></a></span></span><span> </span><span id="local-6989586621681131353"><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131353"><span class="hs-identifier hs-var">after</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681131352"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131352"><span class="hs-identifier hs-var">tail</span></a></span></span><span> </span><span id="local-6989586621681131351"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131351"><span class="hs-identifier hs-var">tail_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1707"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681131350"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131350"><span class="hs-identifier hs-var">stmts1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131349"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131349"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MonadNames
-&gt; HsStmtContext GhcRn
-&gt; ExprStmtTree
-&gt; [ExprLStmt GhcRn]
-&gt; FreeVars
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#stmtTreeToStmts"><span class="hs-identifier hs-var">stmtTreeToStmts</span></a></span><span> </span><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131356"><span class="hs-identifier hs-var">monad_names</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131355"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131353"><span class="hs-identifier hs-var">after</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131352"><span class="hs-identifier hs-var">tail</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131351"><span class="hs-identifier hs-var">tail_fvs</span></a></span><span>
</span><span id="line-1708"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131348"><span class="annot"><span class="annottext">tail1_fvs :: FreeVars
</span><a href="#local-6989586621681131348"><span class="hs-identifier hs-var hs-var">tail1_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unionNameSets"><span class="hs-identifier hs-var">unionNameSets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131351"><span class="hs-identifier hs-var">tail_fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; [FreeVars] -&gt; [FreeVars]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((ExprLStmt GhcRn, FreeVars) -&gt; FreeVars)
-&gt; [(ExprLStmt GhcRn, FreeVars)] -&gt; [FreeVars]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars) -&gt; FreeVars
forall a b. (a, b) -&gt; b
</span><a href="../../base/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprStmtTree -&gt; [(ExprLStmt GhcRn, FreeVars)]
forall a. StmtTree a -&gt; [a]
</span><a href="GHC.Rename.Expr.html#flattenStmtTree"><span class="hs-identifier hs-var">flattenStmtTree</span></a></span><span> </span><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131353"><span class="hs-identifier hs-var">after</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1709"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681131346"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131346"><span class="hs-identifier hs-var">stmts2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131345"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131345"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MonadNames
-&gt; HsStmtContext GhcRn
-&gt; ExprStmtTree
-&gt; [ExprLStmt GhcRn]
-&gt; FreeVars
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#stmtTreeToStmts"><span class="hs-identifier hs-var">stmtTreeToStmts</span></a></span><span> </span><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131356"><span class="hs-identifier hs-var">monad_names</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131355"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131354"><span class="hs-identifier hs-var">before</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131350"><span class="hs-identifier hs-var">stmts1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131348"><span class="hs-identifier hs-var">tail1_fvs</span></a></span><span>
</span><span id="line-1710"></span><span>  </span><span class="annot"><span class="annottext">([ExprLStmt GhcRn], FreeVars) -&gt; RnM ([ExprLStmt GhcRn], FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131346"><span class="hs-identifier hs-var">stmts2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131349"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131345"><span class="hs-identifier hs-var">fvs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1711"></span><span>
</span><span id="line-1712"></span><span class="annot"><a href="GHC.Rename.Expr.html#stmtTreeToStmts"><span class="hs-identifier hs-var">stmtTreeToStmts</span></a></span><span> </span><span id="local-6989586621681131344"><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131344"><span class="hs-identifier hs-var">monad_names</span></a></span></span><span> </span><span id="local-6989586621681131343"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131343"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeApplicative"><span class="hs-identifier hs-type">StmtTreeApplicative</span></a></span><span> </span><span id="local-6989586621681131342"><span class="annot"><span class="annottext">[ExprStmtTree]
</span><a href="#local-6989586621681131342"><span class="hs-identifier hs-var">trees</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681131341"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131341"><span class="hs-identifier hs-var">tail</span></a></span></span><span> </span><span id="local-6989586621681131340"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131340"><span class="hs-identifier hs-var">tail_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1713"></span><span>   </span><span id="local-6989586621681131339"><span class="annot"><span class="annottext">[(ApplicativeArg GhcRn, FreeVars)]
</span><a href="#local-6989586621681131339"><span class="hs-identifier hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ExprStmtTree
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) (ApplicativeArg GhcRn, FreeVars))
-&gt; [ExprStmtTree]
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [(ApplicativeArg GhcRn, FreeVars)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; FreeVars
-&gt; ExprStmtTree
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (ApplicativeArg GhcRn, FreeVars)
</span><a href="#local-6989586621681131338"><span class="hs-identifier hs-var">stmtTreeArg</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131343"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131340"><span class="hs-identifier hs-var">tail_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ExprStmtTree]
</span><a href="#local-6989586621681131342"><span class="hs-identifier hs-var">trees</span></a></span><span>
</span><span id="line-1714"></span><span>   </span><span id="local-6989586621681131337"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131337"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-1715"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131336"><span class="annot"><span class="annottext">[ApplicativeArg GhcRn]
</span><a href="#local-6989586621681131336"><span class="hs-identifier hs-var">stmts'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131335"><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681131335"><span class="hs-identifier hs-var">fvss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ApplicativeArg GhcRn, FreeVars)]
-&gt; ([ApplicativeArg GhcRn], [FreeVars])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../base/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(ApplicativeArg GhcRn, FreeVars)]
</span><a href="#local-6989586621681131339"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-1716"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131334"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131334"><span class="hs-identifier hs-var">need_join</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131333"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131333"><span class="hs-identifier hs-var">tail'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1717"></span><span>     </span><span class="hs-comment">-- See Note [ApplicativeDo and refutable patterns]</span><span>
</span><span id="line-1718"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(ApplicativeArg GhcRn -&gt; Bool) -&gt; [ApplicativeArg GhcRn] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base/src/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; ApplicativeArg GhcRn -&gt; Bool
</span><a href="GHC.Rename.Expr.html#hasRefutablePattern"><span class="hs-identifier hs-var">hasRefutablePattern</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131337"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ApplicativeArg GhcRn]
</span><a href="#local-6989586621681131336"><span class="hs-identifier hs-var">stmts'</span></a></span><span>
</span><span id="line-1719"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131341"><span class="hs-identifier hs-var">tail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1720"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">MonadNames -&gt; [ExprLStmt GhcRn] -&gt; (Bool, [ExprLStmt GhcRn])
</span><a href="GHC.Rename.Expr.html#needJoin"><span class="hs-identifier hs-var">needJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131344"><span class="hs-identifier hs-var">monad_names</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131341"><span class="hs-identifier hs-var">tail</span></a></span><span>
</span><span id="line-1721"></span><span>
</span><span id="line-1722"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621681131330"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131330"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131329"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131329"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; [ApplicativeArg GhcRn]
-&gt; Bool
-&gt; [ExprLStmt GhcRn]
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#mkApplicativeStmt"><span class="hs-identifier hs-var">mkApplicativeStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131343"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[ApplicativeArg GhcRn]
</span><a href="#local-6989586621681131336"><span class="hs-identifier hs-var">stmts'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131334"><span class="hs-identifier hs-var">need_join</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131333"><span class="hs-identifier hs-var">tail'</span></a></span><span>
</span><span id="line-1723"></span><span>   </span><span class="annot"><span class="annottext">([ExprLStmt GhcRn], FreeVars) -&gt; RnM ([ExprLStmt GhcRn], FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131330"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unionNameSets"><span class="hs-identifier hs-var">unionNameSets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131329"><span class="hs-identifier hs-var">fvs</span></a></span><span class="annot"><span class="annottext">FreeVars -&gt; [FreeVars] -&gt; [FreeVars]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[FreeVars]
</span><a href="#local-6989586621681131335"><span class="hs-identifier hs-var">fvss</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1724"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1725"></span><span>   </span><span id="local-6989586621681131338"><span class="annot"><span class="annottext">stmtTreeArg :: HsStmtContext GhcRn
-&gt; FreeVars
-&gt; ExprStmtTree
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (ApplicativeArg GhcRn, FreeVars)
</span><a href="#local-6989586621681131338"><span class="hs-identifier hs-var hs-var">stmtTreeArg</span></a></span></span><span> </span><span id="local-6989586621681131328"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131328"><span class="hs-identifier hs-var">_ctxt</span></a></span></span><span> </span><span id="local-6989586621681131327"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131327"><span class="hs-identifier hs-var">_tail_fvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-type">StmtTreeOne</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span id="local-6989586621681131326"><span class="annot"><span class="annottext">XBindStmt GhcRn GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621681131326"><span class="hs-identifier hs-var">xbs</span></a></span></span><span> </span><span id="local-6989586621681131325"><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131325"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681131324"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131324"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1726"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ApplicativeArg GhcRn, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (ApplicativeArg GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApplicativeArgOne :: forall idL.
XApplicativeArgOne idL
-&gt; LPat idL -&gt; LHsExpr idL -&gt; Bool -&gt; ApplicativeArg idL
</span><a href="GHC.Hs.Expr.html#ApplicativeArgOne"><span class="hs-identifier hs-type">ApplicativeArgOne</span></a></span><span>
</span><span id="line-1727"></span><span>               </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">xarg_app_arg_one :: XApplicativeArgOne GhcRn
</span><a href="GHC.Hs.Expr.html#xarg_app_arg_one"><span class="hs-identifier hs-var">xarg_app_arg_one</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XBindStmtRn -&gt; Maybe (SyntaxExpr GhcRn)
</span><a href="GHC.Hs.Expr.html#xbsrn_failOp"><span class="hs-identifier hs-var hs-var">xbsrn_failOp</span></a></span><span> </span><span class="annot"><span class="annottext">XBindStmt GhcRn GhcRn (LHsExpr GhcRn)
XBindStmtRn
</span><a href="#local-6989586621681131326"><span class="hs-identifier hs-var">xbs</span></a></span><span>
</span><span id="line-1728"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">app_arg_pattern :: LPat GhcRn
</span><a href="GHC.Hs.Expr.html#app_arg_pattern"><span class="hs-identifier hs-var">app_arg_pattern</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131325"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1729"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">arg_expr :: LHsExpr GhcRn
</span><a href="GHC.Hs.Expr.html#arg_expr"><span class="hs-identifier hs-var">arg_expr</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131324"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1730"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">is_body_stmt :: Bool
</span><a href="GHC.Hs.Expr.html#is_body_stmt"><span class="hs-identifier hs-var">is_body_stmt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1731"></span><span>               </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1732"></span><span>   </span><span class="annot"><a href="#local-6989586621681131338"><span class="hs-identifier hs-var">stmtTreeArg</span></a></span><span> </span><span id="local-6989586621681131323"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131323"><span class="hs-identifier hs-var">_ctxt</span></a></span></span><span> </span><span id="local-6989586621681131322"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131322"><span class="hs-identifier hs-var">_tail_fvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Expr.html#StmtTreeOne"><span class="hs-identifier hs-type">StmtTreeOne</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-type">BodyStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBodyStmt GhcRn GhcRn (LHsExpr GhcRn)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131321"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131321"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1733"></span><span>     </span><span class="annot"><span class="annottext">(ApplicativeArg GhcRn, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (ApplicativeArg GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApplicativeArgOne :: forall idL.
XApplicativeArgOne idL
-&gt; LPat idL -&gt; LHsExpr idL -&gt; Bool -&gt; ApplicativeArg idL
</span><a href="GHC.Hs.Expr.html#ApplicativeArgOne"><span class="hs-identifier hs-type">ApplicativeArgOne</span></a></span><span>
</span><span id="line-1734"></span><span>             </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">xarg_app_arg_one :: XApplicativeArgOne GhcRn
</span><a href="GHC.Hs.Expr.html#xarg_app_arg_one"><span class="hs-identifier hs-var">xarg_app_arg_one</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XApplicativeArgOne GhcRn
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1735"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">app_arg_pattern :: LPat GhcRn
</span><a href="GHC.Hs.Expr.html#app_arg_pattern"><span class="hs-identifier hs-var">app_arg_pattern</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="GHC.Hs.Utils.html#nlWildPatName"><span class="hs-identifier hs-var">nlWildPatName</span></a></span><span>
</span><span id="line-1736"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">arg_expr :: LHsExpr GhcRn
</span><a href="GHC.Hs.Expr.html#arg_expr"><span class="hs-identifier hs-var">arg_expr</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131321"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1737"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">is_body_stmt :: Bool
</span><a href="GHC.Hs.Expr.html#is_body_stmt"><span class="hs-identifier hs-var">is_body_stmt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1738"></span><span>             </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1739"></span><span>   </span><span class="annot"><a href="#local-6989586621681131338"><span class="hs-identifier hs-var">stmtTreeArg</span></a></span><span> </span><span id="local-6989586621681131320"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131320"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131319"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131319"><span class="hs-identifier hs-var">tail_fvs</span></a></span></span><span> </span><span id="local-6989586621681131318"><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131318"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1740"></span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131317"><span class="annot"><span class="annottext">stmts :: [(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131317"><span class="hs-identifier hs-var hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprStmtTree -&gt; [(ExprLStmt GhcRn, FreeVars)]
forall a. StmtTree a -&gt; [a]
</span><a href="GHC.Rename.Expr.html#flattenStmtTree"><span class="hs-identifier hs-var">flattenStmtTree</span></a></span><span> </span><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131318"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-1741"></span><span>         </span><span id="local-6989586621681131316"><span class="annot"><span class="annottext">pvarset :: FreeVars
</span><a href="#local-6989586621681131316"><span class="hs-identifier hs-var hs-var">pvarset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((ExprLStmt GhcRn, FreeVars) -&gt; [Name])
-&gt; [(ExprLStmt GhcRn, FreeVars)] -&gt; [Name]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StmtLR GhcRn GhcRn (LHsExpr GhcRn) -&gt; [Name]
forall (idL :: Pass) (idR :: Pass) body.
CollectPass (GhcPass idL) =&gt;
StmtLR (GhcPass idL) (GhcPass idR) body -&gt; [IdP (GhcPass idL)]
</span><a href="GHC.Hs.Utils.html#collectStmtBinders"><span class="hs-identifier hs-var">collectStmtBinders</span></a></span><span class="annot"><span class="annottext">(StmtLR GhcRn GhcRn (LHsExpr GhcRn) -&gt; [Name])
-&gt; ((ExprLStmt GhcRn, FreeVars)
    -&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn))
-&gt; (ExprLStmt GhcRn, FreeVars)
-&gt; [Name]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span class="annot"><span class="annottext">ExprLStmt GhcRn -&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn)
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="annot"><span class="annottext">(ExprLStmt GhcRn -&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn))
-&gt; ((ExprLStmt GhcRn, FreeVars) -&gt; ExprLStmt GhcRn)
-&gt; (ExprLStmt GhcRn, FreeVars)
-&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars) -&gt; ExprLStmt GhcRn
forall a b. (a, b) -&gt; a
</span><a href="../../base/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131317"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1742"></span><span>                     </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#intersectNameSet"><span class="hs-operator hs-var">`intersectNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131319"><span class="hs-identifier hs-var">tail_fvs</span></a></span><span>
</span><span id="line-1743"></span><span>         </span><span id="local-6989586621681131314"><span class="annot"><span class="annottext">pvars :: [Name]
</span><a href="#local-6989586621681131314"><span class="hs-identifier hs-var hs-var">pvars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; [Name]
</span><a href="GHC.Types.Name.Set.html#nameSetElemsStable"><span class="hs-identifier hs-var">nameSetElemsStable</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131316"><span class="hs-identifier hs-var">pvarset</span></a></span><span>
</span><span id="line-1744"></span><span>           </span><span class="hs-comment">-- See Note [Deterministic ApplicativeDo and RecursiveDo desugaring]</span><span>
</span><span id="line-1745"></span><span>         </span><span id="local-6989586621681131313"><span class="annot"><span class="annottext">pat :: LPat GhcRn
</span><a href="#local-6989586621681131313"><span class="hs-identifier hs-var hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[IdP GhcRn] -&gt; LPat GhcRn
</span><a href="GHC.Hs.Utils.html#mkBigLHsVarPatTup"><span class="hs-identifier hs-var">mkBigLHsVarPatTup</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
[IdP GhcRn]
</span><a href="#local-6989586621681131314"><span class="hs-identifier hs-var">pvars</span></a></span><span>
</span><span id="line-1746"></span><span>         </span><span id="local-6989586621681131311"><span class="annot"><span class="annottext">tup :: LHsExpr GhcRn
</span><a href="#local-6989586621681131311"><span class="hs-identifier hs-var hs-var">tup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[IdP GhcRn] -&gt; LHsExpr GhcRn
forall (id :: Pass). [IdP (GhcPass id)] -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#mkBigLHsVarTup"><span class="hs-identifier hs-var">mkBigLHsVarTup</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
[IdP GhcRn]
</span><a href="#local-6989586621681131314"><span class="hs-identifier hs-var">pvars</span></a></span><span>
</span><span id="line-1747"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621681131309"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131309"><span class="hs-identifier hs-var">stmts'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131308"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131308"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MonadNames
-&gt; HsStmtContext GhcRn
-&gt; ExprStmtTree
-&gt; [ExprLStmt GhcRn]
-&gt; FreeVars
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#stmtTreeToStmts"><span class="hs-identifier hs-var">stmtTreeToStmts</span></a></span><span> </span><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131344"><span class="hs-identifier hs-var">monad_names</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131320"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ExprStmtTree
</span><a href="#local-6989586621681131318"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131316"><span class="hs-identifier hs-var">pvarset</span></a></span><span>
</span><span id="line-1748"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621681131307"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131307"><span class="hs-identifier hs-var">mb_ret</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131306"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131306"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1749"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeStmt"><span class="hs-identifier hs-type">ApplicativeStmt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn] -&gt; ExprLStmt GhcRn
forall a. [a] -&gt; a
</span><a href="../../base/src/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131309"><span class="hs-identifier hs-var">stmts'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1750"></span><span>             </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; HsExpr GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131311"><span class="hs-identifier hs-var">tup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1751"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1752"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621681131304"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131304"><span class="hs-identifier hs-var">ret</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; TcM (HsExpr GhcRn, FreeVars)
forall p. HsStmtContext p -&gt; Name -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupQualifiedDoExpr"><span class="hs-identifier hs-var">lookupQualifiedDoExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131320"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#returnMName"><span class="hs-identifier hs-var">returnMName</span></a></span><span>
</span><span id="line-1753"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131302"><span class="annot"><span class="annottext">expr :: HsExpr GhcRn
</span><a href="#local-6989586621681131302"><span class="hs-identifier hs-var hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XApp GhcRn -&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XApp p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XApp GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcRn -&gt; LHsExpr GhcRn
forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131304"><span class="hs-identifier hs-var">ret</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131311"><span class="hs-identifier hs-var">tup</span></a></span><span>
</span><span id="line-1754"></span><span>             </span><span class="annot"><span class="annottext">(HsExpr GhcRn, FreeVars) -&gt; TcM (HsExpr GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131302"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1755"></span><span>     </span><span class="annot"><span class="annottext">(ApplicativeArg GhcRn, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (ApplicativeArg GhcRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ApplicativeArgMany :: forall idL.
XApplicativeArgMany idL
-&gt; [ExprLStmt idL]
-&gt; HsExpr idL
-&gt; LPat idL
-&gt; HsStmtContext GhcRn
-&gt; ApplicativeArg idL
</span><a href="GHC.Hs.Expr.html#ApplicativeArgMany"><span class="hs-identifier hs-type">ApplicativeArgMany</span></a></span><span>
</span><span id="line-1756"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">xarg_app_arg_many :: XApplicativeArgMany GhcRn
</span><a href="GHC.Hs.Expr.html#xarg_app_arg_many"><span class="hs-identifier hs-var">xarg_app_arg_many</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NoExtField
XApplicativeArgMany GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span>
</span><span id="line-1757"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">app_stmts :: [ExprLStmt GhcRn]
</span><a href="GHC.Hs.Expr.html#app_stmts"><span class="hs-identifier hs-var">app_stmts</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131309"><span class="hs-identifier hs-var">stmts'</span></a></span><span>
</span><span id="line-1758"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">final_expr :: HsExpr GhcRn
</span><a href="GHC.Hs.Expr.html#final_expr"><span class="hs-identifier hs-var">final_expr</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131307"><span class="hs-identifier hs-var">mb_ret</span></a></span><span>
</span><span id="line-1759"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bv_pattern :: LPat GhcRn
</span><a href="GHC.Hs.Expr.html#bv_pattern"><span class="hs-identifier hs-var">bv_pattern</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131313"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1760"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stmt_context :: HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#stmt_context"><span class="hs-identifier hs-var">stmt_context</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131320"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1761"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-1762"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131306"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131308"><span class="hs-identifier hs-var">fvs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1763"></span><span>
</span><span id="line-1764"></span><span>
</span><span id="line-1765"></span><span class="hs-comment">-- | Divide a sequence of statements into segments, where no segment</span><span>
</span><span id="line-1766"></span><span class="hs-comment">-- depends on any variables defined by a statement in another segment.</span><span>
</span><span id="line-1767"></span><span class="annot"><a href="GHC.Rename.Expr.html#segments"><span class="hs-identifier hs-type">segments</span></a></span><span>
</span><span id="line-1768"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1769"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1770"></span><span id="segments"><span class="annot"><span class="annottext">segments :: [(ExprLStmt GhcRn, FreeVars)] -&gt; [[(ExprLStmt GhcRn, FreeVars)]]
</span><a href="GHC.Rename.Expr.html#segments"><span class="hs-identifier hs-var hs-var">segments</span></a></span></span><span> </span><span id="local-6989586621681131295"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131295"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([(ExprLStmt GhcRn, FreeVars)], Bool)
 -&gt; [(ExprLStmt GhcRn, FreeVars)])
-&gt; [([(ExprLStmt GhcRn, FreeVars)], Bool)]
-&gt; [[(ExprLStmt GhcRn, FreeVars)]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">([(ExprLStmt GhcRn, FreeVars)], Bool)
-&gt; [(ExprLStmt GhcRn, FreeVars)]
forall a b. (a, b) -&gt; a
</span><a href="../../base/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([([(ExprLStmt GhcRn, FreeVars)], Bool)]
 -&gt; [[(ExprLStmt GhcRn, FreeVars)]])
-&gt; [([(ExprLStmt GhcRn, FreeVars)], Bool)]
-&gt; [[(ExprLStmt GhcRn, FreeVars)]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[[(ExprLStmt GhcRn, FreeVars)]]
-&gt; [([(ExprLStmt GhcRn, FreeVars)], Bool)]
forall {a} {b} {b}.
[[(LStmt a b, b)]] -&gt; [([(LStmt a b, b)], Bool)]
</span><a href="#local-6989586621681131294"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">([[(ExprLStmt GhcRn, FreeVars)]]
 -&gt; [([(ExprLStmt GhcRn, FreeVars)], Bool)])
-&gt; [[(ExprLStmt GhcRn, FreeVars)]]
-&gt; [([(ExprLStmt GhcRn, FreeVars)], Bool)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[[(ExprLStmt GhcRn, FreeVars)]] -&gt; [[(ExprLStmt GhcRn, FreeVars)]]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">([[(ExprLStmt GhcRn, FreeVars)]]
 -&gt; [[(ExprLStmt GhcRn, FreeVars)]])
-&gt; [[(ExprLStmt GhcRn, FreeVars)]]
-&gt; [[(ExprLStmt GhcRn, FreeVars)]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">([(ExprLStmt GhcRn, FreeVars)] -&gt; [(ExprLStmt GhcRn, FreeVars)])
-&gt; [[(ExprLStmt GhcRn, FreeVars)]]
-&gt; [[(ExprLStmt GhcRn, FreeVars)]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; [(ExprLStmt GhcRn, FreeVars)]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">([[(ExprLStmt GhcRn, FreeVars)]]
 -&gt; [[(ExprLStmt GhcRn, FreeVars)]])
-&gt; [[(ExprLStmt GhcRn, FreeVars)]]
-&gt; [[(ExprLStmt GhcRn, FreeVars)]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; [[(ExprLStmt GhcRn, FreeVars)]]
</span><a href="#local-6989586621681131293"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; [(ExprLStmt GhcRn, FreeVars)]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131295"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1771"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1772"></span><span>    </span><span id="local-6989586621681131292"><span class="annot"><span class="annottext">allvars :: FreeVars
</span><a href="#local-6989586621681131292"><span class="hs-identifier hs-var hs-var">allvars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((ExprLStmt GhcRn, FreeVars) -&gt; [Name])
-&gt; [(ExprLStmt GhcRn, FreeVars)] -&gt; [Name]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StmtLR GhcRn GhcRn (LHsExpr GhcRn) -&gt; [Name]
forall (idL :: Pass) (idR :: Pass) body.
CollectPass (GhcPass idL) =&gt;
StmtLR (GhcPass idL) (GhcPass idR) body -&gt; [IdP (GhcPass idL)]
</span><a href="GHC.Hs.Utils.html#collectStmtBinders"><span class="hs-identifier hs-var">collectStmtBinders</span></a></span><span class="annot"><span class="annottext">(StmtLR GhcRn GhcRn (LHsExpr GhcRn) -&gt; [Name])
-&gt; ((ExprLStmt GhcRn, FreeVars)
    -&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn))
-&gt; (ExprLStmt GhcRn, FreeVars)
-&gt; [Name]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span class="annot"><span class="annottext">ExprLStmt GhcRn -&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn)
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="annot"><span class="annottext">(ExprLStmt GhcRn -&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn))
-&gt; ((ExprLStmt GhcRn, FreeVars) -&gt; ExprLStmt GhcRn)
-&gt; (ExprLStmt GhcRn, FreeVars)
-&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars) -&gt; ExprLStmt GhcRn
forall a b. (a, b) -&gt; a
</span><a href="../../base/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131295"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1773"></span><span>
</span><span id="line-1774"></span><span>    </span><span class="hs-comment">-- We would rather not have a segment that just has LetStmts in</span><span>
</span><span id="line-1775"></span><span>    </span><span class="hs-comment">-- it, so combine those with an adjacent segment where possible.</span><span>
</span><span id="line-1776"></span><span>    </span><span id="local-6989586621681131294"><span class="annot"><span class="annottext">merge :: [[(LStmt a b, b)]] -&gt; [([(LStmt a b, b)], Bool)]
</span><a href="#local-6989586621681131294"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1777"></span><span>    </span><span class="annot"><a href="#local-6989586621681131294"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131290"><span class="annot"><span class="annottext">[(LStmt a b, b)]
</span><a href="#local-6989586621681131290"><span class="hs-identifier hs-var">seg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681131289"><span class="annot"><span class="annottext">[[(LStmt a b, b)]]
</span><a href="#local-6989586621681131289"><span class="hs-identifier hs-var">segs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1778"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[([(LStmt a b, b)], Bool)]
</span><a href="#local-6989586621681131288"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1779"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LStmt a b, b)]
</span><a href="#local-6989586621681131290"><span class="hs-identifier hs-var">seg</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131287"><span class="hs-identifier hs-var">all_lets</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1780"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681131286"><span class="annot"><span class="annottext">[(LStmt a b, b)]
</span><a href="#local-6989586621681131286"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131285"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131285"><span class="hs-identifier hs-var">s_lets</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681131284"><span class="annot"><span class="annottext">[([(LStmt a b, b)], Bool)]
</span><a href="#local-6989586621681131284"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131287"><span class="hs-identifier hs-var">all_lets</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131285"><span class="hs-identifier hs-var">s_lets</span></a></span><span>
</span><span id="line-1781"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LStmt a b, b)]
</span><a href="#local-6989586621681131290"><span class="hs-identifier hs-var">seg</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmt a b, b)] -&gt; [(LStmt a b, b)] -&gt; [(LStmt a b, b)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmt a b, b)]
</span><a href="#local-6989586621681131286"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131287"><span class="hs-identifier hs-var">all_lets</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131285"><span class="hs-identifier hs-var">s_lets</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(LStmt a b, b)], Bool)
-&gt; [([(LStmt a b, b)], Bool)] -&gt; [([(LStmt a b, b)], Bool)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[([(LStmt a b, b)], Bool)]
</span><a href="#local-6989586621681131284"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-1782"></span><span>          </span><span id="local-6989586621681131282"><span class="annot"><span class="annottext">[([(LStmt a b, b)], Bool)]
</span><a href="#local-6989586621681131282"><span class="hs-identifier hs-var">_otherwise</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LStmt a b, b)]
</span><a href="#local-6989586621681131290"><span class="hs-identifier hs-var">seg</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131287"><span class="hs-identifier hs-var">all_lets</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(LStmt a b, b)], Bool)
-&gt; [([(LStmt a b, b)], Bool)] -&gt; [([(LStmt a b, b)], Bool)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[([(LStmt a b, b)], Bool)]
</span><a href="#local-6989586621681131288"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1783"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1784"></span><span>        </span><span id="local-6989586621681131288"><span class="annot"><span class="annottext">rest :: [([(LStmt a b, b)], Bool)]
</span><a href="#local-6989586621681131288"><span class="hs-identifier hs-var hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(LStmt a b, b)]] -&gt; [([(LStmt a b, b)], Bool)]
</span><a href="#local-6989586621681131294"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">[[(LStmt a b, b)]]
</span><a href="#local-6989586621681131289"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-1785"></span><span>        </span><span id="local-6989586621681131287"><span class="annot"><span class="annottext">all_lets :: Bool
</span><a href="#local-6989586621681131287"><span class="hs-identifier hs-var hs-var">all_lets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((LStmt a b, b) -&gt; Bool) -&gt; [(LStmt a b, b)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LStmt a b -&gt; Bool
forall a b. LStmt a b -&gt; Bool
</span><a href="GHC.Rename.Expr.html#isLetStmt"><span class="hs-identifier hs-var">isLetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">(LStmt a b -&gt; Bool)
-&gt; ((LStmt a b, b) -&gt; LStmt a b) -&gt; (LStmt a b, b) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LStmt a b, b) -&gt; LStmt a b
forall a b. (a, b) -&gt; a
</span><a href="../../base/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(LStmt a b, b)]
</span><a href="#local-6989586621681131290"><span class="hs-identifier hs-var">seg</span></a></span><span>
</span><span id="line-1786"></span><span>
</span><span id="line-1787"></span><span>    </span><span class="hs-comment">-- walk splits the statement sequence into segments, traversing</span><span>
</span><span id="line-1788"></span><span>    </span><span class="hs-comment">-- the sequence from the back to the front, and keeping track of</span><span>
</span><span id="line-1789"></span><span>    </span><span class="hs-comment">-- the set of free variables of the current segment.  Whenever</span><span>
</span><span id="line-1790"></span><span>    </span><span class="hs-comment">-- this set of free variables is empty, we have a complete segment.</span><span>
</span><span id="line-1791"></span><span>    </span><span class="annot"><a href="#local-6989586621681131293"><span class="hs-identifier hs-type">walk</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1792"></span><span>    </span><span id="local-6989586621681131293"><span class="annot"><span class="annottext">walk :: [(ExprLStmt GhcRn, FreeVars)] -&gt; [[(ExprLStmt GhcRn, FreeVars)]]
</span><a href="#local-6989586621681131293"><span class="hs-identifier hs-var hs-var">walk</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1793"></span><span>    </span><span class="annot"><a href="#local-6989586621681131293"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681131279"><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131279"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131278"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131278"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681131277"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131277"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131279"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131278"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars)
-&gt; [(ExprLStmt GhcRn, FreeVars)] -&gt; [(ExprLStmt GhcRn, FreeVars)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131276"><span class="hs-identifier hs-var">seg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
-&gt; [[(ExprLStmt GhcRn, FreeVars)]]
-&gt; [[(ExprLStmt GhcRn, FreeVars)]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; [[(ExprLStmt GhcRn, FreeVars)]]
</span><a href="#local-6989586621681131293"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131275"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1794"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131276"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131276"><span class="hs-identifier hs-var">seg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131275"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131275"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
-&gt; [(ExprLStmt GhcRn, FreeVars)]
-&gt; ([(ExprLStmt GhcRn, FreeVars)], [(ExprLStmt GhcRn, FreeVars)])
</span><a href="#local-6989586621681131274"><span class="hs-identifier hs-var">chunter</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131273"><span class="hs-identifier hs-var">fvs'</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131277"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-1795"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131273"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131273"><span class="hs-identifier hs-var">fvs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn -&gt; FreeVars -&gt; (FreeVars, FreeVars)
</span><a href="#local-6989586621681131272"><span class="hs-identifier hs-var">stmtRefs</span></a></span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131279"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131278"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1796"></span><span>
</span><span id="line-1797"></span><span>    </span><span id="local-6989586621681131274"><span class="annot"><span class="annottext">chunter :: FreeVars
-&gt; [(ExprLStmt GhcRn, FreeVars)]
-&gt; ([(ExprLStmt GhcRn, FreeVars)], [(ExprLStmt GhcRn, FreeVars)])
</span><a href="#local-6989586621681131274"><span class="hs-identifier hs-var hs-var">chunter</span></a></span></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1798"></span><span>    </span><span class="annot"><a href="#local-6989586621681131274"><span class="hs-identifier hs-var">chunter</span></a></span><span> </span><span id="local-6989586621681131271"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131271"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681131270"><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131270"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131269"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131269"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681131268"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131268"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1799"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#isEmptyNameSet"><span class="hs-identifier hs-var">isEmptyNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131271"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1800"></span><span>       </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn -&gt; Bool
</span><a href="#local-6989586621681131267"><span class="hs-identifier hs-var">isStrictPatternBind</span></a></span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131270"><span class="hs-identifier hs-var">stmt</span></a></span><span>
</span><span id="line-1801"></span><span>           </span><span class="hs-comment">-- See Note [ApplicativeDo and strict patterns]</span><span>
</span><span id="line-1802"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131270"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131269"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars)
-&gt; [(ExprLStmt GhcRn, FreeVars)] -&gt; [(ExprLStmt GhcRn, FreeVars)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131266"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131265"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1803"></span><span>       </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131266"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131266"><span class="hs-identifier hs-var">chunk</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131265"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131265"><span class="hs-identifier hs-var">rest'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
-&gt; [(ExprLStmt GhcRn, FreeVars)]
-&gt; ([(ExprLStmt GhcRn, FreeVars)], [(ExprLStmt GhcRn, FreeVars)])
</span><a href="#local-6989586621681131274"><span class="hs-identifier hs-var">chunter</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131264"><span class="hs-identifier hs-var">vars'</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131268"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1804"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621681131263"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131263"><span class="hs-identifier hs-var">pvars</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131262"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131262"><span class="hs-identifier hs-var">evars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn -&gt; FreeVars -&gt; (FreeVars, FreeVars)
</span><a href="#local-6989586621681131272"><span class="hs-identifier hs-var">stmtRefs</span></a></span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131270"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131269"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1805"></span><span>             </span><span id="local-6989586621681131264"><span class="annot"><span class="annottext">vars' :: FreeVars
</span><a href="#local-6989586621681131264"><span class="hs-identifier hs-var hs-var">vars'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131271"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#minusNameSet"><span class="hs-operator hs-var">`minusNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131263"><span class="hs-identifier hs-var">pvars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unionNameSet"><span class="hs-operator hs-var">`unionNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131262"><span class="hs-identifier hs-var">evars</span></a></span><span>
</span><span id="line-1806"></span><span>    </span><span class="annot"><a href="#local-6989586621681131274"><span class="hs-identifier hs-var">chunter</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131260"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131260"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131260"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1807"></span><span>
</span><span id="line-1808"></span><span>    </span><span id="local-6989586621681131272"><span class="annot"><span class="annottext">stmtRefs :: ExprLStmt GhcRn -&gt; FreeVars -&gt; (FreeVars, FreeVars)
</span><a href="#local-6989586621681131272"><span class="hs-identifier hs-var hs-var">stmtRefs</span></a></span></span><span> </span><span id="local-6989586621681131259"><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131259"><span class="hs-identifier hs-var">stmt</span></a></span></span><span> </span><span id="local-6989586621681131258"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131258"><span class="hs-identifier hs-var">fvs</span></a></span></span><span>
</span><span id="line-1809"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn -&gt; Bool
forall a b. LStmt a b -&gt; Bool
</span><a href="GHC.Rename.Expr.html#isLetStmt"><span class="hs-identifier hs-var">isLetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131259"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131257"><span class="hs-identifier hs-var">pvars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131256"><span class="hs-identifier hs-var">fvs'</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#minusNameSet"><span class="hs-operator hs-var">`minusNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131257"><span class="hs-identifier hs-var">pvars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1810"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131257"><span class="hs-identifier hs-var">pvars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131256"><span class="hs-identifier hs-var">fvs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1811"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681131256"><span class="annot"><span class="annottext">fvs' :: FreeVars
</span><a href="#local-6989586621681131256"><span class="hs-identifier hs-var hs-var">fvs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131258"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#intersectNameSet"><span class="hs-operator hs-var">`intersectNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131292"><span class="hs-identifier hs-var">allvars</span></a></span><span>
</span><span id="line-1812"></span><span>            </span><span id="local-6989586621681131257"><span class="annot"><span class="annottext">pvars :: FreeVars
</span><a href="#local-6989586621681131257"><span class="hs-identifier hs-var hs-var">pvars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StmtLR GhcRn GhcRn (LHsExpr GhcRn) -&gt; [IdP GhcRn]
forall (idL :: Pass) (idR :: Pass) body.
CollectPass (GhcPass idL) =&gt;
StmtLR (GhcPass idL) (GhcPass idR) body -&gt; [IdP (GhcPass idL)]
</span><a href="GHC.Hs.Utils.html#collectStmtBinders"><span class="hs-identifier hs-var">collectStmtBinders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprLStmt GhcRn -&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn)
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131259"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1813"></span><span>
</span><span id="line-1814"></span><span>    </span><span class="annot"><a href="#local-6989586621681131267"><span class="hs-identifier hs-type">isStrictPatternBind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1815"></span><span>    </span><span id="local-6989586621681131267"><span class="annot"><span class="annottext">isStrictPatternBind :: ExprLStmt GhcRn -&gt; Bool
</span><a href="#local-6989586621681131267"><span class="hs-identifier hs-var hs-var">isStrictPatternBind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBindStmt GhcRn GhcRn (LHsExpr GhcRn)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131255"><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131255"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcRn -&gt; Bool
forall (p :: Pass). LPat (GhcPass p) -&gt; Bool
</span><a href="GHC.Rename.Expr.html#isStrictPattern"><span class="hs-identifier hs-var">isStrictPattern</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131255"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1816"></span><span>    </span><span class="annot"><a href="#local-6989586621681131267"><span class="hs-identifier hs-var">isStrictPatternBind</span></a></span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1817"></span><span>
</span><span id="line-1818"></span><span class="hs-comment">{-
Note [ApplicativeDo and strict patterns]

A strict pattern match is really a dependency.  For example,

do
  (x,y) &lt;- A
  z &lt;- B
  return C

The pattern (_,_) must be matched strictly before we do B.  If we
allowed this to be transformed into

  (\(x,y) -&gt; \z -&gt; C) &lt;$&gt; A &lt;*&gt; B

then it could be lazier than the standard desuraging using &gt;&gt;=.  See #13875
for more examples.

Thus, whenever we have a strict pattern match, we treat it as a
dependency between that statement and the following one.  The
dependency prevents those two statements from being performed &quot;in
parallel&quot; in an ApplicativeStmt, but doesn't otherwise affect what we
can do with the rest of the statements in the same &quot;do&quot; expression.
-}</span><span>
</span><span id="line-1842"></span><span>
</span><span id="line-1843"></span><span id="local-6989586621681133294"><span class="annot"><a href="GHC.Rename.Expr.html#isStrictPattern"><span class="hs-identifier hs-type">isStrictPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Pat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133294"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-1844"></span><span id="isStrictPattern"><span class="annot"><span class="annottext">isStrictPattern :: forall (p :: Pass). LPat (GhcPass p) -&gt; Bool
</span><a href="GHC.Rename.Expr.html#isStrictPattern"><span class="hs-identifier hs-var hs-var">isStrictPattern</span></a></span></span><span> </span><span id="local-6989586621681131254"><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131254"><span class="hs-identifier hs-var">lpat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1845"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpan (Pat (GhcPass p)) -&gt; Pat (GhcPass p)
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpan (Pat (GhcPass p))
LPat (GhcPass p)
</span><a href="#local-6989586621681131254"><span class="hs-identifier hs-var">lpat</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1846"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#WildPat"><span class="hs-identifier hs-type">WildPat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1847"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#VarPat"><span class="hs-identifier hs-type">VarPat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1848"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#LazyPat"><span class="hs-identifier hs-type">LazyPat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1849"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#AsPat"><span class="hs-identifier hs-type">AsPat</span></a></span><span> </span><span class="annot"><span class="annottext">XAsPat (GhcPass p)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Located (IdP (GhcPass p))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131249"><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131249"><span class="hs-identifier hs-var">p</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LPat (GhcPass p) -&gt; Bool
forall (p :: Pass). LPat (GhcPass p) -&gt; Bool
</span><a href="GHC.Rename.Expr.html#isStrictPattern"><span class="hs-identifier hs-var">isStrictPattern</span></a></span><span> </span><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131249"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1850"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#ParPat"><span class="hs-identifier hs-type">ParPat</span></a></span><span> </span><span class="annot"><span class="annottext">XParPat (GhcPass p)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131247"><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131247"><span class="hs-identifier hs-var">p</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LPat (GhcPass p) -&gt; Bool
forall (p :: Pass). LPat (GhcPass p) -&gt; Bool
</span><a href="GHC.Rename.Expr.html#isStrictPattern"><span class="hs-identifier hs-var">isStrictPattern</span></a></span><span> </span><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131247"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1851"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#ViewPat"><span class="hs-identifier hs-type">ViewPat</span></a></span><span> </span><span class="annot"><span class="annottext">XViewPat (GhcPass p)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass p)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131245"><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131245"><span class="hs-identifier hs-var">p</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LPat (GhcPass p) -&gt; Bool
forall (p :: Pass). LPat (GhcPass p) -&gt; Bool
</span><a href="GHC.Rename.Expr.html#isStrictPattern"><span class="hs-identifier hs-var">isStrictPattern</span></a></span><span> </span><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131245"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1852"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#SigPat"><span class="hs-identifier hs-type">SigPat</span></a></span><span> </span><span class="annot"><span class="annottext">XSigPat (GhcPass p)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131243"><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131243"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsPatSigType (NoGhcTc (GhcPass p))
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LPat (GhcPass p) -&gt; Bool
forall (p :: Pass). LPat (GhcPass p) -&gt; Bool
</span><a href="GHC.Rename.Expr.html#isStrictPattern"><span class="hs-identifier hs-var">isStrictPattern</span></a></span><span> </span><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131243"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1853"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#BangPat"><span class="hs-identifier hs-type">BangPat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1854"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#ListPat"><span class="hs-identifier hs-type">ListPat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1855"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#TuplePat"><span class="hs-identifier hs-type">TuplePat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1856"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#SumPat"><span class="hs-identifier hs-type">SumPat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1857"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#ConPat"><span class="hs-identifier hs-type">ConPat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1858"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#LitPat"><span class="hs-identifier hs-type">LitPat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1859"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#NPat"><span class="hs-identifier hs-type">NPat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1860"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#NPlusKPat"><span class="hs-identifier hs-type">NPlusKPat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1861"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#SplicePat"><span class="hs-identifier hs-type">SplicePat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1862"></span><span>    </span><span class="annot"><a href="GHC.Hs.Pat.html#XPat"><span class="hs-identifier hs-type">XPat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;isStrictPattern: XPat&quot;</span></span><span>
</span><span id="line-1863"></span><span>
</span><span id="line-1864"></span><span class="hs-comment">{-
Note [ApplicativeDo and refutable patterns]

Refutable patterns in do blocks are desugared to use the monadic 'fail' operation.
This means that sometimes an applicative block needs to be wrapped in 'join' simply because
of a refutable pattern, in order for the types to work out.

-}</span><span>
</span><span id="line-1872"></span><span>
</span><span id="line-1873"></span><span class="annot"><a href="GHC.Rename.Expr.html#hasRefutablePattern"><span class="hs-identifier hs-type">hasRefutablePattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeArg"><span class="hs-identifier hs-type">ApplicativeArg</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1874"></span><span id="hasRefutablePattern"><span class="annot"><span class="annottext">hasRefutablePattern :: DynFlags -&gt; ApplicativeArg GhcRn -&gt; Bool
</span><a href="GHC.Rename.Expr.html#hasRefutablePattern"><span class="hs-identifier hs-var hs-var">hasRefutablePattern</span></a></span></span><span> </span><span id="local-6989586621681131232"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131232"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeArgOne"><span class="hs-identifier hs-type">ApplicativeArgOne</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">app_arg_pattern :: forall idL. ApplicativeArg idL -&gt; LPat idL
</span><a href="GHC.Hs.Expr.html#app_arg_pattern"><span class="hs-identifier hs-var">app_arg_pattern</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681131231"><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131231"><span class="hs-identifier hs-var">pat</span></a></span></span><span>
</span><span id="line-1875"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">is_body_stmt :: forall idL. ApplicativeArg idL -&gt; Bool
</span><a href="GHC.Hs.Expr.html#is_body_stmt"><span class="hs-identifier hs-var">is_body_stmt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1876"></span><span>                                         </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; LPat GhcRn -&gt; Bool
forall (p :: Pass).
OutputableBndrId p =&gt;
DynFlags -&gt; LPat (GhcPass p) -&gt; Bool
</span><a href="GHC.Hs.Pat.html#isIrrefutableHsPat"><span class="hs-identifier hs-var">isIrrefutableHsPat</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131232"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcRn
</span><a href="#local-6989586621681131231"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1877"></span><span class="annot"><a href="GHC.Rename.Expr.html#hasRefutablePattern"><span class="hs-identifier hs-var">hasRefutablePattern</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ApplicativeArg GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1878"></span><span>
</span><span id="line-1879"></span><span id="local-6989586621681133278"><span id="local-6989586621681133279"><span class="annot"><a href="GHC.Rename.Expr.html#isLetStmt"><span class="hs-identifier hs-type">isLetStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133279"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133278"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-1880"></span><span id="isLetStmt"><span class="annot"><span class="annottext">isLetStmt :: forall a b. LStmt a b -&gt; Bool
</span><a href="GHC.Rename.Expr.html#isLetStmt"><span class="hs-identifier hs-var hs-var">isLetStmt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1881"></span><span class="annot"><a href="GHC.Rename.Expr.html#isLetStmt"><span class="hs-identifier hs-var">isLetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpan (StmtLR a a b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1882"></span><span>
</span><span id="line-1883"></span><span class="hs-comment">-- | Find a &quot;good&quot; place to insert a bind in an indivisible segment.</span><span>
</span><span id="line-1884"></span><span class="hs-comment">-- This is the only place where we use heuristics.  The current</span><span>
</span><span id="line-1885"></span><span class="hs-comment">-- heuristic is to peel off the first group of independent statements</span><span>
</span><span id="line-1886"></span><span class="hs-comment">-- and put the bind after those.</span><span>
</span><span id="line-1887"></span><span class="annot"><a href="GHC.Rename.Expr.html#splitSegment"><span class="hs-identifier hs-type">splitSegment</span></a></span><span>
</span><span id="line-1888"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1889"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1890"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1891"></span><span id="splitSegment"><span class="annot"><span class="annottext">splitSegment :: [(ExprLStmt GhcRn, FreeVars)]
-&gt; ([(ExprLStmt GhcRn, FreeVars)], [(ExprLStmt GhcRn, FreeVars)])
</span><a href="GHC.Rename.Expr.html#splitSegment"><span class="hs-identifier hs-var hs-var">splitSegment</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681131229"><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131229"><span class="hs-identifier hs-var">one</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131228"><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131228"><span class="hs-identifier hs-var">two</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131229"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131228"><span class="hs-identifier hs-var">two</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1892"></span><span>  </span><span class="hs-comment">-- there is no choice when there are only two statements; this just saves</span><span>
</span><span id="line-1893"></span><span>  </span><span class="hs-comment">-- some work in a common case.</span><span>
</span><span id="line-1894"></span><span class="annot"><a href="GHC.Rename.Expr.html#splitSegment"><span class="hs-identifier hs-var">splitSegment</span></a></span><span> </span><span id="local-6989586621681131227"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131227"><span class="hs-identifier hs-var">stmts</span></a></span></span><span>
</span><span id="line-1895"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131226"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131226"><span class="hs-identifier hs-var">lets</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131225"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131225"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681131224"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131224"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
-&gt; Maybe
     ([(ExprLStmt GhcRn, FreeVars)], [(ExprLStmt GhcRn, FreeVars)],
      [(ExprLStmt GhcRn, FreeVars)])
forall (body :: * -&gt; *).
[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; Maybe
     ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
      [(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
      [(LStmt GhcRn (Located (body GhcRn)), FreeVars)])
</span><a href="GHC.Rename.Expr.html#slurpIndependentStmts"><span class="hs-identifier hs-var">slurpIndependentStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131227"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-1896"></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131226"><span class="hs-identifier hs-var">lets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1897"></span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131226"><span class="hs-identifier hs-var">lets</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131225"><span class="hs-identifier hs-var">binds</span></a></span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
-&gt; [(ExprLStmt GhcRn, FreeVars)] -&gt; [(ExprLStmt GhcRn, FreeVars)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131224"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1898"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131226"><span class="hs-identifier hs-var">lets</span></a></span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
-&gt; [(ExprLStmt GhcRn, FreeVars)] -&gt; [(ExprLStmt GhcRn, FreeVars)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131225"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131224"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1899"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1900"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131227"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1901"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681131222"><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131222"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681131221"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131221"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">(ExprLStmt GhcRn, FreeVars)
</span><a href="#local-6989586621681131222"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131221"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1902"></span><span>      </span><span id="local-6989586621681131220"><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131220"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ExprLStmt GhcRn, FreeVars)]
</span><a href="#local-6989586621681131227"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1903"></span><span>
</span><span id="line-1904"></span><span id="local-6989586621681133266"><span class="annot"><a href="GHC.Rename.Expr.html#slurpIndependentStmts"><span class="hs-identifier hs-type">slurpIndependentStmts</span></a></span><span>
</span><span id="line-1905"></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133266"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1906"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133266"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- LetStmts</span><span>
</span><span id="line-1907"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133266"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- BindStmts</span><span>
</span><span id="line-1908"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133266"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span></span><span>
</span><span id="line-1909"></span><span id="slurpIndependentStmts"><span class="annot"><span class="annottext">slurpIndependentStmts :: forall (body :: * -&gt; *).
[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; Maybe
     ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
      [(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
      [(LStmt GhcRn (Located (body GhcRn)), FreeVars)])
</span><a href="GHC.Rename.Expr.html#slurpIndependentStmts"><span class="hs-identifier hs-var hs-var">slurpIndependentStmts</span></a></span></span><span> </span><span id="local-6989586621681131212"><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681131212"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; FreeVars
-&gt; [(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
-&gt; Maybe
     ([(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
      [(LStmt GhcRn (Located (body GhcRn)), FreeVars)],
      [(LStmt GhcRn (Located (body GhcRn)), FreeVars)])
forall {p :: Pass} {idR} {body} {idR} {body} {l}.
(CollectPass (GhcPass p),
 XBindStmt (GhcPass p) idR body ~ XBindStmt (GhcPass p) idR body,
 IdGhcP p ~ Name,
 XLetStmt (GhcPass p) idR body ~ XLetStmt (GhcPass p) idR body) =&gt;
[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; FreeVars
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; Maybe
     ([(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
      [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
      [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)])
</span><a href="#local-6989586621681131211"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">[(LStmt GhcRn (Located (body GhcRn)), FreeVars)]
</span><a href="#local-6989586621681131212"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-1910"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1911"></span><span>  </span><span class="hs-comment">-- If we encounter a BindStmt that doesn't depend on a previous BindStmt</span><span>
</span><span id="line-1912"></span><span>  </span><span class="hs-comment">-- in this group, then add it to the group. We have to be careful about</span><span>
</span><span id="line-1913"></span><span>  </span><span class="hs-comment">-- strict patterns though; splitSegments expects that if we return Just</span><span>
</span><span id="line-1914"></span><span>  </span><span class="hs-comment">-- then we have actually done some splitting. Otherwise it will go into</span><span>
</span><span id="line-1915"></span><span>  </span><span class="hs-comment">-- an infinite loop (#14163).</span><span>
</span><span id="line-1916"></span><span>  </span><span id="local-6989586621681131211"><span class="annot"><span class="annottext">go :: [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; FreeVars
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; Maybe
     ([(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
      [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
      [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)])
</span><a href="#local-6989586621681131211"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681131194"><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131194"><span class="hs-identifier hs-var">lets</span></a></span></span><span> </span><span id="local-6989586621681131193"><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131193"><span class="hs-identifier hs-var">indep</span></a></span></span><span> </span><span id="local-6989586621681131192"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131192"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131191"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621681131191"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span id="local-6989586621681131190"><span class="annot"><span class="annottext">XBindStmt (GhcPass p) idR body
</span><a href="#local-6989586621681131190"><span class="hs-identifier hs-var">xbs</span></a></span></span><span> </span><span id="local-6989586621681131189"><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131189"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681131188"><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621681131188"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131187"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131187"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681131186"><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131186"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1917"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#disjointNameSet"><span class="hs-identifier hs-var">disjointNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131192"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131187"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LPat (GhcPass p) -&gt; Bool
forall (p :: Pass). LPat (GhcPass p) -&gt; Bool
</span><a href="GHC.Rename.Expr.html#isStrictPattern"><span class="hs-identifier hs-var">isStrictPattern</span></a></span><span> </span><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131189"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1918"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; FreeVars
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; Maybe
     ([(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
      [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
      [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)])
</span><a href="#local-6989586621681131211"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131194"><span class="hs-identifier hs-var">lets</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">l
-&gt; StmtLR (GhcPass p) idR body
-&gt; GenLocated l (StmtLR (GhcPass p) idR body)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621681131191"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XBindStmt (GhcPass p) idR body
-&gt; LPat (GhcPass p) -&gt; body -&gt; StmtLR (GhcPass p) idR body
forall idL idR body.
XBindStmt idL idR body -&gt; LPat idL -&gt; body -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBindStmt (GhcPass p) idR body
XBindStmt (GhcPass p) idR body
</span><a href="#local-6989586621681131190"><span class="hs-identifier hs-var">xbs</span></a></span><span> </span><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131189"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621681131188"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131187"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131193"><span class="hs-identifier hs-var">indep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1919"></span><span>         </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131185"><span class="hs-identifier hs-var">bndrs'</span></a></span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131186"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1920"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681131185"><span class="annot"><span class="annottext">bndrs' :: FreeVars
</span><a href="#local-6989586621681131185"><span class="hs-identifier hs-var hs-var">bndrs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131192"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unionNameSet"><span class="hs-operator hs-var">`unionNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LPat (GhcPass p) -&gt; [IdP (GhcPass p)]
forall p. CollectPass p =&gt; LPat p -&gt; [IdP p]
</span><a href="GHC.Hs.Utils.html#collectPatBinders"><span class="hs-identifier hs-var">collectPatBinders</span></a></span><span> </span><span class="annot"><span class="annottext">LPat (GhcPass p)
</span><a href="#local-6989586621681131189"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1921"></span><span>  </span><span class="hs-comment">-- If we encounter a LetStmt that doesn't depend on a BindStmt in this</span><span>
</span><span id="line-1922"></span><span>  </span><span class="hs-comment">-- group, then move it to the beginning, so that it doesn't interfere with</span><span>
</span><span id="line-1923"></span><span>  </span><span class="hs-comment">-- grouping more BindStmts.</span><span>
</span><span id="line-1924"></span><span>  </span><span class="hs-comment">-- TODO: perhaps we shouldn't do this if there are any strict bindings,</span><span>
</span><span id="line-1925"></span><span>  </span><span class="hs-comment">-- because we might be moving evaluation earlier.</span><span>
</span><span id="line-1926"></span><span>  </span><span class="annot"><a href="#local-6989586621681131211"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681131184"><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131184"><span class="hs-identifier hs-var">lets</span></a></span></span><span> </span><span id="local-6989586621681131183"><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131183"><span class="hs-identifier hs-var">indep</span></a></span></span><span> </span><span id="local-6989586621681131182"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131182"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131181"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621681131181"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span id="local-6989586621681131180"><span class="annot"><span class="annottext">XLetStmt (GhcPass p) idR body
</span><a href="#local-6989586621681131180"><span class="hs-identifier hs-var">noExtField</span></a></span></span><span> </span><span id="local-6989586621681131179"><span class="annot"><span class="annottext">LHsLocalBindsLR (GhcPass p) idR
</span><a href="#local-6989586621681131179"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131178"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131178"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681131177"><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131177"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1927"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#disjointNameSet"><span class="hs-identifier hs-var">disjointNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131182"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131178"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1928"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; FreeVars
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; Maybe
     ([(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
      [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
      [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)])
</span><a href="#local-6989586621681131211"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">l
-&gt; StmtLR (GhcPass p) idR body
-&gt; GenLocated l (StmtLR (GhcPass p) idR body)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621681131181"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLetStmt (GhcPass p) idR body
-&gt; LHsLocalBindsLR (GhcPass p) idR -&gt; StmtLR (GhcPass p) idR body
forall idL idR body.
XLetStmt idL idR body
-&gt; LHsLocalBindsLR idL idR -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLetStmt (GhcPass p) idR body
XLetStmt (GhcPass p) idR body
</span><a href="#local-6989586621681131180"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">LHsLocalBindsLR (GhcPass p) idR
</span><a href="#local-6989586621681131179"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131178"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131184"><span class="hs-identifier hs-var">lets</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131183"><span class="hs-identifier hs-var">indep</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131182"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131177"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1929"></span><span>  </span><span class="annot"><a href="#local-6989586621681131211"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe
  ([(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
   [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
   [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)])
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1930"></span><span>  </span><span class="annot"><a href="#local-6989586621681131211"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe
  ([(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
   [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
   [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)])
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1931"></span><span>  </span><span class="annot"><a href="#local-6989586621681131211"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681131176"><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131176"><span class="hs-identifier hs-var">lets</span></a></span></span><span> </span><span id="local-6989586621681131175"><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131175"><span class="hs-identifier hs-var">indep</span></a></span></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131174"><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131174"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
 [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
 [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)])
-&gt; Maybe
     ([(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
      [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)],
      [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)])
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131176"><span class="hs-identifier hs-var">lets</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
-&gt; [(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131175"><span class="hs-identifier hs-var">indep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(GenLocated l (StmtLR (GhcPass p) idR body), FreeVars)]
</span><a href="#local-6989586621681131174"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1932"></span><span>
</span><span id="line-1933"></span><span class="hs-comment">-- | Build an ApplicativeStmt, and strip the &quot;return&quot; from the tail</span><span>
</span><span id="line-1934"></span><span class="hs-comment">-- if necessary.</span><span>
</span><span id="line-1935"></span><span class="hs-comment">--</span><span>
</span><span id="line-1936"></span><span class="hs-comment">-- For example, if we start with</span><span>
</span><span id="line-1937"></span><span class="hs-comment">--   do x &lt;- E1; y &lt;- E2; return (f x y)</span><span>
</span><span id="line-1938"></span><span class="hs-comment">-- then we get</span><span>
</span><span id="line-1939"></span><span class="hs-comment">--   do (E1[x] | E2[y]); f x y</span><span>
</span><span id="line-1940"></span><span class="hs-comment">--</span><span>
</span><span id="line-1941"></span><span class="hs-comment">-- the LastStmt in this case has the return removed, but we set the</span><span>
</span><span id="line-1942"></span><span class="hs-comment">-- flag on the LastStmt to indicate this, so that we can print out the</span><span>
</span><span id="line-1943"></span><span class="hs-comment">-- original statement correctly in error messages.  It is easier to do</span><span>
</span><span id="line-1944"></span><span class="hs-comment">-- it this way rather than try to ignore the return later in both the</span><span>
</span><span id="line-1945"></span><span class="hs-comment">-- typechecker and the desugarer (I tried it that way first!).</span><span>
</span><span id="line-1946"></span><span class="annot"><a href="GHC.Rename.Expr.html#mkApplicativeStmt"><span class="hs-identifier hs-type">mkApplicativeStmt</span></a></span><span>
</span><span id="line-1947"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-1948"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeArg"><span class="hs-identifier hs-type">ApplicativeArg</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>             </span><span class="hs-comment">-- ^ The args</span><span>
</span><span id="line-1949"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>                               </span><span class="hs-comment">-- ^ True &lt;=&gt; need a join</span><span>
</span><span id="line-1950"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- ^ The body statements</span><span>
</span><span id="line-1951"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1952"></span><span id="mkApplicativeStmt"><span class="annot"><span class="annottext">mkApplicativeStmt :: HsStmtContext GhcRn
-&gt; [ApplicativeArg GhcRn]
-&gt; Bool
-&gt; [ExprLStmt GhcRn]
-&gt; RnM ([ExprLStmt GhcRn], FreeVars)
</span><a href="GHC.Rename.Expr.html#mkApplicativeStmt"><span class="hs-identifier hs-var hs-var">mkApplicativeStmt</span></a></span></span><span> </span><span id="local-6989586621681131173"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131173"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131172"><span class="annot"><span class="annottext">[ApplicativeArg GhcRn]
</span><a href="#local-6989586621681131172"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621681131171"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131171"><span class="hs-identifier hs-var">need_join</span></a></span></span><span> </span><span id="local-6989586621681131170"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131170"><span class="hs-identifier hs-var">body_stmts</span></a></span></span><span>
</span><span id="line-1953"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131169"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131169"><span class="hs-identifier hs-var">fmap_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131168"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131168"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupQualifiedDoStmtName"><span class="hs-identifier hs-var">lookupQualifiedDoStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131173"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#fmapName"><span class="hs-identifier hs-var">fmapName</span></a></span><span>
</span><span id="line-1954"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131167"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131167"><span class="hs-identifier hs-var">ap_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131166"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131166"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupQualifiedDoStmtName"><span class="hs-identifier hs-var">lookupQualifiedDoStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131173"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#apAName"><span class="hs-identifier hs-var">apAName</span></a></span><span>
</span><span id="line-1955"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131164"><span class="annot"><span class="annottext">Maybe SyntaxExprRn
</span><a href="#local-6989586621681131164"><span class="hs-identifier hs-var">mb_join</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131163"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131163"><span class="hs-identifier hs-var">fvs3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1956"></span><span>           </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131171"><span class="hs-identifier hs-var">need_join</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-1957"></span><span>             </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131162"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131162"><span class="hs-identifier hs-var">join_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131161"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131161"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#lookupQualifiedDoStmtName"><span class="hs-identifier hs-var">lookupQualifiedDoStmtName</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131173"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#joinMName"><span class="hs-identifier hs-var">joinMName</span></a></span><span>
</span><span id="line-1958"></span><span>                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(Maybe SyntaxExprRn, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe SyntaxExprRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntaxExprRn -&gt; Maybe SyntaxExprRn
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131162"><span class="hs-identifier hs-var">join_op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131161"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1959"></span><span>           </span><span class="hs-keyword">else</span><span>
</span><span id="line-1960"></span><span>             </span><span class="annot"><span class="annottext">(Maybe SyntaxExprRn, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe SyntaxExprRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe SyntaxExprRn
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1961"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681131159"><span class="annot"><span class="annottext">applicative_stmt :: ExprLStmt GhcRn
</span><a href="#local-6989586621681131159"><span class="hs-identifier hs-var hs-var">applicative_stmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StmtLR GhcRn GhcRn (LHsExpr GhcRn) -&gt; ExprLStmt GhcRn
forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">(StmtLR GhcRn GhcRn (LHsExpr GhcRn) -&gt; ExprLStmt GhcRn)
-&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn) -&gt; ExprLStmt GhcRn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">XApplicativeStmt GhcRn GhcRn (LHsExpr GhcRn)
-&gt; [(SyntaxExpr GhcRn, ApplicativeArg GhcRn)]
-&gt; Maybe (SyntaxExpr GhcRn)
-&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn)
forall idL idR body.
XApplicativeStmt idL idR body
-&gt; [(SyntaxExpr idR, ApplicativeArg idL)]
-&gt; Maybe (SyntaxExpr idR)
-&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#ApplicativeStmt"><span class="hs-identifier hs-var">ApplicativeStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XApplicativeStmt GhcRn GhcRn (LHsExpr GhcRn)
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span>
</span><span id="line-1962"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SyntaxExprRn]
-&gt; [ApplicativeArg GhcRn] -&gt; [(SyntaxExprRn, ApplicativeArg GhcRn)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../base/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131169"><span class="hs-identifier hs-var">fmap_op</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExprRn -&gt; [SyntaxExprRn] -&gt; [SyntaxExprRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExprRn -&gt; [SyntaxExprRn]
forall a. a -&gt; [a]
</span><a href="../../base/src/GHC.List.html#repeat"><span class="hs-identifier hs-var">repeat</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131167"><span class="hs-identifier hs-var">ap_op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ApplicativeArg GhcRn]
</span><a href="#local-6989586621681131172"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1963"></span><span>               </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcRn)
Maybe SyntaxExprRn
</span><a href="#local-6989586621681131164"><span class="hs-identifier hs-var">mb_join</span></a></span><span>
</span><span id="line-1964"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">([ExprLStmt GhcRn], FreeVars) -&gt; RnM ([ExprLStmt GhcRn], FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn
</span><a href="#local-6989586621681131159"><span class="hs-identifier hs-var">applicative_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">ExprLStmt GhcRn -&gt; [ExprLStmt GhcRn] -&gt; [ExprLStmt GhcRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131170"><span class="hs-identifier hs-var">body_stmts</span></a></span><span>
</span><span id="line-1965"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131168"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131166"><span class="hs-identifier hs-var">fvs2</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131163"><span class="hs-identifier hs-var">fvs3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1966"></span><span>
</span><span id="line-1967"></span><span class="hs-comment">-- | Given the statements following an ApplicativeStmt, determine whether</span><span>
</span><span id="line-1968"></span><span class="hs-comment">-- we need a @join@ or not, and remove the @return@ if necessary.</span><span>
</span><span id="line-1969"></span><span class="annot"><a href="GHC.Rename.Expr.html#needJoin"><span class="hs-identifier hs-type">needJoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#MonadNames"><span class="hs-identifier hs-type">MonadNames</span></a></span><span>
</span><span id="line-1970"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1971"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1972"></span><span id="needJoin"><span class="annot"><span class="annottext">needJoin :: MonadNames -&gt; [ExprLStmt GhcRn] -&gt; (Bool, [ExprLStmt GhcRn])
</span><a href="GHC.Rename.Expr.html#needJoin"><span class="hs-identifier hs-var hs-var">needJoin</span></a></span></span><span> </span><span id="local-6989586621681131158"><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131158"><span class="hs-identifier hs-var">_monad_names</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- we're in an ApplicativeArg</span><span>
</span><span id="line-1973"></span><span class="annot"><a href="GHC.Rename.Expr.html#needJoin"><span class="hs-identifier hs-var">needJoin</span></a></span><span> </span><span id="local-6989586621681131157"><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131157"><span class="hs-identifier hs-var">monad_names</span></a></span></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131156"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131156"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-type">LastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLastStmt GhcRn GhcRn (LHsExpr GhcRn)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131155"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131155"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131154"><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><a href="#local-6989586621681131154"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1974"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131153"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131153"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131152"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131152"><span class="hs-identifier hs-var">wasDollar</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MonadNames -&gt; LHsExpr GhcRn -&gt; Maybe (LHsExpr GhcRn, Bool)
</span><a href="GHC.Rename.Expr.html#isReturnApp"><span class="hs-identifier hs-var">isReturnApp</span></a></span><span> </span><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131157"><span class="hs-identifier hs-var">monad_names</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131155"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1975"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SrcSpan -&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn) -&gt; ExprLStmt GhcRn
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131156"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLastStmt GhcRn GhcRn (LHsExpr GhcRn)
-&gt; LHsExpr GhcRn
-&gt; Maybe Bool
-&gt; SyntaxExpr GhcRn
-&gt; StmtLR GhcRn GhcRn (LHsExpr GhcRn)
forall idL idR body.
XLastStmt idL idR body
-&gt; body -&gt; Maybe Bool -&gt; SyntaxExpr idR -&gt; StmtLR idL idR body
</span><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XLastStmt GhcRn GhcRn (LHsExpr GhcRn)
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131153"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131152"><span class="hs-identifier hs-var">wasDollar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><a href="#local-6989586621681131154"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1976"></span><span class="annot"><a href="GHC.Rename.Expr.html#needJoin"><span class="hs-identifier hs-var">needJoin</span></a></span><span> </span><span id="local-6989586621681131150"><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131150"><span class="hs-identifier hs-var">_monad_names</span></a></span></span><span> </span><span id="local-6989586621681131149"><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131149"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcRn]
</span><a href="#local-6989586621681131149"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1977"></span><span>
</span><span id="line-1978"></span><span class="hs-comment">-- | @(Just e, False)@, if the expression is @return e@</span><span>
</span><span id="line-1979"></span><span class="hs-comment">--   @(Just e, True)@ if the expression is @return $ e@,</span><span>
</span><span id="line-1980"></span><span class="hs-comment">--   otherwise @Nothing@.</span><span>
</span><span id="line-1981"></span><span class="annot"><a href="GHC.Rename.Expr.html#isReturnApp"><span class="hs-identifier hs-type">isReturnApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#MonadNames"><span class="hs-identifier hs-type">MonadNames</span></a></span><span>
</span><span id="line-1982"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-1983"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-1984"></span><span id="isReturnApp"><span class="annot"><span class="annottext">isReturnApp :: MonadNames -&gt; LHsExpr GhcRn -&gt; Maybe (LHsExpr GhcRn, Bool)
</span><a href="GHC.Rename.Expr.html#isReturnApp"><span class="hs-identifier hs-var hs-var">isReturnApp</span></a></span></span><span> </span><span id="local-6989586621681131148"><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131148"><span class="hs-identifier hs-var">monad_names</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131147"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131147"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonadNames -&gt; LHsExpr GhcRn -&gt; Maybe (LHsExpr GhcRn, Bool)
</span><a href="GHC.Rename.Expr.html#isReturnApp"><span class="hs-identifier hs-var">isReturnApp</span></a></span><span> </span><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131148"><span class="hs-identifier hs-var">monad_names</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131147"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1985"></span><span class="annot"><a href="GHC.Rename.Expr.html#isReturnApp"><span class="hs-identifier hs-var">isReturnApp</span></a></span><span> </span><span id="local-6989586621681131146"><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131146"><span class="hs-identifier hs-var">monad_names</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131145"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131145"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131145"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1986"></span><span>  </span><span class="annot"><a href="GHC.Hs.Expr.html#OpApp"><span class="hs-identifier hs-type">OpApp</span></a></span><span> </span><span class="annot"><span class="annottext">XOpApp GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131144"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131144"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681131143"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131143"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621681131142"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131142"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; Bool
</span><a href="#local-6989586621681131141"><span class="hs-identifier hs-var">is_return</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131144"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; Bool
</span><a href="#local-6989586621681131140"><span class="hs-identifier hs-var">is_dollar</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131143"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LHsExpr GhcRn, Bool) -&gt; Maybe (LHsExpr GhcRn, Bool)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131142"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1987"></span><span>  </span><span class="annot"><a href="GHC.Hs.Expr.html#HsApp"><span class="hs-identifier hs-type">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">XApp GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131139"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131139"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681131138"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131138"><span class="hs-identifier hs-var">arg</span></a></span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; Bool
</span><a href="#local-6989586621681131141"><span class="hs-identifier hs-var">is_return</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131139"><span class="hs-identifier hs-var">f</span></a></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LHsExpr GhcRn, Bool) -&gt; Maybe (LHsExpr GhcRn, Bool)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681131138"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-1988"></span><span>  </span><span id="local-6989586621681131137"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131137"><span class="hs-identifier hs-var">_otherwise</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (LHsExpr GhcRn, Bool)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1989"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1990"></span><span>  </span><span id="local-6989586621681131136"><span class="annot"><span class="annottext">is_var :: (IdP p -&gt; Bool) -&gt; LHsExpr p -&gt; Bool
</span><a href="#local-6989586621681131136"><span class="hs-identifier hs-var hs-var">is_var</span></a></span></span><span> </span><span id="local-6989586621681131135"><span class="annot"><span class="annottext">IdP p -&gt; Bool
</span><a href="#local-6989586621681131135"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131134"><span class="annot"><span class="annottext">LHsExpr p
</span><a href="#local-6989586621681131134"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IdP p -&gt; Bool) -&gt; LHsExpr p -&gt; Bool
</span><a href="#local-6989586621681131136"><span class="hs-identifier hs-var">is_var</span></a></span><span> </span><span class="annot"><span class="annottext">IdP p -&gt; Bool
</span><a href="#local-6989586621681131135"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr p
</span><a href="#local-6989586621681131134"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1991"></span><span>  </span><span class="annot"><a href="#local-6989586621681131136"><span class="hs-identifier hs-var">is_var</span></a></span><span> </span><span id="local-6989586621681131133"><span class="annot"><span class="annottext">IdP p -&gt; Bool
</span><a href="#local-6989586621681131133"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsAppType"><span class="hs-identifier hs-type">HsAppType</span></a></span><span> </span><span class="annot"><span class="annottext">XAppTypeE p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131132"><span class="annot"><span class="annottext">LHsExpr p
</span><a href="#local-6989586621681131132"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsWcType (NoGhcTc p)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IdP p -&gt; Bool) -&gt; LHsExpr p -&gt; Bool
</span><a href="#local-6989586621681131136"><span class="hs-identifier hs-var">is_var</span></a></span><span> </span><span class="annot"><span class="annottext">IdP p -&gt; Bool
</span><a href="#local-6989586621681131133"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr p
</span><a href="#local-6989586621681131132"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1992"></span><span>  </span><span class="annot"><a href="#local-6989586621681131136"><span class="hs-identifier hs-var">is_var</span></a></span><span> </span><span id="local-6989586621681131131"><span class="annot"><span class="annottext">IdP p -&gt; Bool
</span><a href="#local-6989586621681131131"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131130"><span class="annot"><span class="annottext">IdP p
</span><a href="#local-6989586621681131130"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP p -&gt; Bool
</span><a href="#local-6989586621681131131"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IdP p
</span><a href="#local-6989586621681131130"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1993"></span><span>       </span><span class="hs-comment">-- TODO: I don't know how to get this right for rebindable syntax</span><span>
</span><span id="line-1994"></span><span>  </span><span class="annot"><a href="#local-6989586621681131136"><span class="hs-identifier hs-var">is_var</span></a></span><span> </span><span class="annot"><span class="annottext">IdP p -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1995"></span><span>
</span><span id="line-1996"></span><span>  </span><span id="local-6989586621681131141"><span class="annot"><span class="annottext">is_return :: LHsExpr GhcRn -&gt; Bool
</span><a href="#local-6989586621681131141"><span class="hs-identifier hs-var hs-var">is_return</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IdP GhcRn -&gt; Bool) -&gt; LHsExpr GhcRn -&gt; Bool
forall {p}. (IdP p -&gt; Bool) -&gt; LHsExpr p -&gt; Bool
</span><a href="#local-6989586621681131136"><span class="hs-identifier hs-var">is_var</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681131129"><span class="annot"><span class="annottext">IdP GhcRn
</span><a href="#local-6989586621681131129"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
IdP GhcRn
</span><a href="#local-6989586621681131129"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">MonadNames -&gt; Name
</span><a href="GHC.Rename.Expr.html#return_name"><span class="hs-identifier hs-var hs-var">return_name</span></a></span><span> </span><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131146"><span class="hs-identifier hs-var">monad_names</span></a></span><span>
</span><span id="line-1997"></span><span>                         </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Name
IdP GhcRn
</span><a href="#local-6989586621681131129"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">MonadNames -&gt; Name
</span><a href="GHC.Rename.Expr.html#pure_name"><span class="hs-identifier hs-var hs-var">pure_name</span></a></span><span> </span><span class="annot"><span class="annottext">MonadNames
</span><a href="#local-6989586621681131146"><span class="hs-identifier hs-var">monad_names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1998"></span><span>  </span><span id="local-6989586621681131140"><span class="annot"><span class="annottext">is_dollar :: LHsExpr GhcRn -&gt; Bool
</span><a href="#local-6989586621681131140"><span class="hs-identifier hs-var hs-var">is_dollar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IdP GhcRn -&gt; Bool) -&gt; LHsExpr GhcRn -&gt; Bool
forall {p}. (IdP p -&gt; Bool) -&gt; LHsExpr p -&gt; Bool
</span><a href="#local-6989586621681131136"><span class="hs-identifier hs-var">is_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IdP GhcRn -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#dollarIdKey"><span class="hs-identifier hs-var">dollarIdKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1999"></span><span>
</span><span id="line-2000"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsubsection{Errors}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2007"></span><span>
</span><span id="line-2008"></span><span class="annot"><a href="GHC.Rename.Expr.html#checkEmptyStmts"><span class="hs-identifier hs-type">checkEmptyStmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2009"></span><span class="hs-comment">-- We've seen an empty sequence of Stmts... is that ok?</span><span>
</span><span id="line-2010"></span><span id="checkEmptyStmts"><span class="annot"><span class="annottext">checkEmptyStmts :: HsStmtContext GhcRn -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Expr.html#checkEmptyStmts"><span class="hs-identifier hs-var hs-var">checkEmptyStmts</span></a></span></span><span> </span><span id="local-6989586621681131122"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131122"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>
</span><span id="line-2011"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Bool
forall id. HsStmtContext id -&gt; Bool
</span><a href="GHC.Rename.Expr.html#okEmpty"><span class="hs-identifier hs-var">okEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131122"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; MsgDoc
</span><a href="GHC.Rename.Expr.html#emptyErr"><span class="hs-identifier hs-var">emptyErr</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131122"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2012"></span><span>
</span><span id="line-2013"></span><span id="local-6989586621681131119"><span class="annot"><a href="GHC.Rename.Expr.html#okEmpty"><span class="hs-identifier hs-type">okEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681131119"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-2014"></span><span id="okEmpty"><span class="annot"><span class="annottext">okEmpty :: forall id. HsStmtContext id -&gt; Bool
</span><a href="GHC.Rename.Expr.html#okEmpty"><span class="hs-identifier hs-var hs-var">okEmpty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#PatGuard"><span class="hs-identifier hs-type">PatGuard</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2015"></span><span class="annot"><a href="GHC.Rename.Expr.html#okEmpty"><span class="hs-identifier hs-var">okEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext a
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2016"></span><span>
</span><span id="line-2017"></span><span class="annot"><a href="GHC.Rename.Expr.html#emptyErr"><span class="hs-identifier hs-type">emptyErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-2018"></span><span id="emptyErr"><span class="annot"><span class="annottext">emptyErr :: HsStmtContext GhcRn -&gt; MsgDoc
</span><a href="GHC.Rename.Expr.html#emptyErr"><span class="hs-identifier hs-var hs-var">emptyErr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmtCtxt"><span class="hs-identifier hs-type">ParStmtCtxt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty statement group in parallel comprehension&quot;</span></span><span>
</span><span id="line-2019"></span><span class="annot"><a href="GHC.Rename.Expr.html#emptyErr"><span class="hs-identifier hs-var">emptyErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#TransStmtCtxt"><span class="hs-identifier hs-type">TransStmtCtxt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty statement group preceding 'group' or 'then'&quot;</span></span><span>
</span><span id="line-2020"></span><span class="annot"><a href="GHC.Rename.Expr.html#emptyErr"><span class="hs-identifier hs-var">emptyErr</span></a></span><span> </span><span id="local-6989586621681131117"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131117"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty&quot;</span></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; MsgDoc
forall id. Outputable (IdP id) =&gt; HsStmtContext id -&gt; MsgDoc
</span><a href="GHC.Hs.Expr.html#pprStmtContext"><span class="hs-identifier hs-var">pprStmtContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131117"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-2021"></span><span>
</span><span id="line-2022"></span><span class="hs-comment">----------------------</span><span>
</span><span id="line-2023"></span><span id="local-6989586621681133478"><span class="annot"><a href="GHC.Rename.Expr.html#checkLastStmt"><span class="hs-identifier hs-type">checkLastStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133478"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-2024"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133478"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2025"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133478"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-2026"></span><span id="checkLastStmt"><span class="annot"><span class="annottext">checkLastStmt :: forall (body :: * -&gt; *).
Outputable (body GhcPs) =&gt;
HsStmtContext GhcRn
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; RnM (LStmt GhcPs (Located (body GhcPs)))
</span><a href="GHC.Rename.Expr.html#checkLastStmt"><span class="hs-identifier hs-var hs-var">checkLastStmt</span></a></span></span><span> </span><span id="local-6989586621681131097"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131097"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131096"><span class="annot"><span class="annottext">lstmt :: LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131096"><span class="hs-identifier hs-var">lstmt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681131095"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131095"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681131094"><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131094"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2027"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131097"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2028"></span><span>      </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#ListComp"><span class="hs-identifier hs-var">ListComp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RnM (LStmt GhcPs (Located (body GhcPs)))
</span><a href="#local-6989586621681131093"><span class="hs-identifier hs-var">check_comp</span></a></span><span>
</span><span id="line-2029"></span><span>      </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#MonadComp"><span class="hs-identifier hs-var">MonadComp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RnM (LStmt GhcPs (Located (body GhcPs)))
</span><a href="#local-6989586621681131093"><span class="hs-identifier hs-var">check_comp</span></a></span><span>
</span><span id="line-2030"></span><span>      </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#ArrowExpr"><span class="hs-identifier hs-var">ArrowExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RnM (LStmt GhcPs (Located (body GhcPs)))
</span><a href="#local-6989586621681131092"><span class="hs-identifier hs-var">check_do</span></a></span><span>
</span><span id="line-2031"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#DoExpr"><span class="hs-identifier hs-type">DoExpr</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RnM (LStmt GhcPs (Located (body GhcPs)))
</span><a href="#local-6989586621681131092"><span class="hs-identifier hs-var">check_do</span></a></span><span>
</span><span id="line-2032"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#MDoExpr"><span class="hs-identifier hs-type">MDoExpr</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RnM (LStmt GhcPs (Located (body GhcPs)))
</span><a href="#local-6989586621681131092"><span class="hs-identifier hs-var">check_do</span></a></span><span>
</span><span id="line-2033"></span><span>      </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RnM (LStmt GhcPs (Located (body GhcPs)))
</span><a href="#local-6989586621681131091"><span class="hs-identifier hs-var">check_other</span></a></span><span>
</span><span id="line-2034"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2035"></span><span>    </span><span id="local-6989586621681131092"><span class="annot"><span class="annottext">check_do :: RnM (LStmt GhcPs (Located (body GhcPs)))
</span><a href="#local-6989586621681131092"><span class="hs-identifier hs-var hs-var">check_do</span></a></span></span><span>    </span><span class="hs-comment">-- Expect BodyStmt, and change it to LastStmt</span><span>
</span><span id="line-2036"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131094"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2037"></span><span>          </span><span class="annot"><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-type">BodyStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBodyStmt GhcPs GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131090"><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681131090"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
-&gt; RnM (LStmt GhcPs (Located (body GhcPs)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
-&gt; StmtLR GhcPs GhcPs (Located (body GhcPs))
-&gt; LStmt GhcPs (Located (body GhcPs))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681131095"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located (body GhcPs) -&gt; StmtLR GhcPs GhcPs (Located (body GhcPs))
forall (idR :: Pass) (bodyR :: * -&gt; *) (idL :: Pass).
IsPass idR =&gt;
Located (bodyR (GhcPass idR))
-&gt; StmtLR
     (GhcPass idL) (GhcPass idR) (Located (bodyR (GhcPass idR)))
</span><a href="GHC.Hs.Utils.html#mkLastStmt"><span class="hs-identifier hs-var">mkLastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Located (body GhcPs)
</span><a href="#local-6989586621681131090"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2038"></span><span>          </span><span class="annot"><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-type">LastStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
-&gt; RnM (LStmt GhcPs (Located (body GhcPs)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131096"><span class="hs-identifier hs-var">lstmt</span></a></span><span>   </span><span class="hs-comment">-- &quot;Deriving&quot; clauses may generate a</span><span>
</span><span id="line-2039"></span><span>                                             </span><span class="hs-comment">-- LastStmt directly (unlike the parser)</span><span>
</span><span id="line-2040"></span><span>          </span><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MsgDoc -&gt; Int -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="annot"><span class="annottext">MsgDoc
</span><a href="#local-6989586621681131088"><span class="hs-identifier hs-var">last_error</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs)) -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131094"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
-&gt; RnM (LStmt GhcPs (Located (body GhcPs)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131096"><span class="hs-identifier hs-var">lstmt</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2041"></span><span>    </span><span id="local-6989586621681131088"><span class="annot"><span class="annottext">last_error :: MsgDoc
</span><a href="#local-6989586621681131088"><span class="hs-identifier hs-var hs-var">last_error</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The last statement in&quot;</span></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; MsgDoc
forall id. Outputable (IdP id) =&gt; HsStmtContext id -&gt; MsgDoc
</span><a href="GHC.Hs.Expr.html#pprAStmtContext"><span class="hs-identifier hs-var">pprAStmtContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131097"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-2042"></span><span>                  </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;must be an expression&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2043"></span><span>
</span><span id="line-2044"></span><span>    </span><span id="local-6989586621681131093"><span class="annot"><span class="annottext">check_comp :: RnM (LStmt GhcPs (Located (body GhcPs)))
</span><a href="#local-6989586621681131093"><span class="hs-identifier hs-var hs-var">check_comp</span></a></span></span><span>  </span><span class="hs-comment">-- Expect LastStmt; this should be enforced by the parser!</span><span>
</span><span id="line-2045"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131094"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2046"></span><span>          </span><span class="annot"><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-type">LastStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
-&gt; RnM (LStmt GhcPs (Located (body GhcPs)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131096"><span class="hs-identifier hs-var">lstmt</span></a></span><span>
</span><span id="line-2047"></span><span>          </span><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc -&gt; RnM (LStmt GhcPs (Located (body GhcPs)))
forall a. HasCallStack =&gt; String -&gt; MsgDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;checkLastStmt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs)) -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131096"><span class="hs-identifier hs-var">lstmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2048"></span><span>
</span><span id="line-2049"></span><span>    </span><span id="local-6989586621681131091"><span class="annot"><span class="annottext">check_other :: RnM (LStmt GhcPs (Located (body GhcPs)))
</span><a href="#local-6989586621681131091"><span class="hs-identifier hs-var hs-var">check_other</span></a></span></span><span> </span><span class="hs-comment">-- Behave just as if this wasn't the last stmt</span><span>
</span><span id="line-2050"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall (body :: * -&gt; *).
HsStmtContext GhcRn
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Expr.html#checkStmt"><span class="hs-identifier hs-var">checkStmt</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131097"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131096"><span class="hs-identifier hs-var">lstmt</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
-&gt; RnM (LStmt GhcPs (Located (body GhcPs)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">LStmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131096"><span class="hs-identifier hs-var">lstmt</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2051"></span><span>
</span><span id="line-2052"></span><span class="hs-comment">-- Checking when a particular Stmt is ok</span><span>
</span><span id="line-2053"></span><span id="local-6989586621681133473"><span class="annot"><a href="GHC.Rename.Expr.html#checkStmt"><span class="hs-identifier hs-type">checkStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-2054"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133473"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2055"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-2056"></span><span id="checkStmt"><span class="annot"><span class="annottext">checkStmt :: forall (body :: * -&gt; *).
HsStmtContext GhcRn
-&gt; LStmt GhcPs (Located (body GhcPs))
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Expr.html#checkStmt"><span class="hs-identifier hs-var hs-var">checkStmt</span></a></span></span><span> </span><span id="local-6989586621681131082"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131082"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131081"><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131081"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2057"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681131080"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131080"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-2058"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; HsStmtContext GhcRn
-&gt; StmtLR GhcPs GhcPs (Located (body GhcPs))
-&gt; Validity
forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okStmt"><span class="hs-identifier hs-var">okStmt</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131080"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131082"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131081"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2059"></span><span>           </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2060"></span><span>           </span><span class="annot"><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-type">NotValid</span></a></span><span> </span><span id="local-6989586621681131076"><span class="annot"><span class="annottext">MsgDoc
</span><a href="#local-6989586621681131076"><span class="hs-identifier hs-var">extra</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MsgDoc
</span><a href="#local-6989586621681131075"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">MsgDoc
</span><a href="#local-6989586621681131076"><span class="hs-identifier hs-var">extra</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2061"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2062"></span><span>   </span><span id="local-6989586621681131075"><span class="annot"><span class="annottext">msg :: MsgDoc
</span><a href="#local-6989586621681131075"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MsgDoc] -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unexpected&quot;</span></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs)) -&gt; MsgDoc
forall (a :: Pass) body. Stmt (GhcPass a) body -&gt; MsgDoc
</span><a href="GHC.Rename.Expr.html#pprStmtCat"><span class="hs-identifier hs-var">pprStmtCat</span></a></span><span> </span><span class="annot"><span class="annottext">StmtLR GhcPs GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131081"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PtrString -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; PtrString
</span><a href="GHC.Data.FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;statement&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2063"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;in&quot;</span></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; MsgDoc
forall id. Outputable (IdP id) =&gt; HsStmtContext id -&gt; MsgDoc
</span><a href="GHC.Hs.Expr.html#pprAStmtContext"><span class="hs-identifier hs-var">pprAStmtContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131082"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2064"></span><span>
</span><span id="line-2065"></span><span id="local-6989586621681133242"><span id="local-6989586621681133243"><span class="annot"><a href="GHC.Rename.Expr.html#pprStmtCat"><span class="hs-identifier hs-type">pprStmtCat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133243"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681133242"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span></span></span><span>
</span><span id="line-2066"></span><span id="pprStmtCat"><span class="annot"><span class="annottext">pprStmtCat :: forall (a :: Pass) body. Stmt (GhcPass a) body -&gt; MsgDoc
</span><a href="GHC.Rename.Expr.html#pprStmtCat"><span class="hs-identifier hs-var hs-var">pprStmtCat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#TransStmt"><span class="hs-identifier hs-type">TransStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span>
</span><span id="line-2067"></span><span class="annot"><a href="GHC.Rename.Expr.html#pprStmtCat"><span class="hs-identifier hs-var">pprStmtCat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-type">LastStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;return expression&quot;</span></span><span>
</span><span id="line-2068"></span><span class="annot"><a href="GHC.Rename.Expr.html#pprStmtCat"><span class="hs-identifier hs-var">pprStmtCat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-type">BodyStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;body&quot;</span></span><span>
</span><span id="line-2069"></span><span class="annot"><a href="GHC.Rename.Expr.html#pprStmtCat"><span class="hs-identifier hs-var">pprStmtCat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;binding&quot;</span></span><span>
</span><span id="line-2070"></span><span class="annot"><a href="GHC.Rename.Expr.html#pprStmtCat"><span class="hs-identifier hs-var">pprStmtCat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;let&quot;</span></span><span>
</span><span id="line-2071"></span><span class="annot"><a href="GHC.Rename.Expr.html#pprStmtCat"><span class="hs-identifier hs-var">pprStmtCat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#RecStmt"><span class="hs-identifier hs-type">RecStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rec&quot;</span></span><span>
</span><span id="line-2072"></span><span class="annot"><a href="GHC.Rename.Expr.html#pprStmtCat"><span class="hs-identifier hs-var">pprStmtCat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmt"><span class="hs-identifier hs-type">ParStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;parallel&quot;</span></span><span>
</span><span id="line-2073"></span><span class="annot"><a href="GHC.Rename.Expr.html#pprStmtCat"><span class="hs-identifier hs-var">pprStmtCat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeStmt"><span class="hs-identifier hs-type">ApplicativeStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pprStmtCat: ApplicativeStmt&quot;</span></span><span>
</span><span id="line-2074"></span><span>
</span><span id="line-2075"></span><span class="hs-comment">------------</span><span>
</span><span id="line-2076"></span><span class="annot"><a href="GHC.Rename.Expr.html#emptyInvalid"><span class="hs-identifier hs-type">emptyInvalid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span>  </span><span class="hs-comment">-- Payload is the empty document</span><span>
</span><span id="line-2077"></span><span id="emptyInvalid"><span class="annot"><span class="annottext">emptyInvalid :: Validity
</span><a href="GHC.Rename.Expr.html#emptyInvalid"><span class="hs-identifier hs-var hs-var">emptyInvalid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; Validity
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="annot"><span class="annottext">MsgDoc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">Outputable.empty</span></a></span><span>
</span><span id="line-2078"></span><span>
</span><span id="line-2079"></span><span id="local-6989586621681133244"><span class="annot"><a href="GHC.Rename.Expr.html#okStmt"><span class="hs-identifier hs-type">okStmt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#okDoStmt"><span class="hs-identifier hs-type">okDoStmt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#okCompStmt"><span class="hs-identifier hs-type">okCompStmt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#okParStmt"><span class="hs-identifier hs-type">okParStmt</span></a></span><span>
</span><span id="line-2080"></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-2081"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133244"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span></span><span>
</span><span id="line-2082"></span><span class="hs-comment">-- Return Nothing if OK, (Just extra) if not ok</span><span>
</span><span id="line-2083"></span><span class="hs-comment">-- The &quot;extra&quot; is an SDoc that is appended to a generic error message</span><span>
</span><span id="line-2084"></span><span>
</span><span id="line-2085"></span><span id="okStmt"><span class="annot"><span class="annottext">okStmt :: forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okStmt"><span class="hs-identifier hs-var hs-var">okStmt</span></a></span></span><span> </span><span id="local-6989586621681131065"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131065"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681131064"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131064"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131063"><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131063"><span class="hs-identifier hs-var">stmt</span></a></span></span><span>
</span><span id="line-2086"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131064"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2087"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#PatGuard"><span class="hs-identifier hs-type">PatGuard</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs)) -&gt; Validity
forall (body :: * -&gt; *).
Stmt GhcPs (Located (body GhcPs)) -&gt; Validity
</span><a href="GHC.Rename.Expr.html#okPatGuardStmt"><span class="hs-identifier hs-var">okPatGuardStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131063"><span class="hs-identifier hs-var">stmt</span></a></span><span>
</span><span id="line-2088"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmtCtxt"><span class="hs-identifier hs-type">ParStmtCtxt</span></a></span><span> </span><span id="local-6989586621681131061"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131061"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okParStmt"><span class="hs-identifier hs-var">okParStmt</span></a></span><span>  </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131065"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131061"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131063"><span class="hs-identifier hs-var">stmt</span></a></span><span>
</span><span id="line-2089"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#DoExpr"><span class="hs-identifier hs-type">DoExpr</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okDoStmt"><span class="hs-identifier hs-var">okDoStmt</span></a></span><span>   </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131065"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131064"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131063"><span class="hs-identifier hs-var">stmt</span></a></span><span>
</span><span id="line-2090"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#MDoExpr"><span class="hs-identifier hs-type">MDoExpr</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okDoStmt"><span class="hs-identifier hs-var">okDoStmt</span></a></span><span>   </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131065"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131064"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131063"><span class="hs-identifier hs-var">stmt</span></a></span><span>
</span><span id="line-2091"></span><span>      </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#ArrowExpr"><span class="hs-identifier hs-var">ArrowExpr</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okDoStmt"><span class="hs-identifier hs-var">okDoStmt</span></a></span><span>   </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131065"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131064"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131063"><span class="hs-identifier hs-var">stmt</span></a></span><span>
</span><span id="line-2092"></span><span>      </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#GhciStmtCtxt"><span class="hs-identifier hs-var">GhciStmtCtxt</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okDoStmt"><span class="hs-identifier hs-var">okDoStmt</span></a></span><span>   </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131065"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131064"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131063"><span class="hs-identifier hs-var">stmt</span></a></span><span>
</span><span id="line-2093"></span><span>      </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#ListComp"><span class="hs-identifier hs-var">ListComp</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okCompStmt"><span class="hs-identifier hs-var">okCompStmt</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131065"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131064"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131063"><span class="hs-identifier hs-var">stmt</span></a></span><span>
</span><span id="line-2094"></span><span>      </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#MonadComp"><span class="hs-identifier hs-var">MonadComp</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okCompStmt"><span class="hs-identifier hs-var">okCompStmt</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131065"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131064"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131063"><span class="hs-identifier hs-var">stmt</span></a></span><span>
</span><span id="line-2095"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#TransStmtCtxt"><span class="hs-identifier hs-type">TransStmtCtxt</span></a></span><span> </span><span id="local-6989586621681131060"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131060"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okStmt"><span class="hs-identifier hs-var">okStmt</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131065"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131060"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131063"><span class="hs-identifier hs-var">stmt</span></a></span><span>
</span><span id="line-2096"></span><span>
</span><span id="line-2097"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-2098"></span><span id="local-6989586621681133237"><span class="annot"><a href="GHC.Rename.Expr.html#okPatGuardStmt"><span class="hs-identifier hs-type">okPatGuardStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681133237"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span></span><span>
</span><span id="line-2099"></span><span id="okPatGuardStmt"><span class="annot"><span class="annottext">okPatGuardStmt :: forall (body :: * -&gt; *).
Stmt GhcPs (Located (body GhcPs)) -&gt; Validity
</span><a href="GHC.Rename.Expr.html#okPatGuardStmt"><span class="hs-identifier hs-var hs-var">okPatGuardStmt</span></a></span></span><span> </span><span id="local-6989586621681131059"><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131059"><span class="hs-identifier hs-var">stmt</span></a></span></span><span>
</span><span id="line-2100"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131059"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2101"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-type">BodyStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2102"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2103"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2104"></span><span>      </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Rename.Expr.html#emptyInvalid"><span class="hs-identifier hs-var">emptyInvalid</span></a></span><span>
</span><span id="line-2105"></span><span>
</span><span id="line-2106"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-2107"></span><span id="okParStmt"><span class="annot"><span class="annottext">okParStmt :: forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okParStmt"><span class="hs-identifier hs-var hs-var">okParStmt</span></a></span></span><span> </span><span id="local-6989586621681131058"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131058"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681131057"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131057"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131056"><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131056"><span class="hs-identifier hs-var">stmt</span></a></span></span><span>
</span><span id="line-2108"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131056"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2109"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLetStmt GhcPs GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#HsIPBinds"><span class="hs-identifier hs-type">HsIPBinds</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Rename.Expr.html#emptyInvalid"><span class="hs-identifier hs-var">emptyInvalid</span></a></span><span>
</span><span id="line-2110"></span><span>      </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okStmt"><span class="hs-identifier hs-var">okStmt</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131058"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131057"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131056"><span class="hs-identifier hs-var">stmt</span></a></span><span>
</span><span id="line-2111"></span><span>
</span><span id="line-2112"></span><span class="hs-comment">----------------</span><span>
</span><span id="line-2113"></span><span id="okDoStmt"><span class="annot"><span class="annottext">okDoStmt :: forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okDoStmt"><span class="hs-identifier hs-var hs-var">okDoStmt</span></a></span></span><span> </span><span id="local-6989586621681131055"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131055"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681131054"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131054"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681131053"><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131053"><span class="hs-identifier hs-var">stmt</span></a></span></span><span>
</span><span id="line-2114"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131053"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2115"></span><span>       </span><span class="annot"><a href="GHC.Hs.Expr.html#RecStmt"><span class="hs-identifier hs-type">RecStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-2116"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#RecursiveDo"><span class="hs-identifier hs-var">LangExt.RecursiveDo</span></a></span><span> </span><span class="annot"><span class="annottext">Extension -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#xopt"><span class="hs-operator hs-var">`xopt`</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131055"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2117"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="GHC.Hs.Expr.html#ArrowExpr"><span class="hs-identifier hs-var">ArrowExpr</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131054"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>    </span><span class="hs-comment">-- Arrows allows 'rec'</span><span>
</span><span id="line-2118"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; Validity
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Use RecursiveDo&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2119"></span><span>       </span><span class="annot"><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2120"></span><span>       </span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2121"></span><span>       </span><span class="annot"><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-type">BodyStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2122"></span><span>       </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Rename.Expr.html#emptyInvalid"><span class="hs-identifier hs-var">emptyInvalid</span></a></span><span>
</span><span id="line-2123"></span><span>
</span><span id="line-2124"></span><span class="hs-comment">----------------</span><span>
</span><span id="line-2125"></span><span id="okCompStmt"><span class="annot"><span class="annottext">okCompStmt :: forall (body :: * -&gt; *).
DynFlags
-&gt; HsStmtContext GhcRn
-&gt; Stmt GhcPs (Located (body GhcPs))
-&gt; Validity
</span><a href="GHC.Rename.Expr.html#okCompStmt"><span class="hs-identifier hs-var hs-var">okCompStmt</span></a></span></span><span> </span><span id="local-6989586621681131051"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131051"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681131050"><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131050"><span class="hs-identifier hs-var">stmt</span></a></span></span><span>
</span><span id="line-2126"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stmt GhcPs (Located (body GhcPs))
</span><a href="#local-6989586621681131050"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2127"></span><span>       </span><span class="annot"><a href="GHC.Hs.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2128"></span><span>       </span><span class="annot"><a href="GHC.Hs.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2129"></span><span>       </span><span class="annot"><a href="GHC.Hs.Expr.html#BodyStmt"><span class="hs-identifier hs-type">BodyStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2130"></span><span>       </span><span class="annot"><a href="GHC.Hs.Expr.html#ParStmt"><span class="hs-identifier hs-type">ParStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-2131"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#ParallelListComp"><span class="hs-identifier hs-var">LangExt.ParallelListComp</span></a></span><span> </span><span class="annot"><span class="annottext">Extension -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#xopt"><span class="hs-operator hs-var">`xopt`</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131051"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2132"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; Validity
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Use ParallelListComp&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2133"></span><span>       </span><span class="annot"><a href="GHC.Hs.Expr.html#TransStmt"><span class="hs-identifier hs-type">TransStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-2134"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#TransformListComp"><span class="hs-identifier hs-var">LangExt.TransformListComp</span></a></span><span> </span><span class="annot"><span class="annottext">Extension -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#xopt"><span class="hs-operator hs-var">`xopt`</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131051"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2135"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; Validity
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Use TransformListComp&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2136"></span><span>       </span><span class="annot"><a href="GHC.Hs.Expr.html#RecStmt"><span class="hs-identifier hs-type">RecStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Rename.Expr.html#emptyInvalid"><span class="hs-identifier hs-var">emptyInvalid</span></a></span><span>
</span><span id="line-2137"></span><span>       </span><span class="annot"><a href="GHC.Hs.Expr.html#LastStmt"><span class="hs-identifier hs-type">LastStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Rename.Expr.html#emptyInvalid"><span class="hs-identifier hs-var">emptyInvalid</span></a></span><span>  </span><span class="hs-comment">-- Should not happen (dealt with by checkLastStmt)</span><span>
</span><span id="line-2138"></span><span>       </span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeStmt"><span class="hs-identifier hs-type">ApplicativeStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validity
</span><a href="GHC.Rename.Expr.html#emptyInvalid"><span class="hs-identifier hs-var">emptyInvalid</span></a></span><span>
</span><span id="line-2139"></span><span>
</span><span id="line-2140"></span><span class="hs-comment">---------</span><span>
</span><span id="line-2141"></span><span class="annot"><a href="GHC.Rename.Expr.html#checkTupleSection"><span class="hs-identifier hs-type">checkTupleSection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.Expr.html#LHsTupArg"><span class="hs-identifier hs-type">LHsTupArg</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2142"></span><span id="checkTupleSection"><span class="annot"><span class="annottext">checkTupleSection :: [LHsTupArg GhcPs] -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Expr.html#checkTupleSection"><span class="hs-identifier hs-var hs-var">checkTupleSection</span></a></span></span><span> </span><span id="local-6989586621681131047"><span class="annot"><span class="annottext">[LHsTupArg GhcPs]
</span><a href="#local-6989586621681131047"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-2143"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681131046"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131046"><span class="hs-identifier hs-var">tuple_section</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#TupleSections"><span class="hs-identifier hs-var">LangExt.TupleSections</span></a></span><span>
</span><span id="line-2144"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; MsgDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#checkErr"><span class="hs-identifier hs-var">checkErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LHsTupArg GhcPs -&gt; Bool) -&gt; [LHsTupArg GhcPs] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">LHsTupArg GhcPs -&gt; Bool
forall id. LHsTupArg id -&gt; Bool
</span><a href="GHC.Hs.Expr.html#tupArgPresent"><span class="hs-identifier hs-var">tupArgPresent</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsTupArg GhcPs]
</span><a href="#local-6989586621681131047"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131046"><span class="hs-identifier hs-var">tuple_section</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MsgDoc
</span><a href="#local-6989586621681131042"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2145"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2146"></span><span>    </span><span id="local-6989586621681131042"><span class="annot"><span class="annottext">msg :: MsgDoc
</span><a href="#local-6989586621681131042"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal tuple section: use TupleSections&quot;</span></span><span>
</span><span id="line-2147"></span><span>
</span><span id="line-2148"></span><span class="hs-comment">---------</span><span>
</span><span id="line-2149"></span><span class="annot"><a href="GHC.Rename.Expr.html#sectionErr"><span class="hs-identifier hs-type">sectionErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-2150"></span><span id="sectionErr"><span class="annot"><span class="annottext">sectionErr :: HsExpr GhcPs -&gt; MsgDoc
</span><a href="GHC.Rename.Expr.html#sectionErr"><span class="hs-identifier hs-var hs-var">sectionErr</span></a></span></span><span> </span><span id="local-6989586621681131041"><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681131041"><span class="hs-identifier hs-var">expr</span></a></span></span><span>
</span><span id="line-2151"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; Int -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A section must be enclosed in parentheses&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2152"></span><span>       </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;thus:&quot;</span></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621681131041"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2153"></span><span>
</span><span id="line-2154"></span><span id="local-6989586621681133370"><span class="annot"><a href="GHC.Rename.Expr.html#badIpBinds"><span class="hs-identifier hs-type">badIpBinds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133370"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681133370"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span></span><span>
</span><span id="line-2155"></span><span id="badIpBinds"><span class="annot"><span class="annottext">badIpBinds :: forall a. Outputable a =&gt; MsgDoc -&gt; a -&gt; MsgDoc
</span><a href="GHC.Rename.Expr.html#badIpBinds"><span class="hs-identifier hs-var hs-var">badIpBinds</span></a></span></span><span> </span><span id="local-6989586621681131038"><span class="annot"><span class="annottext">MsgDoc
</span><a href="#local-6989586621681131038"><span class="hs-identifier hs-var">what</span></a></span></span><span> </span><span id="local-6989586621681131037"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131037"><span class="hs-identifier hs-var">binds</span></a></span></span><span>
</span><span id="line-2156"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; Int -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Implicit-parameter bindings illegal in&quot;</span></span><span> </span><span class="annot"><span class="annottext">MsgDoc -&gt; MsgDoc -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MsgDoc
</span><a href="#local-6989586621681131038"><span class="hs-identifier hs-var">what</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2157"></span><span>         </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; MsgDoc
forall a. Outputable a =&gt; a -&gt; MsgDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681131037"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2158"></span><span>
</span><span id="line-2159"></span><span class="hs-comment">---------</span><span>
</span><span id="line-2160"></span><span>
</span><span id="line-2161"></span><span class="annot"><a href="GHC.Rename.Expr.html#monadFailOp"><span class="hs-identifier hs-type">monadFailOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Pat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-2162"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-2163"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#FailOperator"><span class="hs-identifier hs-type">FailOperator</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2164"></span><span id="monadFailOp"><span class="annot"><span class="annottext">monadFailOp :: LPat GhcPs
-&gt; HsStmtContext GhcRn -&gt; RnM (Maybe (SyntaxExpr GhcRn), FreeVars)
</span><a href="GHC.Rename.Expr.html#monadFailOp"><span class="hs-identifier hs-var hs-var">monadFailOp</span></a></span></span><span> </span><span id="local-6989586621681131035"><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621681131035"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681131034"><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131034"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2165"></span><span>    </span><span id="local-6989586621681131033"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131033"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-2166"></span><span>        </span><span class="hs-comment">-- If the pattern is irrefutable (e.g.: wildcard, tuple, ~pat, etc.)</span><span>
</span><span id="line-2167"></span><span>        </span><span class="hs-comment">-- we should not need to fail.</span><span>
</span><span id="line-2168"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; LPat GhcPs -&gt; Bool
forall (p :: Pass).
OutputableBndrId p =&gt;
DynFlags -&gt; LPat (GhcPass p) -&gt; Bool
</span><a href="GHC.Hs.Pat.html#isIrrefutableHsPat"><span class="hs-identifier hs-var">isIrrefutableHsPat</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681131033"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621681131035"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe SyntaxExprRn, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe SyntaxExprRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe SyntaxExprRn
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2169"></span><span>
</span><span id="line-2170"></span><span>        </span><span class="hs-comment">-- For non-monadic contexts (e.g. guard patterns, list</span><span>
</span><span id="line-2171"></span><span>        </span><span class="hs-comment">-- comprehensions, etc.) we should not need to fail, or failure is handled in</span><span>
</span><span id="line-2172"></span><span>        </span><span class="hs-comment">-- a different way. See Note [Failing pattern matches in Stmts].</span><span>
</span><span id="line-2173"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; Bool
forall id. HsStmtContext id -&gt; Bool
</span><a href="GHC.Hs.Expr.html#isMonadStmtContext"><span class="hs-identifier hs-var">isMonadStmtContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131034"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe SyntaxExprRn, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe SyntaxExprRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe SyntaxExprRn
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2174"></span><span>
</span><span id="line-2175"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn -&gt; RnM (Maybe (SyntaxExpr GhcRn), FreeVars)
forall p.
HsStmtContext p -&gt; RnM (Maybe (SyntaxExpr GhcRn), FreeVars)
</span><a href="GHC.Rename.Expr.html#getMonadFailOp"><span class="hs-identifier hs-var">getMonadFailOp</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext GhcRn
</span><a href="#local-6989586621681131034"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-2176"></span><span>
</span><span id="line-2177"></span><span class="hs-comment">{-
Note [Monad fail : Rebindable syntax, overloaded strings]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Given the code
  foo x = do { Just y &lt;- x; return y }

we expect it to desugar as
  foo x = x &gt;&gt;= \r -&gt; case r of
                        Just y  -&gt; return y
                        Nothing -&gt; fail &quot;Pattern match error&quot;

But with RebindableSyntax and OverloadedStrings, we really want
it to desugar thus:
  foo x = x &gt;&gt;= \r -&gt; case r of
                        Just y  -&gt; return y
                        Nothing -&gt; fail (fromString &quot;Patterm match error&quot;)

So, in this case, we synthesize the function
  \x -&gt; fail (fromString x)

(rather than plain 'fail') for the 'fail' operation. This is done in
'getMonadFailOp'.

Similarly with QualifiedDo and OverloadedStrings, we also want to desugar
using fromString:

  foo x = M.do { Just y &lt;- x; return y }

  ===&gt;

  foo x = x M.&gt;&gt;= \r -&gt; case r of
                        Just y  -&gt; return y
                        Nothing -&gt; M.fail (fromString &quot;Pattern match error&quot;)

-}</span><span>
</span><span id="line-2213"></span><span id="local-6989586621681133359"><span class="annot"><a href="GHC.Rename.Expr.html#getMonadFailOp"><span class="hs-identifier hs-type">getMonadFailOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133359"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#FailOperator"><span class="hs-identifier hs-type">FailOperator</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-comment">-- Syntax expr fail op</span><span>
</span><span id="line-2214"></span><span id="getMonadFailOp"><span class="annot"><span class="annottext">getMonadFailOp :: forall p.
HsStmtContext p -&gt; RnM (Maybe (SyntaxExpr GhcRn), FreeVars)
</span><a href="GHC.Rename.Expr.html#getMonadFailOp"><span class="hs-identifier hs-var hs-var">getMonadFailOp</span></a></span></span><span> </span><span id="local-6989586621681131014"><span class="annot"><span class="annottext">HsStmtContext p
</span><a href="#local-6989586621681131014"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>
</span><span id="line-2215"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681131013"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131013"><span class="hs-identifier hs-var">xOverloadedStrings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DynFlags -&gt; Bool)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) DynFlags
-&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Extension -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#xopt"><span class="hs-identifier hs-var">xopt</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#OverloadedStrings"><span class="hs-identifier hs-var">LangExt.OverloadedStrings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-2216"></span><span>      </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681131012"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131012"><span class="hs-identifier hs-var">xRebindableSyntax</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DynFlags -&gt; Bool)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) DynFlags
-&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Extension -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#xopt"><span class="hs-identifier hs-var">xopt</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="../../ghc-boot-th/src/GHC.LanguageExtensions.Type.html#RebindableSyntax"><span class="hs-identifier hs-var">LangExt.RebindableSyntax</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-2217"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681131011"><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131011"><span class="hs-identifier hs-var">fail</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131010"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131010"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Bool -&gt; IOEnv (Env TcGblEnv TcLclEnv) (SyntaxExprRn, FreeVars)
</span><a href="#local-6989586621681131009"><span class="hs-identifier hs-var">reallyGetMonadFailOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131012"><span class="hs-identifier hs-var">xRebindableSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131013"><span class="hs-identifier hs-var">xOverloadedStrings</span></a></span><span>
</span><span id="line-2218"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(Maybe SyntaxExprRn, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe SyntaxExprRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntaxExprRn -&gt; Maybe SyntaxExprRn
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExprRn
</span><a href="#local-6989586621681131011"><span class="hs-identifier hs-var">fail</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131010"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2219"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-2220"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2221"></span><span>    </span><span id="local-6989586621681131008"><span class="annot"><span class="annottext">isQualifiedDo :: Bool
</span><a href="#local-6989586621681131008"><span class="hs-identifier hs-var hs-var">isQualifiedDo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../base/src/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsStmtContext p -&gt; Maybe ModuleName
forall p. HsStmtContext p -&gt; Maybe ModuleName
</span><a href="GHC.Hs.Expr.html#qualifiedDoModuleName_maybe"><span class="hs-identifier hs-var">qualifiedDoModuleName_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext p
</span><a href="#local-6989586621681131014"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2222"></span><span>
</span><span id="line-2223"></span><span>    </span><span id="local-6989586621681131009"><span class="annot"><span class="annottext">reallyGetMonadFailOp :: Bool
-&gt; Bool -&gt; IOEnv (Env TcGblEnv TcLclEnv) (SyntaxExprRn, FreeVars)
</span><a href="#local-6989586621681131009"><span class="hs-identifier hs-var hs-var">reallyGetMonadFailOp</span></a></span></span><span> </span><span id="local-6989586621681131007"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131007"><span class="hs-identifier hs-var">rebindableSyntax</span></a></span></span><span> </span><span id="local-6989586621681131006"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131006"><span class="hs-identifier hs-var">overloadedStrings</span></a></span></span><span>
</span><span id="line-2224"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131008"><span class="hs-identifier hs-var">isQualifiedDo</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131007"><span class="hs-identifier hs-var">rebindableSyntax</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681131006"><span class="hs-identifier hs-var">overloadedStrings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2225"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681131005"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131005"><span class="hs-identifier hs-var">failExpr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131004"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131004"><span class="hs-identifier hs-var">failFvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsStmtContext p -&gt; Name -&gt; TcM (HsExpr GhcRn, FreeVars)
forall p. HsStmtContext p -&gt; Name -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupQualifiedDoExpr"><span class="hs-identifier hs-var">lookupQualifiedDoExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext p
</span><a href="#local-6989586621681131014"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#failMName"><span class="hs-identifier hs-var">failMName</span></a></span><span>
</span><span id="line-2226"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681131002"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131002"><span class="hs-identifier hs-var">fromStringExpr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681131001"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131001"><span class="hs-identifier hs-var">fromStringFvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM (HsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupSyntaxExpr"><span class="hs-identifier hs-var">lookupSyntaxExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#fromStringName"><span class="hs-identifier hs-var">fromStringName</span></a></span><span>
</span><span id="line-2227"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681130998"><span class="annot"><span class="annottext">arg_lit :: OccName
</span><a href="#local-6989586621681130998"><span class="hs-identifier hs-var hs-var">arg_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#mkVarOcc"><span class="hs-identifier hs-var">mkVarOcc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arg&quot;</span></span><span>
</span><span id="line-2228"></span><span>        </span><span id="local-6989586621681130996"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681130996"><span class="hs-identifier hs-var">arg_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; RnM Name
forall gbl lcl. OccName -&gt; TcRnIf gbl lcl Name
</span><a href="GHC.Tc.Utils.Monad.html#newSysName"><span class="hs-identifier hs-var">newSysName</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681130998"><span class="hs-identifier hs-var">arg_lit</span></a></span><span>
</span><span id="line-2229"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681130994"><span class="annot"><span class="annottext">arg_syn_expr :: LHsExpr GhcRn
</span><a href="#local-6989586621681130994"><span class="hs-identifier hs-var hs-var">arg_syn_expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcRn -&gt; LHsExpr GhcRn
forall (id :: Pass). IdP (GhcPass id) -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
IdP GhcRn
</span><a href="#local-6989586621681130996"><span class="hs-identifier hs-var">arg_name</span></a></span><span>
</span><span id="line-2230"></span><span>            </span><span id="local-6989586621681130992"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130992"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2231"></span><span>              </span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn
forall (id :: Pass).
IsPass id =&gt;
LHsExpr (GhcPass id)
-&gt; LHsExpr (GhcPass id) -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcRn -&gt; LHsExpr GhcRn
forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131005"><span class="hs-identifier hs-var">failExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2232"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn
forall (id :: Pass).
IsPass id =&gt;
LHsExpr (GhcPass id)
-&gt; LHsExpr (GhcPass id) -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcRn -&gt; LHsExpr GhcRn
forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn -&gt; LHsExpr GhcRn) -&gt; HsExpr GhcRn -&gt; LHsExpr GhcRn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681131002"><span class="hs-identifier hs-var">fromStringExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130994"><span class="hs-identifier hs-var">arg_syn_expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2233"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681130990"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681130990"><span class="hs-identifier hs-var">failAfterFromStringExpr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2234"></span><span>              </span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; HsExpr GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">(LHsExpr GhcRn -&gt; HsExpr GhcRn) -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[LPat GhcRn] -&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn
forall (p :: Pass).
(IsPass p, XMG (GhcPass p) (LHsExpr (GhcPass p)) ~ NoExtField) =&gt;
[LPat (GhcPass p)] -&gt; LHsExpr (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#mkHsLam"><span class="hs-identifier hs-var">mkHsLam</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pat GhcRn -&gt; Located (Pat GhcRn)
forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">(Pat GhcRn -&gt; Located (Pat GhcRn))
-&gt; Pat GhcRn -&gt; Located (Pat GhcRn)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">XVarPat GhcRn -&gt; Located (IdP GhcRn) -&gt; Pat GhcRn
forall p. XVarPat p -&gt; Located (IdP p) -&gt; Pat p
</span><a href="GHC.Hs.Pat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XVarPat GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">(Located (IdP GhcRn) -&gt; Pat GhcRn)
-&gt; Located (IdP GhcRn) -&gt; Pat GhcRn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Located Name
forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681130996"><span class="hs-identifier hs-var">arg_name</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130992"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-2235"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681130988"><span class="annot"><span class="annottext">SyntaxExpr GhcRn
</span><a href="#local-6989586621681130988"><span class="hs-identifier hs-var">failAfterFromStringSynExpr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2236"></span><span>              </span><span class="annot"><span class="annottext">HsExpr GhcRn -&gt; SyntaxExprRn
</span><a href="GHC.Hs.Expr.html#mkSyntaxExpr"><span class="hs-identifier hs-var">mkSyntaxExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681130990"><span class="hs-identifier hs-var">failAfterFromStringExpr</span></a></span><span>
</span><span id="line-2237"></span><span>        </span><span class="annot"><span class="annottext">(SyntaxExprRn, FreeVars)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (SyntaxExprRn, FreeVars)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntaxExpr GhcRn
SyntaxExprRn
</span><a href="#local-6989586621681130988"><span class="hs-identifier hs-var">failAfterFromStringSynExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131004"><span class="hs-identifier hs-var">failFvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621681131001"><span class="hs-identifier hs-var">fromStringFvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2238"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsStmtContext p -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
forall p.
HsStmtContext p -&gt; Name -&gt; RnM (SyntaxExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Env.html#lookupQualifiedDo"><span class="hs-identifier hs-var">lookupQualifiedDo</span></a></span><span> </span><span class="annot"><span class="annottext">HsStmtContext p
</span><a href="#local-6989586621681131014"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#failMName"><span class="hs-identifier hs-var">failMName</span></a></span><span>
</span><span id="line-2239"></span><span>
</span><span id="line-2240"></span><span class="hs-comment">-- Rebinding 'if's to 'ifThenElse' applications.</span><span>
</span><span id="line-2241"></span><span class="hs-comment">--</span><span>
</span><span id="line-2242"></span><span class="hs-comment">-- See Note [Rebindable syntax and HsExpansion]</span><span>
</span><span id="line-2243"></span><span class="annot"><a href="GHC.Rename.Expr.html#rebindIf"><span class="hs-identifier hs-type">rebindIf</span></a></span><span>
</span><span id="line-2244"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>  </span><span class="hs-comment">-- 'Name' for the 'ifThenElse' function we will rebind to</span><span>
</span><span id="line-2245"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-comment">-- renamed condition</span><span>
</span><span id="line-2246"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-comment">-- renamed true branch</span><span>
</span><span id="line-2247"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-comment">-- renamed false branch</span><span>
</span><span id="line-2248"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>  </span><span class="hs-comment">-- rebound if expression</span><span>
</span><span id="line-2249"></span><span id="rebindIf"><span class="annot"><span class="annottext">rebindIf :: Located Name
-&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
</span><a href="GHC.Rename.Expr.html#rebindIf"><span class="hs-identifier hs-var hs-var">rebindIf</span></a></span></span><span> </span><span id="local-6989586621681130987"><span class="annot"><span class="annottext">Located Name
</span><a href="#local-6989586621681130987"><span class="hs-identifier hs-var">ifteName</span></a></span></span><span> </span><span id="local-6989586621681130986"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130986"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681130985"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130985"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span id="local-6989586621681130984"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130984"><span class="hs-identifier hs-var">b2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2250"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681130983"><span class="annot"><span class="annottext">ifteOrig :: HsExpr GhcRn
</span><a href="#local-6989586621681130983"><span class="hs-identifier hs-var hs-var">ifteOrig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XIf GhcRn
-&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn
forall p. XIf p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XIf GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130986"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130985"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130984"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-2251"></span><span>      </span><span id="local-6989586621681130982"><span class="annot"><span class="annottext">ifteFun :: LHsExpr GhcRn
</span><a href="#local-6989586621681130982"><span class="hs-identifier hs-var hs-var">ifteFun</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; HsExpr GhcRn -&gt; LHsExpr GhcRn
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#generatedSrcSpan"><span class="hs-identifier hs-var">generatedSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XVar GhcRn -&gt; Located (IdP GhcRn) -&gt; HsExpr GhcRn
forall p. XVar p -&gt; Located (IdP p) -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
XVar GhcRn
</span><a href="GHC.Hs.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">Located Name
Located (IdP GhcRn)
</span><a href="#local-6989586621681130987"><span class="hs-identifier hs-var">ifteName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2252"></span><span>                 </span><span class="hs-comment">-- ifThenElse var</span><span>
</span><span id="line-2253"></span><span>      </span><span id="local-6989586621681130980"><span class="annot"><span class="annottext">ifteApp :: LHsExpr GhcRn
</span><a href="#local-6989586621681130980"><span class="hs-identifier hs-var hs-var">ifteApp</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LHsExpr GhcRn -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn -&gt; LHsExpr GhcRn)
-&gt; LHsExpr GhcRn -&gt; [LHsExpr GhcRn] -&gt; LHsExpr GhcRn
forall (id :: Pass).
(LHsExpr (GhcPass id)
 -&gt; LHsExpr (GhcPass id)
 -&gt; HsExpr (GhcPass id)
 -&gt; LHsExpr (GhcPass id))
-&gt; LHsExpr (GhcPass id)
-&gt; [LHsExpr (GhcPass id)]
-&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#mkHsAppsWith"><span class="hs-identifier hs-var">mkHsAppsWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681130978"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681130978"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; HsExpr GhcRn -&gt; LHsExpr GhcRn
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#generatedSrcSpan"><span class="hs-identifier hs-var">generatedSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681130978"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2254"></span><span>                              </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130982"><span class="hs-identifier hs-var">ifteFun</span></a></span><span>
</span><span id="line-2255"></span><span>                              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130986"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130985"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130984"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2256"></span><span>                 </span><span class="hs-comment">-- desugared_if_expr =</span><span>
</span><span id="line-2257"></span><span>                 </span><span class="hs-comment">--   ifThenElse desugared_predicate</span><span>
</span><span id="line-2258"></span><span>                 </span><span class="hs-comment">--              desugared_true_branch</span><span>
</span><span id="line-2259"></span><span>                 </span><span class="hs-comment">--              desugared_false_branch</span><span>
</span><span id="line-2260"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(HsExpansion (HsExpr GhcRn) (HsExpr GhcRn) -&gt; HsExpr GhcRn)
-&gt; HsExpr GhcRn -&gt; HsExpr GhcRn -&gt; HsExpr GhcRn
forall a b. (HsExpansion a b -&gt; b) -&gt; a -&gt; b -&gt; b
</span><a href="GHC.Hs.Expr.html#mkExpanded"><span class="hs-identifier hs-var">mkExpanded</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpansion (HsExpr GhcRn) (HsExpr GhcRn) -&gt; HsExpr GhcRn
forall p. XXExpr p -&gt; HsExpr p
</span><a href="GHC.Hs.Expr.html#XExpr"><span class="hs-identifier hs-var">XExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621681130983"><span class="hs-identifier hs-var">ifteOrig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcRn -&gt; HsExpr GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621681130980"><span class="hs-identifier hs-var">ifteApp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2261"></span><span>     </span><span class="hs-comment">-- (source_if_expr, desugared_if_expr)</span><span>
</span><span id="line-2262"></span></pre></body></html>