<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621680814055"><span id="local-6989586621680814056"><span id="local-6989586621680814057"><span id="local-6989586621680814058"></span></span></span></span><span class="hs-comment">-- (c) The University of Glasgow 2006</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- (c) The GRASP/AQUA Project, Glasgow University, 1998</span><span>
</span><span id="line-3"></span><span class="hs-comment">--</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Type - public interface</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE CPP, FlexibleContexts, PatternSynonyms, ViewPatterns #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-record-updates #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-- | Main functions for manipulating types and type-related things</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Core.Type</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-12"></span><span>        </span><span class="hs-comment">-- Note some of this is just re-exports from TyCon..</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Main data types representing Types</span></span><span>
</span><span id="line-15"></span><span>        </span><span class="annot"><span class="hs-comment">-- $type_classification</span></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span>        </span><span class="annot"><span class="hs-comment">-- $representation_types</span></span><span>
</span><span id="line-18"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyThing"><span class="hs-identifier">TyThing</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#ArgFlag"><span class="hs-identifier">ArgFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#AnonArgFlag"><span class="hs-identifier">AnonArgFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#Specificity"><span class="hs-identifier">Specificity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindOrType"><span class="hs-identifier">KindOrType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier">PredType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier">ThetaType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier">TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier">isTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier">TyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier">TyCoBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVarBinder"><span class="hs-identifier">TyCoVarBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVarBinder"><span class="hs-identifier">TyVarBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier">Mult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier">Scaled</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KnotTied"><span class="hs-identifier">KnotTied</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Constructing and deconstructing types</span></span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier">mkTyVarTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier">mkTyVarTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#getTyVar"><span class="hs-identifier">getTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier">getTyVar_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#repGetTyVar_maybe"><span class="hs-identifier">repGetTyVar_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#getCastedTyVar_maybe"><span class="hs-identifier">getCastedTyVar_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier">tyVarKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#varType"><span class="hs-identifier">varType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier">mkAppTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier">mkAppTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitAppTy"><span class="hs-identifier">splitAppTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitAppTys"><span class="hs-identifier">splitAppTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#repSplitAppTys"><span class="hs-identifier">repSplitAppTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitAppTy_maybe"><span class="hs-identifier">splitAppTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#repSplitAppTy_maybe"><span class="hs-identifier">repSplitAppTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tcRepSplitAppTy_maybe"><span class="hs-identifier">tcRepSplitAppTy_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkVisFunTy"><span class="hs-identifier">mkVisFunTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkInvisFunTy"><span class="hs-identifier">mkInvisFunTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkVisFunTys"><span class="hs-identifier">mkVisFunTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier">mkVisFunTyMany</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkInvisFunTyMany"><span class="hs-identifier">mkInvisFunTyMany</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkVisFunTysMany"><span class="hs-identifier">mkVisFunTysMany</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkInvisFunTysMany"><span class="hs-identifier">mkInvisFunTysMany</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitFunTy"><span class="hs-identifier">splitFunTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier">splitFunTy_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitFunTys"><span class="hs-identifier">splitFunTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#funResultTy"><span class="hs-identifier">funResultTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#funArgTy"><span class="hs-identifier">funArgTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkTyConApp"><span class="hs-identifier">mkTyConApp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkTyConTy"><span class="hs-identifier">mkTyConTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier">tyConAppTyCon_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier">tyConAppTyConPicky_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppArgs_maybe"><span class="hs-identifier">tyConAppArgs_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyCon"><span class="hs-identifier">tyConAppTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppArgs"><span class="hs-identifier">tyConAppArgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier">splitTyConApp_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitTyConApp"><span class="hs-identifier">splitTyConApp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppArgN"><span class="hs-identifier">tyConAppArgN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier">tcSplitTyConApp_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitListTyConApp_maybe"><span class="hs-identifier">splitListTyConApp_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#repSplitTyConApp_maybe"><span class="hs-identifier">repSplitTyConApp_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkForAllTy"><span class="hs-identifier">mkForAllTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkForAllTys"><span class="hs-identifier">mkForAllTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkInvisForAllTys"><span class="hs-identifier">mkInvisForAllTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoInvForAllTys"><span class="hs-identifier">mkTyCoInvForAllTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkSpecForAllTy"><span class="hs-identifier">mkSpecForAllTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier">mkSpecForAllTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkVisForAllTys"><span class="hs-identifier">mkVisForAllTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoInvForAllTy"><span class="hs-identifier">mkTyCoInvForAllTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkInfForAllTy"><span class="hs-identifier">mkInfForAllTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkInfForAllTys"><span class="hs-identifier">mkInfForAllTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTys"><span class="hs-identifier">splitForAllTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTysReq"><span class="hs-identifier">splitForAllTysReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTysInvis"><span class="hs-identifier">splitForAllTysInvis</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllVarBndrs"><span class="hs-identifier">splitForAllVarBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTy_maybe"><span class="hs-identifier">splitForAllTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTy"><span class="hs-identifier">splitForAllTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTy_ty_maybe"><span class="hs-identifier">splitForAllTy_ty_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTy_co_maybe"><span class="hs-identifier">splitForAllTy_co_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitPiTy_maybe"><span class="hs-identifier">splitPiTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitPiTy"><span class="hs-identifier">splitPiTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitPiTys"><span class="hs-identifier">splitPiTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkTyConBindersPreferAnon"><span class="hs-identifier">mkTyConBindersPreferAnon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkPiTy"><span class="hs-identifier">mkPiTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkPiTys"><span class="hs-identifier">mkPiTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#piResultTy"><span class="hs-identifier">piResultTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier">piResultTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#applyTysX"><span class="hs-identifier">applyTysX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#dropForAlls"><span class="hs-identifier">dropForAlls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkFamilyTyConApp"><span class="hs-identifier">mkFamilyTyConApp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#buildSynTyCon"><span class="hs-identifier">buildSynTyCon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkNumLitTy"><span class="hs-identifier">mkNumLitTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isNumLitTy"><span class="hs-identifier">isNumLitTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkStrLitTy"><span class="hs-identifier">mkStrLitTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isStrLitTy"><span class="hs-identifier">isStrLitTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isLitTy"><span class="hs-identifier">isLitTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isPredTy"><span class="hs-identifier">isPredTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier">getRuntimeRep_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier">kindRep_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#kindRep"><span class="hs-identifier">kindRep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier">mkCastTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkCoercionTy"><span class="hs-identifier">mkCoercionTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitCastTy_maybe"><span class="hs-identifier">splitCastTy_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#userTypeError_maybe"><span class="hs-identifier">userTypeError_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier">pprUserTypeErrorTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#coAxNthLHS"><span class="hs-identifier">coAxNthLHS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#stripCoercionTy"><span class="hs-identifier">stripCoercionTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitPiTysInvisible"><span class="hs-identifier">splitPiTysInvisible</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitPiTysInvisibleN"><span class="hs-identifier">splitPiTysInvisibleN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#invisibleTyBndrCount"><span class="hs-identifier">invisibleTyBndrCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#filterOutInvisibleTypes"><span class="hs-identifier">filterOutInvisibleTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#filterOutInferredTypes"><span class="hs-identifier">filterOutInferredTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier">partitionInvisibleTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#partitionInvisibles"><span class="hs-identifier">partitionInvisibles</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyConArgFlags"><span class="hs-identifier">tyConArgFlags</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#appTyArgFlags"><span class="hs-identifier">appTyArgFlags</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#synTyConResKind"><span class="hs-identifier">synTyConResKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Analyzing types</span></span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#TyCoMapper"><span class="hs-identifier">TyCoMapper</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mapTyCo"><span class="hs-identifier">mapTyCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mapTyCoX"><span class="hs-identifier">mapTyCoX</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoFolder"><span class="hs-identifier">TyCoFolder</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#foldTyCo"><span class="hs-identifier">foldTyCo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>        </span><span class="hs-comment">-- (Newtypes)</span><span>
</span><span id="line-91"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#newTyConInstRhs"><span class="hs-identifier">newTyConInstRhs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Binders</span></span><span>
</span><span id="line-94"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#sameVis"><span class="hs-identifier">sameVis</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#mkTyCoVarBinder"><span class="hs-identifier">mkTyCoVarBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#mkTyCoVarBinders"><span class="hs-identifier">mkTyCoVarBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#mkTyVarBinder"><span class="hs-identifier">mkTyVarBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#mkTyVarBinders"><span class="hs-identifier">mkTyVarBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#tyVarSpecToBinders"><span class="hs-identifier">tyVarSpecToBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkAnonBinder"><span class="hs-identifier">mkAnonBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isAnonTyCoBinder"><span class="hs-identifier">isAnonTyCoBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#binderVar"><span class="hs-identifier">binderVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier">binderVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#binderType"><span class="hs-identifier">binderType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#binderArgFlag"><span class="hs-identifier">binderArgFlag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyCoBinderType"><span class="hs-identifier">tyCoBinderType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyCoBinderVar_maybe"><span class="hs-identifier">tyCoBinderVar_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyBinderType"><span class="hs-identifier">tyBinderType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#binderRelevantType_maybe"><span class="hs-identifier">binderRelevantType_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#isVisibleArgFlag"><span class="hs-identifier">isVisibleArgFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#isInvisibleArgFlag"><span class="hs-identifier">isInvisibleArgFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#isVisibleBinder"><span class="hs-identifier">isVisibleBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#isInvisibleBinder"><span class="hs-identifier">isInvisibleBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#isNamedBinder"><span class="hs-identifier">isNamedBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyConBindersTyCoBinders"><span class="hs-identifier">tyConBindersTyCoBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Common type constructors</span></span><span>
</span><span id="line-109"></span><span>        </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html#funTyCon"><span class="hs-identifier">funTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#unrestrictedFunTyCon"><span class="hs-identifier">unrestrictedFunTyCon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Predicates on types</span></span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isTyVarTy"><span class="hs-identifier">isTyVarTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isFunTy"><span class="hs-identifier">isFunTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy"><span class="hs-identifier">isCoercionTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy_maybe"><span class="hs-identifier">isCoercionTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy"><span class="hs-identifier">isForAllTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_ty"><span class="hs-identifier">isForAllTy_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_co"><span class="hs-identifier">isForAllTy_co</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isPiTy"><span class="hs-identifier">isPiTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier">isTauTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier">isFamFreeTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isCoVarType"><span class="hs-identifier">isCoVarType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier">isAtomicTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isValidJoinPointType"><span class="hs-identifier">isValidJoinPointType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppNeedsKindSig"><span class="hs-identifier">tyConAppNeedsKindSig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><span class="hs-comment">-- *** Levity and boxity</span></span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isLiftedType_maybe"><span class="hs-identifier">isLiftedType_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isLiftedTypeKind"><span class="hs-identifier">isLiftedTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedTypeKind"><span class="hs-identifier">isUnliftedTypeKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isLiftedRuntimeRep"><span class="hs-identifier">isLiftedRuntimeRep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedRuntimeRep"><span class="hs-identifier">isUnliftedRuntimeRep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedType"><span class="hs-identifier">isUnliftedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mightBeUnliftedType"><span class="hs-identifier">mightBeUnliftedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isUnboxedTupleType"><span class="hs-identifier">isUnboxedTupleType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isUnboxedSumType"><span class="hs-identifier">isUnboxedSumType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isAlgType"><span class="hs-identifier">isAlgType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isDataFamilyAppType"><span class="hs-identifier">isDataFamilyAppType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isPrimitiveType"><span class="hs-identifier">isPrimitiveType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isStrictType"><span class="hs-identifier">isStrictType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepTy"><span class="hs-identifier">isRuntimeRepTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepVar"><span class="hs-identifier">isRuntimeRepVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepKindedTy"><span class="hs-identifier">isRuntimeRepKindedTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#dropRuntimeRepArgs"><span class="hs-identifier">dropRuntimeRepArgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier">getRuntimeRep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Multiplicity</span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isMultiplicityTy"><span class="hs-identifier">isMultiplicityTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isMultiplicityVar"><span class="hs-identifier">isMultiplicityVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier">unrestricted</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#linear"><span class="hs-identifier">linear</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tymult"><span class="hs-identifier">tymult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkScaled"><span class="hs-identifier">mkScaled</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#irrelevantMult"><span class="hs-identifier">irrelevantMult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#scaledSet"><span class="hs-identifier">scaledSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#One"><span class="hs-identifier">One</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#Many"><span class="hs-identifier">Many</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isOneDataConTy"><span class="hs-identifier">isOneDataConTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isManyDataConTy"><span class="hs-identifier">isManyDataConTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isLinearType"><span class="hs-identifier">isLinearType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Main data types representing Kinds</span></span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier">Kind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Finding the kind of a type</span></span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier">typeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier">tcTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isTypeLevPoly"><span class="hs-identifier">isTypeLevPoly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#resultIsLevPoly"><span class="hs-identifier">resultIsLevPoly</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tcIsLiftedTypeKind"><span class="hs-identifier">tcIsLiftedTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tcIsConstraintKind"><span class="hs-identifier">tcIsConstraintKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tcReturnsConstraintKind"><span class="hs-identifier">tcReturnsConstraintKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tcIsRuntimeTypeKind"><span class="hs-identifier">tcIsRuntimeTypeKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Common Kind</span></span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier">liftedTypeKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Type free variables</span></span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier">tyCoFVsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsBndr"><span class="hs-identifier">tyCoFVsBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndr"><span class="hs-identifier">tyCoFVsVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndrs"><span class="hs-identifier">tyCoFVsVarBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier">tyCoVarsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier">tyCoVarsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeDSet"><span class="hs-identifier">tyCoVarsOfTypeDSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfType"><span class="hs-identifier">coVarsOfType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfTypes"><span class="hs-identifier">coVarsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfType"><span class="hs-identifier">noFreeVarsOfType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitVisVarsOfType"><span class="hs-identifier">splitVisVarsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitVisVarsOfTypes"><span class="hs-identifier">splitVisVarsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#expandTypeSynonyms"><span class="hs-identifier">expandTypeSynonyms</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#typeSize"><span class="hs-identifier">typeSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#occCheckExpand"><span class="hs-identifier">occCheckExpand</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Closing over kinds</span></span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKindsDSet"><span class="hs-identifier">closeOverKindsDSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKindsList"><span class="hs-identifier">closeOverKindsList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKinds"><span class="hs-identifier">closeOverKinds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Well-scoped lists of variables</span></span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#scopedSort"><span class="hs-identifier">scopedSort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeWellScoped"><span class="hs-identifier">tyCoVarsOfTypeWellScoped</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesWellScoped"><span class="hs-identifier">tyCoVarsOfTypesWellScoped</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Type comparison</span></span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#eqType"><span class="hs-identifier">eqType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#eqTypeX"><span class="hs-identifier">eqTypeX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#eqTypes"><span class="hs-identifier">eqTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpType"><span class="hs-identifier">nonDetCmpType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpTypes"><span class="hs-identifier">nonDetCmpTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpTypeX"><span class="hs-identifier">nonDetCmpTypeX</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpTypesX"><span class="hs-identifier">nonDetCmpTypesX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpTc"><span class="hs-identifier">nonDetCmpTc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#eqVarBndrs"><span class="hs-identifier">eqVarBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Forcing evaluation of types</span></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier">seqType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#seqTypes"><span class="hs-identifier">seqTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Other views onto Types</span></span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier">coreView</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tcView"><span class="hs-identifier">tcView</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyConsOfType"><span class="hs-identifier">tyConsOfType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Main type substitution data types</span></span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier">TvSubstEnv</span></a></span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Representation widely visible</span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier">TCvSubst</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- Representation visible to a few friends</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Manipulating type substitutions</span></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#emptyTvSubstEnv"><span class="hs-identifier">emptyTvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#emptyTCvSubst"><span class="hs-identifier">emptyTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkEmptyTCvSubst"><span class="hs-identifier">mkEmptyTCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTCvSubst"><span class="hs-identifier">mkTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier">zipTvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTvSubstPrs"><span class="hs-identifier">mkTvSubstPrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTCvSubst"><span class="hs-identifier">zipTCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-194"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#notElemTCvSubst"><span class="hs-identifier">notElemTCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getTvSubstEnv"><span class="hs-identifier">getTvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#setTvSubstEnv"><span class="hs-identifier">setTvSubstEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zapTCvSubst"><span class="hs-identifier">zapTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getTCvInScope"><span class="hs-identifier">getTCvInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getTCvSubstRangeFVs"><span class="hs-identifier">getTCvSubstRangeFVs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-197"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvInScope"><span class="hs-identifier">extendTCvInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvInScopeList"><span class="hs-identifier">extendTCvInScopeList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvInScopeSet"><span class="hs-identifier">extendTCvInScopeSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier">extendTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendCvSubst"><span class="hs-identifier">extendCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubst"><span class="hs-identifier">extendTvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstBinderAndInScope"><span class="hs-identifier">extendTvSubstBinderAndInScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstList"><span class="hs-identifier">extendTvSubstList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstAndInScope"><span class="hs-identifier">extendTvSubstAndInScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubstList"><span class="hs-identifier">extendTCvSubstList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstWithClone"><span class="hs-identifier">extendTvSubstWithClone</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubstWithClone"><span class="hs-identifier">extendTCvSubstWithClone</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#isInScope"><span class="hs-identifier">isInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#composeTCvSubstEnv"><span class="hs-identifier">composeTCvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#composeTCvSubst"><span class="hs-identifier">composeTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTyEnv"><span class="hs-identifier">zipTyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipCoEnv"><span class="hs-identifier">zipCoEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier">isEmptyTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#unionTCvSubst"><span class="hs-identifier">unionTCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Performing substitution on types and kinds</span></span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier">substTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier">substTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTy"><span class="hs-identifier">substScaledTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTys"><span class="hs-identifier">substScaledTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWith"><span class="hs-identifier">substTyWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTysWith"><span class="hs-identifier">substTysWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTheta"><span class="hs-identifier">substTheta</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyAddInScope"><span class="hs-identifier">substTyAddInScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-210"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyUnchecked"><span class="hs-identifier">substTyUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTysUnchecked"><span class="hs-identifier">substTysUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTyUnchecked"><span class="hs-identifier">substScaledTyUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTysUnchecked"><span class="hs-identifier">substScaledTysUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-211"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substThetaUnchecked"><span class="hs-identifier">substThetaUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWithUnchecked"><span class="hs-identifier">substTyWithUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoUnchecked"><span class="hs-identifier">substCoUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoWithUnchecked"><span class="hs-identifier">substCoWithUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVarBndr"><span class="hs-identifier">substTyVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVarBndrs"><span class="hs-identifier">substTyVarBndrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVar"><span class="hs-identifier">substTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVars"><span class="hs-identifier">substTyVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substVarBndr"><span class="hs-identifier">substVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substVarBndrs"><span class="hs-identifier">substVarBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndr"><span class="hs-identifier">cloneTyVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndrs"><span class="hs-identifier">cloneTyVarBndrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#lookupTyVar"><span class="hs-identifier">lookupTyVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Tidying type related things up for printing</span></span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier">tidyType</span></a></span><span class="hs-special">,</span><span>      </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTypes"><span class="hs-identifier">tidyTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenType"><span class="hs-identifier">tidyOpenType</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTypes"><span class="hs-identifier">tidyOpenTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenKind"><span class="hs-identifier">tidyOpenKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndr"><span class="hs-identifier">tidyVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndrs"><span class="hs-identifier">tidyVarBndrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyFreeTyCoVars"><span class="hs-identifier">tidyFreeTyCoVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTyCoVar"><span class="hs-identifier">tidyOpenTyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTyCoVars"><span class="hs-identifier">tidyOpenTyCoVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTyCoVarOcc"><span class="hs-identifier">tidyTyCoVarOcc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTopType"><span class="hs-identifier">tidyTopType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyKind"><span class="hs-identifier">tidyKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTyCoVarBinder"><span class="hs-identifier">tidyTyCoVarBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTyCoVarBinders"><span class="hs-identifier">tidyTyCoVarBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Kinds</span></span><span>
</span><span id="line-229"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCon.html#isConstraintKindCon"><span class="hs-identifier">isConstraintKindCon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#classifiesTypeWithValues"><span class="hs-identifier">classifiesTypeWithValues</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isKindLevPoly"><span class="hs-identifier">isKindLevPoly</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#include &quot;HsVersions.h&quot;
</span><span>
</span><span id="line-236"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- We import the representation and primitive functions from GHC.Core.TyCo.Rep.</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- Many things are reexported, but not the representation!</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>
</span><span id="line-244"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html"><span class="hs-identifier">GHC.Core.TyCo.Subst</span></a></span><span>
</span><span id="line-245"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html"><span class="hs-identifier">GHC.Core.TyCo.Tidy</span></a></span><span>
</span><span id="line-246"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html"><span class="hs-identifier">GHC.Core.TyCo.FVs</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- friends:</span><span>
</span><span id="line-249"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span>
</span><span id="line-250"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html"><span class="hs-identifier">GHC.Types.Var.Env</span></a></span><span>
</span><span id="line-251"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html"><span class="hs-identifier">GHC.Types.Var.Set</span></a></span><span>
</span><span id="line-252"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Set.html"><span class="hs-identifier">GHC.Types.Unique.Set</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-255"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html"><span class="hs-identifier">GHC.Builtin.Types.Prim</span></a></span><span>
</span><span id="line-256"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span>
</span><span id="line-257"></span><span>                                 </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#listTyCon"><span class="hs-identifier">listTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#typeNatKind"><span class="hs-identifier">typeNatKind</span></a></span><span>
</span><span id="line-258"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#typeSymbolKind"><span class="hs-identifier">typeSymbolKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier">liftedTypeKind</span></a></span><span>
</span><span id="line-259"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#constraintKind"><span class="hs-identifier">constraintKind</span></a></span><span>
</span><span id="line-260"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#unrestrictedFunTyCon"><span class="hs-identifier">unrestrictedFunTyCon</span></a></span><span>
</span><span id="line-261"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#manyDataConTy"><span class="hs-identifier">manyDataConTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#oneDataConTy"><span class="hs-identifier">oneDataConTy</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-264"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html"><span class="hs-identifier">GHC.Core.Coercion.Axiom</span></a></span><span>
</span><span id="line-265"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html"><span class="hs-identifier">GHC.Core.Coercion</span></a></span><span>
</span><span id="line-266"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkNomReflCo"><span class="hs-identifier">mkNomReflCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkGReflCo"><span class="hs-identifier">mkGReflCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkReflCo"><span class="hs-identifier">mkReflCo</span></a></span><span>
</span><span id="line-267"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkTyConAppCo"><span class="hs-identifier">mkTyConAppCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkAppCo"><span class="hs-identifier">mkAppCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkCoVarCo"><span class="hs-identifier">mkCoVarCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkAxiomRuleCo"><span class="hs-identifier">mkAxiomRuleCo</span></a></span><span>
</span><span id="line-268"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkForAllCo"><span class="hs-identifier">mkForAllCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkFunCo"><span class="hs-identifier">mkFunCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkAxiomInstCo"><span class="hs-identifier">mkAxiomInstCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkUnivCo"><span class="hs-identifier">mkUnivCo</span></a></span><span>
</span><span id="line-269"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkSymCo"><span class="hs-identifier">mkSymCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkTransCo"><span class="hs-identifier">mkTransCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkNthCo"><span class="hs-identifier">mkNthCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkLRCo"><span class="hs-identifier">mkLRCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkInstCo"><span class="hs-identifier">mkInstCo</span></a></span><span>
</span><span id="line-270"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkKindCo"><span class="hs-identifier">mkKindCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkSubCo"><span class="hs-identifier">mkSubCo</span></a></span><span>
</span><span id="line-271"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#decomposePiCos"><span class="hs-identifier">decomposePiCos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier">coercionKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionLKind"><span class="hs-identifier">coercionLKind</span></a></span><span>
</span><span id="line-272"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionRKind"><span class="hs-identifier">coercionRKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier">coercionType</span></a></span><span>
</span><span id="line-273"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#isReflexiveCo"><span class="hs-identifier">isReflexiveCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#seqCo"><span class="hs-identifier">seqCo</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- others</span><span>
</span><span id="line-276"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-277"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html"><span class="hs-identifier">GHC.Utils.FV</span></a></span><span>
</span><span id="line-278"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-279"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-280"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html"><span class="hs-identifier">GHC.Data.Pair</span></a></span><span>
</span><span id="line-281"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html"><span class="hs-identifier">GHC.Data.List.SetOps</span></a></span><span>
</span><span id="line-282"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html"><span class="hs-identifier">GHC.Types.Unique</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#nonDetCmpUnique"><span class="hs-identifier">nonDetCmpUnique</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#orElse"><span class="hs-identifier">orElse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#expectJust"><span class="hs-identifier">expectJust</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base/src/Data.Maybe.html#"><span class="hs-identifier">Data.Maybe</span></a></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base/src/Data.Maybe.html#isJust"><span class="hs-identifier">isJust</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base/src/Control.Monad.html#"><span class="hs-identifier">Control.Monad</span></a></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base/src/Control.Monad.html#guard"><span class="hs-identifier">guard</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- $type_classification</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- #type_classification#</span><span>
</span><span id="line-290"></span><span class="hs-comment">--</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- Types are one of:</span><span>
</span><span id="line-292"></span><span class="hs-comment">--</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- [Unboxed]            Iff its representation is other than a pointer</span><span>
</span><span id="line-294"></span><span class="hs-comment">--                      Unboxed types are also unlifted.</span><span>
</span><span id="line-295"></span><span class="hs-comment">--</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- [Lifted]             Iff it has bottom as an element.</span><span>
</span><span id="line-297"></span><span class="hs-comment">--                      Closures always have lifted types: i.e. any</span><span>
</span><span id="line-298"></span><span class="hs-comment">--                      let-bound identifier in Core must have a lifted</span><span>
</span><span id="line-299"></span><span class="hs-comment">--                      type. Operationally, a lifted object is one that</span><span>
</span><span id="line-300"></span><span class="hs-comment">--                      can be entered.</span><span>
</span><span id="line-301"></span><span class="hs-comment">--                      Only lifted types may be unified with a type variable.</span><span>
</span><span id="line-302"></span><span class="hs-comment">--</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- [Algebraic]          Iff it is a type with one or more constructors, whether</span><span>
</span><span id="line-304"></span><span class="hs-comment">--                      declared with @data@ or @newtype@.</span><span>
</span><span id="line-305"></span><span class="hs-comment">--                      An algebraic type is one that can be deconstructed</span><span>
</span><span id="line-306"></span><span class="hs-comment">--                      with a case expression. This is /not/ the same as</span><span>
</span><span id="line-307"></span><span class="hs-comment">--                      lifted types, because we also include unboxed</span><span>
</span><span id="line-308"></span><span class="hs-comment">--                      tuples in this classification.</span><span>
</span><span id="line-309"></span><span class="hs-comment">--</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- [Data]               Iff it is a type declared with @data@, or a boxed tuple.</span><span>
</span><span id="line-311"></span><span class="hs-comment">--</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- [Primitive]          Iff it is a built-in type that can't be expressed in Haskell.</span><span>
</span><span id="line-313"></span><span class="hs-comment">--</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- Currently, all primitive types are unlifted, but that's not necessarily</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- the case: for example, @Int@ could be primitive.</span><span>
</span><span id="line-316"></span><span class="hs-comment">--</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- Some primitive types are unboxed, such as @Int#@, whereas some are boxed</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- but unlifted (such as @ByteArray#@).  The only primitive types that we</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- classify as algebraic are the unboxed tuples.</span><span>
</span><span id="line-320"></span><span class="hs-comment">--</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- Some examples of type classifications that may make this a bit clearer are:</span><span>
</span><span id="line-322"></span><span class="hs-comment">--</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- Type          primitive       boxed           lifted          algebraic</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- Int#          Yes             No              No              No</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- ByteArray#    Yes             Yes             No              No</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- (\# a, b \#)  Yes             No              No              Yes</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- (\# a | b \#) Yes             No              No              Yes</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- (  a, b  )    No              Yes             Yes             Yes</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- [a]           No              Yes             Yes             Yes</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">-- $representation_types</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- A /source type/ is a type that is a separate type as far as the type checker is</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- concerned, but which has a more low-level representation as far as Core-to-Core</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- passes and the rest of the back end is concerned.</span><span>
</span><span id="line-338"></span><span class="hs-comment">--</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- You don't normally have to worry about this, as the utility functions in</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- this module will automatically convert a source into a representation type</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- if they are spotted, to the best of its abilities. If you don't want this</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- to happen, use the equivalent functions from the &quot;TcType&quot; module.</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Type representation
*                                                                      *
************************************************************************

Note [coreView vs tcView]
~~~~~~~~~~~~~~~~~~~~~~~~~
So far as the typechecker is concerned, 'Constraint' and 'TYPE
LiftedRep' are distinct kinds.

But in Core these two are treated as identical.

We implement this by making 'coreView' convert 'Constraint' to 'TYPE
LiftedRep' on the fly.  The function tcView (used in the type checker)
does not do this.

See also #11715, which tracks removing this inconsistency.

-}</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- | Gives the typechecker view of a type. This unwraps synonyms but</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- leaves 'Constraint' alone. c.f. coreView, which turns Constraint into</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- TYPE LiftedRep. Returns Nothing if no unwrapping happens.</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- See also Note [coreView vs tcView]</span><span>
</span><span id="line-370"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tcView"><span class="hs-pragma hs-type">tcView</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-371"></span><span class="annot"><a href="GHC.Core.Type.html#tcView"><span class="hs-identifier hs-type">tcView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-372"></span><span id="tcView"><span class="annot"><span class="annottext">tcView :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#tcView"><span class="hs-identifier hs-var hs-var">tcView</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813525"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813525"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680813524"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813524"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680813523"><span class="annot"><span class="annottext">[(TyVar, Type)]
</span><a href="#local-6989586621680813523"><span class="hs-identifier hs-var">tenv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813522"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813522"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813521"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813521"><span class="hs-identifier hs-var">tys'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Maybe ([(TyVar, Type)], Type, [Type])
forall tyco.
TyCon -&gt; [tyco] -&gt; Maybe ([(TyVar, tyco)], Type, [tyco])
</span><a href="GHC.Core.TyCon.html#expandSynTyCon_maybe"><span class="hs-identifier hs-var">expandSynTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813525"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813524"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(TyVar, Type)] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkTvSubstPrs"><span class="hs-identifier hs-var">mkTvSubstPrs</span></a></span><span> </span><span class="annot"><span class="annottext">[(TyVar, Type)]
</span><a href="#local-6989586621680813523"><span class="hs-identifier hs-var">tenv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813522"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813521"><span class="hs-identifier hs-var">tys'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>               </span><span class="hs-comment">-- The free vars of 'rhs' should all be bound by 'tenv', so it's</span><span>
</span><span id="line-375"></span><span>               </span><span class="hs-comment">-- ok to use 'substTy' here.</span><span>
</span><span id="line-376"></span><span>               </span><span class="hs-comment">-- See also Note [The substitution invariant] in GHC.Core.TyCo.Subst.</span><span>
</span><span id="line-377"></span><span>               </span><span class="hs-comment">-- Its important to use mkAppTys, rather than (foldl AppTy),</span><span>
</span><span id="line-378"></span><span>               </span><span class="hs-comment">-- because the function part might well return a</span><span>
</span><span id="line-379"></span><span>               </span><span class="hs-comment">-- partially-applied type constructor; indeed, usually will!</span><span>
</span><span id="line-380"></span><span class="annot"><a href="GHC.Core.Type.html#tcView"><span class="hs-identifier hs-var">tcView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#coreView"><span class="hs-pragma hs-type">coreView</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-383"></span><span class="annot"><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-type">coreView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-384"></span><span class="hs-comment">-- ^ This function Strips off the /top layer only/ of a type synonym</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- application (if any) its underlying representation type.</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- Returns Nothing if there is nothing to look through.</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- This function considers 'Constraint' to be a synonym of @TYPE LiftedRep@.</span><span>
</span><span id="line-388"></span><span class="hs-comment">--</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- By being non-recursive and inlined, this case analysis gets efficiently</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- joined onto the case analysis that the caller is already doing</span><span>
</span><span id="line-391"></span><span id="coreView"><span class="annot"><span class="annottext">coreView :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var hs-var">coreView</span></a></span></span><span> </span><span id="local-6989586621680813519"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680813519"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813518"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813518"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680813517"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813517"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680813516"><span class="annot"><span class="annottext">[(TyVar, Type)]
</span><a href="#local-6989586621680813516"><span class="hs-identifier hs-var">tenv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813515"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813515"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813514"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813514"><span class="hs-identifier hs-var">tys'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Maybe ([(TyVar, Type)], Type, [Type])
forall tyco.
TyCon -&gt; [tyco] -&gt; Maybe ([(TyVar, tyco)], Type, [tyco])
</span><a href="GHC.Core.TyCon.html#expandSynTyCon_maybe"><span class="hs-identifier hs-var">expandSynTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813518"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813517"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(TyVar, Type)] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkTvSubstPrs"><span class="hs-identifier hs-var">mkTvSubstPrs</span></a></span><span> </span><span class="annot"><span class="annottext">[(TyVar, Type)]
</span><a href="#local-6989586621680813516"><span class="hs-identifier hs-var">tenv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813515"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813514"><span class="hs-identifier hs-var">tys'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-comment">-- This equation is exactly like tcView</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-comment">-- At the Core level, Constraint = Type</span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-comment">-- See Note [coreView vs tcView]</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isConstraintKindCon"><span class="hs-identifier hs-var">isConstraintKindCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813518"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="annot"><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#coreFullView"><span class="hs-pragma hs-type">coreFullView</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-405"></span><span class="annot"><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-type">coreFullView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-406"></span><span class="hs-comment">-- ^ Iterates 'coreView' until there is no more to synonym to expand.</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- See Note [Inlining coreView].</span><span>
</span><span id="line-408"></span><span id="coreFullView"><span class="annot"><span class="annottext">coreFullView :: Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var hs-var">coreFullView</span></a></span></span><span> </span><span id="local-6989586621680813506"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680813506"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813505"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813505"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeSynonymTyCon"><span class="hs-identifier hs-var">isTypeSynonymTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813505"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isConstraintKindCon"><span class="hs-identifier hs-var">isConstraintKindCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813505"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621680813502"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813506"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-411"></span><span>    </span><span id="local-6989586621680813502"><span class="annot"><span class="annottext">go :: Type -&gt; Type
</span><a href="#local-6989586621680813502"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680813501"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813501"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-412"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680813500"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813500"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813501"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621680813502"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813500"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-413"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813501"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="annot"><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span id="local-6989586621680813499"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813499"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813499"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-comment">{- Note [Inlining coreView] in GHC.Core.Type
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
It is very common to have a function

  f :: Type -&gt; ...
  f ty | Just ty' &lt;- coreView ty = f ty'
  f (TyVarTy ...) = ...
  f ...           = ...

If f is not otherwise recursive, the initial call to coreView
causes f to become recursive, which kills the possibility of
inlining. Instead, for non-recursive functions, we prefer to
use coreFullView, which guarantees to unwrap top-level type
synonyms. It can be inlined and is efficient and non-allocating
in its fast path. For this to really be fast, all calls made
on its fast path must also be inlined, linked back to this Note.
-}</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">-----------------------------------------------</span><span>
</span><span id="line-436"></span><span class="annot"><a href="GHC.Core.Type.html#expandTypeSynonyms"><span class="hs-identifier hs-type">expandTypeSynonyms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-437"></span><span class="hs-comment">-- ^ Expand out all type synonyms.  Actually, it'd suffice to expand out</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- just the ones that discard type variables (e.g.  type Funny a = Int)</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- But we don't know which those are currently, so we just expand all.</span><span>
</span><span id="line-440"></span><span class="hs-comment">--</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- 'expandTypeSynonyms' only expands out type synonyms mentioned in the type,</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- not in the kinds of any TyCon or TyVar mentioned in the type.</span><span>
</span><span id="line-443"></span><span class="hs-comment">--</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- Keep this synchronized with 'synonymTyConsOfType'</span><span>
</span><span id="line-445"></span><span id="expandTypeSynonyms"><span class="annot"><span class="annottext">expandTypeSynonyms :: Type -&gt; Type
</span><a href="GHC.Core.Type.html#expandTypeSynonyms"><span class="hs-identifier hs-var hs-var">expandTypeSynonyms</span></a></span></span><span> </span><span id="local-6989586621680813498"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813498"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var">mkEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621680813496"><span class="hs-identifier hs-var">in_scope</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813498"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>    </span><span id="local-6989586621680813496"><span class="annot"><span class="annottext">in_scope :: InScopeSet
</span><a href="#local-6989586621680813496"><span class="hs-identifier hs-var hs-var">in_scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813498"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span>    </span><span id="local-6989586621680813497"><span class="annot"><span class="annottext">go :: TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680813488"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813488"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813487"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813487"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680813486"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813486"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680813485"><span class="annot"><span class="annottext">[(TyVar, Type)]
</span><a href="#local-6989586621680813485"><span class="hs-identifier hs-var">tenv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813484"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813484"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813483"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813483"><span class="hs-identifier hs-var">tys'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Maybe ([(TyVar, Type)], Type, [Type])
forall tyco.
TyCon -&gt; [tyco] -&gt; Maybe ([(TyVar, tyco)], Type, [tyco])
</span><a href="GHC.Core.TyCon.html#expandSynTyCon_maybe"><span class="hs-identifier hs-var">expandSynTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813487"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813482"><span class="hs-identifier hs-var">expanded_tys</span></a></span><span>
</span><span id="line-452"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680813481"><span class="annot"><span class="annottext">subst' :: TCvSubst
</span><a href="#local-6989586621680813481"><span class="hs-identifier hs-var hs-var">subst'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkTvSubst"><span class="hs-identifier hs-var">mkTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621680813496"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(TyVar, Type)] -&gt; TvSubstEnv
forall a. [(TyVar, a)] -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#mkVarEnv"><span class="hs-identifier hs-var">mkVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[(TyVar, Type)]
</span><a href="#local-6989586621680813485"><span class="hs-identifier hs-var">tenv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>            </span><span class="hs-comment">-- Make a fresh substitution; rhs has nothing to</span><span>
</span><span id="line-454"></span><span>            </span><span class="hs-comment">-- do with anything that has happened so far</span><span>
</span><span id="line-455"></span><span>            </span><span class="hs-comment">-- NB: if you make changes here, be sure to build an</span><span>
</span><span id="line-456"></span><span>            </span><span class="hs-comment">--     /idempotent/ substitution, even in the nested case</span><span>
</span><span id="line-457"></span><span>            </span><span class="hs-comment">--        type T a b = a -&gt; b</span><span>
</span><span id="line-458"></span><span>            </span><span class="hs-comment">--        type S x y = T y x</span><span>
</span><span id="line-459"></span><span>            </span><span class="hs-comment">-- (#11665)</span><span>
</span><span id="line-460"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813481"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813484"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813483"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-461"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-462"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813487"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813482"><span class="hs-identifier hs-var">expanded_tys</span></a></span><span>
</span><span id="line-463"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>        </span><span id="local-6989586621680813482"><span class="annot"><span class="annottext">expanded_tys :: [Type]
</span><a href="#local-6989586621680813482"><span class="hs-identifier hs-var hs-var">expanded_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; [Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813488"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813486"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span>    </span><span class="annot"><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621680813477"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680813477"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680813477"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-467"></span><span>    </span><span class="annot"><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680813476"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813476"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680813474"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813474"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; TyVar -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813476"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813474"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680813473"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813473"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680813471"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813471"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680813470"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813470"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813473"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813471"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813473"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813470"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>    </span><span class="annot"><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680813469"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813469"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621680813468"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680813468"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680813466"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813466"><span class="hs-identifier hs-var">mult</span></a></span></span><span> </span><span id="local-6989586621680813465"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813465"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621680813464"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813464"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813468"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813469"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813466"><span class="hs-identifier hs-var">mult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813469"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813465"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813469"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813464"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-471"></span><span>    </span><span class="annot"><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680813460"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813460"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680813457"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813457"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680813456"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680813456"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680813455"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813455"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680813454"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813454"><span class="hs-identifier hs-var">subst'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813453"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813453"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCvSubst -&gt; Type -&gt; Type)
-&gt; TCvSubst -&gt; TyVar -&gt; (TCvSubst, TyVar)
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndrUsing"><span class="hs-identifier hs-var">substVarBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813460"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813457"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-473"></span><span>        </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ArgFlag -&gt; VarBndr TyVar ArgFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813453"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680813456"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813454"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813455"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>    </span><span class="annot"><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680813451"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813451"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680813449"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813449"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680813448"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813448"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813451"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813449"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813451"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813448"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680813446"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813446"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621680813444"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813444"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCoercionTy"><span class="hs-identifier hs-var">mkCoercionTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813446"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813444"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621680813443"><span class="annot"><span class="annottext">go_mco :: TCvSubst -&gt; MCoercionN -&gt; MCoercionN
</span><a href="#local-6989586621680813443"><span class="hs-identifier hs-var hs-var">go_mco</span></a></span></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><span class="hs-identifier">_</span></span><span>     </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><a href="#local-6989586621680813443"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span id="local-6989586621680813441"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813441"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621680813439"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813439"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-var">MCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813441"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813439"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>    </span><span id="local-6989586621680813447"><span class="annot"><span class="annottext">go_co :: TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var hs-var">go_co</span></a></span></span><span> </span><span id="local-6989586621680813438"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813438"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span id="local-6989586621680813436"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813436"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkNomReflCo"><span class="hs-identifier hs-var">mkNomReflCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813438"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813436"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813435"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813435"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span id="local-6989586621680813433"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813433"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680813432"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813432"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680813431"><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621680813431"><span class="hs-identifier hs-var">mco</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; MCoercionN -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkGReflCo"><span class="hs-identifier hs-var">mkGReflCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813433"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813435"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813432"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; MCoercionN -&gt; MCoercionN
</span><a href="#local-6989586621680813443"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813435"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621680813431"><span class="hs-identifier hs-var">mco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>       </span><span class="hs-comment">-- NB: coercions are always expanded upon creation</span><span>
</span><span id="line-485"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813430"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813430"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span id="local-6989586621680813428"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813428"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680813427"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813427"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680813426"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813426"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-var">mkTyConAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813428"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813427"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; [KindCoercion] -&gt; [KindCoercion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813430"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813426"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813425"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813425"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621680813423"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813423"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621680813422"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813422"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkAppCo"><span class="hs-identifier hs-var">mkAppCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813425"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813423"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813425"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813422"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813421"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813421"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span id="local-6989586621680813419"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813419"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680813418"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813418"><span class="hs-identifier hs-var">kind_co</span></a></span></span><span> </span><span id="local-6989586621680813417"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813417"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680813416"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813416"><span class="hs-identifier hs-var">subst'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813415"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813415"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813414"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813414"><span class="hs-identifier hs-var">kind_co'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst
-&gt; TyVar -&gt; KindCoercion -&gt; (TCvSubst, TyVar, KindCoercion)
</span><a href="#local-6989586621680813413"><span class="hs-identifier hs-var">go_cobndr</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813421"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813419"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813418"><span class="hs-identifier hs-var">kind_co</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-491"></span><span>        </span><span class="annot"><span class="annottext">TyVar -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkForAllCo"><span class="hs-identifier hs-var">mkForAllCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813415"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813414"><span class="hs-identifier hs-var">kind_co'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813416"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813417"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813412"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813412"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span id="local-6989586621680813410"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813410"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680813409"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813409"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680813408"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813408"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621680813407"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813407"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role
-&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkFunCo"><span class="hs-identifier hs-var">mkFunCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813410"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813412"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813409"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813412"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813408"><span class="hs-identifier hs-var">co1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813412"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813407"><span class="hs-identifier hs-var">co2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813406"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813406"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span id="local-6989586621680813404"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813404"><span class="hs-identifier hs-var">cv</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; TyVar -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Subst.html#substCoVar"><span class="hs-identifier hs-var">substCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813406"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813404"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813402"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813402"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomInstCo"><span class="hs-identifier hs-type">AxiomInstCo</span></a></span><span> </span><span id="local-6989586621680813400"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621680813400"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621680813399"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680813399"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621680813398"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813398"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; Int -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkAxiomInstCo"><span class="hs-identifier hs-var">mkAxiomInstCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621680813400"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680813399"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; [KindCoercion] -&gt; [KindCoercion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813402"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813398"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813397"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813397"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span id="local-6989586621680813395"><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680813395"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680813394"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813394"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680813393"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813393"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680813392"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813392"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; Role -&gt; Type -&gt; Type -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkUnivCo"><span class="hs-identifier hs-var">mkUnivCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; UnivCoProvenance -&gt; UnivCoProvenance
</span><a href="#local-6989586621680813391"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813397"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680813395"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813394"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813397"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813393"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621680813497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813397"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813392"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813390"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813390"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621680813388"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813388"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813390"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813388"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813387"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813387"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621680813385"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813385"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621680813384"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813384"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813387"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813385"><span class="hs-identifier hs-var">co1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813387"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813384"><span class="hs-identifier hs-var">co2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813383"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813383"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NthCo"><span class="hs-identifier hs-type">NthCo</span></a></span><span> </span><span id="local-6989586621680813381"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813381"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680813380"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680813380"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680813379"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813379"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Role -&gt; Int -&gt; KindCoercion -&gt; KindCoercion
Role -&gt; Int -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkNthCo"><span class="hs-identifier hs-var">mkNthCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813381"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680813380"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813383"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813379"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813378"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813378"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span id="local-6989586621680813376"><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621680813376"><span class="hs-identifier hs-var">lr</span></a></span></span><span> </span><span id="local-6989586621680813375"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813375"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LeftOrRight -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkLRCo"><span class="hs-identifier hs-var">mkLRCo</span></a></span><span> </span><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621680813376"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813378"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813375"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813374"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813374"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621680813372"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813372"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621680813371"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813371"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkInstCo"><span class="hs-identifier hs-var">mkInstCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813374"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813372"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813374"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813371"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813370"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813370"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621680813368"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813368"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkKindCo"><span class="hs-identifier hs-var">mkKindCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813370"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813368"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813367"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813367"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621680813365"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813365"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkSubCo"><span class="hs-identifier hs-var">mkSubCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813367"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813365"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813364"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813364"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomRuleCo"><span class="hs-identifier hs-type">AxiomRuleCo</span></a></span><span> </span><span id="local-6989586621680813362"><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621680813362"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621680813361"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813361"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiomRule -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621680813362"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; [KindCoercion] -&gt; [KindCoercion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813364"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813361"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>    </span><span class="annot"><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span id="local-6989586621680813359"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621680813359"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; KindCoercion
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expandTypeSynonyms hit a hole&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoercionHole -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621680813359"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span>    </span><span id="local-6989586621680813391"><span class="annot"><span class="annottext">go_prov :: TCvSubst -&gt; UnivCoProvenance -&gt; UnivCoProvenance
</span><a href="#local-6989586621680813391"><span class="hs-identifier hs-var hs-var">go_prov</span></a></span></span><span> </span><span id="local-6989586621680813357"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813357"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PhantomProv"><span class="hs-identifier hs-type">PhantomProv</span></a></span><span> </span><span id="local-6989586621680813355"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813355"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813357"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813355"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>    </span><span class="annot"><a href="#local-6989586621680813391"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span id="local-6989586621680813354"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813354"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ProofIrrelProv"><span class="hs-identifier hs-type">ProofIrrelProv</span></a></span><span> </span><span id="local-6989586621680813352"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813352"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813354"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813352"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>    </span><span class="annot"><a href="#local-6989586621680813391"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><span class="hs-identifier">_</span></span><span>     </span><span id="local-6989586621680813351"><span class="annot"><span class="annottext">p :: UnivCoProvenance
</span><a href="#local-6989586621680813351"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PluginProv"><span class="hs-identifier hs-type">PluginProv</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680813351"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-522"></span><span>    </span><span class="annot"><a href="#local-6989586621680813391"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><span class="hs-identifier">_</span></span><span>     </span><span id="local-6989586621680813349"><span class="annot"><span class="annottext">p :: UnivCoProvenance
</span><a href="#local-6989586621680813349"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#CorePrepProv"><span class="hs-identifier hs-var">CorePrepProv</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680813349"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span>      </span><span class="hs-comment">-- the &quot;False&quot; and &quot;const&quot; are to accommodate the type of</span><span>
</span><span id="line-525"></span><span>      </span><span class="hs-comment">-- substForAllCoBndrUsing, which is general enough to</span><span>
</span><span id="line-526"></span><span>      </span><span class="hs-comment">-- handle coercion optimization (which sometimes swaps the</span><span>
</span><span id="line-527"></span><span>      </span><span class="hs-comment">-- order of a coercion)</span><span>
</span><span id="line-528"></span><span>    </span><span id="local-6989586621680813413"><span class="annot"><span class="annottext">go_cobndr :: TCvSubst
-&gt; TyVar -&gt; KindCoercion -&gt; (TCvSubst, TyVar, KindCoercion)
</span><a href="#local-6989586621680813413"><span class="hs-identifier hs-var hs-var">go_cobndr</span></a></span></span><span> </span><span id="local-6989586621680813347"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813347"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (KindCoercion -&gt; KindCoercion)
-&gt; TCvSubst
-&gt; TyVar
-&gt; KindCoercion
-&gt; (TCvSubst, TyVar, KindCoercion)
</span><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndrUsing"><span class="hs-identifier hs-var">substForAllCoBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621680813447"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813347"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680813347"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="hs-comment">-- | Extract the RuntimeRep classifier of a type from its kind. For example,</span><span>
</span><span id="line-532"></span><span class="hs-comment">-- @kindRep * = LiftedRep@; Panics if this is not possible.</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- Treats * and Constraint as the same</span><span>
</span><span id="line-534"></span><span class="annot"><a href="GHC.Core.Type.html#kindRep"><span class="hs-identifier hs-type">kindRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-535"></span><span id="kindRep"><span class="annot"><span class="annottext">kindRep :: HasDebugCallStack =&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#kindRep"><span class="hs-identifier hs-var hs-var">kindRep</span></a></span></span><span> </span><span id="local-6989586621680813340"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813340"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-var">kindRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813340"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-536"></span><span>              </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680813339"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813339"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813339"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-537"></span><span>              </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;kindRep&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813340"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="hs-comment">-- | Given a kind (TYPE rr), extract its RuntimeRep classifier rr.</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- For example, @kindRep_maybe * = Just LiftedRep@</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- Returns 'Nothing' if the kind is not of form (TYPE rr)</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- Treats * and Constraint as the same</span><span>
</span><span id="line-543"></span><span class="annot"><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-type">kindRep_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-544"></span><span id="kindRep_maybe"><span class="annot"><span class="annottext">kindRep_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-var hs-var">kindRep_maybe</span></a></span></span><span> </span><span id="local-6989586621680813336"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813336"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813335"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813335"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621680813334"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813334"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813336"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813335"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#tYPETyConKey"><span class="hs-identifier hs-var">tYPETyConKey</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813334"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="hs-comment">-- | This version considers Constraint to be the same as *. Returns True</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- if the argument is equivalent to Type/Constraint and False otherwise.</span><span>
</span><span id="line-551"></span><span class="hs-comment">-- See Note [Kind Constraint and kind Type]</span><span>
</span><span id="line-552"></span><span class="annot"><a href="GHC.Core.Type.html#isLiftedTypeKind"><span class="hs-identifier hs-type">isLiftedTypeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-553"></span><span id="isLiftedTypeKind"><span class="annot"><span class="annottext">isLiftedTypeKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedTypeKind"><span class="hs-identifier hs-var hs-var">isLiftedTypeKind</span></a></span></span><span> </span><span id="local-6989586621680813331"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813331"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-var">kindRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813331"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-555"></span><span>      </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680813330"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813330"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedRuntimeRep"><span class="hs-identifier hs-var">isLiftedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813330"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-556"></span><span>      </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span class="annot"><a href="GHC.Core.Type.html#isLiftedRuntimeRep"><span class="hs-identifier hs-type">isLiftedRuntimeRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-559"></span><span class="hs-comment">-- isLiftedRuntimeRep is true of LiftedRep :: RuntimeRep</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- False of type variables (a :: RuntimeRep)</span><span>
</span><span id="line-561"></span><span class="hs-comment">--   and of other reps e.g. (IntRep :: RuntimeRep)</span><span>
</span><span id="line-562"></span><span id="isLiftedRuntimeRep"><span class="annot"><span class="annottext">isLiftedRuntimeRep :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedRuntimeRep"><span class="hs-identifier hs-var hs-var">isLiftedRuntimeRep</span></a></span></span><span> </span><span id="local-6989586621680813329"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813329"><span class="hs-identifier hs-var">rep</span></a></span></span><span>
</span><span id="line-563"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813328"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813328"><span class="hs-identifier hs-var">rr_tc</span></a></span></span><span> </span><span id="local-6989586621680813327"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813327"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813329"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813328"><span class="hs-identifier hs-var">rr_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#liftedRepDataConKey"><span class="hs-identifier hs-var">liftedRepDataConKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-565"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-comment">-- | Returns True if the kind classifies unlifted types and False otherwise.</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- Note that this returns False for levity-polymorphic kinds, which may</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- be specialized to a kind that classifies unlifted types.</span><span>
</span><span id="line-570"></span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedTypeKind"><span class="hs-identifier hs-type">isUnliftedTypeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-571"></span><span id="isUnliftedTypeKind"><span class="annot"><span class="annottext">isUnliftedTypeKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnliftedTypeKind"><span class="hs-identifier hs-var hs-var">isUnliftedTypeKind</span></a></span></span><span> </span><span id="local-6989586621680813324"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813324"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-var">kindRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813324"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-573"></span><span>      </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680813323"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813323"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnliftedRuntimeRep"><span class="hs-identifier hs-var">isUnliftedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813323"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-574"></span><span>      </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedRuntimeRep"><span class="hs-identifier hs-type">isUnliftedRuntimeRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-577"></span><span class="hs-comment">-- True of definitely-unlifted RuntimeReps</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- False of           (LiftedRep :: RuntimeRep)</span><span>
</span><span id="line-579"></span><span class="hs-comment">--   and of variables (a :: RuntimeRep)</span><span>
</span><span id="line-580"></span><span id="isUnliftedRuntimeRep"><span class="annot"><span class="annottext">isUnliftedRuntimeRep :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnliftedRuntimeRep"><span class="hs-identifier hs-var hs-var">isUnliftedRuntimeRep</span></a></span></span><span> </span><span id="local-6989586621680813322"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813322"><span class="hs-identifier hs-var">rep</span></a></span></span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813321"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813321"><span class="hs-identifier hs-var">rr_tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813322"><span class="hs-identifier hs-var">rep</span></a></span><span>   </span><span class="hs-comment">-- NB: args might be non-empty</span><span>
</span><span id="line-582"></span><span>                                           </span><span class="hs-comment">--     e.g. TupleRep [r1, .., rn]</span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isPromotedDataCon"><span class="hs-identifier hs-var">isPromotedDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813321"><span class="hs-identifier hs-var">rr_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813321"><span class="hs-identifier hs-var">rr_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#liftedRepDataConKey"><span class="hs-identifier hs-var">liftedRepDataConKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>        </span><span class="hs-comment">-- Avoid searching all the unlifted RuntimeRep type cons</span><span>
</span><span id="line-585"></span><span>        </span><span class="hs-comment">-- In the RuntimeRep data type, only LiftedRep is lifted</span><span>
</span><span id="line-586"></span><span>        </span><span class="hs-comment">-- But be careful of type families (F tys) :: RuntimeRep</span><span>
</span><span id="line-587"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-comment">{- Variables, applications -}</span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="hs-comment">-- | Is this the type 'RuntimeRep'?</span><span>
</span><span id="line-591"></span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepTy"><span class="hs-identifier hs-type">isRuntimeRepTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-592"></span><span id="isRuntimeRepTy"><span class="annot"><span class="annottext">isRuntimeRepTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isRuntimeRepTy"><span class="hs-identifier hs-var hs-var">isRuntimeRepTy</span></a></span></span><span> </span><span id="local-6989586621680813319"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813319"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-593"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813318"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813318"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680813317"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813317"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813319"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-594"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813318"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#runtimeRepTyConKey"><span class="hs-identifier hs-var">runtimeRepTyConKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span class="hs-comment">-- | Is a tyvar of type 'RuntimeRep'?</span><span>
</span><span id="line-599"></span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepVar"><span class="hs-identifier hs-type">isRuntimeRepVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-600"></span><span id="isRuntimeRepVar"><span class="annot"><span class="annottext">isRuntimeRepVar :: TyVar -&gt; Bool
</span><a href="GHC.Core.Type.html#isRuntimeRepVar"><span class="hs-identifier hs-var hs-var">isRuntimeRepVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isRuntimeRepTy"><span class="hs-identifier hs-var">isRuntimeRepTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (TyVar -&gt; Type) -&gt; TyVar -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span class="hs-comment">-- | Is this the type 'Multiplicity'?</span><span>
</span><span id="line-603"></span><span class="annot"><a href="GHC.Core.Type.html#isMultiplicityTy"><span class="hs-identifier hs-type">isMultiplicityTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-604"></span><span id="isMultiplicityTy"><span class="annot"><span class="annottext">isMultiplicityTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isMultiplicityTy"><span class="hs-identifier hs-var hs-var">isMultiplicityTy</span></a></span></span><span> </span><span id="local-6989586621680813314"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813314"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-605"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813313"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813313"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813314"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813313"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#multiplicityTyConKey"><span class="hs-identifier hs-var">multiplicityTyConKey</span></a></span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="hs-comment">-- | Is a tyvar of type 'Multiplicity'?</span><span>
</span><span id="line-609"></span><span class="annot"><a href="GHC.Core.Type.html#isMultiplicityVar"><span class="hs-identifier hs-type">isMultiplicityVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-610"></span><span id="isMultiplicityVar"><span class="annot"><span class="annottext">isMultiplicityVar :: TyVar -&gt; Bool
</span><a href="GHC.Core.Type.html#isMultiplicityVar"><span class="hs-identifier hs-var hs-var">isMultiplicityVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isMultiplicityTy"><span class="hs-identifier hs-var">isMultiplicityTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (TyVar -&gt; Type) -&gt; TyVar -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
               mapType
*                                                                      *
************************************************************************

These functions do a map-like operation over types, performing some operation
on all variables and binding sites. Primarily used for zonking.

Note [Efficiency for ForAllCo case of mapTyCoX]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
As noted in Note [Forall coercions] in GHC.Core.TyCo.Rep, a ForAllCo is a bit redundant.
It stores a TyCoVar and a Coercion, where the kind of the TyCoVar always matches
the left-hand kind of the coercion. This is convenient lots of the time, but
not when mapping a function over a coercion.

The problem is that tcm_tybinder will affect the TyCoVar's kind and
mapCoercion will affect the Coercion, and we hope that the results will be
the same. Even if they are the same (which should generally happen with
correct algorithms), then there is an efficiency issue. In particular,
this problem seems to make what should be a linear algorithm into a potentially
exponential one. But it's only going to be bad in the case where there's
lots of foralls in the kinds of other foralls. Like this:

  forall a : (forall b : (forall c : ...). ...). ...

This construction seems unlikely. So we'll do the inefficient, easy way
for now.

Note [Specialising mappers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~
These INLINE pragmas are indispensable. mapTyCo and mapTyCoX are used
to implement zonking, and it's vital that they get specialised to the TcM
monad and the particular mapper in use.

Even specialising to the monad alone made a 20% allocation difference
in perf/compiler/T5030.

See Note [Specialising foldType] in &quot;GHC.Core.TyCo.Rep&quot; for more details of this
idiom.
-}</span><span>
</span><span id="line-653"></span><span>
</span><span id="line-654"></span><span class="hs-comment">-- | This describes how a &quot;map&quot; operation over a type/coercion should behave</span><span>
</span><span id="line-655"></span><span class="hs-keyword">data</span><span> </span><span id="TyCoMapper"><span class="annot"><a href="GHC.Core.Type.html#TyCoMapper"><span class="hs-identifier hs-var">TyCoMapper</span></a></span></span><span> </span><span id="local-6989586621680814205"><span class="annot"><a href="#local-6989586621680814205"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680814204"><span class="annot"><a href="#local-6989586621680814204"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TyCoMapper"><span class="annot"><a href="GHC.Core.Type.html#TyCoMapper"><span class="hs-identifier hs-var">TyCoMapper</span></a></span></span><span>
</span><span id="line-657"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="tcm_tyvar"><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; TyVar -&gt; m Type
</span><a href="GHC.Core.Type.html#tcm_tyvar"><span class="hs-identifier hs-var hs-var">tcm_tyvar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680814205"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-658"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="tcm_covar"><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; TyVar -&gt; m KindCoercion
</span><a href="GHC.Core.Type.html#tcm_covar"><span class="hs-identifier hs-var hs-var">tcm_covar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680814205"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-659"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="tcm_hole"><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; CoercionHole -&gt; m KindCoercion
</span><a href="GHC.Core.Type.html#tcm_hole"><span class="hs-identifier hs-var hs-var">tcm_hole</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680814205"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionHole"><span class="hs-identifier hs-type">CoercionHole</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-660"></span><span>          </span><span class="hs-comment">-- ^ What to do with coercion holes.</span><span>
</span><span id="line-661"></span><span>          </span><span class="hs-comment">-- See Note [Coercion holes] in &quot;GHC.Core.TyCo.Rep&quot;.</span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="tcm_tycobinder"><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; TyVar -&gt; ArgFlag -&gt; m (env, TyVar)
</span><a href="GHC.Core.Type.html#tcm_tycobinder"><span class="hs-identifier hs-var hs-var">tcm_tycobinder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680814205"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680814205"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>          </span><span class="hs-comment">-- ^ The returned env is used in the extended scope</span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="tcm_tycon"><span class="annot"><span class="annottext">forall env (m :: * -&gt; *). TyCoMapper env m -&gt; TyCon -&gt; m TyCon
</span><a href="GHC.Core.Type.html#tcm_tycon"><span class="hs-identifier hs-var hs-var">tcm_tycon</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-667"></span><span>          </span><span class="hs-comment">-- ^ This is used only for TcTyCons</span><span>
</span><span id="line-668"></span><span>          </span><span class="hs-comment">-- a) To zonk TcTyCons</span><span>
</span><span id="line-669"></span><span>          </span><span class="hs-comment">-- b) To turn TcTyCons into TyCons.</span><span>
</span><span id="line-670"></span><span>          </span><span class="hs-comment">--    See Note [Type checking recursive type and class declarations]</span><span>
</span><span id="line-671"></span><span>          </span><span class="hs-comment">--    in &quot;GHC.Tc.TyCl&quot;</span><span>
</span><span id="line-672"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mapTyCo"><span class="hs-pragma hs-type">mapTyCo</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>  </span><span class="hs-comment">-- See Note [Specialising mappers]</span><span>
</span><span id="line-675"></span><span id="local-6989586621680814192"><span class="annot"><a href="GHC.Core.Type.html#mapTyCo"><span class="hs-identifier hs-type">mapTyCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680814192"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680814192"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-676"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814192"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-677"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814192"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-678"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814192"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-679"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814192"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-680"></span><span id="mapTyCo"><span class="annot"><span class="annottext">mapTyCo :: forall (m :: * -&gt; *).
Monad m =&gt;
TyCoMapper () m
-&gt; (Type -&gt; m Type, [Type] -&gt; m [Type],
    KindCoercion -&gt; m KindCoercion, [KindCoercion] -&gt; m [KindCoercion])
</span><a href="GHC.Core.Type.html#mapTyCo"><span class="hs-identifier hs-var hs-var">mapTyCo</span></a></span></span><span> </span><span id="local-6989586621680813301"><span class="annot"><span class="annottext">TyCoMapper () m
</span><a href="#local-6989586621680813301"><span class="hs-identifier hs-var">mapper</span></a></span></span><span>
</span><span id="line-681"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyCoMapper () m
-&gt; (() -&gt; Type -&gt; m Type, () -&gt; [Type] -&gt; m [Type],
    () -&gt; KindCoercion -&gt; m KindCoercion,
    () -&gt; [KindCoercion] -&gt; m [KindCoercion])
forall (m :: * -&gt; *) env.
Monad m =&gt;
TyCoMapper env m
-&gt; (env -&gt; Type -&gt; m Type, env -&gt; [Type] -&gt; m [Type],
    env -&gt; KindCoercion -&gt; m KindCoercion,
    env -&gt; [KindCoercion] -&gt; m [KindCoercion])
</span><a href="GHC.Core.Type.html#mapTyCoX"><span class="hs-identifier hs-var">mapTyCoX</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoMapper () m
</span><a href="#local-6989586621680813301"><span class="hs-identifier hs-var">mapper</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-682"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621680813300"><span class="annot"><span class="annottext">() -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813300"><span class="hs-identifier hs-var">go_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813299"><span class="annot"><span class="annottext">() -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621680813299"><span class="hs-identifier hs-var">go_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813298"><span class="annot"><span class="annottext">() -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813298"><span class="hs-identifier hs-var">go_co</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813297"><span class="annot"><span class="annottext">() -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621680813297"><span class="hs-identifier hs-var">go_cos</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813300"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">() -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621680813299"><span class="hs-identifier hs-var">go_tys</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">() -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813298"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">() -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621680813297"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mapTyCoX"><span class="hs-pragma hs-type">mapTyCoX</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>  </span><span class="hs-comment">-- See Note [Specialising mappers]</span><span>
</span><span id="line-686"></span><span id="local-6989586621680814189"><span id="local-6989586621680814190"><span class="annot"><a href="GHC.Core.Type.html#mapTyCoX"><span class="hs-identifier hs-type">mapTyCoX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680814190"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680814189"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680814190"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-687"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621680814189"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814190"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-688"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680814189"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814190"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-689"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680814189"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814190"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-690"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680814189"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814190"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-691"></span><span id="mapTyCoX"><span class="annot"><span class="annottext">mapTyCoX :: forall (m :: * -&gt; *) env.
Monad m =&gt;
TyCoMapper env m
-&gt; (env -&gt; Type -&gt; m Type, env -&gt; [Type] -&gt; m [Type],
    env -&gt; KindCoercion -&gt; m KindCoercion,
    env -&gt; [KindCoercion] -&gt; m [KindCoercion])
</span><a href="GHC.Core.Type.html#mapTyCoX"><span class="hs-identifier hs-var hs-var">mapTyCoX</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcm_tyvar :: forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; TyVar -&gt; m Type
</span><a href="GHC.Core.Type.html#tcm_tyvar"><span class="hs-identifier hs-var">tcm_tyvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680813291"><span class="annot"><span class="annottext">env -&gt; TyVar -&gt; m Type
</span><a href="#local-6989586621680813291"><span class="hs-identifier hs-var">tyvar</span></a></span></span><span>
</span><span id="line-692"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcm_tycobinder :: forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; TyVar -&gt; ArgFlag -&gt; m (env, TyVar)
</span><a href="GHC.Core.Type.html#tcm_tycobinder"><span class="hs-identifier hs-var">tcm_tycobinder</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680813290"><span class="annot"><span class="annottext">env -&gt; TyVar -&gt; ArgFlag -&gt; m (env, TyVar)
</span><a href="#local-6989586621680813290"><span class="hs-identifier hs-var">tycobinder</span></a></span></span><span>
</span><span id="line-693"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcm_tycon :: forall env (m :: * -&gt; *). TyCoMapper env m -&gt; TyCon -&gt; m TyCon
</span><a href="GHC.Core.Type.html#tcm_tycon"><span class="hs-identifier hs-var">tcm_tycon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680813289"><span class="annot"><span class="annottext">TyCon -&gt; m TyCon
</span><a href="#local-6989586621680813289"><span class="hs-identifier hs-var">tycon</span></a></span></span><span>
</span><span id="line-694"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcm_covar :: forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; TyVar -&gt; m KindCoercion
</span><a href="GHC.Core.Type.html#tcm_covar"><span class="hs-identifier hs-var">tcm_covar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680813288"><span class="annot"><span class="annottext">env -&gt; TyVar -&gt; m KindCoercion
</span><a href="#local-6989586621680813288"><span class="hs-identifier hs-var">covar</span></a></span></span><span>
</span><span id="line-695"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcm_hole :: forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; CoercionHole -&gt; m KindCoercion
</span><a href="GHC.Core.Type.html#tcm_hole"><span class="hs-identifier hs-var">tcm_hole</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680813287"><span class="annot"><span class="annottext">env -&gt; CoercionHole -&gt; m KindCoercion
</span><a href="#local-6989586621680813287"><span class="hs-identifier hs-var">cohole</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">env -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621680813285"><span class="hs-identifier hs-var">go_tys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621680813283"><span class="hs-identifier hs-var">go_cos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-698"></span><span>    </span><span id="local-6989586621680813285"><span class="annot"><span class="annottext">go_tys :: env -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621680813285"><span class="hs-identifier hs-var hs-var">go_tys</span></a></span></span><span> </span><span class="annot"><span class="annottext">env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; m [Type]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-699"></span><span>    </span><span class="annot"><a href="#local-6989586621680813285"><span class="hs-identifier hs-var">go_tys</span></a></span><span> </span><span id="local-6989586621680813216"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813216"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680813215"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813215"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680813214"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813214"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; [Type] -&gt; [Type]) -&gt; m Type -&gt; m ([Type] -&gt; [Type])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813216"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813215"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">m ([Type] -&gt; [Type]) -&gt; m [Type] -&gt; m [Type]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621680813285"><span class="hs-identifier hs-var">go_tys</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813216"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813214"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span>    </span><span id="local-6989586621680813286"><span class="annot"><span class="annottext">go_ty :: env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var hs-var">go_ty</span></a></span></span><span> </span><span id="local-6989586621680813212"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813212"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680813211"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813211"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">env -&gt; TyVar -&gt; m Type
</span><a href="#local-6989586621680813291"><span class="hs-identifier hs-var">tyvar</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813212"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813211"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-702"></span><span>    </span><span class="annot"><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span id="local-6989586621680813210"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813210"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680813209"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813209"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680813208"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813208"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; m Type -&gt; m (Type -&gt; Type)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813210"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813209"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">m (Type -&gt; Type) -&gt; m Type -&gt; m Type
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813210"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813208"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-703"></span><span>    </span><span class="annot"><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621680813207"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680813207"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813207"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-704"></span><span>    </span><span class="annot"><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span id="local-6989586621680813206"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813206"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680813205"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813205"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680813204"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813204"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; KindCoercion -&gt; Type)
-&gt; m Type -&gt; m (KindCoercion -&gt; Type)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813206"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813205"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">m (KindCoercion -&gt; Type) -&gt; m KindCoercion -&gt; m Type
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813206"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813204"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-705"></span><span>    </span><span class="annot"><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span id="local-6989586621680813203"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813203"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621680813202"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813202"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; Type) -&gt; m KindCoercion -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813203"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813202"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span>    </span><span class="annot"><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span id="local-6989586621680813201"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813201"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680813200"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680813200"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680813199"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813199"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680813198"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813198"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621680813197"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813197"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680813196"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813196"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813201"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813199"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621680813195"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813195"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813201"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813198"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621680813194"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813194"><span class="hs-identifier hs-var">res'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813201"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813197"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-709"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813200"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813196"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813195"><span class="hs-identifier hs-var">arg'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813194"><span class="hs-identifier hs-var">res'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-710"></span><span>
</span><span id="line-711"></span><span>    </span><span class="annot"><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span id="local-6989586621680813193"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813193"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680813192"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680813192"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813191"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813191"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680813190"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813190"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTcTyCon"><span class="hs-identifier hs-var">isTcTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813191"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-713"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680813188"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813188"><span class="hs-identifier hs-var">tc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; m TyCon
</span><a href="#local-6989586621680813289"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813191"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-714"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813188"><span class="hs-identifier hs-var">tc'</span></a></span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; Type) -&gt; m [Type] -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621680813285"><span class="hs-identifier hs-var">go_tys</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813193"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813190"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span>      </span><span class="hs-comment">-- Not a TcTyCon</span><span>
</span><span id="line-717"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813190"><span class="hs-identifier hs-var">tys</span></a></span><span>    </span><span class="hs-comment">-- Avoid allocation in this very</span><span>
</span><span id="line-718"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813192"><span class="hs-identifier hs-var">ty</span></a></span><span>   </span><span class="hs-comment">-- common case (E.g. Int, LiftedRep etc)</span><span>
</span><span id="line-719"></span><span>
</span><span id="line-720"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-721"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813191"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; Type) -&gt; m [Type] -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621680813285"><span class="hs-identifier hs-var">go_tys</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813193"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813190"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span>    </span><span class="annot"><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span id="local-6989586621680813187"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813187"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680813186"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813186"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680813185"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680813185"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680813184"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813184"><span class="hs-identifier hs-var">inner</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-724"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680813183"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813183"><span class="hs-identifier hs-var">env'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813182"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813182"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">env -&gt; TyVar -&gt; ArgFlag -&gt; m (env, TyVar)
</span><a href="#local-6989586621680813290"><span class="hs-identifier hs-var">tycobinder</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813187"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813186"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680813185"><span class="hs-identifier hs-var">vis</span></a></span><span>
</span><span id="line-725"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680813181"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813181"><span class="hs-identifier hs-var">inner'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813183"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813184"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-726"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; m Type) -&gt; Type -&gt; m Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ArgFlag -&gt; VarBndr TyVar ArgFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813182"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680813185"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813181"><span class="hs-identifier hs-var">inner'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span>    </span><span id="local-6989586621680813283"><span class="annot"><span class="annottext">go_cos :: env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621680813283"><span class="hs-identifier hs-var hs-var">go_cos</span></a></span></span><span> </span><span class="annot"><span class="annottext">env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[KindCoercion] -&gt; m [KindCoercion]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-729"></span><span>    </span><span class="annot"><a href="#local-6989586621680813283"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span id="local-6989586621680813180"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813180"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680813179"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813179"><span class="hs-identifier hs-var">co</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680813178"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813178"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; [KindCoercion] -&gt; [KindCoercion])
-&gt; m KindCoercion -&gt; m ([KindCoercion] -&gt; [KindCoercion])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813180"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813179"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">m ([KindCoercion] -&gt; [KindCoercion])
-&gt; m [KindCoercion] -&gt; m [KindCoercion]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621680813283"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813180"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813178"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-730"></span><span>
</span><span id="line-731"></span><span>    </span><span id="local-6989586621680813177"><span class="annot"><span class="annottext">go_mco :: env -&gt; MCoercionN -&gt; m MCoercionN
</span><a href="#local-6989586621680813177"><span class="hs-identifier hs-var hs-var">go_mco</span></a></span></span><span> </span><span class="annot"><span class="annottext">env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MCoercionN -&gt; m MCoercionN
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>
</span><span id="line-732"></span><span>    </span><span class="annot"><a href="#local-6989586621680813177"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span id="local-6989586621680813176"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813176"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621680813175"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813175"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-var">MCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; MCoercionN) -&gt; m KindCoercion -&gt; m MCoercionN
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813176"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813175"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>
</span><span id="line-734"></span><span>    </span><span id="local-6989586621680813284"><span class="annot"><span class="annottext">go_co :: env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var hs-var">go_co</span></a></span></span><span> </span><span id="local-6989586621680813174"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813174"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span id="local-6989586621680813173"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813173"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; KindCoercion) -&gt; m Type -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813174"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813173"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-735"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813172"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813172"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span id="local-6989586621680813171"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813171"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680813170"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813170"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680813169"><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621680813169"><span class="hs-identifier hs-var">mco</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; MCoercionN -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkGReflCo"><span class="hs-identifier hs-var">mkGReflCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813171"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; MCoercionN -&gt; KindCoercion)
-&gt; m Type -&gt; m (MCoercionN -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813172"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813170"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">m (MCoercionN -&gt; KindCoercion) -&gt; m MCoercionN -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; MCoercionN -&gt; m MCoercionN
</span><a href="#local-6989586621680813177"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813172"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621680813169"><span class="hs-identifier hs-var">mco</span></a></span><span>
</span><span id="line-736"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813168"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813168"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621680813167"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813167"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621680813166"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813166"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkAppCo"><span class="hs-identifier hs-var">mkAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m (KindCoercion -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813168"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813167"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">m (KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813168"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813166"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-737"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813165"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813165"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span id="local-6989586621680813164"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813164"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680813163"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813163"><span class="hs-identifier hs-var">cw</span></a></span></span><span> </span><span id="local-6989586621680813162"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813162"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621680813161"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813161"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role
-&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkFunCo"><span class="hs-identifier hs-var">mkFunCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813164"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion
-&gt; m (KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813165"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813163"><span class="hs-identifier hs-var">cw</span></a></span><span> </span><span class="annot"><span class="annottext">m (KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m (KindCoercion -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813165"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813162"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">m (KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813165"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813161"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-738"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813160"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813160"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span id="local-6989586621680813159"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813159"><span class="hs-identifier hs-var">cv</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">env -&gt; TyVar -&gt; m KindCoercion
</span><a href="#local-6989586621680813288"><span class="hs-identifier hs-var">covar</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813160"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813159"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-739"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813158"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813158"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span id="local-6989586621680813157"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621680813157"><span class="hs-identifier hs-var">hole</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">env -&gt; CoercionHole -&gt; m KindCoercion
</span><a href="#local-6989586621680813287"><span class="hs-identifier hs-var">cohole</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813158"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621680813157"><span class="hs-identifier hs-var">hole</span></a></span><span>
</span><span id="line-740"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813156"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813156"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span id="local-6989586621680813155"><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680813155"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680813154"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813154"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680813153"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813153"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680813152"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813152"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; Role -&gt; Type -&gt; Type -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkUnivCo"><span class="hs-identifier hs-var">mkUnivCo</span></a></span><span> </span><span class="annot"><span class="annottext">(UnivCoProvenance -&gt; Role -&gt; Type -&gt; Type -&gt; KindCoercion)
-&gt; m UnivCoProvenance -&gt; m (Role -&gt; Type -&gt; Type -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; UnivCoProvenance -&gt; m UnivCoProvenance
</span><a href="#local-6989586621680813151"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813156"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680813155"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">m (Role -&gt; Type -&gt; Type -&gt; KindCoercion)
-&gt; m Role -&gt; m (Type -&gt; Type -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; m Role
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813154"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-741"></span><span>                                    </span><span class="annot"><span class="annottext">m (Type -&gt; Type -&gt; KindCoercion)
-&gt; m Type -&gt; m (Type -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813156"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813153"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">m (Type -&gt; KindCoercion) -&gt; m Type -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621680813286"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813156"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813152"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-742"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813150"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813150"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621680813149"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813149"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813150"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813149"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-743"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813148"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813148"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621680813147"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813147"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621680813146"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813146"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m (KindCoercion -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813148"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813147"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">m (KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813148"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813146"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-744"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813145"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813145"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomRuleCo"><span class="hs-identifier hs-type">AxiomRuleCo</span></a></span><span> </span><span id="local-6989586621680813144"><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621680813144"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680813143"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813143"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiomRule -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621680813144"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">([KindCoercion] -&gt; KindCoercion)
-&gt; m [KindCoercion] -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621680813283"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813145"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813143"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-745"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813142"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813142"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NthCo"><span class="hs-identifier hs-type">NthCo</span></a></span><span> </span><span id="local-6989586621680813141"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813141"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680813140"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680813140"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680813139"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813139"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Role -&gt; Int -&gt; KindCoercion -&gt; KindCoercion
Role -&gt; Int -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkNthCo"><span class="hs-identifier hs-var">mkNthCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813141"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680813140"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813142"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813139"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-746"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813138"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813138"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span id="local-6989586621680813137"><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621680813137"><span class="hs-identifier hs-var">lr</span></a></span></span><span> </span><span id="local-6989586621680813136"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813136"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LeftOrRight -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkLRCo"><span class="hs-identifier hs-var">mkLRCo</span></a></span><span> </span><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621680813137"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813138"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813136"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-747"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813135"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813135"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621680813134"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813134"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621680813133"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813133"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkInstCo"><span class="hs-identifier hs-var">mkInstCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m (KindCoercion -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813135"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813134"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">m (KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813135"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813133"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-748"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813132"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813132"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621680813131"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813131"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkKindCo"><span class="hs-identifier hs-var">mkKindCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813132"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813131"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-749"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813130"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813130"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621680813129"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813129"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkSubCo"><span class="hs-identifier hs-var">mkSubCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813130"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813129"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-750"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813128"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813128"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomInstCo"><span class="hs-identifier hs-type">AxiomInstCo</span></a></span><span> </span><span id="local-6989586621680813127"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621680813127"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621680813126"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680813126"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680813125"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813125"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; Int -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkAxiomInstCo"><span class="hs-identifier hs-var">mkAxiomInstCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621680813127"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680813126"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">([KindCoercion] -&gt; KindCoercion)
-&gt; m [KindCoercion] -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621680813283"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813128"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813125"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-751"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813124"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813124"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680813123"><span class="annot"><span class="annottext">co :: KindCoercion
</span><a href="#local-6989586621680813123"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span id="local-6989586621680813122"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813122"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680813121"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813121"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680813120"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813120"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTcTyCon"><span class="hs-identifier hs-var">isTcTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813121"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-753"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680813119"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813119"><span class="hs-identifier hs-var">tc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; m TyCon
</span><a href="#local-6989586621680813289"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813121"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-754"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-var">mkTyConAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813122"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813119"><span class="hs-identifier hs-var">tc'</span></a></span><span> </span><span class="annot"><span class="annottext">([KindCoercion] -&gt; KindCoercion)
-&gt; m [KindCoercion] -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621680813283"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813124"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813120"><span class="hs-identifier hs-var">cos</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-755"></span><span>
</span><span id="line-756"></span><span>      </span><span class="hs-comment">-- Not a TcTyCon</span><span>
</span><span id="line-757"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[KindCoercion] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813120"><span class="hs-identifier hs-var">cos</span></a></span><span>    </span><span class="hs-comment">-- Avoid allocation in this very</span><span>
</span><span id="line-758"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; m KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813123"><span class="hs-identifier hs-var">co</span></a></span><span>   </span><span class="hs-comment">-- common case (E.g. Int, LiftedRep etc)</span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-761"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-var">mkTyConAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680813122"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813121"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">([KindCoercion] -&gt; KindCoercion)
-&gt; m [KindCoercion] -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621680813283"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813124"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813120"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-762"></span><span>    </span><span class="annot"><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680813118"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813118"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span id="local-6989586621680813117"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813117"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680813116"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813116"><span class="hs-identifier hs-var">kind_co</span></a></span></span><span> </span><span id="local-6989586621680813115"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813115"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680813114"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813114"><span class="hs-identifier hs-var">kind_co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813118"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813116"><span class="hs-identifier hs-var">kind_co</span></a></span><span>
</span><span id="line-764"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680813113"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813113"><span class="hs-identifier hs-var">env'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813112"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813112"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">env -&gt; TyVar -&gt; ArgFlag -&gt; m (env, TyVar)
</span><a href="#local-6989586621680813290"><span class="hs-identifier hs-var">tycobinder</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813118"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813117"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span>
</span><span id="line-765"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680813110"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813110"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813113"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813115"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-766"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; m KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; m KindCoercion) -&gt; KindCoercion -&gt; m KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkForAllCo"><span class="hs-identifier hs-var">mkForAllCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813112"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813114"><span class="hs-identifier hs-var">kind_co'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813110"><span class="hs-identifier hs-var">co'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-767"></span><span>        </span><span class="hs-comment">-- See Note [Efficiency for ForAllCo case of mapTyCoX]</span><span>
</span><span id="line-768"></span><span>
</span><span id="line-769"></span><span>    </span><span id="local-6989586621680813151"><span class="annot"><span class="annottext">go_prov :: env -&gt; UnivCoProvenance -&gt; m UnivCoProvenance
</span><a href="#local-6989586621680813151"><span class="hs-identifier hs-var hs-var">go_prov</span></a></span></span><span> </span><span id="local-6989586621680813109"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813109"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PhantomProv"><span class="hs-identifier hs-type">PhantomProv</span></a></span><span> </span><span id="local-6989586621680813108"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813108"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; UnivCoProvenance)
-&gt; m KindCoercion -&gt; m UnivCoProvenance
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813109"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813108"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-770"></span><span>    </span><span class="annot"><a href="#local-6989586621680813151"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span id="local-6989586621680813107"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813107"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ProofIrrelProv"><span class="hs-identifier hs-type">ProofIrrelProv</span></a></span><span> </span><span id="local-6989586621680813106"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813106"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; UnivCoProvenance)
-&gt; m KindCoercion -&gt; m UnivCoProvenance
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621680813284"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680813107"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813106"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-771"></span><span>    </span><span class="annot"><a href="#local-6989586621680813151"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621680813105"><span class="annot"><span class="annottext">p :: UnivCoProvenance
</span><a href="#local-6989586621680813105"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PluginProv"><span class="hs-identifier hs-type">PluginProv</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; m UnivCoProvenance
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680813105"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-772"></span><span>    </span><span class="annot"><a href="#local-6989586621680813151"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621680813104"><span class="annot"><span class="annottext">p :: UnivCoProvenance
</span><a href="#local-6989586621680813104"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#CorePrepProv"><span class="hs-identifier hs-var">CorePrepProv</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; m UnivCoProvenance
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680813104"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-773"></span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Constructor-specific functions}
*                                                                      *
************************************************************************


---------------------------------------------------------------------
                                TyVarTy
                                ~~~~~~~
-}</span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span class="hs-comment">-- | Attempts to obtain the type variable underlying a 'Type', and panics with the</span><span>
</span><span id="line-789"></span><span class="hs-comment">-- given message if this is not a type variable type. See also 'getTyVar_maybe'</span><span>
</span><span id="line-790"></span><span class="annot"><a href="GHC.Core.Type.html#getTyVar"><span class="hs-identifier hs-type">getTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span>
</span><span id="line-791"></span><span id="getTyVar"><span class="annot"><span class="annottext">getTyVar :: String -&gt; Type -&gt; TyVar
</span><a href="GHC.Core.Type.html#getTyVar"><span class="hs-identifier hs-var hs-var">getTyVar</span></a></span></span><span> </span><span id="local-6989586621680813103"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680813103"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621680813102"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813102"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813102"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-792"></span><span>                    </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680813101"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813101"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813101"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-793"></span><span>                    </span><span class="annot"><span class="annottext">Maybe TyVar
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TyVar
forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getTyVar: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680813103"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span class="annot"><a href="GHC.Core.Type.html#isTyVarTy"><span class="hs-identifier hs-type">isTyVarTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-796"></span><span id="isTyVarTy"><span class="annot"><span class="annottext">isTyVarTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTyVarTy"><span class="hs-identifier hs-var hs-var">isTyVarTy</span></a></span></span><span> </span><span id="local-6989586621680813099"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813099"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyVar -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../base/src/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813099"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span>
</span><span id="line-798"></span><span class="hs-comment">-- | Attempts to obtain the type variable underlying a 'Type'</span><span>
</span><span id="line-799"></span><span class="annot"><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-type">getTyVar_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span>
</span><span id="line-800"></span><span id="getTyVar_maybe"><span class="annot"><span class="annottext">getTyVar_maybe :: Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-var hs-var">getTyVar_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#repGetTyVar_maybe"><span class="hs-identifier hs-var">repGetTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe TyVar) -&gt; (Type -&gt; Type) -&gt; Type -&gt; Maybe TyVar
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span>
</span><span id="line-801"></span><span>
</span><span id="line-802"></span><span class="hs-comment">-- | If the type is a tyvar, possibly under a cast, returns it, along</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- with the coercion. Thus, the co is :: kind tv ~N kind ty</span><span>
</span><span id="line-804"></span><span class="annot"><a href="GHC.Core.Type.html#getCastedTyVar_maybe"><span class="hs-identifier hs-type">getCastedTyVar_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionN"><span class="hs-identifier hs-type">CoercionN</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-805"></span><span id="getCastedTyVar_maybe"><span class="annot"><span class="annottext">getCastedTyVar_maybe :: Type -&gt; Maybe (TyVar, KindCoercion)
</span><a href="GHC.Core.Type.html#getCastedTyVar_maybe"><span class="hs-identifier hs-var hs-var">getCastedTyVar_maybe</span></a></span></span><span> </span><span id="local-6989586621680813097"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813097"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813097"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-806"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680813096"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813096"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680813095"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813095"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TyVar, KindCoercion) -&gt; Maybe (TyVar, KindCoercion)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813096"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813095"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-807"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680813094"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813094"><span class="hs-identifier hs-var">tv</span></a></span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TyVar, KindCoercion) -&gt; Maybe (TyVar, KindCoercion)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813094"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkReflCo"><span class="hs-identifier hs-var">mkReflCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="GHC.Core.Coercion.Axiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813094"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TyVar, KindCoercion)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-809"></span><span>
</span><span id="line-810"></span><span class="hs-comment">-- | Attempts to obtain the type variable underlying a 'Type', without</span><span>
</span><span id="line-811"></span><span class="hs-comment">-- any expansion</span><span>
</span><span id="line-812"></span><span class="annot"><a href="GHC.Core.Type.html#repGetTyVar_maybe"><span class="hs-identifier hs-type">repGetTyVar_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span>
</span><span id="line-813"></span><span id="repGetTyVar_maybe"><span class="annot"><span class="annottext">repGetTyVar_maybe :: Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#repGetTyVar_maybe"><span class="hs-identifier hs-var hs-var">repGetTyVar_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680813092"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813092"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Maybe TyVar
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680813092"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-814"></span><span class="annot"><a href="GHC.Core.Type.html#repGetTyVar_maybe"><span class="hs-identifier hs-var">repGetTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyVar
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span class="hs-comment">{-
---------------------------------------------------------------------
                                AppTy
                                ~~~~~
We need to be pretty careful with AppTy to make sure we obey the
invariant that a TyConApp is always visibly so.  mkAppTy maintains the
invariant: use it.

Note [Decomposing fat arrow c=&gt;t]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Can we unify (a b) with (Eq a =&gt; ty)?   If we do so, we end up with
a partial application like ((=&gt;) Eq a) which doesn't make sense in
source Haskell.  In contrast, we *can* unify (a b) with (t1 -&gt; t2).
Here's an example (#9858) of how you might do it:
   i :: (Typeable a, Typeable b) =&gt; Proxy (a b) -&gt; TypeRep
   i p = typeRep p

   j = i (Proxy :: Proxy (Eq Int =&gt; Int))
The type (Proxy (Eq Int =&gt; Int)) is only accepted with -XImpredicativeTypes,
but suppose we want that.  But then in the call to 'i', we end
up decomposing (Eq Int =&gt; Int), and we definitely don't want that.

This really only applies to the type checker; in Core, '=&gt;' and '-&gt;'
are the same, as are 'Constraint' and '*'.  But for now I've put
the test in repSplitAppTy_maybe, which applies throughout, because
the other calls to splitAppTy are in GHC.Core.Unify, which is also used by
the type checker (e.g. when matching type-function equations).

-}</span><span>
</span><span id="line-845"></span><span>
</span><span id="line-846"></span><span class="hs-comment">-- | Applies a type to another, as in e.g. @k a@</span><span>
</span><span id="line-847"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-type">mkAppTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-848"></span><span>  </span><span class="hs-comment">-- See Note [Respecting definitional equality], invariant (EQ1).</span><span>
</span><span id="line-849"></span><span id="mkAppTy"><span class="annot"><span class="annottext">mkAppTy :: Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-var hs-var">mkAppTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680813091"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813091"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span> </span><span id="local-6989586621680813090"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813090"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680813089"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813089"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span>
</span><span id="line-850"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span id="local-6989586621680813088"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813088"><span class="hs-identifier hs-var">arg_co</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813087"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813087"><span class="hs-identifier hs-var">res_co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
KindCoercion
-&gt; Pair Type -&gt; [Type] -&gt; ([KindCoercion], KindCoercion)
KindCoercion
-&gt; Pair Type -&gt; [Type] -&gt; ([KindCoercion], KindCoercion)
</span><a href="GHC.Core.Coercion.html#decomposePiCos"><span class="hs-identifier hs-var">decomposePiCos</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813090"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; Pair Type
</span><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-var">coercionKind</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813090"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813089"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-851"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813091"><span class="hs-identifier hs-var">fun_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-operator hs-var">`mkAppTy`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813089"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-operator hs-var">`mkCastTy`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813088"><span class="hs-identifier hs-var">arg_co</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-operator hs-var">`mkCastTy`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813087"><span class="hs-identifier hs-var">res_co</span></a></span><span>
</span><span id="line-852"></span><span>
</span><span id="line-853"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813086"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813086"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680813085"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813085"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680813084"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813084"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813086"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813085"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813084"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-854"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a></span><span> </span><span id="local-6989586621680813083"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813083"><span class="hs-identifier hs-var">ty1</span></a></span></span><span>               </span><span id="local-6989586621680813082"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813082"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813083"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813082"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-855"></span><span>        </span><span class="hs-comment">-- Note that the TyConApp could be an</span><span>
</span><span id="line-856"></span><span>        </span><span class="hs-comment">-- under-saturated type synonym.  GHC allows that; e.g.</span><span>
</span><span id="line-857"></span><span>        </span><span class="hs-comment">--      type Foo k = k a -&gt; k a</span><span>
</span><span id="line-858"></span><span>        </span><span class="hs-comment">--      type Id x = x</span><span>
</span><span id="line-859"></span><span>        </span><span class="hs-comment">--      foo :: Foo Id -&gt; Foo Id</span><span>
</span><span id="line-860"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-861"></span><span>        </span><span class="hs-comment">-- Here Id is partially applied in the type sig for Foo,</span><span>
</span><span id="line-862"></span><span>        </span><span class="hs-comment">-- but once the type synonyms are expanded all is well</span><span>
</span><span id="line-863"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-864"></span><span>        </span><span class="hs-comment">-- Moreover in GHC.Tc.Types.tcInferTyApps we build up a type</span><span>
</span><span id="line-865"></span><span>        </span><span class="hs-comment">--   (T t1 t2 t3) one argument at a type, thus forming</span><span>
</span><span id="line-866"></span><span>        </span><span class="hs-comment">--   (T t1), (T t1 t2), etc</span><span>
</span><span id="line-867"></span><span>
</span><span id="line-868"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-type">mkAppTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-869"></span><span id="mkAppTys"><span class="annot"><span class="annottext">mkAppTys :: Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var hs-var">mkAppTys</span></a></span></span><span> </span><span id="local-6989586621680813081"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813081"><span class="hs-identifier hs-var">ty1</span></a></span></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813081"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-870"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680813080"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813080"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span> </span><span id="local-6989586621680813079"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813079"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680813078"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813078"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span>  </span><span class="hs-comment">-- much more efficient then nested mkAppTy</span><span>
</span><span id="line-871"></span><span>                                     </span><span class="hs-comment">-- Why do this? See (EQ1) of</span><span>
</span><span id="line-872"></span><span>                                     </span><span class="hs-comment">-- Note [Respecting definitional equality]</span><span>
</span><span id="line-873"></span><span>                                     </span><span class="hs-comment">-- in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-874"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base/src/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813080"><span class="hs-identifier hs-var">fun_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813076"><span class="hs-identifier hs-var">casted_arg_tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-operator hs-var">`mkCastTy`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813075"><span class="hs-identifier hs-var">res_co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813074"><span class="hs-identifier hs-var">leftovers</span></a></span><span>
</span><span id="line-875"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-876"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680813072"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813072"><span class="hs-identifier hs-var">arg_cos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813075"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813075"><span class="hs-identifier hs-var">res_co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
KindCoercion
-&gt; Pair Type -&gt; [Type] -&gt; ([KindCoercion], KindCoercion)
KindCoercion
-&gt; Pair Type -&gt; [Type] -&gt; ([KindCoercion], KindCoercion)
</span><a href="GHC.Core.Coercion.html#decomposePiCos"><span class="hs-identifier hs-var">decomposePiCos</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813079"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; Pair Type
</span><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-var">coercionKind</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680813079"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813078"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-877"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680813071"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813071"><span class="hs-identifier hs-var">args_to_cast</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813074"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813074"><span class="hs-identifier hs-var">leftovers</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[KindCoercion] -&gt; [Type] -&gt; ([Type], [Type])
forall b a. [b] -&gt; [a] -&gt; ([a], [a])
</span><a href="GHC.Utils.Misc.html#splitAtList"><span class="hs-identifier hs-var">splitAtList</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813072"><span class="hs-identifier hs-var">arg_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813078"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-878"></span><span>    </span><span id="local-6989586621680813076"><span class="annot"><span class="annottext">casted_arg_tys :: [Type]
</span><a href="#local-6989586621680813076"><span class="hs-identifier hs-var hs-var">casted_arg_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; KindCoercion -&gt; Type)
-&gt; [Type] -&gt; [KindCoercion] -&gt; [Type]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../../base/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813071"><span class="hs-identifier hs-var">args_to_cast</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680813072"><span class="hs-identifier hs-var">arg_cos</span></a></span><span>
</span><span id="line-879"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813068"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813068"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680813067"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813067"><span class="hs-identifier hs-var">tys1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680813066"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813066"><span class="hs-identifier hs-var">tys2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813068"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813067"><span class="hs-identifier hs-var">tys1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813066"><span class="hs-identifier hs-var">tys2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-880"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span id="local-6989586621680813065"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813065"><span class="hs-identifier hs-var">ty1</span></a></span></span><span>                </span><span id="local-6989586621680813064"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813064"><span class="hs-identifier hs-var">tys2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base/src/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813065"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813064"><span class="hs-identifier hs-var">tys2</span></a></span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-883"></span><span class="annot"><a href="GHC.Core.Type.html#splitAppTy_maybe"><span class="hs-identifier hs-type">splitAppTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-884"></span><span class="hs-comment">-- ^ Attempt to take a type application apart, whether it is a</span><span>
</span><span id="line-885"></span><span class="hs-comment">-- function, type constructor, or plain type application. Note</span><span>
</span><span id="line-886"></span><span class="hs-comment">-- that type family applications are NEVER unsaturated by this!</span><span>
</span><span id="line-887"></span><span id="splitAppTy_maybe"><span class="annot"><span class="annottext">splitAppTy_maybe :: Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var hs-var">splitAppTy_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (Type, Type)
Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe (Type, Type))
-&gt; (Type -&gt; Type) -&gt; Type -&gt; Maybe (Type, Type)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-890"></span><span class="annot"><a href="GHC.Core.Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-type">repSplitAppTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-891"></span><span class="hs-comment">-- ^ Does the AppTy split as in 'splitAppTy_maybe', but assumes that</span><span>
</span><span id="line-892"></span><span class="hs-comment">-- any Core view stuff is already done</span><span>
</span><span id="line-893"></span><span id="repSplitAppTy_maybe"><span class="annot"><span class="annottext">repSplitAppTy_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var hs-var">repSplitAppTy_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680813062"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813062"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680813061"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813061"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621680813060"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813060"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-894"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, Type) -&gt; Maybe (Type, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813062"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813059"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813058"><span class="hs-identifier hs-var">rep2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813061"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813060"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-896"></span><span>    </span><span id="local-6989586621680813059"><span class="annot"><span class="annottext">rep1 :: Type
</span><a href="#local-6989586621680813059"><span class="hs-identifier hs-var hs-var">rep1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813061"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-897"></span><span>    </span><span id="local-6989586621680813058"><span class="annot"><span class="annottext">rep2 :: Type
</span><a href="#local-6989586621680813058"><span class="hs-identifier hs-var hs-var">rep2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813060"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="annot"><a href="GHC.Core.Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680813055"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813055"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621680813054"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813054"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, Type) -&gt; Maybe (Type, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813055"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813054"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-901"></span><span>
</span><span id="line-902"></span><span class="annot"><a href="GHC.Core.Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813053"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813053"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680813052"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813052"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-903"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#mustBeSaturated"><span class="hs-identifier hs-var">mustBeSaturated</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813053"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813052"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int -&gt; Bool
forall a. [a] -&gt; Int -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthExceeds"><span class="hs-operator hs-var">`lengthExceeds`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Int
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813053"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-904"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680813048"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813048"><span class="hs-identifier hs-var">tys'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813047"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813047"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Maybe ([Type], Type)
forall a. [a] -&gt; Maybe ([a], a)
</span><a href="GHC.Utils.Misc.html#snocView"><span class="hs-identifier hs-var">snocView</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813052"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-905"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, Type) -&gt; Maybe (Type, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813053"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813048"><span class="hs-identifier hs-var">tys'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813047"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Never create unsaturated type family apps!</span><span>
</span><span id="line-906"></span><span>
</span><span id="line-907"></span><span class="annot"><a href="GHC.Core.Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a></span><span> </span><span id="local-6989586621680813045"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813045"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Type, Type)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-908"></span><span>
</span><span id="line-909"></span><span class="hs-comment">-- This one doesn't break apart (c =&gt; t).</span><span>
</span><span id="line-910"></span><span class="hs-comment">-- See Note [Decomposing fat arrow c=&gt;t]</span><span>
</span><span id="line-911"></span><span class="hs-comment">-- Defined here to avoid module loops between Unify and TcType.</span><span>
</span><span id="line-912"></span><span class="annot"><a href="GHC.Core.Type.html#tcRepSplitAppTy_maybe"><span class="hs-identifier hs-type">tcRepSplitAppTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-913"></span><span class="hs-comment">-- ^ Does the AppTy split as in 'tcSplitAppTy_maybe', but assumes that</span><span>
</span><span id="line-914"></span><span class="hs-comment">-- any coreView stuff is already done. Refuses to look through (c =&gt; t)</span><span>
</span><span id="line-915"></span><span id="tcRepSplitAppTy_maybe"><span class="annot"><span class="annottext">tcRepSplitAppTy_maybe :: Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#tcRepSplitAppTy_maybe"><span class="hs-identifier hs-var hs-var">tcRepSplitAppTy_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; AnonArgFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680813043"><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680813043"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680813042"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813042"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680813041"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813041"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680813040"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813040"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-916"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="GHC.Types.Var.html#InvisArg"><span class="hs-identifier hs-var">InvisArg</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680813043"><span class="hs-identifier hs-var">af</span></a></span><span>
</span><span id="line-917"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Type, Type)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-comment">-- See Note [Decomposing fat arrow c=&gt;t]</span><span>
</span><span id="line-918"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-919"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, Type) -&gt; Maybe (Type, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813042"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813038"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813037"><span class="hs-identifier hs-var">rep2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813041"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813040"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-920"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-921"></span><span>    </span><span id="local-6989586621680813038"><span class="annot"><span class="annottext">rep1 :: Type
</span><a href="#local-6989586621680813038"><span class="hs-identifier hs-var hs-var">rep1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813041"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-922"></span><span>    </span><span id="local-6989586621680813037"><span class="annot"><span class="annottext">rep2 :: Type
</span><a href="#local-6989586621680813037"><span class="hs-identifier hs-var hs-var">rep2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813040"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-923"></span><span>
</span><span id="line-924"></span><span class="annot"><a href="GHC.Core.Type.html#tcRepSplitAppTy_maybe"><span class="hs-identifier hs-var">tcRepSplitAppTy_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680813034"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813034"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621680813033"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813033"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, Type) -&gt; Maybe (Type, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813034"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813033"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-925"></span><span class="annot"><a href="GHC.Core.Type.html#tcRepSplitAppTy_maybe"><span class="hs-identifier hs-var">tcRepSplitAppTy_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813032"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813032"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680813031"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813031"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-926"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#mustBeSaturated"><span class="hs-identifier hs-var">mustBeSaturated</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813032"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813031"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int -&gt; Bool
forall a. [a] -&gt; Int -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthExceeds"><span class="hs-operator hs-var">`lengthExceeds`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Int
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813032"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-927"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680813030"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813030"><span class="hs-identifier hs-var">tys'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813029"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813029"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Maybe ([Type], Type)
forall a. [a] -&gt; Maybe ([a], a)
</span><a href="GHC.Utils.Misc.html#snocView"><span class="hs-identifier hs-var">snocView</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813031"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-928"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, Type) -&gt; Maybe (Type, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813032"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813030"><span class="hs-identifier hs-var">tys'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813029"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Never create unsaturated type family apps!</span><span>
</span><span id="line-929"></span><span class="annot"><a href="GHC.Core.Type.html#tcRepSplitAppTy_maybe"><span class="hs-identifier hs-var">tcRepSplitAppTy_maybe</span></a></span><span> </span><span id="local-6989586621680813028"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813028"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Type, Type)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-930"></span><span>
</span><span id="line-931"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-932"></span><span class="annot"><a href="GHC.Core.Type.html#splitAppTy"><span class="hs-identifier hs-type">splitAppTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-933"></span><span class="hs-comment">-- ^ Attempts to take a type application apart, as in 'splitAppTy_maybe',</span><span>
</span><span id="line-934"></span><span class="hs-comment">-- and panics if this is not possible</span><span>
</span><span id="line-935"></span><span id="splitAppTy"><span class="annot"><span class="annottext">splitAppTy :: Type -&gt; (Type, Type)
</span><a href="GHC.Core.Type.html#splitAppTy"><span class="hs-identifier hs-var hs-var">splitAppTy</span></a></span></span><span> </span><span id="local-6989586621680813027"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813027"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var">splitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813027"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-936"></span><span>                </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680813026"><span class="annot"><span class="annottext">(Type, Type)
</span><a href="#local-6989586621680813026"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Type, Type)
</span><a href="#local-6989586621680813026"><span class="hs-identifier hs-var">pr</span></a></span><span>
</span><span id="line-937"></span><span>                </span><span class="annot"><span class="annottext">Maybe (Type, Type)
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Type, Type)
forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitAppTy&quot;</span></span><span>
</span><span id="line-938"></span><span>
</span><span id="line-939"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-940"></span><span class="annot"><a href="GHC.Core.Type.html#splitAppTys"><span class="hs-identifier hs-type">splitAppTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-941"></span><span class="hs-comment">-- ^ Recursively splits a type as far as is possible, leaving a residual</span><span>
</span><span id="line-942"></span><span class="hs-comment">-- type being applied to and the type arguments applied to it. Never fails,</span><span>
</span><span id="line-943"></span><span class="hs-comment">-- even if that means returning an empty list of type applications.</span><span>
</span><span id="line-944"></span><span id="splitAppTys"><span class="annot"><span class="annottext">splitAppTys :: Type -&gt; (Type, [Type])
</span><a href="GHC.Core.Type.html#splitAppTys"><span class="hs-identifier hs-var hs-var">splitAppTys</span></a></span></span><span> </span><span id="local-6989586621680813025"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813025"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621680813024"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813025"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813025"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-945"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-946"></span><span>    </span><span id="local-6989586621680813024"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621680813024"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621680813022"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813022"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621680813021"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813021"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680813020"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813020"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680813019"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813019"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813021"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621680813024"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813022"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813019"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813020"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-947"></span><span>    </span><span class="annot"><a href="#local-6989586621680813024"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680813018"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813018"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680813017"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813017"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>        </span><span id="local-6989586621680813016"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813016"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621680813024"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813018"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813018"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813017"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813016"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-948"></span><span>    </span><span class="annot"><a href="#local-6989586621680813024"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680813015"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813015"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680813014"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813014"><span class="hs-identifier hs-var">tc_args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680813013"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813013"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-949"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- keep type families saturated</span><span>
</span><span id="line-950"></span><span>            </span><span id="local-6989586621680813012"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621680813012"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#mustBeSaturated"><span class="hs-identifier hs-var">mustBeSaturated</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813015"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Int
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813015"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-951"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-952"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680813011"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813011"><span class="hs-identifier hs-var">tc_args1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680813010"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813010"><span class="hs-identifier hs-var">tc_args2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; ([Type], [Type])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><a href="../../base/src/GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680813012"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813014"><span class="hs-identifier hs-var">tc_args</span></a></span><span>
</span><span id="line-953"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-954"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680813015"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813011"><span class="hs-identifier hs-var">tc_args1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813010"><span class="hs-identifier hs-var">tc_args2</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813013"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-955"></span><span>    </span><span class="annot"><a href="#local-6989586621680813024"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680813008"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813008"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680813007"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813007"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621680813006"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813006"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680813005"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680813005"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-956"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813008"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813004"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813003"><span class="hs-identifier hs-var">rep2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813007"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813006"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-958"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-959"></span><span>        </span><span id="local-6989586621680813004"><span class="annot"><span class="annottext">rep1 :: Type
</span><a href="#local-6989586621680813004"><span class="hs-identifier hs-var hs-var">rep1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813007"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-960"></span><span>        </span><span id="local-6989586621680813003"><span class="annot"><span class="annottext">rep2 :: Type
</span><a href="#local-6989586621680813003"><span class="hs-identifier hs-var hs-var">rep2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813006"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-961"></span><span>
</span><span id="line-962"></span><span>    </span><span class="annot"><a href="#local-6989586621680813024"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680813000"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813000"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                     </span><span id="local-6989586621680812999"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812999"><span class="hs-identifier hs-var">args</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680813000"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812999"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-963"></span><span>
</span><span id="line-964"></span><span class="hs-comment">-- | Like 'splitAppTys', but doesn't look through type synonyms</span><span>
</span><span id="line-965"></span><span class="annot"><a href="GHC.Core.Type.html#repSplitAppTys"><span class="hs-identifier hs-type">repSplitAppTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-966"></span><span id="repSplitAppTys"><span class="annot"><span class="annottext">repSplitAppTys :: HasDebugCallStack =&gt; Type -&gt; (Type, [Type])
</span><a href="GHC.Core.Type.html#repSplitAppTys"><span class="hs-identifier hs-var hs-var">repSplitAppTys</span></a></span></span><span> </span><span id="local-6989586621680812997"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812997"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621680812996"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812997"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-967"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-968"></span><span>    </span><span id="local-6989586621680812996"><span class="annot"><span class="annottext">split :: Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621680812996"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680812994"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812994"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812993"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812993"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812992"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812992"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621680812996"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812994"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812993"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812992"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-969"></span><span>    </span><span class="annot"><a href="#local-6989586621680812996"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812991"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812991"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680812990"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812990"><span class="hs-identifier hs-var">tc_args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812989"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812989"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-970"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680812988"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621680812988"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#mustBeSaturated"><span class="hs-identifier hs-var">mustBeSaturated</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812991"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Int
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812991"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-971"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-972"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680812987"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812987"><span class="hs-identifier hs-var">tc_args1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812986"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812986"><span class="hs-identifier hs-var">tc_args2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; ([Type], [Type])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><a href="../../base/src/GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680812988"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812990"><span class="hs-identifier hs-var">tc_args</span></a></span><span>
</span><span id="line-973"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-974"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812991"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812987"><span class="hs-identifier hs-var">tc_args1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812986"><span class="hs-identifier hs-var">tc_args2</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812989"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span>    </span><span class="annot"><a href="#local-6989586621680812996"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812985"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812985"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680812984"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812984"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621680812983"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812983"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812982"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812982"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-976"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-977"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812985"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812981"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812980"><span class="hs-identifier hs-var">rep2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812984"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812983"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-978"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-979"></span><span>        </span><span id="local-6989586621680812981"><span class="annot"><span class="annottext">rep1 :: Type
</span><a href="#local-6989586621680812981"><span class="hs-identifier hs-var hs-var">rep1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812984"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-980"></span><span>        </span><span id="local-6989586621680812980"><span class="annot"><span class="annottext">rep2 :: Type
</span><a href="#local-6989586621680812980"><span class="hs-identifier hs-var hs-var">rep2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812983"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-981"></span><span>
</span><span id="line-982"></span><span>    </span><span class="annot"><a href="#local-6989586621680812996"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812977"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812977"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812976"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812976"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812977"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812976"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-983"></span><span>
</span><span id="line-984"></span><span class="hs-comment">{-
                      LitTy
                      ~~~~~
-}</span><span>
</span><span id="line-988"></span><span>
</span><span id="line-989"></span><span class="annot"><a href="GHC.Core.Type.html#mkNumLitTy"><span class="hs-identifier hs-type">mkNumLitTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-990"></span><span id="mkNumLitTy"><span class="annot"><span class="annottext">mkNumLitTy :: Integer -&gt; Type
</span><a href="GHC.Core.Type.html#mkNumLitTy"><span class="hs-identifier hs-var hs-var">mkNumLitTy</span></a></span></span><span> </span><span id="local-6989586621680812975"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680812975"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; TyLit
</span><a href="GHC.Core.TyCo.Rep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680812975"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-991"></span><span>
</span><span id="line-992"></span><span class="hs-comment">-- | Is this a numeric literal. We also look through type synonyms.</span><span>
</span><span id="line-993"></span><span class="annot"><a href="GHC.Core.Type.html#isNumLitTy"><span class="hs-identifier hs-type">isNumLitTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-994"></span><span id="isNumLitTy"><span class="annot"><span class="annottext">isNumLitTy :: Type -&gt; Maybe Integer
</span><a href="GHC.Core.Type.html#isNumLitTy"><span class="hs-identifier hs-var hs-var">isNumLitTy</span></a></span></span><span> </span><span id="local-6989586621680812973"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812973"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-995"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NumTyLit"><span class="hs-identifier hs-type">NumTyLit</span></a></span><span> </span><span id="local-6989586621680812972"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680812972"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812973"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680812972"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-996"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-997"></span><span>
</span><span id="line-998"></span><span class="annot"><a href="GHC.Core.Type.html#mkStrLitTy"><span class="hs-identifier hs-type">mkStrLitTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-999"></span><span id="mkStrLitTy"><span class="annot"><span class="annottext">mkStrLitTy :: FastString -&gt; Type
</span><a href="GHC.Core.Type.html#mkStrLitTy"><span class="hs-identifier hs-var hs-var">mkStrLitTy</span></a></span></span><span> </span><span id="local-6989586621680812971"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680812971"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; TyLit
</span><a href="GHC.Core.TyCo.Rep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680812971"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1000"></span><span>
</span><span id="line-1001"></span><span class="hs-comment">-- | Is this a symbol literal. We also look through type synonyms.</span><span>
</span><span id="line-1002"></span><span class="annot"><a href="GHC.Core.Type.html#isStrLitTy"><span class="hs-identifier hs-type">isStrLitTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-1003"></span><span id="isStrLitTy"><span class="annot"><span class="annottext">isStrLitTy :: Type -&gt; Maybe FastString
</span><a href="GHC.Core.Type.html#isStrLitTy"><span class="hs-identifier hs-var hs-var">isStrLitTy</span></a></span></span><span> </span><span id="local-6989586621680812969"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812969"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1004"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#StrTyLit"><span class="hs-identifier hs-type">StrTyLit</span></a></span><span> </span><span id="local-6989586621680812968"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680812968"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812969"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Maybe FastString
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680812968"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1005"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FastString
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1006"></span><span>
</span><span id="line-1007"></span><span class="hs-comment">-- | Is this a type literal (symbol or numeric).</span><span>
</span><span id="line-1008"></span><span class="annot"><a href="GHC.Core.Type.html#isLitTy"><span class="hs-identifier hs-type">isLitTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a></span><span>
</span><span id="line-1009"></span><span id="isLitTy"><span class="annot"><span class="annottext">isLitTy :: Type -&gt; Maybe TyLit
</span><a href="GHC.Core.Type.html#isLitTy"><span class="hs-identifier hs-var hs-var">isLitTy</span></a></span></span><span> </span><span id="local-6989586621680812967"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812967"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1010"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621680812966"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680812966"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812967"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Maybe TyLit
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680812966"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1011"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyLit
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1012"></span><span>
</span><span id="line-1013"></span><span class="hs-comment">-- | Is this type a custom user error?</span><span>
</span><span id="line-1014"></span><span class="hs-comment">-- If so, give us the kind and the error message.</span><span>
</span><span id="line-1015"></span><span class="annot"><a href="GHC.Core.Type.html#userTypeError_maybe"><span class="hs-identifier hs-type">userTypeError_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1016"></span><span id="userTypeError_maybe"><span class="annot"><span class="annottext">userTypeError_maybe :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#userTypeError_maybe"><span class="hs-identifier hs-var hs-var">userTypeError_maybe</span></a></span></span><span> </span><span id="local-6989586621680812965"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812965"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-1017"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812964"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812964"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812963"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812963"><span class="hs-identifier hs-var">_kind</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680812962"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812962"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812965"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1018"></span><span>          </span><span class="hs-comment">-- There may be more than 2 arguments, if the type error is</span><span>
</span><span id="line-1019"></span><span>          </span><span class="hs-comment">-- used as a type constructor (e.g. at kind `Type -&gt; Type`).</span><span>
</span><span id="line-1020"></span><span>
</span><span id="line-1021"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../base/src/Control.Monad.html#guard"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812964"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#errorMessageTypeErrorFamName"><span class="hs-identifier hs-var">errorMessageTypeErrorFamName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1022"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812962"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1023"></span><span>
</span><span id="line-1024"></span><span class="hs-comment">-- | Render a type corresponding to a user type error into a SDoc.</span><span>
</span><span id="line-1025"></span><span class="annot"><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-type">pprUserTypeErrorTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1026"></span><span id="pprUserTypeErrorTy"><span class="annot"><span class="annottext">pprUserTypeErrorTy :: Type -&gt; SDoc
</span><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var hs-var">pprUserTypeErrorTy</span></a></span></span><span> </span><span id="local-6989586621680812959"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812959"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1027"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812959"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1028"></span><span>
</span><span id="line-1029"></span><span>    </span><span class="hs-comment">-- Text &quot;Something&quot;</span><span>
</span><span id="line-1030"></span><span>    </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812958"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812958"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621680812957"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812957"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1031"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812958"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#typeErrorTextDataConName"><span class="hs-identifier hs-var">typeErrorTextDataConName</span></a></span><span>
</span><span id="line-1032"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812955"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680812955"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe FastString
</span><a href="GHC.Core.Type.html#isStrLitTy"><span class="hs-identifier hs-var">isStrLitTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812957"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680812955"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-1033"></span><span>
</span><span id="line-1034"></span><span>    </span><span class="hs-comment">-- ShowType t</span><span>
</span><span id="line-1035"></span><span>    </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812953"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812953"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621680812952"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812952"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680812951"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812951"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1036"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812953"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#typeErrorShowTypeDataConName"><span class="hs-identifier hs-var">typeErrorShowTypeDataConName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812951"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1037"></span><span>
</span><span id="line-1038"></span><span>    </span><span class="hs-comment">-- t1 :&lt;&gt;: t2</span><span>
</span><span id="line-1039"></span><span>    </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812949"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812949"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621680812948"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812948"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680812947"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812947"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812949"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#typeErrorAppendDataConName"><span class="hs-identifier hs-var">typeErrorAppendDataConName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1041"></span><span>        </span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812948"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812947"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1042"></span><span>
</span><span id="line-1043"></span><span>    </span><span class="hs-comment">-- t1 :$$: t2</span><span>
</span><span id="line-1044"></span><span>    </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812944"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812944"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621680812943"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812943"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680812942"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812942"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1045"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812944"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#typeErrorVAppendDataConName"><span class="hs-identifier hs-var">typeErrorVAppendDataConName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1046"></span><span>        </span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812943"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812942"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1047"></span><span>
</span><span id="line-1048"></span><span>    </span><span class="hs-comment">-- An unevaluated type function</span><span>
</span><span id="line-1049"></span><span>    </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812959"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1050"></span><span>
</span><span id="line-1051"></span><span>
</span><span id="line-1052"></span><span>
</span><span id="line-1053"></span><span>
</span><span id="line-1054"></span><span class="hs-comment">{-
---------------------------------------------------------------------
                                FunTy
                                ~~~~~

Note [Representation of function types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Functions (e.g. Int -&gt; Char) can be thought of as being applications
of funTyCon (known in Haskell surface syntax as (-&gt;)), (note that
`RuntimeRep' quantifiers are left inferred)

    (-&gt;) :: forall {r1 :: RuntimeRep} {r2 :: RuntimeRep}
                   (a :: TYPE r1) (b :: TYPE r2).
            a -&gt; b -&gt; Type

However, for efficiency's sake we represent saturated applications of (-&gt;)
with FunTy. For instance, the type,

    (-&gt;) r1 r2 a b

is equivalent to,

    FunTy (Anon a) b

Note how the RuntimeReps are implied in the FunTy representation. For this
reason we must be careful when recontructing the TyConApp representation (see,
for instance, splitTyConApp_maybe).

In the compiler we maintain the invariant that all saturated applications of
(-&gt;) are represented with FunTy.

See #11714.
-}</span><span>
</span><span id="line-1088"></span><span>
</span><span id="line-1089"></span><span class="annot"><a href="GHC.Core.Type.html#splitFunTy"><span class="hs-identifier hs-type">splitFunTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1090"></span><span class="hs-comment">-- ^ Attempts to extract the argument and result types from a type, and</span><span>
</span><span id="line-1091"></span><span class="hs-comment">-- panics if that is not possible. See also 'splitFunTy_maybe'</span><span>
</span><span id="line-1092"></span><span id="splitFunTy"><span class="annot"><span class="annottext">splitFunTy :: Type -&gt; (Type, Type, Type)
</span><a href="GHC.Core.Type.html#splitFunTy"><span class="hs-identifier hs-var hs-var">splitFunTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe (Type, Type, Type) -&gt; (Type, Type, Type)
forall a. HasCallStack =&gt; String -&gt; Maybe a -&gt; a
</span><a href="GHC.Data.Maybe.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitFunTy&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Type, Type, Type) -&gt; (Type, Type, Type))
-&gt; (Type -&gt; Maybe (Type, Type, Type)) -&gt; Type -&gt; (Type, Type, Type)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type, Type)
</span><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a></span><span>
</span><span id="line-1093"></span><span>
</span><span id="line-1094"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-pragma hs-type">splitFunTy_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1095"></span><span class="annot"><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier hs-type">splitFunTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1096"></span><span class="hs-comment">-- ^ Attempts to extract the argument and result types from a type</span><span>
</span><span id="line-1097"></span><span id="splitFunTy_maybe"><span class="annot"><span class="annottext">splitFunTy_maybe :: Type -&gt; Maybe (Type, Type, Type)
</span><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var hs-var">splitFunTy_maybe</span></a></span></span><span> </span><span id="local-6989586621680812939"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812939"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1098"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812938"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812938"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680812937"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812937"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621680812936"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812936"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812939"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, Type, Type) -&gt; Maybe (Type, Type, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812938"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812937"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812936"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1099"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Type, Type, Type)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1100"></span><span>
</span><span id="line-1101"></span><span class="annot"><a href="GHC.Core.Type.html#splitFunTys"><span class="hs-identifier hs-type">splitFunTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1102"></span><span id="splitFunTys"><span class="annot"><span class="annottext">splitFunTys :: Type -&gt; ([Scaled Type], Type)
</span><a href="GHC.Core.Type.html#splitFunTys"><span class="hs-identifier hs-var hs-var">splitFunTys</span></a></span></span><span> </span><span id="local-6989586621680812935"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812935"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Type -&gt; Type -&gt; ([Scaled Type], Type)
</span><a href="#local-6989586621680812934"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812935"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812935"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1103"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1104"></span><span>      </span><span class="hs-comment">-- common case first</span><span>
</span><span id="line-1105"></span><span>    </span><span id="local-6989586621680812934"><span class="annot"><span class="annottext">split :: [Scaled Type] -&gt; Type -&gt; Type -&gt; ([Scaled Type], Type)
</span><a href="#local-6989586621680812934"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621680812933"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621680812933"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812932"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812932"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680812931"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812931"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621680812930"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812930"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Type -&gt; Type -&gt; ([Scaled Type], Type)
</span><a href="#local-6989586621680812934"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812932"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812931"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scaled Type -&gt; [Scaled Type] -&gt; [Scaled Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621680812933"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812930"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812930"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1106"></span><span>    </span><span class="annot"><a href="#local-6989586621680812934"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812928"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621680812928"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680812927"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812927"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621680812926"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812926"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812925"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812925"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812926"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Type -&gt; Type -&gt; ([Scaled Type], Type)
</span><a href="#local-6989586621680812934"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621680812928"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812927"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812925"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1107"></span><span>    </span><span class="annot"><a href="#local-6989586621680812934"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812924"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621680812924"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680812923"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812923"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Scaled Type] -&gt; [Scaled Type]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621680812924"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812923"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span>
</span><span id="line-1109"></span><span class="annot"><a href="GHC.Core.Type.html#funResultTy"><span class="hs-identifier hs-type">funResultTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1110"></span><span class="hs-comment">-- ^ Extract the function result type and panic if that is not possible</span><span>
</span><span id="line-1111"></span><span id="funResultTy"><span class="annot"><span class="annottext">funResultTy :: Type -&gt; Type
</span><a href="GHC.Core.Type.html#funResultTy"><span class="hs-identifier hs-var hs-var">funResultTy</span></a></span></span><span> </span><span id="local-6989586621680812921"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812921"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1112"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812920"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812920"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812921"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812920"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1113"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;funResultTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812921"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1114"></span><span>
</span><span id="line-1115"></span><span class="annot"><a href="GHC.Core.Type.html#funArgTy"><span class="hs-identifier hs-type">funArgTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1116"></span><span class="hs-comment">-- ^ Extract the function argument type and panic if that is not possible</span><span>
</span><span id="line-1117"></span><span id="funArgTy"><span class="annot"><span class="annottext">funArgTy :: Type -&gt; Type
</span><a href="GHC.Core.Type.html#funArgTy"><span class="hs-identifier hs-var hs-var">funArgTy</span></a></span></span><span> </span><span id="local-6989586621680812919"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812919"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1118"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812918"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812918"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812919"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812918"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1119"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;funArgTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812919"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1120"></span><span>
</span><span id="line-1121"></span><span class="hs-comment">-- ^ Just like 'piResultTys' but for a single argument</span><span>
</span><span id="line-1122"></span><span class="hs-comment">-- Try not to iterate 'piResultTy', because it's inefficient to substitute</span><span>
</span><span id="line-1123"></span><span class="hs-comment">-- one variable at a time; instead use 'piResultTys&quot;</span><span>
</span><span id="line-1124"></span><span class="annot"><a href="GHC.Core.Type.html#piResultTy"><span class="hs-identifier hs-type">piResultTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1125"></span><span id="piResultTy"><span class="annot"><span class="annottext">piResultTy :: HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTy"><span class="hs-identifier hs-var hs-var">piResultTy</span></a></span></span><span> </span><span id="local-6989586621680812912"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812912"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812911"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812911"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#piResultTy_maybe"><span class="hs-identifier hs-var">piResultTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812912"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812911"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1126"></span><span>                      </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812909"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812909"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812909"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1127"></span><span>                      </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;piResultTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812912"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812911"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span>
</span><span id="line-1129"></span><span class="annot"><a href="GHC.Core.Type.html#piResultTy_maybe"><span class="hs-identifier hs-type">piResultTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1130"></span><span class="hs-comment">-- We don't need a 'tc' version, because</span><span>
</span><span id="line-1131"></span><span class="hs-comment">-- this function behaves the same for Type and Constraint</span><span>
</span><span id="line-1132"></span><span id="piResultTy_maybe"><span class="annot"><span class="annottext">piResultTy_maybe :: Type -&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#piResultTy_maybe"><span class="hs-identifier hs-var hs-var">piResultTy_maybe</span></a></span></span><span> </span><span id="local-6989586621680812908"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812908"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812907"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812907"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812908"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1133"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812906"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812906"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812906"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1134"></span><span>
</span><span id="line-1135"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812905"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812905"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812904"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812904"><span class="hs-identifier hs-var">res</span></a></span></span><span>
</span><span id="line-1136"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680812903"><span class="annot"><span class="annottext">empty_subst :: TCvSubst
</span><a href="#local-6989586621680812903"><span class="hs-identifier hs-var hs-var">empty_subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var">mkEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">(InScopeSet -&gt; TCvSubst) -&gt; InScopeSet -&gt; TCvSubst
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet -&gt; InScopeSet) -&gt; TyCoVarSet -&gt; InScopeSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1137"></span><span>                         </span><span class="annot"><span class="annottext">[Type] -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812907"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812904"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1138"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; TyVar -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812903"><span class="hs-identifier hs-var">empty_subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812905"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812907"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812904"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1139"></span><span>
</span><span id="line-1140"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1141"></span><span>
</span><span id="line-1142"></span><span class="hs-comment">-- | (piResultTys f_ty [ty1, .., tyn]) gives the type of (f ty1 .. tyn)</span><span>
</span><span id="line-1143"></span><span class="hs-comment">--   where f :: f_ty</span><span>
</span><span id="line-1144"></span><span class="hs-comment">-- 'piResultTys' is interesting because:</span><span>
</span><span id="line-1145"></span><span class="hs-comment">--      1. 'f_ty' may have more for-alls than there are args</span><span>
</span><span id="line-1146"></span><span class="hs-comment">--      2. Less obviously, it may have fewer for-alls</span><span>
</span><span id="line-1147"></span><span class="hs-comment">-- For case 2. think of:</span><span>
</span><span id="line-1148"></span><span class="hs-comment">--   piResultTys (forall a.a) [forall b.b, Int]</span><span>
</span><span id="line-1149"></span><span class="hs-comment">-- This really can happen, but only (I think) in situations involving</span><span>
</span><span id="line-1150"></span><span class="hs-comment">-- undefined.  For example:</span><span>
</span><span id="line-1151"></span><span class="hs-comment">--       undefined :: forall a. a</span><span>
</span><span id="line-1152"></span><span class="hs-comment">-- Term: undefined @(forall b. b-&gt;b) @Int</span><span>
</span><span id="line-1153"></span><span class="hs-comment">-- This term should have type (Int -&gt; Int), but notice that</span><span>
</span><span id="line-1154"></span><span class="hs-comment">-- there are more type args than foralls in 'undefined's type.</span><span>
</span><span id="line-1155"></span><span>
</span><span id="line-1156"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-1157"></span><span class="hs-comment">-- See Note [GHC Formalism] in GHC.Core.Lint</span><span>
</span><span id="line-1158"></span><span>
</span><span id="line-1159"></span><span class="hs-comment">-- This is a heavily used function (e.g. from typeKind),</span><span>
</span><span id="line-1160"></span><span class="hs-comment">-- so we pay attention to efficiency, especially in the special case</span><span>
</span><span id="line-1161"></span><span class="hs-comment">-- where there are no for-alls so we are just dropping arrows from</span><span>
</span><span id="line-1162"></span><span class="hs-comment">-- a function type/kind.</span><span>
</span><span id="line-1163"></span><span class="annot"><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-type">piResultTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1164"></span><span id="piResultTys"><span class="annot"><span class="annottext">piResultTys :: HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var hs-var">piResultTys</span></a></span></span><span> </span><span id="local-6989586621680812888"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812888"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812888"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1165"></span><span class="annot"><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span id="local-6989586621680812887"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812887"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812886"><span class="annot"><span class="annottext">orig_args :: [Type]
</span><a href="#local-6989586621680812886"><span class="hs-identifier hs-var">orig_args</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621680812885"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812885"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680812884"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812884"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1166"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812883"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812883"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812887"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1167"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812883"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812884"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1168"></span><span>
</span><span id="line-1169"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812882"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812882"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812881"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812881"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812887"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1170"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621680812880"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; TyVar -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812879"><span class="hs-identifier hs-var">init_subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812882"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812885"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812881"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812884"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1171"></span><span>
</span><span id="line-1172"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812878"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812878"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812887"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1173"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812878"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812886"><span class="hs-identifier hs-var">orig_args</span></a></span><span>
</span><span id="line-1174"></span><span>
</span><span id="line-1175"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1176"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;piResultTys1&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812887"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812886"><span class="hs-identifier hs-var">orig_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1177"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1178"></span><span>    </span><span id="local-6989586621680812879"><span class="annot"><span class="annottext">init_subst :: TCvSubst
</span><a href="#local-6989586621680812879"><span class="hs-identifier hs-var hs-var">init_subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var">mkEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">(InScopeSet -&gt; TCvSubst) -&gt; InScopeSet -&gt; TCvSubst
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812887"><span class="hs-identifier hs-var">ty</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812886"><span class="hs-identifier hs-var">orig_args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1179"></span><span>
</span><span id="line-1180"></span><span>    </span><span class="annot"><a href="#local-6989586621680812880"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1181"></span><span>    </span><span id="local-6989586621680812880"><span class="annot"><span class="annottext">go :: TCvSubst -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621680812880"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680812877"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812877"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621680812876"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812876"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyUnchecked"><span class="hs-identifier hs-var">substTyUnchecked</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812877"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812876"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1182"></span><span>
</span><span id="line-1183"></span><span>    </span><span class="annot"><a href="#local-6989586621680812880"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812875"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812875"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621680812874"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812874"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812873"><span class="annot"><span class="annottext">all_args :: [Type]
</span><a href="#local-6989586621680812873"><span class="hs-identifier hs-var">all_args</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621680812872"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812872"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680812871"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812871"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1184"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812870"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812870"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812874"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1185"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621680812880"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812875"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812870"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812871"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1186"></span><span>
</span><span id="line-1187"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812869"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812869"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812868"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812868"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812874"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1188"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621680812880"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; TyVar -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812875"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812869"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812872"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812868"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812871"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1189"></span><span>
</span><span id="line-1190"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812867"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812867"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812874"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1191"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621680812880"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812875"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812867"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812873"><span class="hs-identifier hs-var">all_args</span></a></span><span>
</span><span id="line-1192"></span><span>
</span><span id="line-1193"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812875"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- See Note [Care with kind instantiation]</span><span>
</span><span id="line-1194"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621680812880"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812879"><span class="hs-identifier hs-var">init_subst</span></a></span><span>
</span><span id="line-1195"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812875"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812874"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1196"></span><span>          </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812873"><span class="hs-identifier hs-var">all_args</span></a></span><span>
</span><span id="line-1197"></span><span>
</span><span id="line-1198"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1199"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- We have not run out of arguments, but the function doesn't</span><span>
</span><span id="line-1200"></span><span>        </span><span class="hs-comment">-- have the right kind to apply to them; so panic.</span><span>
</span><span id="line-1201"></span><span>        </span><span class="hs-comment">-- Without the explicit isEmptyVarEnv test, an ill-kinded type</span><span>
</span><span id="line-1202"></span><span>        </span><span class="hs-comment">-- would give an infinite loop, which is very unhelpful</span><span>
</span><span id="line-1203"></span><span>        </span><span class="hs-comment">-- c.f. #15473</span><span>
</span><span id="line-1204"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;piResultTys2&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812874"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812886"><span class="hs-identifier hs-var">orig_args</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812873"><span class="hs-identifier hs-var">all_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1205"></span><span>
</span><span id="line-1206"></span><span class="annot"><a href="GHC.Core.Type.html#applyTysX"><span class="hs-identifier hs-type">applyTysX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1207"></span><span class="hs-comment">-- applyTyxX beta-reduces (/\tvs. body_ty) arg_tys</span><span>
</span><span id="line-1208"></span><span class="hs-comment">-- Assumes that (/\tvs. body_ty) is closed</span><span>
</span><span id="line-1209"></span><span id="applyTysX"><span class="annot"><span class="annottext">applyTysX :: [TyVar] -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#applyTysX"><span class="hs-identifier hs-var hs-var">applyTysX</span></a></span></span><span> </span><span id="local-6989586621680812866"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812866"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621680812865"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812865"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span> </span><span id="local-6989586621680812864"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812864"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span>
</span><span id="line-1210"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">arg_tys</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">lengthAtLeast</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n_tvs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pp_stuff</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1211"></span><span>    </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tyCoVarsOfType</span><span> </span><span class="hs-identifier">body_ty</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">subVarSet</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">mkVarSet</span><span> </span><span class="hs-identifier">tvs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pp_stuff</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1212"></span><span>    </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; [TyVar] -&gt; [Type] -&gt; Type -&gt; Type
[TyVar] -&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyWith"><span class="hs-identifier hs-var">substTyWith</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812866"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; [Type]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680812862"><span class="hs-identifier hs-var">n_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812864"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812865"><span class="hs-identifier hs-var">body_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1213"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; [Type]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#drop"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680812862"><span class="hs-identifier hs-var">n_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812864"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1214"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1215"></span><span>    </span><span id="local-6989586621680812861"><span class="annot"><span class="annottext">pp_stuff :: SDoc
</span><a href="#local-6989586621680812861"><span class="hs-identifier hs-var hs-var">pp_stuff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[TyVar] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812866"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812865"><span class="hs-identifier hs-var">body_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812864"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1216"></span><span>    </span><span id="local-6989586621680812862"><span class="annot"><span class="annottext">n_tvs :: Int
</span><a href="#local-6989586621680812862"><span class="hs-identifier hs-var hs-var">n_tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812866"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1217"></span><span>
</span><span id="line-1218"></span><span>
</span><span id="line-1219"></span><span>
</span><span id="line-1220"></span><span class="hs-comment">{- Note [Care with kind instantiation]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose we have
  T :: forall k. k
and we are finding the kind of
  T (forall b. b -&gt; b) * Int
Then
  T (forall b. b-&gt;b) :: k[ k :-&gt; forall b. b-&gt;b]
                     :: forall b. b -&gt; b
So
  T (forall b. b-&gt;b) * :: (b -&gt; b)[ b :-&gt; *]
                       :: * -&gt; *

In other words we must instantiate the forall!

Similarly (#15428)
   S :: forall k f. k -&gt; f k
and we are finding the kind of
   S * (* -&gt;) Int Bool
We have
   S * (* -&gt;) :: (k -&gt; f k)[ k :-&gt; *, f :-&gt; (* -&gt;)]
              :: * -&gt; * -&gt; *
So again we must instantiate.

The same thing happens in GHC.CoreToIface.toIfaceAppArgsX.

---------------------------------------------------------------------
                                TyConApp
                                ~~~~~~~~
-}</span><span>
</span><span id="line-1250"></span><span>
</span><span id="line-1251"></span><span class="hs-comment">-- splitTyConApp &quot;looks through&quot; synonyms, because they don't</span><span>
</span><span id="line-1252"></span><span class="hs-comment">-- mean a distinct type, but all other type-constructor applications</span><span>
</span><span id="line-1253"></span><span class="hs-comment">-- including functions are returned as Just ..</span><span>
</span><span id="line-1254"></span><span>
</span><span id="line-1255"></span><span class="hs-comment">-- | Retrieve the tycon heading this type, if there is one. Does /not/</span><span>
</span><span id="line-1256"></span><span class="hs-comment">-- look through synonyms.</span><span>
</span><span id="line-1257"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier hs-type">tyConAppTyConPicky_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-1258"></span><span id="tyConAppTyConPicky_maybe"><span class="annot"><span class="annottext">tyConAppTyConPicky_maybe :: Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier hs-var hs-var">tyConAppTyConPicky_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812849"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812849"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812849"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1259"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier hs-var">tyConAppTyConPicky_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a></span><span>
</span><span id="line-1260"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier hs-var">tyConAppTyConPicky_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1261"></span><span>
</span><span id="line-1262"></span><span>
</span><span id="line-1263"></span><span class="hs-comment">-- | The same as @fst . splitTyConApp@</span><span>
</span><span id="line-1264"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-pragma hs-type">tyConAppTyCon_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1265"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-type">tyConAppTyCon_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-1266"></span><span id="tyConAppTyCon_maybe"><span class="annot"><span class="annottext">tyConAppTyCon_maybe :: Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var hs-var">tyConAppTyCon_maybe</span></a></span></span><span> </span><span id="local-6989586621680812848"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812848"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812848"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1267"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812847"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812847"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812847"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1268"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a></span><span>
</span><span id="line-1269"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1270"></span><span>
</span><span id="line-1271"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyCon"><span class="hs-identifier hs-type">tyConAppTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-1272"></span><span id="tyConAppTyCon"><span class="annot"><span class="annottext">tyConAppTyCon :: Type -&gt; TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon"><span class="hs-identifier hs-var hs-var">tyConAppTyCon</span></a></span></span><span> </span><span id="local-6989586621680812846"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812846"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812846"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TyCon -&gt; TyCon -&gt; TyCon
forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TyCon
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tyConAppTyCon&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812846"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1273"></span><span>
</span><span id="line-1274"></span><span class="hs-comment">-- | The same as @snd . splitTyConApp@</span><span>
</span><span id="line-1275"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-type">tyConAppArgs_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1276"></span><span id="tyConAppArgs_maybe"><span class="annot"><span class="annottext">tyConAppArgs_maybe :: Type -&gt; Maybe [Type]
</span><a href="GHC.Core.Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var hs-var">tyConAppArgs_maybe</span></a></span></span><span> </span><span id="local-6989586621680812845"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812845"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812845"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1277"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812844"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812844"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Maybe [Type]
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812844"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1278"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812843"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812843"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680812842"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812842"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621680812841"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812841"><span class="hs-identifier hs-var">res</span></a></span></span><span>
</span><span id="line-1279"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812840"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812840"><span class="hs-identifier hs-var">rep1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812842"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1280"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812839"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812839"><span class="hs-identifier hs-var">rep2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812841"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1281"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Maybe [Type]
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812843"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812840"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812839"><span class="hs-identifier hs-var">rep2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812842"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812841"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1282"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [Type]
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1283"></span><span>
</span><span id="line-1284"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppArgs"><span class="hs-identifier hs-type">tyConAppArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1285"></span><span id="tyConAppArgs"><span class="annot"><span class="annottext">tyConAppArgs :: Type -&gt; [Type]
</span><a href="GHC.Core.Type.html#tyConAppArgs"><span class="hs-identifier hs-var hs-var">tyConAppArgs</span></a></span></span><span> </span><span id="local-6989586621680812838"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812838"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe [Type]
</span><a href="GHC.Core.Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var">tyConAppArgs_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812838"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Type] -&gt; [Type] -&gt; [Type]
forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; [Type]
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tyConAppArgs&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812838"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1286"></span><span>
</span><span id="line-1287"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppArgN"><span class="hs-identifier hs-type">tyConAppArgN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1288"></span><span class="hs-comment">-- Executing Nth</span><span>
</span><span id="line-1289"></span><span id="tyConAppArgN"><span class="annot"><span class="annottext">tyConAppArgN :: Int -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#tyConAppArgN"><span class="hs-identifier hs-var hs-var">tyConAppArgN</span></a></span></span><span> </span><span id="local-6989586621680812837"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680812837"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680812836"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812836"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1290"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe [Type]
</span><a href="GHC.Core.Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var">tyConAppArgs_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812836"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1291"></span><span>      </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812835"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812835"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812835"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int -&gt; Type
forall a. Outputable a =&gt; [a] -&gt; Int -&gt; a
</span><a href="GHC.Data.List.SetOps.html#getNth"><span class="hs-operator hs-var">`getNth`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680812837"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1292"></span><span>      </span><span class="annot"><span class="annottext">Maybe [Type]
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tyConAppArgN&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680812837"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812836"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1293"></span><span>
</span><span id="line-1294"></span><span class="hs-comment">-- | Attempts to tease a type apart into a type constructor and the application</span><span>
</span><span id="line-1295"></span><span class="hs-comment">-- of a number of arguments to that constructor. Panics if that is not possible.</span><span>
</span><span id="line-1296"></span><span class="hs-comment">-- See also 'splitTyConApp_maybe'</span><span>
</span><span id="line-1297"></span><span class="annot"><a href="GHC.Core.Type.html#splitTyConApp"><span class="hs-identifier hs-type">splitTyConApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1298"></span><span id="splitTyConApp"><span class="annot"><span class="annottext">splitTyConApp :: Type -&gt; (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp"><span class="hs-identifier hs-var hs-var">splitTyConApp</span></a></span></span><span> </span><span id="local-6989586621680812832"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812832"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812832"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1299"></span><span>                   </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812831"><span class="annot"><span class="annottext">(TyCon, [Type])
</span><a href="#local-6989586621680812831"><span class="hs-identifier hs-var">stuff</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TyCon, [Type])
</span><a href="#local-6989586621680812831"><span class="hs-identifier hs-var">stuff</span></a></span><span>
</span><span id="line-1300"></span><span>                   </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (TyCon, [Type])
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitTyConApp&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812832"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1301"></span><span>
</span><span id="line-1302"></span><span class="hs-comment">-- | Attempts to tease a type apart into a type constructor and the application</span><span>
</span><span id="line-1303"></span><span class="hs-comment">-- of a number of arguments to that constructor</span><span>
</span><span id="line-1304"></span><span class="annot"><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-type">splitTyConApp_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1305"></span><span id="splitTyConApp_maybe"><span class="annot"><span class="annottext">splitTyConApp_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var hs-var">splitTyConApp_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#repSplitTyConApp_maybe"><span class="hs-identifier hs-var">repSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe (TyCon, [Type]))
-&gt; (Type -&gt; Type) -&gt; Type -&gt; Maybe (TyCon, [Type])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span>
</span><span id="line-1306"></span><span>
</span><span id="line-1307"></span><span class="hs-comment">-- | Split a type constructor application into its type constructor and</span><span>
</span><span id="line-1308"></span><span class="hs-comment">-- applied types. Note that this may fail in the case of a 'FunTy' with an</span><span>
</span><span id="line-1309"></span><span class="hs-comment">-- argument of unknown kind 'FunTy' (e.g. @FunTy (a :: k) Int@. since the kind</span><span>
</span><span id="line-1310"></span><span class="hs-comment">-- of @a@ isn't of the form @TYPE rep@). Consequently, you may need to zonk your</span><span>
</span><span id="line-1311"></span><span class="hs-comment">-- type before using this function.</span><span>
</span><span id="line-1312"></span><span class="hs-comment">--</span><span>
</span><span id="line-1313"></span><span class="hs-comment">-- If you only need the 'TyCon', consider using 'tcTyConAppTyCon_maybe'.</span><span>
</span><span id="line-1314"></span><span class="annot"><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-type">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1315"></span><span class="hs-comment">-- Defined here to avoid module loops between Unify and TcType.</span><span>
</span><span id="line-1316"></span><span id="tcSplitTyConApp_maybe"><span class="annot"><span class="annottext">tcSplitTyConApp_maybe :: HasCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var hs-var">tcSplitTyConApp_maybe</span></a></span></span><span> </span><span id="local-6989586621680812824"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812824"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812823"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812823"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#tcView"><span class="hs-identifier hs-var">tcView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812824"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812823"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1317"></span><span class="annot"><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span id="local-6989586621680812822"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812822"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#repSplitTyConApp_maybe"><span class="hs-identifier hs-var">repSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812822"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1318"></span><span>
</span><span id="line-1319"></span><span class="hs-comment">-------------------</span><span>
</span><span id="line-1320"></span><span class="annot"><a href="GHC.Core.Type.html#repSplitTyConApp_maybe"><span class="hs-identifier hs-type">repSplitTyConApp_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1321"></span><span class="hs-comment">-- ^ Like 'splitTyConApp_maybe', but doesn't look through synonyms. This</span><span>
</span><span id="line-1322"></span><span class="hs-comment">-- assumes the synonyms have already been dealt with.</span><span>
</span><span id="line-1323"></span><span class="hs-comment">--</span><span>
</span><span id="line-1324"></span><span class="hs-comment">-- Moreover, for a FunTy, it only succeeds if the argument types</span><span>
</span><span id="line-1325"></span><span class="hs-comment">-- have enough info to extract the runtime-rep arguments that</span><span>
</span><span id="line-1326"></span><span class="hs-comment">-- the funTyCon requires.  This will usually be true;</span><span>
</span><span id="line-1327"></span><span class="hs-comment">-- but may be temporarily false during canonicalization:</span><span>
</span><span id="line-1328"></span><span class="hs-comment">--     see Note [FunTy and decomposing tycon applications] in &quot;GHC.Tc.Solver.Canonical&quot;</span><span>
</span><span id="line-1329"></span><span class="hs-comment">--</span><span>
</span><span id="line-1330"></span><span id="repSplitTyConApp_maybe"><span class="annot"><span class="annottext">repSplitTyConApp_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#repSplitTyConApp_maybe"><span class="hs-identifier hs-var hs-var">repSplitTyConApp_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812818"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812818"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680812817"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812817"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCon, [Type]) -&gt; Maybe (TyCon, [Type])
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812818"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812817"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1331"></span><span class="annot"><a href="GHC.Core.Type.html#repSplitTyConApp_maybe"><span class="hs-identifier hs-var">repSplitTyConApp_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812816"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812816"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680812815"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812815"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621680812814"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812814"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1332"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812813"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812813"><span class="hs-identifier hs-var">arg_rep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812815"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1333"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812812"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812812"><span class="hs-identifier hs-var">res_rep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812814"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1334"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCon, [Type]) -&gt; Maybe (TyCon, [Type])
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812816"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812813"><span class="hs-identifier hs-var">arg_rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812812"><span class="hs-identifier hs-var">res_rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812815"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812814"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1335"></span><span class="annot"><a href="GHC.Core.Type.html#repSplitTyConApp_maybe"><span class="hs-identifier hs-var">repSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1336"></span><span>
</span><span id="line-1337"></span><span class="hs-comment">-------------------</span><span>
</span><span id="line-1338"></span><span class="hs-comment">-- | Attempts to tease a list type apart and gives the type of the elements if</span><span>
</span><span id="line-1339"></span><span class="hs-comment">-- successful (looks through type synonyms)</span><span>
</span><span id="line-1340"></span><span class="annot"><a href="GHC.Core.Type.html#splitListTyConApp_maybe"><span class="hs-identifier hs-type">splitListTyConApp_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1341"></span><span id="splitListTyConApp_maybe"><span class="annot"><span class="annottext">splitListTyConApp_maybe :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#splitListTyConApp_maybe"><span class="hs-identifier hs-var hs-var">splitListTyConApp_maybe</span></a></span></span><span> </span><span id="local-6989586621680812811"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812811"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812811"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1342"></span><span>  </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812810"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812810"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621680812809"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812809"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812810"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; TyCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.html#listTyCon"><span class="hs-identifier hs-var">listTyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812809"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1343"></span><span>  </span><span id="local-6989586621680812808"><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><a href="#local-6989586621680812808"><span class="hs-identifier hs-var">_other</span></a></span></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1344"></span><span>
</span><span id="line-1345"></span><span class="annot"><a href="GHC.Core.Type.html#newTyConInstRhs"><span class="hs-identifier hs-type">newTyConInstRhs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1346"></span><span class="hs-comment">-- ^ Unwrap one 'layer' of newtype on a type constructor and its</span><span>
</span><span id="line-1347"></span><span class="hs-comment">-- arguments, using an eta-reduced version of the @newtype@ if possible.</span><span>
</span><span id="line-1348"></span><span class="hs-comment">-- This requires tys to have at least @newTyConInstArity tycon@ elements.</span><span>
</span><span id="line-1349"></span><span id="newTyConInstRhs"><span class="annot"><span class="annottext">newTyConInstRhs :: TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#newTyConInstRhs"><span class="hs-identifier hs-var hs-var">newTyConInstRhs</span></a></span></span><span> </span><span id="local-6989586621680812807"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812807"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621680812806"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812806"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-1350"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">leLength</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tycon</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1351"></span><span>      </span><span class="annot"><span class="annottext">[TyVar] -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#applyTysX"><span class="hs-identifier hs-var">applyTysX</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812805"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812803"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812806"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1352"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1353"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680812805"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812805"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812803"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812803"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; ([TyVar], Type)
</span><a href="GHC.Core.TyCon.html#newTyConEtadRhs"><span class="hs-identifier hs-var">newTyConEtadRhs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812807"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1354"></span><span>
</span><span id="line-1355"></span><span class="hs-comment">{-
---------------------------------------------------------------------
                           CastTy
                           ~~~~~~
A casted type has its *kind* casted into something new.
-}</span><span>
</span><span id="line-1361"></span><span>
</span><span id="line-1362"></span><span class="annot"><a href="GHC.Core.Type.html#splitCastTy_maybe"><span class="hs-identifier hs-type">splitCastTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1363"></span><span id="splitCastTy_maybe"><span class="annot"><span class="annottext">splitCastTy_maybe :: Type -&gt; Maybe (Type, KindCoercion)
</span><a href="GHC.Core.Type.html#splitCastTy_maybe"><span class="hs-identifier hs-var hs-var">splitCastTy_maybe</span></a></span></span><span> </span><span id="local-6989586621680812801"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812801"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1364"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680812800"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812800"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span id="local-6989586621680812799"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812799"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812801"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, KindCoercion) -&gt; Maybe (Type, KindCoercion)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812800"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812799"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1365"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Type, KindCoercion)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1366"></span><span>
</span><span id="line-1367"></span><span class="hs-comment">-- | Make a 'CastTy'. The Coercion must be nominal. Checks the</span><span>
</span><span id="line-1368"></span><span class="hs-comment">-- Coercion for reflexivity, dropping it if it's reflexive.</span><span>
</span><span id="line-1369"></span><span class="hs-comment">-- See Note [Respecting definitional equality] in &quot;GHC.Core.TyCo.Rep&quot;</span><span>
</span><span id="line-1370"></span><span class="annot"><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-type">mkCastTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1371"></span><span id="mkCastTy"><span class="annot"><span class="annottext">mkCastTy :: Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var hs-var">mkCastTy</span></a></span></span><span> </span><span id="local-6989586621680812798"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812798"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812797"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812797"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Bool
</span><a href="GHC.Core.Coercion.html#isReflexiveCo"><span class="hs-identifier hs-var">isReflexiveCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812797"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812798"><span class="hs-identifier hs-var">ty</span></a></span><span>  </span><span class="hs-comment">-- (EQ2) from the Note</span><span>
</span><span id="line-1372"></span><span class="hs-comment">-- NB: Do the slow check here. This is important to keep the splitXXX</span><span>
</span><span id="line-1373"></span><span class="hs-comment">-- functions working properly. Otherwise, we may end up with something</span><span>
</span><span id="line-1374"></span><span class="hs-comment">-- like (((-&gt;) |&gt; something_reflexive_but_not_obviously_so) biz baz)</span><span>
</span><span id="line-1375"></span><span class="hs-comment">-- fails under splitFunTy_maybe. This happened with the cheaper check</span><span>
</span><span id="line-1376"></span><span class="hs-comment">-- in test dependent/should_compile/dynamic-paper.</span><span>
</span><span id="line-1377"></span><span>
</span><span id="line-1378"></span><span class="annot"><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680812796"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812796"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812795"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812795"><span class="hs-identifier hs-var">co1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812794"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812794"><span class="hs-identifier hs-var">co2</span></a></span></span><span>
</span><span id="line-1379"></span><span>  </span><span class="hs-comment">-- (EQ3) from the Note</span><span>
</span><span id="line-1380"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812796"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812795"><span class="hs-identifier hs-var">co1</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTransCo"><span class="hs-operator hs-var">`mkTransCo`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812794"><span class="hs-identifier hs-var">co2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1381"></span><span>      </span><span class="hs-comment">-- call mkCastTy again for the reflexivity check</span><span>
</span><span id="line-1382"></span><span>
</span><span id="line-1383"></span><span class="annot"><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812793"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812793"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680812792"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812792"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812791"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812791"><span class="hs-identifier hs-var">inner_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812790"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812790"><span class="hs-identifier hs-var">co</span></a></span></span><span>
</span><span id="line-1384"></span><span>  </span><span class="hs-comment">-- (EQ4) from the Note</span><span>
</span><span id="line-1385"></span><span>  </span><span class="hs-comment">-- See Note [Weird typing rule for ForAllTy] in GHC.Core.TyCo.Rep.</span><span>
</span><span id="line-1386"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812793"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1387"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680812789"><span class="annot"><span class="annottext">fvs :: TyCoVarSet
</span><a href="#local-6989586621680812789"><span class="hs-identifier hs-var hs-var">fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812790"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1388"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- have to make sure that pushing the co in doesn't capture the bound var!</span><span>
</span><span id="line-1389"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812793"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TyCoVarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812789"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1390"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680812786"><span class="annot"><span class="annottext">empty_subst :: TCvSubst
</span><a href="#local-6989586621680812786"><span class="hs-identifier hs-var hs-var">empty_subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var">mkEmptyTCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812789"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1391"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621680812783"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812783"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812782"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812782"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; TyVar -&gt; (TCvSubst, TyVar)
TCvSubst -&gt; TyVar -&gt; (TCvSubst, TyVar)
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndr"><span class="hs-identifier hs-var">substVarBndr</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812786"><span class="hs-identifier hs-var">empty_subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812793"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1392"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ArgFlag -&gt; VarBndr TyVar ArgFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812782"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812792"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812783"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812791"><span class="hs-identifier hs-var">inner_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-operator hs-var">`mkCastTy`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812790"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1393"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ArgFlag -&gt; VarBndr TyVar ArgFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812793"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812792"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812791"><span class="hs-identifier hs-var">inner_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-operator hs-var">`mkCastTy`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812790"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1394"></span><span>
</span><span id="line-1395"></span><span class="annot"><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span id="local-6989586621680812781"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812781"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812780"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812780"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812781"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812780"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1396"></span><span>
</span><span id="line-1397"></span><span class="annot"><a href="GHC.Core.Type.html#tyConBindersTyCoBinders"><span class="hs-identifier hs-type">tyConBindersTyCoBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1398"></span><span class="hs-comment">-- Return the tyConBinders in TyCoBinder form</span><span>
</span><span id="line-1399"></span><span id="tyConBindersTyCoBinders"><span class="annot"><span class="annottext">tyConBindersTyCoBinders :: [TyConBinder] -&gt; [TyCoBinder]
</span><a href="GHC.Core.Type.html#tyConBindersTyCoBinders"><span class="hs-identifier hs-var hs-var">tyConBindersTyCoBinders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyConBinder -&gt; TyCoBinder) -&gt; [TyConBinder] -&gt; [TyCoBinder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">TyConBinder -&gt; TyCoBinder
</span><a href="#local-6989586621680812779"><span class="hs-identifier hs-var">to_tyb</span></a></span><span>
</span><span id="line-1400"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1401"></span><span>    </span><span id="local-6989586621680812779"><span class="annot"><span class="annottext">to_tyb :: TyConBinder -&gt; TyCoBinder
</span><a href="#local-6989586621680812779"><span class="hs-identifier hs-var hs-var">to_tyb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812778"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812778"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#NamedTCB"><span class="hs-identifier hs-type">NamedTCB</span></a></span><span> </span><span id="local-6989586621680812776"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812776"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ArgFlag -&gt; VarBndr TyVar ArgFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812778"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812776"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1402"></span><span>    </span><span class="annot"><a href="#local-6989586621680812779"><span class="hs-identifier hs-var">to_tyb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812774"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812774"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#AnonTCB"><span class="hs-identifier hs-type">AnonTCB</span></a></span><span> </span><span id="local-6989586621680812772"><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680812772"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnonArgFlag -&gt; Scaled Type -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680812772"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Scaled Type
forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#tymult"><span class="hs-identifier hs-var">tymult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812774"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1403"></span><span>
</span><span id="line-1404"></span><span>
</span><span id="line-1405"></span><span class="hs-comment">{-
--------------------------------------------------------------------
                            CoercionTy
                            ~~~~~~~~~~
CoercionTy allows us to inject coercions into types. A CoercionTy
should appear only in the right-hand side of an application.
-}</span><span>
</span><span id="line-1412"></span><span>
</span><span id="line-1413"></span><span class="annot"><a href="GHC.Core.Type.html#mkCoercionTy"><span class="hs-identifier hs-type">mkCoercionTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1414"></span><span id="mkCoercionTy"><span class="annot"><span class="annottext">mkCoercionTy :: KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCoercionTy"><span class="hs-identifier hs-var hs-var">mkCoercionTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a></span><span>
</span><span id="line-1415"></span><span>
</span><span id="line-1416"></span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy"><span class="hs-identifier hs-type">isCoercionTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1417"></span><span id="isCoercionTy"><span class="annot"><span class="annottext">isCoercionTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isCoercionTy"><span class="hs-identifier hs-var hs-var">isCoercionTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1418"></span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy"><span class="hs-identifier hs-var">isCoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1419"></span><span>
</span><span id="line-1420"></span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy_maybe"><span class="hs-identifier hs-type">isCoercionTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-1421"></span><span id="isCoercionTy_maybe"><span class="annot"><span class="annottext">isCoercionTy_maybe :: Type -&gt; Maybe KindCoercion
</span><a href="GHC.Core.Type.html#isCoercionTy_maybe"><span class="hs-identifier hs-var hs-var">isCoercionTy_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621680812770"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812770"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812770"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1422"></span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy_maybe"><span class="hs-identifier hs-var">isCoercionTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe KindCoercion
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1423"></span><span>
</span><span id="line-1424"></span><span class="annot"><a href="GHC.Core.Type.html#stripCoercionTy"><span class="hs-identifier hs-type">stripCoercionTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-1425"></span><span id="stripCoercionTy"><span class="annot"><span class="annottext">stripCoercionTy :: Type -&gt; KindCoercion
</span><a href="GHC.Core.Type.html#stripCoercionTy"><span class="hs-identifier hs-var hs-var">stripCoercionTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621680812769"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812769"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812769"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1426"></span><span class="annot"><a href="GHC.Core.Type.html#stripCoercionTy"><span class="hs-identifier hs-var">stripCoercionTy</span></a></span><span> </span><span id="local-6989586621680812768"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812768"><span class="hs-identifier hs-var">ty</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; KindCoercion
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;stripCoercionTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812768"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1427"></span><span>
</span><span id="line-1428"></span><span class="hs-comment">{-
---------------------------------------------------------------------
                                SynTy
                                ~~~~~

Notes on type synonyms
~~~~~~~~~~~~~~~~~~~~~~
The various &quot;split&quot; functions (splitFunTy, splitRhoTy, splitForAllTy) try
to return type synonyms wherever possible. Thus

        type Foo a = a -&gt; a

we want
        splitFunTys (a -&gt; Foo a) = ([a], Foo a)
not                                ([a], a -&gt; a)

The reason is that we then get better (shorter) type signatures in
interfaces.  Notably this plays a role in tcTySigs in GHC.Tc.Gen.Bind.


---------------------------------------------------------------------
                                ForAllTy
                                ~~~~~~~~
-}</span><span>
</span><span id="line-1452"></span><span>
</span><span id="line-1453"></span><span class="hs-comment">-- | Make a dependent forall over an 'Inferred' variable</span><span>
</span><span id="line-1454"></span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoInvForAllTy"><span class="hs-identifier hs-type">mkTyCoInvForAllTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1455"></span><span id="mkTyCoInvForAllTy"><span class="annot"><span class="annottext">mkTyCoInvForAllTy :: TyVar -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyCoInvForAllTy"><span class="hs-identifier hs-var hs-var">mkTyCoInvForAllTy</span></a></span></span><span> </span><span id="local-6989586621680812767"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812767"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680812766"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812766"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1456"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812767"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1457"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812767"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TyCoVarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812766"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1458"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier hs-var">mkVisFunTyMany</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812767"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812766"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1459"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1460"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ArgFlag -&gt; VarBndr TyVar ArgFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812767"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812766"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1461"></span><span>
</span><span id="line-1462"></span><span class="hs-comment">-- | Like 'mkTyCoInvForAllTy', but tv should be a tyvar</span><span>
</span><span id="line-1463"></span><span class="annot"><a href="GHC.Core.Type.html#mkInfForAllTy"><span class="hs-identifier hs-type">mkInfForAllTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1464"></span><span id="mkInfForAllTy"><span class="annot"><span class="annottext">mkInfForAllTy :: TyVar -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkInfForAllTy"><span class="hs-identifier hs-var hs-var">mkInfForAllTy</span></a></span></span><span> </span><span id="local-6989586621680812764"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812764"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680812763"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812763"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tv</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1465"></span><span>                      </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ArgFlag -&gt; VarBndr TyVar ArgFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812764"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812763"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1466"></span><span>
</span><span id="line-1467"></span><span class="hs-comment">-- | Like 'mkForAllTys', but assumes all variables are dependent and</span><span>
</span><span id="line-1468"></span><span class="hs-comment">-- 'Inferred', a common case</span><span>
</span><span id="line-1469"></span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoInvForAllTys"><span class="hs-identifier hs-type">mkTyCoInvForAllTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1470"></span><span id="mkTyCoInvForAllTys"><span class="annot"><span class="annottext">mkTyCoInvForAllTys :: [TyVar] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyCoInvForAllTys"><span class="hs-identifier hs-var hs-var">mkTyCoInvForAllTys</span></a></span></span><span> </span><span id="local-6989586621680812762"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812762"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621680812761"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812761"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; Type -&gt; Type) -&gt; Type -&gt; [TyVar] -&gt; Type
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyCoInvForAllTy"><span class="hs-identifier hs-var">mkTyCoInvForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812761"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812762"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1471"></span><span>
</span><span id="line-1472"></span><span class="hs-comment">-- | Like 'mkTyCoInvForAllTys', but tvs should be a list of tyvar</span><span>
</span><span id="line-1473"></span><span class="annot"><a href="GHC.Core.Type.html#mkInfForAllTys"><span class="hs-identifier hs-type">mkInfForAllTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1474"></span><span id="mkInfForAllTys"><span class="annot"><span class="annottext">mkInfForAllTys :: [TyVar] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkInfForAllTys"><span class="hs-identifier hs-var hs-var">mkInfForAllTys</span></a></span></span><span> </span><span id="local-6989586621680812759"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812759"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621680812758"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812758"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; Type -&gt; Type) -&gt; Type -&gt; [TyVar] -&gt; Type
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkInfForAllTy"><span class="hs-identifier hs-var">mkInfForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812758"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812759"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1475"></span><span>
</span><span id="line-1476"></span><span class="hs-comment">-- | Like 'mkForAllTy', but assumes the variable is dependent and 'Specified',</span><span>
</span><span id="line-1477"></span><span class="hs-comment">-- a common case</span><span>
</span><span id="line-1478"></span><span class="annot"><a href="GHC.Core.Type.html#mkSpecForAllTy"><span class="hs-identifier hs-type">mkSpecForAllTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1479"></span><span id="mkSpecForAllTy"><span class="annot"><span class="annottext">mkSpecForAllTy :: TyVar -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTy"><span class="hs-identifier hs-var hs-var">mkSpecForAllTy</span></a></span></span><span> </span><span id="local-6989586621680812757"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812757"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680812756"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812756"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tv</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1480"></span><span>                       </span><span class="hs-comment">-- covar is always Inferred, so input should be tyvar</span><span>
</span><span id="line-1481"></span><span>                       </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ArgFlag -&gt; VarBndr TyVar ArgFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812757"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Specified"><span class="hs-identifier hs-var">Specified</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812756"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1482"></span><span>
</span><span id="line-1483"></span><span class="hs-comment">-- | Like 'mkForAllTys', but assumes all variables are dependent and</span><span>
</span><span id="line-1484"></span><span class="hs-comment">-- 'Specified', a common case</span><span>
</span><span id="line-1485"></span><span class="annot"><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-type">mkSpecForAllTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1486"></span><span id="mkSpecForAllTys"><span class="annot"><span class="annottext">mkSpecForAllTys :: [TyVar] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var hs-var">mkSpecForAllTys</span></a></span></span><span> </span><span id="local-6989586621680812754"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812754"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621680812753"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812753"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; Type -&gt; Type) -&gt; Type -&gt; [TyVar] -&gt; Type
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTy"><span class="hs-identifier hs-var">mkSpecForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812753"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812754"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1487"></span><span>
</span><span id="line-1488"></span><span class="hs-comment">-- | Like mkForAllTys, but assumes all variables are dependent and visible</span><span>
</span><span id="line-1489"></span><span class="annot"><a href="GHC.Core.Type.html#mkVisForAllTys"><span class="hs-identifier hs-type">mkVisForAllTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1490"></span><span id="mkVisForAllTys"><span class="annot"><span class="annottext">mkVisForAllTys :: [TyVar] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkVisForAllTys"><span class="hs-identifier hs-var hs-var">mkVisForAllTys</span></a></span></span><span> </span><span id="local-6989586621680812752"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812752"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">all</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1491"></span><span>                     </span><span class="hs-comment">-- covar is always Inferred, so all inputs should be tyvar</span><span>
</span><span id="line-1492"></span><span>                     </span><span class="annot"><span class="annottext">[VarBndr TyVar ArgFlag] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkForAllTys"><span class="hs-identifier hs-var">mkForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; ArgFlag -&gt; VarBndr TyVar ArgFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812750"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680812750"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812750"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812752"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1493"></span><span>
</span><span id="line-1494"></span><span class="hs-comment">-- | Given a list of type-level vars and the free vars of a result kind,</span><span>
</span><span id="line-1495"></span><span class="hs-comment">-- makes TyCoBinders, preferring anonymous binders</span><span>
</span><span id="line-1496"></span><span class="hs-comment">-- if the variable is, in fact, not dependent.</span><span>
</span><span id="line-1497"></span><span class="hs-comment">-- e.g.    mkTyConBindersPreferAnon [(k:*),(b:k),(c:k)] (k-&gt;k)</span><span>
</span><span id="line-1498"></span><span class="hs-comment">-- We want (k:*) Named, (b:k) Anon, (c:k) Anon</span><span>
</span><span id="line-1499"></span><span class="hs-comment">--</span><span>
</span><span id="line-1500"></span><span class="hs-comment">-- All non-coercion binders are /visible/.</span><span>
</span><span id="line-1501"></span><span class="annot"><a href="GHC.Core.Type.html#mkTyConBindersPreferAnon"><span class="hs-identifier hs-type">mkTyConBindersPreferAnon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span>      </span><span class="hs-comment">-- ^ binders</span><span>
</span><span id="line-1502"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>   </span><span class="hs-comment">-- ^ free variables of result</span><span>
</span><span id="line-1503"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1504"></span><span id="mkTyConBindersPreferAnon"><span class="annot"><span class="annottext">mkTyConBindersPreferAnon :: [TyVar] -&gt; TyCoVarSet -&gt; [TyConBinder]
</span><a href="GHC.Core.Type.html#mkTyConBindersPreferAnon"><span class="hs-identifier hs-var hs-var">mkTyConBindersPreferAnon</span></a></span></span><span> </span><span id="local-6989586621680812748"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812748"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621680812747"><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812747"><span class="hs-identifier hs-var">inner_tkvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">all</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">vars</span><span class="hs-special">)</span><span>
</span><span id="line-1505"></span><span>                                           </span><span class="annot"><span class="annottext">([TyConBinder], TyCoVarSet) -&gt; [TyConBinder]
forall a b. (a, b) -&gt; a
</span><a href="../../base/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; ([TyConBinder], TyCoVarSet)
</span><a href="#local-6989586621680812746"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812748"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1506"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1507"></span><span>    </span><span class="annot"><a href="#local-6989586621680812746"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- also returns the free vars</span><span>
</span><span id="line-1508"></span><span>    </span><span id="local-6989586621680812746"><span class="annot"><span class="annottext">go :: [TyVar] -&gt; ([TyConBinder], TyCoVarSet)
</span><a href="#local-6989586621680812746"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812747"><span class="hs-identifier hs-var">inner_tkvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1509"></span><span>    </span><span class="annot"><a href="#local-6989586621680812746"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812744"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812744"><span class="hs-identifier hs-var">v</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680812743"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812743"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812744"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TyCoVarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812742"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1510"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TyConBndrVis -&gt; TyConBinder
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812744"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgFlag -&gt; TyConBndrVis
</span><a href="GHC.Core.TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyConBinder -&gt; [TyConBinder] -&gt; [TyConBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621680812741"><span class="hs-identifier hs-var">binders</span></a></span><span>
</span><span id="line-1511"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812742"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyVar -&gt; TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#delVarSet"><span class="hs-operator hs-var">`delVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812744"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyCoVarSet -&gt; TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#unionVarSet"><span class="hs-operator hs-var">`unionVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812738"><span class="hs-identifier hs-var">kind_vars</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1512"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1513"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TyConBndrVis -&gt; TyConBinder
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812744"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnonArgFlag -&gt; TyConBndrVis
</span><a href="GHC.Core.TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="GHC.Types.Var.html#VisArg"><span class="hs-identifier hs-var">VisArg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyConBinder -&gt; [TyConBinder] -&gt; [TyConBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621680812741"><span class="hs-identifier hs-var">binders</span></a></span><span>
</span><span id="line-1514"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812742"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyCoVarSet -&gt; TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#unionVarSet"><span class="hs-operator hs-var">`unionVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812738"><span class="hs-identifier hs-var">kind_vars</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1515"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1516"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680812741"><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621680812741"><span class="hs-identifier hs-var">binders</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812742"><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812742"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; ([TyConBinder], TyCoVarSet)
</span><a href="#local-6989586621680812746"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812743"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-1517"></span><span>        </span><span id="local-6989586621680812738"><span class="annot"><span class="annottext">kind_vars :: TyCoVarSet
</span><a href="#local-6989586621680812738"><span class="hs-identifier hs-var hs-var">kind_vars</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TyCoVarSet) -&gt; Type -&gt; TyCoVarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812744"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1518"></span><span>
</span><span id="line-1519"></span><span class="hs-comment">-- | Take a ForAllTy apart, returning the list of tycovars and the result type.</span><span>
</span><span id="line-1520"></span><span class="hs-comment">-- This always succeeds, even if it returns only an empty list. Note that the</span><span>
</span><span id="line-1521"></span><span class="hs-comment">-- result type returned may have free variables that were bound by a forall.</span><span>
</span><span id="line-1522"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTys"><span class="hs-identifier hs-type">splitForAllTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1523"></span><span id="splitForAllTys"><span class="annot"><span class="annottext">splitForAllTys :: Type -&gt; ([TyVar], Type)
</span><a href="GHC.Core.Type.html#splitForAllTys"><span class="hs-identifier hs-var hs-var">splitForAllTys</span></a></span></span><span> </span><span id="local-6989586621680812736"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812736"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621680812735"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812736"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812736"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1524"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1525"></span><span>    </span><span id="local-6989586621680812735"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621680812735"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812734"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812734"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812733"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812733"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621680812732"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812732"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621680812735"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812733"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812733"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812734"><span class="hs-identifier hs-var">tv</span></a></span><span class="annot"><span class="annottext">TyVar -&gt; [TyVar] -&gt; [TyVar]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812732"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1526"></span><span>    </span><span class="annot"><a href="#local-6989586621680812735"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812731"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812731"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621680812730"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812730"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812729"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812729"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812728"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812728"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812730"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621680812735"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812731"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812728"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812729"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1527"></span><span>    </span><span class="annot"><a href="#local-6989586621680812735"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812727"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812727"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                            </span><span id="local-6989586621680812726"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812726"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812726"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812727"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1528"></span><span>
</span><span id="line-1529"></span><span class="hs-comment">-- | Splits the longest initial sequence of ForAllTys' that satisfy</span><span>
</span><span id="line-1530"></span><span class="hs-comment">-- @argf_pred@, returning the binders transformed by @argf_pred@</span><span>
</span><span id="line-1531"></span><span id="local-6989586621680814138"><span class="annot"><a href="GHC.Core.Type.html#splitSomeForAllTys"><span class="hs-identifier hs-type">splitSomeForAllTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680814138"><span class="hs-identifier hs-type">af</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680814138"><span class="hs-identifier hs-type">af</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1532"></span><span id="splitSomeForAllTys"><span class="annot"><span class="annottext">splitSomeForAllTys :: forall af.
(ArgFlag -&gt; Maybe af) -&gt; Type -&gt; ([VarBndr TyVar af], Type)
</span><a href="GHC.Core.Type.html#splitSomeForAllTys"><span class="hs-identifier hs-var hs-var">splitSomeForAllTys</span></a></span></span><span> </span><span id="local-6989586621680812724"><span class="annot"><span class="annottext">ArgFlag -&gt; Maybe af
</span><a href="#local-6989586621680812724"><span class="hs-identifier hs-var">argf_pred</span></a></span></span><span> </span><span id="local-6989586621680812723"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812723"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [VarBndr TyVar af] -&gt; ([VarBndr TyVar af], Type)
</span><a href="#local-6989586621680812722"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812723"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812723"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1533"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1534"></span><span>    </span><span id="local-6989586621680812722"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [VarBndr TyVar af] -&gt; ([VarBndr TyVar af], Type)
</span><a href="#local-6989586621680812722"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812721"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812721"><span class="hs-identifier hs-var">tcv</span></a></span></span><span> </span><span id="local-6989586621680812720"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812720"><span class="hs-identifier hs-var">argf</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812719"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812719"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812718"><span class="annot"><span class="annottext">[VarBndr TyVar af]
</span><a href="#local-6989586621680812718"><span class="hs-identifier hs-var">tvs</span></a></span></span><span>
</span><span id="line-1535"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812717"><span class="annot"><span class="annottext">af
</span><a href="#local-6989586621680812717"><span class="hs-identifier hs-var">argf'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ArgFlag -&gt; Maybe af
</span><a href="#local-6989586621680812724"><span class="hs-identifier hs-var">argf_pred</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812720"><span class="hs-identifier hs-var">argf</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [VarBndr TyVar af] -&gt; ([VarBndr TyVar af], Type)
</span><a href="#local-6989586621680812722"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812719"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812719"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; af -&gt; VarBndr TyVar af
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812721"><span class="hs-identifier hs-var">tcv</span></a></span><span> </span><span class="annot"><span class="annottext">af
</span><a href="#local-6989586621680812717"><span class="hs-identifier hs-var">argf'</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar af -&gt; [VarBndr TyVar af] -&gt; [VarBndr TyVar af]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[VarBndr TyVar af]
</span><a href="#local-6989586621680812718"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1536"></span><span>    </span><span class="annot"><a href="#local-6989586621680812722"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812716"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812716"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621680812715"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812715"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812714"><span class="annot"><span class="annottext">[VarBndr TyVar af]
</span><a href="#local-6989586621680812714"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812713"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812713"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812715"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [VarBndr TyVar af] -&gt; ([VarBndr TyVar af], Type)
</span><a href="#local-6989586621680812722"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812716"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812713"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TyVar af]
</span><a href="#local-6989586621680812714"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1537"></span><span>    </span><span class="annot"><a href="#local-6989586621680812722"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812712"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812712"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                            </span><span id="local-6989586621680812711"><span class="annot"><span class="annottext">[VarBndr TyVar af]
</span><a href="#local-6989586621680812711"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VarBndr TyVar af] -&gt; [VarBndr TyVar af]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TyVar af]
</span><a href="#local-6989586621680812711"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812712"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1538"></span><span>
</span><span id="line-1539"></span><span class="hs-comment">-- | Like 'splitForAllTys', but only splits 'ForAllTy's with 'Required' type</span><span>
</span><span id="line-1540"></span><span class="hs-comment">-- variable binders. Furthermore, each returned tyvar is annotated with '()'.</span><span>
</span><span id="line-1541"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTysReq"><span class="hs-identifier hs-type">splitForAllTysReq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#ReqTVBinder"><span class="hs-identifier hs-type">ReqTVBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1542"></span><span id="splitForAllTysReq"><span class="annot"><span class="annottext">splitForAllTysReq :: Type -&gt; ([ReqTVBinder], Type)
</span><a href="GHC.Core.Type.html#splitForAllTysReq"><span class="hs-identifier hs-var hs-var">splitForAllTysReq</span></a></span></span><span> </span><span id="local-6989586621680812710"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812710"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ArgFlag -&gt; Maybe ()) -&gt; Type -&gt; ([ReqTVBinder], Type)
forall af.
(ArgFlag -&gt; Maybe af) -&gt; Type -&gt; ([VarBndr TyVar af], Type)
</span><a href="GHC.Core.Type.html#splitSomeForAllTys"><span class="hs-identifier hs-var">splitSomeForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag -&gt; Maybe ()
</span><a href="#local-6989586621680812709"><span class="hs-identifier hs-var">argf_pred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812710"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1543"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1544"></span><span>    </span><span class="annot"><a href="#local-6989586621680812709"><span class="hs-identifier hs-type">argf_pred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1545"></span><span>    </span><span id="local-6989586621680812709"><span class="annot"><span class="annottext">argf_pred :: ArgFlag -&gt; Maybe ()
</span><a href="#local-6989586621680812709"><span class="hs-identifier hs-var hs-var">argf_pred</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1546"></span><span>    </span><span class="annot"><a href="#local-6989586621680812709"><span class="hs-identifier hs-var">argf_pred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Invisible"><span class="hs-identifier hs-type">Invisible</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1547"></span><span>
</span><span id="line-1548"></span><span class="hs-comment">-- | Like 'splitForAllTys', but only splits 'ForAllTy's with 'Invisible' type</span><span>
</span><span id="line-1549"></span><span class="hs-comment">-- variable binders. Furthermore, each returned tyvar is annotated with its</span><span>
</span><span id="line-1550"></span><span class="hs-comment">-- 'Specificity'.</span><span>
</span><span id="line-1551"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTysInvis"><span class="hs-identifier hs-type">splitForAllTysInvis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#InvisTVBinder"><span class="hs-identifier hs-type">InvisTVBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1552"></span><span id="splitForAllTysInvis"><span class="annot"><span class="annottext">splitForAllTysInvis :: Type -&gt; ([InvisTVBinder], Type)
</span><a href="GHC.Core.Type.html#splitForAllTysInvis"><span class="hs-identifier hs-var hs-var">splitForAllTysInvis</span></a></span></span><span> </span><span id="local-6989586621680812707"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812707"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ArgFlag -&gt; Maybe Specificity) -&gt; Type -&gt; ([InvisTVBinder], Type)
forall af.
(ArgFlag -&gt; Maybe af) -&gt; Type -&gt; ([VarBndr TyVar af], Type)
</span><a href="GHC.Core.Type.html#splitSomeForAllTys"><span class="hs-identifier hs-var">splitSomeForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag -&gt; Maybe Specificity
</span><a href="#local-6989586621680812706"><span class="hs-identifier hs-var">argf_pred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812707"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1553"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1554"></span><span>    </span><span class="annot"><a href="#local-6989586621680812706"><span class="hs-identifier hs-type">argf_pred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Specificity"><span class="hs-identifier hs-type">Specificity</span></a></span><span>
</span><span id="line-1555"></span><span>    </span><span id="local-6989586621680812706"><span class="annot"><span class="annottext">argf_pred :: ArgFlag -&gt; Maybe Specificity
</span><a href="#local-6989586621680812706"><span class="hs-identifier hs-var hs-var">argf_pred</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Specificity
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1556"></span><span>    </span><span class="annot"><a href="#local-6989586621680812706"><span class="hs-identifier hs-var">argf_pred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Invisible"><span class="hs-identifier hs-type">Invisible</span></a></span><span> </span><span id="local-6989586621680812705"><span class="annot"><span class="annottext">Specificity
</span><a href="#local-6989586621680812705"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Specificity -&gt; Maybe Specificity
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Specificity
</span><a href="#local-6989586621680812705"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-1557"></span><span>
</span><span id="line-1558"></span><span class="hs-comment">-- | Like splitForAllTys, but split only for tyvars.</span><span>
</span><span id="line-1559"></span><span class="hs-comment">-- This always succeeds, even if it returns only an empty list. Note that the</span><span>
</span><span id="line-1560"></span><span class="hs-comment">-- result type returned may have free variables that were bound by a forall.</span><span>
</span><span id="line-1561"></span><span class="annot"><a href="GHC.Core.Type.html#splitTyVarForAllTys"><span class="hs-identifier hs-type">splitTyVarForAllTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1562"></span><span id="splitTyVarForAllTys"><span class="annot"><span class="annottext">splitTyVarForAllTys :: Type -&gt; ([TyVar], Type)
</span><a href="GHC.Core.Type.html#splitTyVarForAllTys"><span class="hs-identifier hs-var hs-var">splitTyVarForAllTys</span></a></span></span><span> </span><span id="local-6989586621680812703"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812703"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621680812702"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812703"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812703"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1563"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1564"></span><span>    </span><span id="local-6989586621680812702"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621680812702"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812701"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812701"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812700"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812700"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812699"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812699"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812701"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621680812702"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812700"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812700"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812701"><span class="hs-identifier hs-var">tv</span></a></span><span class="annot"><span class="annottext">TyVar -&gt; [TyVar] -&gt; [TyVar]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812699"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1565"></span><span>    </span><span class="annot"><a href="#local-6989586621680812702"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812698"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812698"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621680812697"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812697"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812696"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812696"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812695"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812695"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812697"><span class="hs-identifier hs-var">ty</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621680812702"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812698"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812695"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812696"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1566"></span><span>    </span><span class="annot"><a href="#local-6989586621680812702"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812694"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812694"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                   </span><span id="local-6989586621680812693"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812693"><span class="hs-identifier hs-var">tvs</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812693"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812694"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1567"></span><span>
</span><span id="line-1568"></span><span class="hs-comment">-- | Checks whether this is a proper forall (with a named binder)</span><span>
</span><span id="line-1569"></span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy"><span class="hs-identifier hs-type">isForAllTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1570"></span><span id="isForAllTy"><span class="annot"><span class="annottext">isForAllTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isForAllTy"><span class="hs-identifier hs-var hs-var">isForAllTy</span></a></span></span><span> </span><span id="local-6989586621680812692"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812692"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1571"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812692"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1572"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1573"></span><span>
</span><span id="line-1574"></span><span class="hs-comment">-- | Like `isForAllTy`, but returns True only if it is a tyvar binder</span><span>
</span><span id="line-1575"></span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_ty"><span class="hs-identifier hs-type">isForAllTy_ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1576"></span><span id="isForAllTy_ty"><span class="annot"><span class="annottext">isForAllTy_ty :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isForAllTy_ty"><span class="hs-identifier hs-var hs-var">isForAllTy_ty</span></a></span></span><span> </span><span id="local-6989586621680812691"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812691"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1577"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812690"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812690"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812691"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1578"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812690"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1579"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1580"></span><span>
</span><span id="line-1581"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1582"></span><span>
</span><span id="line-1583"></span><span class="hs-comment">-- | Like `isForAllTy`, but returns True only if it is a covar binder</span><span>
</span><span id="line-1584"></span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_co"><span class="hs-identifier hs-type">isForAllTy_co</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1585"></span><span id="isForAllTy_co"><span class="annot"><span class="annottext">isForAllTy_co :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isForAllTy_co"><span class="hs-identifier hs-var hs-var">isForAllTy_co</span></a></span></span><span> </span><span id="local-6989586621680812689"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812689"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1586"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812688"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812688"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812689"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1587"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812688"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1588"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1589"></span><span>
</span><span id="line-1590"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1591"></span><span>
</span><span id="line-1592"></span><span class="hs-comment">-- | Is this a function or forall?</span><span>
</span><span id="line-1593"></span><span class="annot"><a href="GHC.Core.Type.html#isPiTy"><span class="hs-identifier hs-type">isPiTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1594"></span><span id="isPiTy"><span class="annot"><span class="annottext">isPiTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isPiTy"><span class="hs-identifier hs-var hs-var">isPiTy</span></a></span></span><span> </span><span id="local-6989586621680812687"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812687"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812687"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1595"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1596"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1597"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1598"></span><span>
</span><span id="line-1599"></span><span class="hs-comment">-- | Is this a function?</span><span>
</span><span id="line-1600"></span><span class="annot"><a href="GHC.Core.Type.html#isFunTy"><span class="hs-identifier hs-type">isFunTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1601"></span><span id="isFunTy"><span class="annot"><span class="annottext">isFunTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFunTy"><span class="hs-identifier hs-var hs-var">isFunTy</span></a></span></span><span> </span><span id="local-6989586621680812686"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812686"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1602"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812686"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1603"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1604"></span><span>
</span><span id="line-1605"></span><span class="hs-comment">-- | Take a forall type apart, or panics if that is not possible.</span><span>
</span><span id="line-1606"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTy"><span class="hs-identifier hs-type">splitForAllTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1607"></span><span id="splitForAllTy"><span class="annot"><span class="annottext">splitForAllTy :: Type -&gt; (TyVar, Type)
</span><a href="GHC.Core.Type.html#splitForAllTy"><span class="hs-identifier hs-var hs-var">splitForAllTy</span></a></span></span><span> </span><span id="local-6989586621680812685"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812685"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1608"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812684"><span class="annot"><span class="annottext">(TyVar, Type)
</span><a href="#local-6989586621680812684"><span class="hs-identifier hs-var">answer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TyVar, Type)
</span><a href="GHC.Core.Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var">splitForAllTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812685"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar, Type)
</span><a href="#local-6989586621680812684"><span class="hs-identifier hs-var">answer</span></a></span><span>
</span><span id="line-1609"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (TyVar, Type)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitForAllTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812685"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1610"></span><span>
</span><span id="line-1611"></span><span class="hs-comment">-- | Drops all ForAllTys</span><span>
</span><span id="line-1612"></span><span class="annot"><a href="GHC.Core.Type.html#dropForAlls"><span class="hs-identifier hs-type">dropForAlls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1613"></span><span id="dropForAlls"><span class="annot"><span class="annottext">dropForAlls :: Type -&gt; Type
</span><a href="GHC.Core.Type.html#dropForAlls"><span class="hs-identifier hs-var hs-var">dropForAlls</span></a></span></span><span> </span><span id="local-6989586621680812683"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812683"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621680812682"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812683"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1614"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1615"></span><span>    </span><span id="local-6989586621680812682"><span class="annot"><span class="annottext">go :: Type -&gt; Type
</span><a href="#local-6989586621680812682"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812681"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812681"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621680812682"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812681"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1616"></span><span>    </span><span class="annot"><a href="#local-6989586621680812682"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812680"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812680"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812679"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812679"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812680"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621680812682"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812679"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1617"></span><span>    </span><span class="annot"><a href="#local-6989586621680812682"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812678"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812678"><span class="hs-identifier hs-var">res</span></a></span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812678"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1618"></span><span>
</span><span id="line-1619"></span><span class="hs-comment">-- | Attempts to take a forall type apart, but only if it's a proper forall,</span><span>
</span><span id="line-1620"></span><span class="hs-comment">-- with a named binder</span><span>
</span><span id="line-1621"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-type">splitForAllTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1622"></span><span id="splitForAllTy_maybe"><span class="annot"><span class="annottext">splitForAllTy_maybe :: Type -&gt; Maybe (TyVar, Type)
</span><a href="GHC.Core.Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var hs-var">splitForAllTy_maybe</span></a></span></span><span> </span><span id="local-6989586621680812677"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812677"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1623"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812676"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812676"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812675"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812675"><span class="hs-identifier hs-var">inner_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812677"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar, Type) -&gt; Maybe (TyVar, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812676"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812675"><span class="hs-identifier hs-var">inner_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1624"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TyVar, Type)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1625"></span><span>
</span><span id="line-1626"></span><span class="hs-comment">-- | Like splitForAllTy_maybe, but only returns Just if it is a tyvar binder.</span><span>
</span><span id="line-1627"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTy_ty_maybe"><span class="hs-identifier hs-type">splitForAllTy_ty_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1628"></span><span id="splitForAllTy_ty_maybe"><span class="annot"><span class="annottext">splitForAllTy_ty_maybe :: Type -&gt; Maybe (TyVar, Type)
</span><a href="GHC.Core.Type.html#splitForAllTy_ty_maybe"><span class="hs-identifier hs-var hs-var">splitForAllTy_ty_maybe</span></a></span></span><span> </span><span id="local-6989586621680812674"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812674"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1629"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812673"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812673"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812672"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812672"><span class="hs-identifier hs-var">inner_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812674"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1630"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812673"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1631"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar, Type) -&gt; Maybe (TyVar, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812673"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812672"><span class="hs-identifier hs-var">inner_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1632"></span><span>
</span><span id="line-1633"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TyVar, Type)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1634"></span><span>
</span><span id="line-1635"></span><span class="hs-comment">-- | Like splitForAllTy_maybe, but only returns Just if it is a covar binder.</span><span>
</span><span id="line-1636"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTy_co_maybe"><span class="hs-identifier hs-type">splitForAllTy_co_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1637"></span><span id="splitForAllTy_co_maybe"><span class="annot"><span class="annottext">splitForAllTy_co_maybe :: Type -&gt; Maybe (TyVar, Type)
</span><a href="GHC.Core.Type.html#splitForAllTy_co_maybe"><span class="hs-identifier hs-var hs-var">splitForAllTy_co_maybe</span></a></span></span><span> </span><span id="local-6989586621680812671"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812671"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1638"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812670"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812670"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812669"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812669"><span class="hs-identifier hs-var">inner_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812671"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1639"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812670"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1640"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar, Type) -&gt; Maybe (TyVar, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812670"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812669"><span class="hs-identifier hs-var">inner_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1641"></span><span>
</span><span id="line-1642"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TyVar, Type)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1643"></span><span>
</span><span id="line-1644"></span><span class="hs-comment">-- | Attempts to take a forall type apart; works with proper foralls and</span><span>
</span><span id="line-1645"></span><span class="hs-comment">-- functions</span><span>
</span><span id="line-1646"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitPiTy_maybe"><span class="hs-pragma hs-type">splitPiTy_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>  </span><span class="hs-comment">-- callers will immediately deconstruct</span><span>
</span><span id="line-1647"></span><span class="annot"><a href="GHC.Core.Type.html#splitPiTy_maybe"><span class="hs-identifier hs-type">splitPiTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1648"></span><span id="splitPiTy_maybe"><span class="annot"><span class="annottext">splitPiTy_maybe :: Type -&gt; Maybe (TyCoBinder, Type)
</span><a href="GHC.Core.Type.html#splitPiTy_maybe"><span class="hs-identifier hs-var hs-var">splitPiTy_maybe</span></a></span></span><span> </span><span id="local-6989586621680812668"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812668"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812668"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1649"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621680812667"><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812667"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621680812666"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812666"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TyCoBinder, Type) -&gt; Maybe (TyCoBinder, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812667"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812666"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1650"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; AnonArgFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812665"><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680812665"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812664"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812664"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812663"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812663"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812662"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812662"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-1651"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TyCoBinder, Type) -&gt; Maybe (TyCoBinder, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnonArgFlag -&gt; Scaled Type -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680812665"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#mkScaled"><span class="hs-identifier hs-var">mkScaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812664"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812663"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812662"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1652"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TyCoBinder, Type)
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1653"></span><span>
</span><span id="line-1654"></span><span class="hs-comment">-- | Takes a forall type apart, or panics</span><span>
</span><span id="line-1655"></span><span class="annot"><a href="GHC.Core.Type.html#splitPiTy"><span class="hs-identifier hs-type">splitPiTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1656"></span><span id="splitPiTy"><span class="annot"><span class="annottext">splitPiTy :: Type -&gt; (TyCoBinder, Type)
</span><a href="GHC.Core.Type.html#splitPiTy"><span class="hs-identifier hs-var hs-var">splitPiTy</span></a></span></span><span> </span><span id="local-6989586621680812661"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812661"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1657"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812660"><span class="annot"><span class="annottext">(TyCoBinder, Type)
</span><a href="#local-6989586621680812660"><span class="hs-identifier hs-var">answer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TyCoBinder, Type)
</span><a href="GHC.Core.Type.html#splitPiTy_maybe"><span class="hs-identifier hs-var">splitPiTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812661"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCoBinder, Type)
</span><a href="#local-6989586621680812660"><span class="hs-identifier hs-var">answer</span></a></span><span>
</span><span id="line-1658"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (TyCoBinder, Type)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitPiTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812661"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1659"></span><span>
</span><span id="line-1660"></span><span class="hs-comment">-- | Split off all TyCoBinders to a type, splitting both proper foralls</span><span>
</span><span id="line-1661"></span><span class="hs-comment">-- and functions</span><span>
</span><span id="line-1662"></span><span class="annot"><a href="GHC.Core.Type.html#splitPiTys"><span class="hs-identifier hs-type">splitPiTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1663"></span><span id="splitPiTys"><span class="annot"><span class="annottext">splitPiTys :: Type -&gt; ([TyCoBinder], Type)
</span><a href="GHC.Core.Type.html#splitPiTys"><span class="hs-identifier hs-var hs-var">splitPiTys</span></a></span></span><span> </span><span id="local-6989586621680812659"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812659"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812658"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812659"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812659"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1664"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1665"></span><span>    </span><span id="local-6989586621680812658"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812658"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621680812657"><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812657"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680812656"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812656"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812655"><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812655"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812658"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812656"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812656"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812657"><span class="hs-identifier hs-var">b</span></a></span><span>  </span><span class="annot"><span class="annottext">TyCoBinder -&gt; [TyCoBinder] -&gt; [TyCoBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812655"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1666"></span><span>    </span><span class="annot"><a href="#local-6989586621680812658"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; AnonArgFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812654"><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680812654"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812653"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812653"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812652"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812652"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812651"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812651"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812650"><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812650"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-1667"></span><span>                                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812658"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812651"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812651"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnonArgFlag -&gt; Scaled Type -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680812654"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812653"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812652"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyCoBinder -&gt; [TyCoBinder] -&gt; [TyCoBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812650"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1668"></span><span>    </span><span class="annot"><a href="#local-6989586621680812658"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812649"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812649"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621680812648"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812648"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812647"><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812647"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812646"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812646"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812648"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812658"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812649"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812646"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812647"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1669"></span><span>    </span><span class="annot"><a href="#local-6989586621680812658"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812645"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812645"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                </span><span id="local-6989586621680812644"><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812644"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyCoBinder] -&gt; [TyCoBinder]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812644"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812645"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1670"></span><span>
</span><span id="line-1671"></span><span class="hs-comment">-- | Like 'splitPiTys' but split off only /named/ binders</span><span>
</span><span id="line-1672"></span><span class="hs-comment">--   and returns TyCoVarBinders rather than TyCoBinders</span><span>
</span><span id="line-1673"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllVarBndrs"><span class="hs-identifier hs-type">splitForAllVarBndrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVarBinder"><span class="hs-identifier hs-type">TyCoVarBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1674"></span><span id="splitForAllVarBndrs"><span class="annot"><span class="annottext">splitForAllVarBndrs :: Type -&gt; ([VarBndr TyVar ArgFlag], Type)
</span><a href="GHC.Core.Type.html#splitForAllVarBndrs"><span class="hs-identifier hs-var hs-var">splitForAllVarBndrs</span></a></span></span><span> </span><span id="local-6989586621680812643"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812643"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
-&gt; Type
-&gt; [VarBndr TyVar ArgFlag]
-&gt; ([VarBndr TyVar ArgFlag], Type)
</span><a href="#local-6989586621680812642"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812643"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812643"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1675"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1676"></span><span>    </span><span id="local-6989586621680812642"><span class="annot"><span class="annottext">split :: Type
-&gt; Type
-&gt; [VarBndr TyVar ArgFlag]
-&gt; ([VarBndr TyVar ArgFlag], Type)
</span><a href="#local-6989586621680812642"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621680812641"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812641"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621680812640"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812640"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812639"><span class="annot"><span class="annottext">[VarBndr TyVar ArgFlag]
</span><a href="#local-6989586621680812639"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812638"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812638"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812640"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
-&gt; Type
-&gt; [VarBndr TyVar ArgFlag]
-&gt; ([VarBndr TyVar ArgFlag], Type)
</span><a href="#local-6989586621680812642"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812641"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812638"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TyVar ArgFlag]
</span><a href="#local-6989586621680812639"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1677"></span><span>    </span><span class="annot"><a href="#local-6989586621680812642"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621680812637"><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812637"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680812636"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812636"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812635"><span class="annot"><span class="annottext">[VarBndr TyVar ArgFlag]
</span><a href="#local-6989586621680812635"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
-&gt; Type
-&gt; [VarBndr TyVar ArgFlag]
-&gt; ([VarBndr TyVar ArgFlag], Type)
</span><a href="#local-6989586621680812642"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812636"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812636"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812637"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
-&gt; [VarBndr TyVar ArgFlag] -&gt; [VarBndr TyVar ArgFlag]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[VarBndr TyVar ArgFlag]
</span><a href="#local-6989586621680812635"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1678"></span><span>    </span><span class="annot"><a href="#local-6989586621680812642"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812634"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812634"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                </span><span id="local-6989586621680812633"><span class="annot"><span class="annottext">[VarBndr TyVar ArgFlag]
</span><a href="#local-6989586621680812633"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VarBndr TyVar ArgFlag] -&gt; [VarBndr TyVar ArgFlag]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TyVar ArgFlag]
</span><a href="#local-6989586621680812633"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812634"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1679"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllVarBndrs"><span class="hs-pragma hs-type">splitForAllVarBndrs</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1680"></span><span>
</span><span id="line-1681"></span><span class="annot"><a href="GHC.Core.Type.html#invisibleTyBndrCount"><span class="hs-identifier hs-type">invisibleTyBndrCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1682"></span><span class="hs-comment">-- Returns the number of leading invisible forall'd binders in the type</span><span>
</span><span id="line-1683"></span><span class="hs-comment">-- Includes invisible predicate arguments; e.g. for</span><span>
</span><span id="line-1684"></span><span class="hs-comment">--    e.g.  forall {k}. (k ~ *) =&gt; k -&gt; k</span><span>
</span><span id="line-1685"></span><span class="hs-comment">-- returns 2 not 1</span><span>
</span><span id="line-1686"></span><span id="invisibleTyBndrCount"><span class="annot"><span class="annottext">invisibleTyBndrCount :: Type -&gt; Int
</span><a href="GHC.Core.Type.html#invisibleTyBndrCount"><span class="hs-identifier hs-var hs-var">invisibleTyBndrCount</span></a></span></span><span> </span><span id="local-6989586621680812632"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812632"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyCoBinder] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([TyCoBinder], Type) -&gt; [TyCoBinder]
forall a b. (a, b) -&gt; a
</span><a href="../../base/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; ([TyCoBinder], Type)
</span><a href="GHC.Core.Type.html#splitPiTysInvisible"><span class="hs-identifier hs-var">splitPiTysInvisible</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812632"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1687"></span><span>
</span><span id="line-1688"></span><span class="hs-comment">-- Like splitPiTys, but returns only *invisible* binders, including constraints</span><span>
</span><span id="line-1689"></span><span class="hs-comment">-- Stops at the first visible binder</span><span>
</span><span id="line-1690"></span><span class="annot"><a href="GHC.Core.Type.html#splitPiTysInvisible"><span class="hs-identifier hs-type">splitPiTysInvisible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1691"></span><span id="splitPiTysInvisible"><span class="annot"><span class="annottext">splitPiTysInvisible :: Type -&gt; ([TyCoBinder], Type)
</span><a href="GHC.Core.Type.html#splitPiTysInvisible"><span class="hs-identifier hs-var hs-var">splitPiTysInvisible</span></a></span></span><span> </span><span id="local-6989586621680812631"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812631"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812630"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812631"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812631"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1692"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-1693"></span><span>    </span><span id="local-6989586621680812630"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812630"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621680812629"><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812629"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680812628"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812628"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812627"><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812627"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-1694"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812626"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812626"><span class="hs-identifier hs-var">vis</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812629"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1695"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ArgFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleArgFlag"><span class="hs-identifier hs-var">isInvisibleArgFlag</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812626"><span class="hs-identifier hs-var">vis</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812630"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812628"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812628"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812629"><span class="hs-identifier hs-var">b</span></a></span><span>  </span><span class="annot"><span class="annottext">TyCoBinder -&gt; [TyCoBinder] -&gt; [TyCoBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812627"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1696"></span><span>    </span><span class="annot"><a href="#local-6989586621680812630"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; AnonArgFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="GHC.Types.Var.html#InvisArg"><span class="hs-identifier hs-var">InvisArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812625"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812625"><span class="hs-identifier hs-var">mult</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812624"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812624"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812623"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812623"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span id="local-6989586621680812622"><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812622"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-1697"></span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812630"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812623"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812623"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnonArgFlag -&gt; Scaled Type -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="GHC.Types.Var.html#InvisArg"><span class="hs-identifier hs-var">InvisArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#mkScaled"><span class="hs-identifier hs-var">mkScaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812625"><span class="hs-identifier hs-var">mult</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812624"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyCoBinder -&gt; [TyCoBinder] -&gt; [TyCoBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812622"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1698"></span><span>    </span><span class="annot"><a href="#local-6989586621680812630"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812621"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812621"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621680812620"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812620"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812619"><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812619"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-1699"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812618"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812618"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812620"><span class="hs-identifier hs-var">ty</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812630"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812621"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812618"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812619"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1700"></span><span>    </span><span class="annot"><a href="#local-6989586621680812630"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621680812617"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812617"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>          </span><span id="local-6989586621680812616"><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812616"><span class="hs-identifier hs-var">bs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyCoBinder] -&gt; [TyCoBinder]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812616"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812617"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1701"></span><span>
</span><span id="line-1702"></span><span class="annot"><a href="GHC.Core.Type.html#splitPiTysInvisibleN"><span class="hs-identifier hs-type">splitPiTysInvisibleN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1703"></span><span class="hs-comment">-- Same as splitPiTysInvisible, but stop when</span><span>
</span><span id="line-1704"></span><span class="hs-comment">--   - you have found 'n' TyCoBinders,</span><span>
</span><span id="line-1705"></span><span class="hs-comment">--   - or you run out of invisible binders</span><span>
</span><span id="line-1706"></span><span id="splitPiTysInvisibleN"><span class="annot"><span class="annottext">splitPiTysInvisibleN :: Int -&gt; Type -&gt; ([TyCoBinder], Type)
</span><a href="GHC.Core.Type.html#splitPiTysInvisibleN"><span class="hs-identifier hs-var hs-var">splitPiTysInvisibleN</span></a></span></span><span> </span><span id="local-6989586621680812615"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680812615"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680812614"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812614"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
forall {a}.
(Eq a, Num a) =&gt;
a -&gt; Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812613"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680812615"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812614"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812614"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1707"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-1708"></span><span>    </span><span id="local-6989586621680812613"><span class="annot"><span class="annottext">split :: a -&gt; Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812613"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621680812604"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680812604"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680812603"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812603"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621680812602"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812602"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812601"><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812601"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-1709"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680812604"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyCoBinder] -&gt; [TyCoBinder]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812601"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812603"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1710"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812600"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812600"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812602"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812613"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680812604"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812603"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812600"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812601"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1711"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621680812599"><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812599"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680812598"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812598"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812602"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1712"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812597"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812597"><span class="hs-identifier hs-var">vis</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812599"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1713"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ArgFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleArgFlag"><span class="hs-identifier hs-var">isInvisibleArgFlag</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812597"><span class="hs-identifier hs-var">vis</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812613"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680812604"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812598"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812598"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812599"><span class="hs-identifier hs-var">b</span></a></span><span>  </span><span class="annot"><span class="annottext">TyCoBinder -&gt; [TyCoBinder] -&gt; [TyCoBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812601"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1714"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; AnonArgFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="GHC.Types.Var.html#InvisArg"><span class="hs-identifier hs-var">InvisArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812596"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812596"><span class="hs-identifier hs-var">mult</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812595"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812595"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812594"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812594"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812602"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1715"></span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Type -&gt; Type -&gt; [TyCoBinder] -&gt; ([TyCoBinder], Type)
</span><a href="#local-6989586621680812613"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680812604"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812594"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812594"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnonArgFlag -&gt; Scaled Type -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="GHC.Types.Var.html#InvisArg"><span class="hs-identifier hs-var">InvisArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812596"><span class="hs-identifier hs-var">mult</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812595"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyCoBinder -&gt; [TyCoBinder] -&gt; [TyCoBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812601"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1716"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyCoBinder] -&gt; [TyCoBinder]
forall a. [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoBinder]
</span><a href="#local-6989586621680812601"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812603"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1717"></span><span>
</span><span id="line-1718"></span><span class="hs-comment">-- | Given a 'TyCon' and a list of argument types, filter out any invisible</span><span>
</span><span id="line-1719"></span><span class="hs-comment">-- (i.e., 'Inferred' or 'Specified') arguments.</span><span>
</span><span id="line-1720"></span><span class="annot"><a href="GHC.Core.Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-type">filterOutInvisibleTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1721"></span><span id="filterOutInvisibleTypes"><span class="annot"><span class="annottext">filterOutInvisibleTypes :: TyCon -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-var hs-var">filterOutInvisibleTypes</span></a></span></span><span> </span><span id="local-6989586621680812593"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812593"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680812592"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812592"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Type], [Type]) -&gt; [Type]
forall a b. (a, b) -&gt; b
</span><a href="../../base/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(([Type], [Type]) -&gt; [Type]) -&gt; ([Type], [Type]) -&gt; [Type]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; ([Type], [Type])
</span><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier hs-var">partitionInvisibleTypes</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812593"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812592"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1722"></span><span>
</span><span id="line-1723"></span><span class="hs-comment">-- | Given a 'TyCon' and a list of argument types, filter out any 'Inferred'</span><span>
</span><span id="line-1724"></span><span class="hs-comment">-- arguments.</span><span>
</span><span id="line-1725"></span><span class="annot"><a href="GHC.Core.Type.html#filterOutInferredTypes"><span class="hs-identifier hs-type">filterOutInferredTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1726"></span><span id="filterOutInferredTypes"><span class="annot"><span class="annottext">filterOutInferredTypes :: TyCon -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.Type.html#filterOutInferredTypes"><span class="hs-identifier hs-var hs-var">filterOutInferredTypes</span></a></span></span><span> </span><span id="local-6989586621680812591"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812591"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680812590"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812590"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1727"></span><span>  </span><span class="annot"><span class="annottext">[Bool] -&gt; [Type] -&gt; [Type]
forall a. [Bool] -&gt; [a] -&gt; [a]
</span><a href="GHC.Utils.Misc.html#filterByList"><span class="hs-identifier hs-var">filterByList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ArgFlag -&gt; Bool) -&gt; [ArgFlag] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgFlag -&gt; ArgFlag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ArgFlag] -&gt; [Bool]) -&gt; [ArgFlag] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; [ArgFlag]
</span><a href="GHC.Core.Type.html#tyConArgFlags"><span class="hs-identifier hs-var">tyConArgFlags</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812591"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812590"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812590"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1728"></span><span>
</span><span id="line-1729"></span><span class="hs-comment">-- | Given a 'TyCon' and a list of argument types, partition the arguments</span><span>
</span><span id="line-1730"></span><span class="hs-comment">-- into:</span><span>
</span><span id="line-1731"></span><span class="hs-comment">--</span><span>
</span><span id="line-1732"></span><span class="hs-comment">-- 1. 'Inferred' or 'Specified' (i.e., invisible) arguments and</span><span>
</span><span id="line-1733"></span><span class="hs-comment">--</span><span>
</span><span id="line-1734"></span><span class="hs-comment">-- 2. 'Required' (i.e., visible) arguments</span><span>
</span><span id="line-1735"></span><span class="annot"><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier hs-type">partitionInvisibleTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1736"></span><span id="partitionInvisibleTypes"><span class="annot"><span class="annottext">partitionInvisibleTypes :: TyCon -&gt; [Type] -&gt; ([Type], [Type])
</span><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier hs-var hs-var">partitionInvisibleTypes</span></a></span></span><span> </span><span id="local-6989586621680812587"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812587"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680812586"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812586"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1737"></span><span>  </span><span class="annot"><span class="annottext">[Bool] -&gt; [Type] -&gt; ([Type], [Type])
forall a. [Bool] -&gt; [a] -&gt; ([a], [a])
</span><a href="GHC.Utils.Misc.html#partitionByList"><span class="hs-identifier hs-var">partitionByList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ArgFlag -&gt; Bool) -&gt; [ArgFlag] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleArgFlag"><span class="hs-identifier hs-var">isInvisibleArgFlag</span></a></span><span> </span><span class="annot"><span class="annottext">([ArgFlag] -&gt; [Bool]) -&gt; [ArgFlag] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; [ArgFlag]
</span><a href="GHC.Core.Type.html#tyConArgFlags"><span class="hs-identifier hs-var">tyConArgFlags</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812587"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812586"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812586"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1738"></span><span>
</span><span id="line-1739"></span><span class="hs-comment">-- | Given a list of things paired with their visibilities, partition the</span><span>
</span><span id="line-1740"></span><span class="hs-comment">-- things into (invisible things, visible things).</span><span>
</span><span id="line-1741"></span><span id="local-6989586621680814127"><span class="annot"><a href="GHC.Core.Type.html#partitionInvisibles"><span class="hs-identifier hs-type">partitionInvisibles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680814127"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680814127"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680814127"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-1742"></span><span id="partitionInvisibles"><span class="annot"><span class="annottext">partitionInvisibles :: forall a. [(a, ArgFlag)] -&gt; ([a], [a])
</span><a href="GHC.Core.Type.html#partitionInvisibles"><span class="hs-identifier hs-var hs-var">partitionInvisibles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, ArgFlag) -&gt; Either a a) -&gt; [(a, ArgFlag)] -&gt; ([a], [a])
forall a b c. (a -&gt; Either b c) -&gt; [a] -&gt; ([b], [c])
</span><a href="GHC.Utils.Misc.html#partitionWith"><span class="hs-identifier hs-var">partitionWith</span></a></span><span> </span><span class="annot"><span class="annottext">(a, ArgFlag) -&gt; Either a a
forall a. (a, ArgFlag) -&gt; Either a a
</span><a href="#local-6989586621680812583"><span class="hs-identifier hs-var">pick_invis</span></a></span><span>
</span><span id="line-1743"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1744"></span><span>    </span><span id="local-6989586621680814122"><span class="annot"><a href="#local-6989586621680812583"><span class="hs-identifier hs-type">pick_invis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680814122"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680814122"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680814122"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1745"></span><span>    </span><span id="local-6989586621680812583"><span class="annot"><span class="annottext">pick_invis :: forall a. (a, ArgFlag) -&gt; Either a a
</span><a href="#local-6989586621680812583"><span class="hs-identifier hs-var hs-var">pick_invis</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812582"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680812582"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812581"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812581"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ArgFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleArgFlag"><span class="hs-identifier hs-var">isInvisibleArgFlag</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812581"><span class="hs-identifier hs-var">vis</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a a
forall a b. a -&gt; Either a b
</span><a href="../../base/src/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680812582"><span class="hs-identifier hs-var">thing</span></a></span><span>
</span><span id="line-1746"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a a
forall a b. b -&gt; Either a b
</span><a href="../../base/src/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680812582"><span class="hs-identifier hs-var">thing</span></a></span><span>
</span><span id="line-1747"></span><span>
</span><span id="line-1748"></span><span class="hs-comment">-- | Given a 'TyCon' and a list of argument types to which the 'TyCon' is</span><span>
</span><span id="line-1749"></span><span class="hs-comment">-- applied, determine each argument's visibility</span><span>
</span><span id="line-1750"></span><span class="hs-comment">-- ('Inferred', 'Specified', or 'Required').</span><span>
</span><span id="line-1751"></span><span class="hs-comment">--</span><span>
</span><span id="line-1752"></span><span class="hs-comment">-- Wrinkle: consider the following scenario:</span><span>
</span><span id="line-1753"></span><span class="hs-comment">--</span><span>
</span><span id="line-1754"></span><span class="hs-comment">-- &gt; T :: forall k. k -&gt; k</span><span>
</span><span id="line-1755"></span><span class="hs-comment">-- &gt; tyConArgFlags T [forall m. m -&gt; m -&gt; m, S, R, Q]</span><span>
</span><span id="line-1756"></span><span class="hs-comment">--</span><span>
</span><span id="line-1757"></span><span class="hs-comment">-- After substituting, we get</span><span>
</span><span id="line-1758"></span><span class="hs-comment">--</span><span>
</span><span id="line-1759"></span><span class="hs-comment">-- &gt; T (forall m. m -&gt; m -&gt; m) :: (forall m. m -&gt; m -&gt; m) -&gt; forall n. n -&gt; n -&gt; n</span><span>
</span><span id="line-1760"></span><span class="hs-comment">--</span><span>
</span><span id="line-1761"></span><span class="hs-comment">-- Thus, the first argument is invisible, @S@ is visible, @R@ is invisible again,</span><span>
</span><span id="line-1762"></span><span class="hs-comment">-- and @Q@ is visible.</span><span>
</span><span id="line-1763"></span><span class="annot"><a href="GHC.Core.Type.html#tyConArgFlags"><span class="hs-identifier hs-type">tyConArgFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1764"></span><span id="tyConArgFlags"><span class="annot"><span class="annottext">tyConArgFlags :: TyCon -&gt; [Type] -&gt; [ArgFlag]
</span><a href="GHC.Core.Type.html#tyConArgFlags"><span class="hs-identifier hs-var hs-var">tyConArgFlags</span></a></span></span><span> </span><span id="local-6989586621680812580"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812580"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [ArgFlag]
</span><a href="GHC.Core.Type.html#fun_kind_arg_flags"><span class="hs-identifier hs-var">fun_kind_arg_flags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier hs-var hs-var">tyConKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812580"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1765"></span><span>
</span><span id="line-1766"></span><span class="hs-comment">-- | Given a 'Type' and a list of argument types to which the 'Type' is</span><span>
</span><span id="line-1767"></span><span class="hs-comment">-- applied, determine each argument's visibility</span><span>
</span><span id="line-1768"></span><span class="hs-comment">-- ('Inferred', 'Specified', or 'Required').</span><span>
</span><span id="line-1769"></span><span class="hs-comment">--</span><span>
</span><span id="line-1770"></span><span class="hs-comment">-- Most of the time, the arguments will be 'Required', but not always. Consider</span><span>
</span><span id="line-1771"></span><span class="hs-comment">-- @f :: forall a. a -&gt; Type@. In @f Type Bool@, the first argument (@Type@) is</span><span>
</span><span id="line-1772"></span><span class="hs-comment">-- 'Specified' and the second argument (@Bool@) is 'Required'. It is precisely</span><span>
</span><span id="line-1773"></span><span class="hs-comment">-- this sort of higher-rank situation in which 'appTyArgFlags' comes in handy,</span><span>
</span><span id="line-1774"></span><span class="hs-comment">-- since @f Type Bool@ would be represented in Core using 'AppTy's.</span><span>
</span><span id="line-1775"></span><span class="hs-comment">-- (See also #15792).</span><span>
</span><span id="line-1776"></span><span class="annot"><a href="GHC.Core.Type.html#appTyArgFlags"><span class="hs-identifier hs-type">appTyArgFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1777"></span><span id="appTyArgFlags"><span class="annot"><span class="annottext">appTyArgFlags :: Type -&gt; [Type] -&gt; [ArgFlag]
</span><a href="GHC.Core.Type.html#appTyArgFlags"><span class="hs-identifier hs-var hs-var">appTyArgFlags</span></a></span></span><span> </span><span id="local-6989586621680812577"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812577"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [ArgFlag]
</span><a href="GHC.Core.Type.html#fun_kind_arg_flags"><span class="hs-identifier hs-var">fun_kind_arg_flags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812577"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1778"></span><span>
</span><span id="line-1779"></span><span class="hs-comment">-- | Given a function kind and a list of argument types (where each argument's</span><span>
</span><span id="line-1780"></span><span class="hs-comment">-- kind aligns with the corresponding position in the argument kind), determine</span><span>
</span><span id="line-1781"></span><span class="hs-comment">-- each argument's visibility ('Inferred', 'Specified', or 'Required').</span><span>
</span><span id="line-1782"></span><span class="annot"><a href="GHC.Core.Type.html#fun_kind_arg_flags"><span class="hs-identifier hs-type">fun_kind_arg_flags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1783"></span><span id="fun_kind_arg_flags"><span class="annot"><span class="annottext">fun_kind_arg_flags :: Type -&gt; [Type] -&gt; [ArgFlag]
</span><a href="GHC.Core.Type.html#fun_kind_arg_flags"><span class="hs-identifier hs-var hs-var">fun_kind_arg_flags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; [Type] -&gt; [ArgFlag]
</span><a href="#local-6989586621680812576"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#emptyTCvSubst"><span class="hs-identifier hs-var">emptyTCvSubst</span></a></span><span>
</span><span id="line-1784"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1785"></span><span>    </span><span id="local-6989586621680812576"><span class="annot"><span class="annottext">go :: TCvSubst -&gt; Type -&gt; [Type] -&gt; [ArgFlag]
</span><a href="#local-6989586621680812576"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680812575"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812575"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621680812574"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812574"><span class="hs-identifier hs-var">ki</span></a></span></span><span> </span><span id="local-6989586621680812573"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812573"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span>
</span><span id="line-1786"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812572"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812572"><span class="hs-identifier hs-var">ki'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812574"><span class="hs-identifier hs-var">ki</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; [Type] -&gt; [ArgFlag]
</span><a href="#local-6989586621680812576"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812575"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812572"><span class="hs-identifier hs-var">ki'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812573"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-1787"></span><span>    </span><span class="annot"><a href="#local-6989586621680812576"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1788"></span><span>    </span><span class="annot"><a href="#local-6989586621680812576"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812571"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812571"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812570"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812570"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680812569"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812569"><span class="hs-identifier hs-var">argf</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812568"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812568"><span class="hs-identifier hs-var">res_ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812567"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812567"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680812566"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812566"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1789"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812569"><span class="hs-identifier hs-var">argf</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag -&gt; [ArgFlag] -&gt; [ArgFlag]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; [Type] -&gt; [ArgFlag]
</span><a href="#local-6989586621680812576"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812565"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812568"><span class="hs-identifier hs-var">res_ki</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812566"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-1790"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1791"></span><span>        </span><span id="local-6989586621680812565"><span class="annot"><span class="annottext">subst' :: TCvSubst
</span><a href="#local-6989586621680812565"><span class="hs-identifier hs-var hs-var">subst'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; TyVar -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubst"><span class="hs-identifier hs-var">extendTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812571"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812570"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812567"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-1792"></span><span>    </span><span class="annot"><a href="#local-6989586621680812576"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812564"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812564"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680812563"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812563"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812562"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812562"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span>
</span><span id="line-1793"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812561"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812561"><span class="hs-identifier hs-var">ki</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; TyVar -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.Subst.html#lookupTyVar"><span class="hs-identifier hs-var">lookupTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812564"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812563"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; [Type] -&gt; [ArgFlag]
</span><a href="#local-6989586621680812576"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812564"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812561"><span class="hs-identifier hs-var">ki</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812562"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-1794"></span><span>    </span><span class="hs-comment">-- This FunTy case is important to handle kinds with nested foralls, such</span><span>
</span><span id="line-1795"></span><span>    </span><span class="hs-comment">-- as this kind (inspired by #16518):</span><span>
</span><span id="line-1796"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1797"></span><span>    </span><span class="hs-comment">--   forall {k1} k2. k1 -&gt; k2 -&gt; forall k3. k3 -&gt; Type</span><span>
</span><span id="line-1798"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1799"></span><span>    </span><span class="hs-comment">-- Here, we want to get the following ArgFlags:</span><span>
</span><span id="line-1800"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1801"></span><span>    </span><span class="hs-comment">-- [Inferred,   Specified, Required, Required, Specified, Required]</span><span>
</span><span id="line-1802"></span><span>    </span><span class="hs-comment">-- forall {k1}. forall k2. k1 -&gt;     k2 -&gt;     forall k3. k3 -&gt;     Type</span><span>
</span><span id="line-1803"></span><span>    </span><span class="annot"><a href="#local-6989586621680812576"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812560"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812560"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ft_af :: Type -&gt; AnonArgFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812559"><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680812559"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812558"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812558"><span class="hs-identifier hs-var">res_ki</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680812557"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812557"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1804"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812556"><span class="hs-identifier hs-var">argf</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag -&gt; [ArgFlag] -&gt; [ArgFlag]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; [Type] -&gt; [ArgFlag]
</span><a href="#local-6989586621680812576"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812560"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812558"><span class="hs-identifier hs-var">res_ki</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812557"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-1805"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1806"></span><span>        </span><span id="local-6989586621680812556"><span class="annot"><span class="annottext">argf :: ArgFlag
</span><a href="#local-6989586621680812556"><span class="hs-identifier hs-var hs-var">argf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680812559"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1807"></span><span>                 </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="GHC.Types.Var.html#VisArg"><span class="hs-identifier hs-var">VisArg</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span>
</span><span id="line-1808"></span><span>                 </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="GHC.Types.Var.html#InvisArg"><span class="hs-identifier hs-var">InvisArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span>
</span><span id="line-1809"></span><span>    </span><span class="annot"><a href="#local-6989586621680812576"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812555"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812555"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; ArgFlag) -&gt; [Type] -&gt; [ArgFlag]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgFlag -&gt; Type -&gt; ArgFlag
forall a b. a -&gt; b -&gt; a
</span><a href="../../base/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812555"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-1810"></span><span>                        </span><span class="hs-comment">-- something is ill-kinded. But this can happen</span><span>
</span><span id="line-1811"></span><span>                        </span><span class="hs-comment">-- when printing errors. Assume everything is Required.</span><span>
</span><span id="line-1812"></span><span>
</span><span id="line-1813"></span><span class="hs-comment">-- @isTauTy@ tests if a type has no foralls or (=&gt;)</span><span>
</span><span id="line-1814"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-type">isTauTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1815"></span><span id="isTauTy"><span class="annot"><span class="annottext">isTauTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var hs-var">isTauTy</span></a></span></span><span> </span><span id="local-6989586621680812553"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812553"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812552"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812552"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812553"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812552"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1816"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1817"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1818"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812551"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812551"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680812550"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812550"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812550"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTauTyCon"><span class="hs-identifier hs-var">isTauTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812551"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1819"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680812548"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812548"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680812547"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812547"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812548"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812547"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1820"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span id="local-6989586621680812546"><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680812546"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621680812545"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812545"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680812544"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812544"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680812543"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812543"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680812546"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1821"></span><span>                                </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="GHC.Types.Var.html#InvisArg"><span class="hs-identifier hs-var">InvisArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>                               </span><span class="hs-comment">-- e.g., Eq a =&gt; b</span><span>
</span><span id="line-1822"></span><span>                                </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="GHC.Types.Var.html#VisArg"><span class="hs-identifier hs-var">VisArg</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812545"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812544"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812543"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-comment">-- e.g., a -&gt; b</span><span>
</span><span id="line-1823"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1824"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680812542"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812542"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812542"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1825"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>  </span><span class="hs-comment">-- Not sure about this</span><span>
</span><span id="line-1826"></span><span>
</span><span id="line-1827"></span><span class="annot"><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier hs-type">isAtomicTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1828"></span><span class="hs-comment">-- True if the type is just a single token, and can be printed compactly</span><span>
</span><span id="line-1829"></span><span class="hs-comment">-- Used when deciding how to lay out type error messages; see the</span><span>
</span><span id="line-1830"></span><span class="hs-comment">-- call in GHC.Tc.Errors</span><span>
</span><span id="line-1831"></span><span id="isAtomicTy"><span class="annot"><span class="annottext">isAtomicTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier hs-var hs-var">isAtomicTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1832"></span><span class="annot"><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier hs-var">isAtomicTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1833"></span><span class="annot"><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier hs-var">isAtomicTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1834"></span><span>
</span><span id="line-1835"></span><span class="annot"><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier hs-var">isAtomicTy</span></a></span><span> </span><span id="local-6989586621680812541"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812541"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedTypeKind"><span class="hs-identifier hs-var">isLiftedTypeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812541"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1836"></span><span>   </span><span class="hs-comment">-- 'Type' prints compactly as *</span><span>
</span><span id="line-1837"></span><span>   </span><span class="hs-comment">-- See GHC.Iface.Type.ppr_kind_type</span><span>
</span><span id="line-1838"></span><span>
</span><span id="line-1839"></span><span class="annot"><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier hs-var">isAtomicTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1840"></span><span>
</span><span id="line-1841"></span><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
   TyCoBinders
%*                                                                      *
%************************************************************************
-}</span><span>
</span><span id="line-1848"></span><span>
</span><span id="line-1849"></span><span class="hs-comment">-- | Make an anonymous binder</span><span>
</span><span id="line-1850"></span><span class="annot"><a href="GHC.Core.Type.html#mkAnonBinder"><span class="hs-identifier hs-type">mkAnonBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#AnonArgFlag"><span class="hs-identifier hs-type">AnonArgFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span>
</span><span id="line-1851"></span><span id="mkAnonBinder"><span class="annot"><span class="annottext">mkAnonBinder :: AnonArgFlag -&gt; Scaled Type -&gt; TyCoBinder
</span><a href="GHC.Core.Type.html#mkAnonBinder"><span class="hs-identifier hs-var hs-var">mkAnonBinder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnonArgFlag -&gt; Scaled Type -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a></span><span>
</span><span id="line-1852"></span><span>
</span><span id="line-1853"></span><span class="hs-comment">-- | Does this binder bind a variable that is /not/ erased? Returns</span><span>
</span><span id="line-1854"></span><span class="hs-comment">-- 'True' for anonymous binders.</span><span>
</span><span id="line-1855"></span><span class="annot"><a href="GHC.Core.Type.html#isAnonTyCoBinder"><span class="hs-identifier hs-type">isAnonTyCoBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1856"></span><span id="isAnonTyCoBinder"><span class="annot"><span class="annottext">isAnonTyCoBinder :: TyCoBinder -&gt; Bool
</span><a href="GHC.Core.Type.html#isAnonTyCoBinder"><span class="hs-identifier hs-var hs-var">isAnonTyCoBinder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1857"></span><span class="annot"><a href="GHC.Core.Type.html#isAnonTyCoBinder"><span class="hs-identifier hs-var">isAnonTyCoBinder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-type">Anon</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1858"></span><span>
</span><span id="line-1859"></span><span class="annot"><a href="GHC.Core.Type.html#tyCoBinderVar_maybe"><span class="hs-identifier hs-type">tyCoBinderVar_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span>
</span><span id="line-1860"></span><span id="tyCoBinderVar_maybe"><span class="annot"><span class="annottext">tyCoBinderVar_maybe :: TyCoBinder -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#tyCoBinderVar_maybe"><span class="hs-identifier hs-var hs-var">tyCoBinderVar_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span id="local-6989586621680812540"><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812540"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Maybe TyVar
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; Maybe TyVar) -&gt; TyVar -&gt; Maybe TyVar
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; TyVar
forall tv argf. VarBndr tv argf -&gt; tv
</span><a href="GHC.Types.Var.html#binderVar"><span class="hs-identifier hs-var">binderVar</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812540"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1861"></span><span class="annot"><a href="GHC.Core.Type.html#tyCoBinderVar_maybe"><span class="hs-identifier hs-var">tyCoBinderVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoBinder
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyVar
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1862"></span><span>
</span><span id="line-1863"></span><span class="annot"><a href="GHC.Core.Type.html#tyCoBinderType"><span class="hs-identifier hs-type">tyCoBinderType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1864"></span><span id="tyCoBinderType"><span class="annot"><span class="annottext">tyCoBinderType :: TyCoBinder -&gt; Type
</span><a href="GHC.Core.Type.html#tyCoBinderType"><span class="hs-identifier hs-var hs-var">tyCoBinderType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span id="local-6989586621680812539"><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812539"><span class="hs-identifier hs-var">tvb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; Type
forall argf. VarBndr TyVar argf -&gt; Type
</span><a href="GHC.Types.Var.html#binderType"><span class="hs-identifier hs-var">binderType</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><a href="#local-6989586621680812539"><span class="hs-identifier hs-var">tvb</span></a></span><span>
</span><span id="line-1865"></span><span class="annot"><a href="GHC.Core.Type.html#tyCoBinderType"><span class="hs-identifier hs-var">tyCoBinderType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-type">Anon</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812538"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621680812538"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; Type
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621680812538"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1866"></span><span>
</span><span id="line-1867"></span><span class="annot"><a href="GHC.Core.Type.html#tyBinderType"><span class="hs-identifier hs-type">tyBinderType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1868"></span><span id="tyBinderType"><span class="annot"><span class="annottext">tyBinderType :: TyCoBinder -&gt; Type
</span><a href="GHC.Core.Type.html#tyBinderType"><span class="hs-identifier hs-var hs-var">tyBinderType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812535"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812535"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1869"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tv</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1870"></span><span>    </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812535"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1871"></span><span class="annot"><a href="GHC.Core.Type.html#tyBinderType"><span class="hs-identifier hs-var">tyBinderType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-type">Anon</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812534"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621680812534"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; Type
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621680812534"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1872"></span><span>
</span><span id="line-1873"></span><span class="hs-comment">-- | Extract a relevant type, if there is one.</span><span>
</span><span id="line-1874"></span><span class="annot"><a href="GHC.Core.Type.html#binderRelevantType_maybe"><span class="hs-identifier hs-type">binderRelevantType_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1875"></span><span id="binderRelevantType_maybe"><span class="annot"><span class="annottext">binderRelevantType_maybe :: TyCoBinder -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#binderRelevantType_maybe"><span class="hs-identifier hs-var hs-var">binderRelevantType_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1876"></span><span class="annot"><a href="GHC.Core.Type.html#binderRelevantType_maybe"><span class="hs-identifier hs-var">binderRelevantType_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-type">Anon</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812533"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621680812533"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type -&gt; Type
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621680812533"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1877"></span><span>
</span><span id="line-1878"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Type families}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1885"></span><span>
</span><span id="line-1886"></span><span class="annot"><a href="GHC.Core.Type.html#mkFamilyTyConApp"><span class="hs-identifier hs-type">mkFamilyTyConApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1887"></span><span class="hs-comment">-- ^ Given a family instance TyCon and its arg types, return the</span><span>
</span><span id="line-1888"></span><span class="hs-comment">-- corresponding family type.  E.g:</span><span>
</span><span id="line-1889"></span><span class="hs-comment">--</span><span>
</span><span id="line-1890"></span><span class="hs-comment">-- &gt; data family T a</span><span>
</span><span id="line-1891"></span><span class="hs-comment">-- &gt; data instance T (Maybe b) = MkT b</span><span>
</span><span id="line-1892"></span><span class="hs-comment">--</span><span>
</span><span id="line-1893"></span><span class="hs-comment">-- Where the instance tycon is :RTL, so:</span><span>
</span><span id="line-1894"></span><span class="hs-comment">--</span><span>
</span><span id="line-1895"></span><span class="hs-comment">-- &gt; mkFamilyTyConApp :RTL Int  =  T (Maybe Int)</span><span>
</span><span id="line-1896"></span><span id="mkFamilyTyConApp"><span class="annot"><span class="annottext">mkFamilyTyConApp :: TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkFamilyTyConApp"><span class="hs-identifier hs-var hs-var">mkFamilyTyConApp</span></a></span></span><span> </span><span id="local-6989586621680812532"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812532"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680812531"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812531"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-1897"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812530"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812530"><span class="hs-identifier hs-var">fam_tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812529"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812529"><span class="hs-identifier hs-var">fam_tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.TyCon.html#tyConFamInst_maybe"><span class="hs-identifier hs-var">tyConFamInst_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812532"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1898"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680812527"><span class="annot"><span class="annottext">tvs :: [TyVar]
</span><a href="#local-6989586621680812527"><span class="hs-identifier hs-var hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [TyVar]
</span><a href="GHC.Core.TyCon.html#tyConTyVars"><span class="hs-identifier hs-var hs-var">tyConTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812532"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1899"></span><span>        </span><span id="local-6989586621680812519"><span class="annot"><span class="annottext">fam_subst :: TCvSubst
</span><a href="#local-6989586621680812519"><span class="hs-identifier hs-var hs-var">fam_subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">equalLength</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tc</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1900"></span><span>                    </span><span class="annot"><span class="annottext">[TyVar] -&gt; [Type] -&gt; TCvSubst
HasDebugCallStack =&gt; [TyVar] -&gt; [Type] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812527"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812531"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1901"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812530"><span class="hs-identifier hs-var">fam_tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; [Type] -&gt; [Type]
TCvSubst -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier hs-var">substTys</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621680812519"><span class="hs-identifier hs-var">fam_subst</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812529"><span class="hs-identifier hs-var">fam_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1902"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1903"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812532"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812531"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1904"></span><span>
</span><span id="line-1905"></span><span class="hs-comment">-- | Get the type on the LHS of a coercion induced by a type/data</span><span>
</span><span id="line-1906"></span><span class="hs-comment">-- family instance.</span><span>
</span><span id="line-1907"></span><span id="local-6989586621680814111"><span class="annot"><a href="GHC.Core.Type.html#coAxNthLHS"><span class="hs-identifier hs-type">coAxNthLHS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680814111"><span class="hs-identifier hs-type">br</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span><span>
</span><span id="line-1908"></span><span id="coAxNthLHS"><span class="annot"><span class="annottext">coAxNthLHS :: forall (br :: BranchFlag). CoAxiom br -&gt; Int -&gt; Type
</span><a href="GHC.Core.Type.html#coAxNthLHS"><span class="hs-identifier hs-var hs-var">coAxNthLHS</span></a></span></span><span> </span><span id="local-6989586621680812517"><span class="annot"><span class="annottext">CoAxiom br
</span><a href="#local-6989586621680812517"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621680812516"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680812516"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1909"></span><span>  </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom br -&gt; TyCon
forall (br :: BranchFlag). CoAxiom br -&gt; TyCon
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom br
</span><a href="#local-6989586621680812517"><span class="hs-identifier hs-var">ax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxBranch -&gt; [Type]
</span><a href="GHC.Core.Coercion.Axiom.html#coAxBranchLHS"><span class="hs-identifier hs-var">coAxBranchLHS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom br -&gt; Int -&gt; CoAxBranch
forall (br :: BranchFlag). CoAxiom br -&gt; Int -&gt; CoAxBranch
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomNthBranch"><span class="hs-identifier hs-var">coAxiomNthBranch</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom br
</span><a href="#local-6989586621680812517"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680812516"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1910"></span><span>
</span><span id="line-1911"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-type">isFamFreeTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1912"></span><span id="isFamFreeTy"><span class="annot"><span class="annottext">isFamFreeTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var hs-var">isFamFreeTy</span></a></span></span><span> </span><span id="local-6989586621680812512"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812512"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812511"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812511"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812512"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812511"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1913"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1914"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1915"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812510"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812510"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680812509"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812509"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812509"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isFamFreeTyCon"><span class="hs-identifier hs-var">isFamFreeTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812510"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1916"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680812507"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812507"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680812506"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812506"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812507"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812506"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1917"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812505"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812505"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680812504"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812504"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680812503"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812503"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812505"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812504"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812503"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1918"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812502"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812502"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812502"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1919"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680812501"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812501"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812501"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1920"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>  </span><span class="hs-comment">-- Not sure about this</span><span>
</span><span id="line-1921"></span><span>
</span><span id="line-1922"></span><span class="hs-comment">-- | Does this type classify a core (unlifted) Coercion?</span><span>
</span><span id="line-1923"></span><span class="hs-comment">-- At either role nominal or representational</span><span>
</span><span id="line-1924"></span><span class="hs-comment">--    (t1 ~# t2) or (t1 ~R# t2)</span><span>
</span><span id="line-1925"></span><span class="hs-comment">-- See Note [Types for coercions, predicates, and evidence] in &quot;GHC.Core.TyCo.Rep&quot;</span><span>
</span><span id="line-1926"></span><span class="annot"><a href="GHC.Core.Type.html#isCoVarType"><span class="hs-identifier hs-type">isCoVarType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1927"></span><span>  </span><span class="hs-comment">-- ToDo: should we check saturation?</span><span>
</span><span id="line-1928"></span><span id="isCoVarType"><span class="annot"><span class="annottext">isCoVarType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isCoVarType"><span class="hs-identifier hs-var hs-var">isCoVarType</span></a></span></span><span> </span><span id="local-6989586621680812500"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812500"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1929"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812499"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812499"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812500"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1930"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812499"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812499"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a></span><span>
</span><span id="line-1931"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1932"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1933"></span><span>
</span><span id="line-1934"></span><span class="annot"><a href="GHC.Core.Type.html#buildSynTyCon"><span class="hs-identifier hs-type">buildSynTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KnotTied"><span class="hs-identifier hs-type">KnotTied</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>   </span><span class="hs-comment">-- ^ /result/ kind</span><span>
</span><span id="line-1935"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KnotTied"><span class="hs-identifier hs-type">KnotTied</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-1936"></span><span class="hs-comment">-- This function is here beucase here is where we have</span><span>
</span><span id="line-1937"></span><span class="hs-comment">--   isFamFree and isTauTy</span><span>
</span><span id="line-1938"></span><span id="buildSynTyCon"><span class="annot"><span class="annottext">buildSynTyCon :: Name -&gt; [TyConBinder] -&gt; Type -&gt; [Role] -&gt; Type -&gt; TyCon
</span><a href="GHC.Core.Type.html#buildSynTyCon"><span class="hs-identifier hs-var hs-var">buildSynTyCon</span></a></span></span><span> </span><span id="local-6989586621680812496"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680812496"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621680812495"><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621680812495"><span class="hs-identifier hs-var">binders</span></a></span></span><span> </span><span id="local-6989586621680812494"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812494"><span class="hs-identifier hs-var">res_kind</span></a></span></span><span> </span><span id="local-6989586621680812493"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621680812493"><span class="hs-identifier hs-var">roles</span></a></span></span><span> </span><span id="local-6989586621680812492"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812492"><span class="hs-identifier hs-var">rhs</span></a></span></span><span>
</span><span id="line-1939"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; [TyConBinder] -&gt; Type -&gt; [Role] -&gt; Type -&gt; Bool -&gt; Bool -&gt; TyCon
</span><a href="GHC.Core.TyCon.html#mkSynonymTyCon"><span class="hs-identifier hs-var">mkSynonymTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680812496"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621680812495"><span class="hs-identifier hs-var">binders</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812494"><span class="hs-identifier hs-var">res_kind</span></a></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621680812493"><span class="hs-identifier hs-var">roles</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812492"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680812490"><span class="hs-identifier hs-var">is_tau</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680812489"><span class="hs-identifier hs-var">is_fam_free</span></a></span><span>
</span><span id="line-1940"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1941"></span><span>    </span><span id="local-6989586621680812490"><span class="annot"><span class="annottext">is_tau :: Bool
</span><a href="#local-6989586621680812490"><span class="hs-identifier hs-var hs-var">is_tau</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812492"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1942"></span><span>    </span><span id="local-6989586621680812489"><span class="annot"><span class="annottext">is_fam_free :: Bool
</span><a href="#local-6989586621680812489"><span class="hs-identifier hs-var hs-var">is_fam_free</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812492"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1943"></span><span>
</span><span id="line-1944"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Liftedness}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1951"></span><span>
</span><span id="line-1952"></span><span class="hs-comment">-- | Returns Just True if this type is surely lifted, Just False</span><span>
</span><span id="line-1953"></span><span class="hs-comment">-- if it is surely unlifted, Nothing if we can't be sure (i.e., it is</span><span>
</span><span id="line-1954"></span><span class="hs-comment">-- levity polymorphic), and panics if the kind does not have the shape</span><span>
</span><span id="line-1955"></span><span class="hs-comment">-- TYPE r.</span><span>
</span><span id="line-1956"></span><span class="annot"><a href="GHC.Core.Type.html#isLiftedType_maybe"><span class="hs-identifier hs-type">isLiftedType_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1957"></span><span id="isLiftedType_maybe"><span class="annot"><span class="annottext">isLiftedType_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe Bool
</span><a href="GHC.Core.Type.html#isLiftedType_maybe"><span class="hs-identifier hs-var hs-var">isLiftedType_maybe</span></a></span></span><span> </span><span id="local-6989586621680812486"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812486"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812486"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1958"></span><span>  </span><span id="local-6989586621680812485"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812485"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedRuntimeRep"><span class="hs-identifier hs-var">isLiftedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812485"><span class="hs-identifier hs-var">ty'</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1959"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>  </span><span class="hs-comment">-- Everything else is unlifted</span><span>
</span><span id="line-1960"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-comment">-- levity polymorphic</span><span>
</span><span id="line-1961"></span><span>
</span><span id="line-1962"></span><span class="hs-comment">-- | See &quot;Type#type_classification&quot; for what an unlifted type is.</span><span>
</span><span id="line-1963"></span><span class="hs-comment">-- Panics on levity polymorphic types; See 'mightBeUnliftedType' for</span><span>
</span><span id="line-1964"></span><span class="hs-comment">-- a more approximate predicate that behaves better in the presence of</span><span>
</span><span id="line-1965"></span><span class="hs-comment">-- levity polymorphism.</span><span>
</span><span id="line-1966"></span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedType"><span class="hs-identifier hs-type">isUnliftedType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1967"></span><span>        </span><span class="hs-comment">-- isUnliftedType returns True for forall'd unlifted types:</span><span>
</span><span id="line-1968"></span><span>        </span><span class="hs-comment">--      x :: forall a. Int#</span><span>
</span><span id="line-1969"></span><span>        </span><span class="hs-comment">-- I found bindings like these were getting floated to the top level.</span><span>
</span><span id="line-1970"></span><span>        </span><span class="hs-comment">-- They are pretty bogus types, mind you.  It would be better never to</span><span>
</span><span id="line-1971"></span><span>        </span><span class="hs-comment">-- construct them</span><span>
</span><span id="line-1972"></span><span id="isUnliftedType"><span class="annot"><span class="annottext">isUnliftedType :: HasDebugCallStack =&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnliftedType"><span class="hs-identifier hs-var hs-var">isUnliftedType</span></a></span></span><span> </span><span id="local-6989586621680812477"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812477"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1973"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Bool
Type -&gt; Maybe Bool
</span><a href="GHC.Core.Type.html#isLiftedType_maybe"><span class="hs-identifier hs-var">isLiftedType_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812477"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Bool -&gt; Bool
forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span>
</span><span id="line-1974"></span><span>         </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Bool
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;isUnliftedType&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812477"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812477"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1975"></span><span>
</span><span id="line-1976"></span><span class="hs-comment">-- | Returns:</span><span>
</span><span id="line-1977"></span><span class="hs-comment">--</span><span>
</span><span id="line-1978"></span><span class="hs-comment">-- * 'False' if the type is /guaranteed/ lifted or</span><span>
</span><span id="line-1979"></span><span class="hs-comment">-- * 'True' if it is unlifted, OR we aren't sure (e.g. in a levity-polymorphic case)</span><span>
</span><span id="line-1980"></span><span class="annot"><a href="GHC.Core.Type.html#mightBeUnliftedType"><span class="hs-identifier hs-type">mightBeUnliftedType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1981"></span><span id="mightBeUnliftedType"><span class="annot"><span class="annottext">mightBeUnliftedType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#mightBeUnliftedType"><span class="hs-identifier hs-var hs-var">mightBeUnliftedType</span></a></span></span><span> </span><span id="local-6989586621680812475"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812475"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1982"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Bool
Type -&gt; Maybe Bool
</span><a href="GHC.Core.Type.html#isLiftedType_maybe"><span class="hs-identifier hs-var">isLiftedType_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812475"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1983"></span><span>      </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812474"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680812474"><span class="hs-identifier hs-var">is_lifted</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680812474"><span class="hs-identifier hs-var">is_lifted</span></a></span><span>
</span><span id="line-1984"></span><span>      </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1985"></span><span>
</span><span id="line-1986"></span><span class="hs-comment">-- | Is this a type of kind RuntimeRep? (e.g. LiftedRep)</span><span>
</span><span id="line-1987"></span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepKindedTy"><span class="hs-identifier hs-type">isRuntimeRepKindedTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1988"></span><span id="isRuntimeRepKindedTy"><span class="annot"><span class="annottext">isRuntimeRepKindedTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isRuntimeRepKindedTy"><span class="hs-identifier hs-var hs-var">isRuntimeRepKindedTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isRuntimeRepTy"><span class="hs-identifier hs-var">isRuntimeRepTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (Type -&gt; Type) -&gt; Type -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span>
</span><span id="line-1989"></span><span>
</span><span id="line-1990"></span><span class="hs-comment">-- | Drops prefix of RuntimeRep constructors in 'TyConApp's. Useful for e.g.</span><span>
</span><span id="line-1991"></span><span class="hs-comment">-- dropping 'LiftedRep arguments of unboxed tuple TyCon applications:</span><span>
</span><span id="line-1992"></span><span class="hs-comment">--</span><span>
</span><span id="line-1993"></span><span class="hs-comment">--   dropRuntimeRepArgs [ 'LiftedRep, 'IntRep</span><span>
</span><span id="line-1994"></span><span class="hs-comment">--                      , String, Int# ] == [String, Int#]</span><span>
</span><span id="line-1995"></span><span class="hs-comment">--</span><span>
</span><span id="line-1996"></span><span class="annot"><a href="GHC.Core.Type.html#dropRuntimeRepArgs"><span class="hs-identifier hs-type">dropRuntimeRepArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1997"></span><span id="dropRuntimeRepArgs"><span class="annot"><span class="annottext">dropRuntimeRepArgs :: [Type] -&gt; [Type]
</span><a href="GHC.Core.Type.html#dropRuntimeRepArgs"><span class="hs-identifier hs-var hs-var">dropRuntimeRepArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; [Type]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.List.html#dropWhile"><span class="hs-identifier hs-var">dropWhile</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isRuntimeRepKindedTy"><span class="hs-identifier hs-var">isRuntimeRepKindedTy</span></a></span><span>
</span><span id="line-1998"></span><span>
</span><span id="line-1999"></span><span class="hs-comment">-- | Extract the RuntimeRep classifier of a type. For instance,</span><span>
</span><span id="line-2000"></span><span class="hs-comment">-- @getRuntimeRep_maybe Int = LiftedRep@. Returns 'Nothing' if this is not</span><span>
</span><span id="line-2001"></span><span class="hs-comment">-- possible.</span><span>
</span><span id="line-2002"></span><span class="annot"><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-type">getRuntimeRep_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span>
</span><span id="line-2003"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-2004"></span><span id="getRuntimeRep_maybe"><span class="annot"><span class="annottext">getRuntimeRep_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var hs-var">getRuntimeRep_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-var">kindRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe Type) -&gt; (Type -&gt; Type) -&gt; Type -&gt; Maybe Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span>
</span><span id="line-2005"></span><span>
</span><span id="line-2006"></span><span class="hs-comment">-- | Extract the RuntimeRep classifier of a type. For instance,</span><span>
</span><span id="line-2007"></span><span class="hs-comment">-- @getRuntimeRep_maybe Int = LiftedRep@. Panics if this is not possible.</span><span>
</span><span id="line-2008"></span><span class="annot"><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-type">getRuntimeRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-2009"></span><span id="getRuntimeRep"><span class="annot"><span class="annottext">getRuntimeRep :: HasDebugCallStack =&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var hs-var">getRuntimeRep</span></a></span></span><span> </span><span id="local-6989586621680812462"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812462"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2010"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812462"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2011"></span><span>      </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812461"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812461"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812461"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2012"></span><span>      </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRuntimeRep&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812462"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812462"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2013"></span><span>
</span><span id="line-2014"></span><span class="annot"><a href="GHC.Core.Type.html#isUnboxedTupleType"><span class="hs-identifier hs-type">isUnboxedTupleType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2015"></span><span id="isUnboxedTupleType"><span class="annot"><span class="annottext">isUnboxedTupleType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnboxedTupleType"><span class="hs-identifier hs-var hs-var">isUnboxedTupleType</span></a></span></span><span> </span><span id="local-6989586621680812460"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812460"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2016"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon"><span class="hs-identifier hs-var">tyConAppTyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812460"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#tupleRepDataConKey"><span class="hs-identifier hs-var">tupleRepDataConKey</span></a></span><span>
</span><span id="line-2017"></span><span>  </span><span class="hs-comment">-- NB: Do not use typePrimRep, as that can't tell the difference between</span><span>
</span><span id="line-2018"></span><span>  </span><span class="hs-comment">-- unboxed tuples and unboxed sums</span><span>
</span><span id="line-2019"></span><span>
</span><span id="line-2020"></span><span>
</span><span id="line-2021"></span><span class="annot"><a href="GHC.Core.Type.html#isUnboxedSumType"><span class="hs-identifier hs-type">isUnboxedSumType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2022"></span><span id="isUnboxedSumType"><span class="annot"><span class="annottext">isUnboxedSumType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnboxedSumType"><span class="hs-identifier hs-var hs-var">isUnboxedSumType</span></a></span></span><span> </span><span id="local-6989586621680812458"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812458"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2023"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon"><span class="hs-identifier hs-var">tyConAppTyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812458"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#sumRepDataConKey"><span class="hs-identifier hs-var">sumRepDataConKey</span></a></span><span>
</span><span id="line-2024"></span><span>
</span><span id="line-2025"></span><span class="hs-comment">-- | See &quot;Type#type_classification&quot; for what an algebraic type is.</span><span>
</span><span id="line-2026"></span><span class="hs-comment">-- Should only be applied to /types/, as opposed to e.g. partially</span><span>
</span><span id="line-2027"></span><span class="hs-comment">-- saturated type constructors</span><span>
</span><span id="line-2028"></span><span class="annot"><a href="GHC.Core.Type.html#isAlgType"><span class="hs-identifier hs-type">isAlgType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2029"></span><span id="isAlgType"><span class="annot"><span class="annottext">isAlgType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isAlgType"><span class="hs-identifier hs-var hs-var">isAlgType</span></a></span></span><span> </span><span id="local-6989586621680812456"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812456"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2030"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812456"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2031"></span><span>      </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812455"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812455"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812454"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812454"><span class="hs-identifier hs-var">ty_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">ty_args</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">lengthIs</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><span class="hs-identifier">tc</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-2032"></span><span>                            </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812455"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2033"></span><span>      </span><span id="local-6989586621680812451"><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><a href="#local-6989586621680812451"><span class="hs-identifier hs-var">_other</span></a></span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2034"></span><span>
</span><span id="line-2035"></span><span class="hs-comment">-- | Check whether a type is a data family type</span><span>
</span><span id="line-2036"></span><span class="annot"><a href="GHC.Core.Type.html#isDataFamilyAppType"><span class="hs-identifier hs-type">isDataFamilyAppType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2037"></span><span id="isDataFamilyAppType"><span class="annot"><span class="annottext">isDataFamilyAppType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isDataFamilyAppType"><span class="hs-identifier hs-var hs-var">isDataFamilyAppType</span></a></span></span><span> </span><span id="local-6989586621680812450"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812450"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812450"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2038"></span><span>                           </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812449"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812449"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isDataFamilyTyCon"><span class="hs-identifier hs-var">isDataFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812449"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2039"></span><span>                           </span><span class="annot"><span class="annottext">Maybe TyCon
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2040"></span><span>
</span><span id="line-2041"></span><span class="hs-comment">-- | Computes whether an argument (or let right hand side) should</span><span>
</span><span id="line-2042"></span><span class="hs-comment">-- be computed strictly or lazily, based only on its type.</span><span>
</span><span id="line-2043"></span><span class="hs-comment">-- Currently, it's just 'isUnliftedType'. Panics on levity-polymorphic types.</span><span>
</span><span id="line-2044"></span><span class="annot"><a href="GHC.Core.Type.html#isStrictType"><span class="hs-identifier hs-type">isStrictType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2045"></span><span id="isStrictType"><span class="annot"><span class="annottext">isStrictType :: HasDebugCallStack =&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isStrictType"><span class="hs-identifier hs-var hs-var">isStrictType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Bool
Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a></span><span>
</span><span id="line-2046"></span><span>
</span><span id="line-2047"></span><span class="annot"><a href="GHC.Core.Type.html#isPrimitiveType"><span class="hs-identifier hs-type">isPrimitiveType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2048"></span><span class="hs-comment">-- ^ Returns true of types that are opaque to Haskell.</span><span>
</span><span id="line-2049"></span><span id="isPrimitiveType"><span class="annot"><span class="annottext">isPrimitiveType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isPrimitiveType"><span class="hs-identifier hs-var hs-var">isPrimitiveType</span></a></span></span><span> </span><span id="local-6989586621680812445"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812445"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812445"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2050"></span><span>                        </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812444"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812444"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812443"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812443"><span class="hs-identifier hs-var">ty_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">ty_args</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">lengthIs</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><span class="hs-identifier">tc</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-2051"></span><span>                                              </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isPrimTyCon"><span class="hs-identifier hs-var">isPrimTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812444"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2052"></span><span>                        </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2053"></span><span>
</span><span id="line-2054"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Join points}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2061"></span><span>
</span><span id="line-2062"></span><span class="hs-comment">-- | Determine whether a type could be the type of a join point of given total</span><span>
</span><span id="line-2063"></span><span class="hs-comment">-- arity, according to the polymorphism rule. A join point cannot be polymorphic</span><span>
</span><span id="line-2064"></span><span class="hs-comment">-- in its return type, since given</span><span>
</span><span id="line-2065"></span><span class="hs-comment">--   join j @a @b x y z = e1 in e2,</span><span>
</span><span id="line-2066"></span><span class="hs-comment">-- the types of e1 and e2 must be the same, and a and b are not in scope for e2.</span><span>
</span><span id="line-2067"></span><span class="hs-comment">-- (See Note [The polymorphism rule of join points] in &quot;GHC.Core&quot;.) Returns False</span><span>
</span><span id="line-2068"></span><span class="hs-comment">-- also if the type simply doesn't have enough arguments.</span><span>
</span><span id="line-2069"></span><span class="hs-comment">--</span><span>
</span><span id="line-2070"></span><span class="hs-comment">-- Note that we need to know how many arguments (type *and* value) the putative</span><span>
</span><span id="line-2071"></span><span class="hs-comment">-- join point takes; for instance, if</span><span>
</span><span id="line-2072"></span><span class="hs-comment">--   j :: forall a. a -&gt; Int</span><span>
</span><span id="line-2073"></span><span class="hs-comment">-- then j could be a binary join point returning an Int, but it could *not* be a</span><span>
</span><span id="line-2074"></span><span class="hs-comment">-- unary join point returning a -&gt; Int.</span><span>
</span><span id="line-2075"></span><span class="hs-comment">--</span><span>
</span><span id="line-2076"></span><span class="hs-comment">-- TODO: See Note [Excess polymorphism and join points]</span><span>
</span><span id="line-2077"></span><span class="annot"><a href="GHC.Core.Type.html#isValidJoinPointType"><span class="hs-identifier hs-type">isValidJoinPointType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#JoinArity"><span class="hs-identifier hs-type">JoinArity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2078"></span><span id="isValidJoinPointType"><span class="annot"><span class="annottext">isValidJoinPointType :: Int -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isValidJoinPointType"><span class="hs-identifier hs-var hs-var">isValidJoinPointType</span></a></span></span><span> </span><span id="local-6989586621680812440"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680812440"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621680812439"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812439"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2079"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; Int -&gt; Type -&gt; Bool
forall {a}. (Eq a, Num a) =&gt; TyCoVarSet -&gt; a -&gt; Type -&gt; Bool
</span><a href="#local-6989586621680812438"><span class="hs-identifier hs-var">valid_under</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680812440"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812439"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2080"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2081"></span><span>    </span><span id="local-6989586621680812438"><span class="annot"><span class="annottext">valid_under :: TyCoVarSet -&gt; a -&gt; Type -&gt; Bool
</span><a href="#local-6989586621680812438"><span class="hs-identifier hs-var hs-var">valid_under</span></a></span></span><span> </span><span id="local-6989586621680812428"><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812428"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621680812427"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680812427"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621680812426"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812426"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2082"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680812427"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2083"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812428"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyCoVarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#disjointVarSet"><span class="hs-operator hs-var">`disjointVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812426"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2084"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812424"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812424"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812423"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812423"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TyVar, Type)
</span><a href="GHC.Core.Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var">splitForAllTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812426"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2085"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; a -&gt; Type -&gt; Bool
</span><a href="#local-6989586621680812438"><span class="hs-identifier hs-var">valid_under</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812428"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyVar -&gt; TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-operator hs-var">`extendVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812424"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680812427"><span class="hs-identifier hs-var">arity</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812423"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2086"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812421"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812421"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type, Type)
</span><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812426"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2087"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; a -&gt; Type -&gt; Bool
</span><a href="#local-6989586621680812438"><span class="hs-identifier hs-var">valid_under</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812428"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680812427"><span class="hs-identifier hs-var">arity</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812421"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-2088"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2089"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2090"></span><span>
</span><span id="line-2091"></span><span class="hs-comment">{- Note [Excess polymorphism and join points]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In principle, if a function would be a join point except that it fails
the polymorphism rule (see Note [The polymorphism rule of join points] in
GHC.Core), it can still be made a join point with some effort. This is because
all tail calls must return the same type (they return to the same context!), and
thus if the return type depends on an argument, that argument must always be the
same.

For instance, consider:

  let f :: forall a. a -&gt; Char -&gt; [a]
      f @a x c = ... f @a y 'a' ...
  in ... f @Int 1 'b' ... f @Int 2 'c' ...

(where the calls are tail calls). `f` fails the polymorphism rule because its
return type is [a], where [a] is bound. But since the type argument is always
'Int', we can rewrite it as:

  let f' :: Int -&gt; Char -&gt; [Int]
      f' x c = ... f' y 'a' ...
  in ... f' 1 'b' ... f 2 'c' ...

and now we can make f' a join point:

  join f' :: Int -&gt; Char -&gt; [Int]
       f' x c = ... jump f' y 'a' ...
  in ... jump f' 1 'b' ... jump f' 2 'c' ...

It's not clear that this comes up often, however. TODO: Measure how often and
add this analysis if necessary.  See #14620.


************************************************************************
*                                                                      *
\subsection{Sequencing on types}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2130"></span><span>
</span><span id="line-2131"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-type">seqType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2132"></span><span id="seqType"><span class="annot"><span class="annottext">seqType :: Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var hs-var">seqType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621680812420"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680812420"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680812420"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2133"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680812419"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812419"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812419"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2134"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680812418"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812418"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680812417"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812417"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812418"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812417"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2135"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812416"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812416"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680812415"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812415"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680812414"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812414"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812416"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812415"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812414"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2136"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812413"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812413"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680812412"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812412"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812413"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ()
</span><a href="GHC.Core.Type.html#seqTypes"><span class="hs-identifier hs-var">seqTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812412"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2137"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812411"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812411"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812410"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812410"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812411"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812410"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2138"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680812409"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812409"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812408"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812408"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812409"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; ()
</span><a href="GHC.Core.Coercion.html#seqCo"><span class="hs-identifier hs-var">seqCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812408"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2139"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621680812407"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812407"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; ()
</span><a href="GHC.Core.Coercion.html#seqCo"><span class="hs-identifier hs-var">seqCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812407"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2140"></span><span>
</span><span id="line-2141"></span><span class="annot"><a href="GHC.Core.Type.html#seqTypes"><span class="hs-identifier hs-type">seqTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2142"></span><span id="seqTypes"><span class="annot"><span class="annottext">seqTypes :: [Type] -&gt; ()
</span><a href="GHC.Core.Type.html#seqTypes"><span class="hs-identifier hs-var hs-var">seqTypes</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2143"></span><span class="annot"><a href="GHC.Core.Type.html#seqTypes"><span class="hs-identifier hs-var">seqTypes</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812406"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812406"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680812405"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812405"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812406"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ()
</span><a href="GHC.Core.Type.html#seqTypes"><span class="hs-identifier hs-var">seqTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812405"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2144"></span><span>
</span><span id="line-2145"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Comparison for types
        (We don't use instances so that we know where it happens)
*                                                                      *
************************************************************************

Note [Equality on AppTys]
~~~~~~~~~~~~~~~~~~~~~~~~~
In our cast-ignoring equality, we want to say that the following two
are equal:

  (Maybe |&gt; co) (Int |&gt; co')   ~?       Maybe Int

But the left is an AppTy while the right is a TyConApp. The solution is
to use repSplitAppTy_maybe to break up the TyConApp into its pieces and
then continue. Easy to do, but also easy to forget to do.

-}</span><span>
</span><span id="line-2165"></span><span>
</span><span id="line-2166"></span><span class="annot"><a href="GHC.Core.Type.html#eqType"><span class="hs-identifier hs-type">eqType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2167"></span><span class="hs-comment">-- ^ Type equality on source types. Does not look through @newtypes@ or</span><span>
</span><span id="line-2168"></span><span class="hs-comment">-- 'PredType's, but it does look through type synonyms.</span><span>
</span><span id="line-2169"></span><span class="hs-comment">-- This first checks that the kinds of the types are equal and then</span><span>
</span><span id="line-2170"></span><span class="hs-comment">-- checks whether the types are equal, ignoring casts and coercions.</span><span>
</span><span id="line-2171"></span><span class="hs-comment">-- (The kind check is a recursive call, but since all kinds have type</span><span>
</span><span id="line-2172"></span><span class="hs-comment">-- @Type@, there is no need to check the types of kinds.)</span><span>
</span><span id="line-2173"></span><span class="hs-comment">-- See also Note [Non-trivial definitional equality] in &quot;GHC.Core.TyCo.Rep&quot;.</span><span>
</span><span id="line-2174"></span><span id="eqType"><span class="annot"><span class="annottext">eqType :: Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#eqType"><span class="hs-identifier hs-var hs-var">eqType</span></a></span></span><span> </span><span id="local-6989586621680812404"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812404"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680812403"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812403"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Bool
</span><a href="GHC.Utils.Misc.html#isEqual"><span class="hs-identifier hs-var">isEqual</span></a></span><span> </span><span class="annot"><span class="annottext">(Ordering -&gt; Bool) -&gt; Ordering -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpType"><span class="hs-identifier hs-var">nonDetCmpType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812404"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812403"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2175"></span><span>  </span><span class="hs-comment">-- It's OK to use nonDetCmpType here and eqType is deterministic,</span><span>
</span><span id="line-2176"></span><span>  </span><span class="hs-comment">-- nonDetCmpType does equality deterministically</span><span>
</span><span id="line-2177"></span><span>
</span><span id="line-2178"></span><span class="hs-comment">-- | Compare types with respect to a (presumably) non-empty 'RnEnv2'.</span><span>
</span><span id="line-2179"></span><span class="annot"><a href="GHC.Core.Type.html#eqTypeX"><span class="hs-identifier hs-type">eqTypeX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2180"></span><span id="eqTypeX"><span class="annot"><span class="annottext">eqTypeX :: RnEnv2 -&gt; Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#eqTypeX"><span class="hs-identifier hs-var hs-var">eqTypeX</span></a></span></span><span> </span><span id="local-6989586621680812401"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812401"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680812400"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812400"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680812399"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812399"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Bool
</span><a href="GHC.Utils.Misc.html#isEqual"><span class="hs-identifier hs-var">isEqual</span></a></span><span> </span><span class="annot"><span class="annottext">(Ordering -&gt; Bool) -&gt; Ordering -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpTypeX"><span class="hs-identifier hs-var">nonDetCmpTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812401"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812400"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812399"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2181"></span><span>  </span><span class="hs-comment">-- It's OK to use nonDetCmpType here and eqTypeX is deterministic,</span><span>
</span><span id="line-2182"></span><span>  </span><span class="hs-comment">-- nonDetCmpTypeX does equality deterministically</span><span>
</span><span id="line-2183"></span><span>
</span><span id="line-2184"></span><span class="hs-comment">-- | Type equality on lists of types, looking through type synonyms</span><span>
</span><span id="line-2185"></span><span class="hs-comment">-- but not newtypes.</span><span>
</span><span id="line-2186"></span><span class="annot"><a href="GHC.Core.Type.html#eqTypes"><span class="hs-identifier hs-type">eqTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2187"></span><span id="eqTypes"><span class="annot"><span class="annottext">eqTypes :: [Type] -&gt; [Type] -&gt; Bool
</span><a href="GHC.Core.Type.html#eqTypes"><span class="hs-identifier hs-var hs-var">eqTypes</span></a></span></span><span> </span><span id="local-6989586621680812398"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812398"><span class="hs-identifier hs-var">tys1</span></a></span></span><span> </span><span id="local-6989586621680812397"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812397"><span class="hs-identifier hs-var">tys2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Bool
</span><a href="GHC.Utils.Misc.html#isEqual"><span class="hs-identifier hs-var">isEqual</span></a></span><span> </span><span class="annot"><span class="annottext">(Ordering -&gt; Bool) -&gt; Ordering -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpTypes"><span class="hs-identifier hs-var">nonDetCmpTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812398"><span class="hs-identifier hs-var">tys1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812397"><span class="hs-identifier hs-var">tys2</span></a></span><span>
</span><span id="line-2188"></span><span>  </span><span class="hs-comment">-- It's OK to use nonDetCmpType here and eqTypes is deterministic,</span><span>
</span><span id="line-2189"></span><span>  </span><span class="hs-comment">-- nonDetCmpTypes does equality deterministically</span><span>
</span><span id="line-2190"></span><span>
</span><span id="line-2191"></span><span class="annot"><a href="GHC.Core.Type.html#eqVarBndrs"><span class="hs-identifier hs-type">eqVarBndrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a></span><span>
</span><span id="line-2192"></span><span class="hs-comment">-- Check that the var lists are the same length</span><span>
</span><span id="line-2193"></span><span class="hs-comment">-- and have matching kinds; if so, extend the RnEnv2</span><span>
</span><span id="line-2194"></span><span class="hs-comment">-- Returns Nothing if they don't match</span><span>
</span><span id="line-2195"></span><span id="eqVarBndrs"><span class="annot"><span class="annottext">eqVarBndrs :: RnEnv2 -&gt; [TyVar] -&gt; [TyVar] -&gt; Maybe RnEnv2
</span><a href="GHC.Core.Type.html#eqVarBndrs"><span class="hs-identifier hs-var hs-var">eqVarBndrs</span></a></span></span><span> </span><span id="local-6989586621680812396"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812396"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2196"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Maybe RnEnv2
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812396"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-2197"></span><span class="annot"><a href="GHC.Core.Type.html#eqVarBndrs"><span class="hs-identifier hs-var">eqVarBndrs</span></a></span><span> </span><span id="local-6989586621680812395"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812395"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812394"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812394"><span class="hs-identifier hs-var">tv1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680812393"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812393"><span class="hs-identifier hs-var">tvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812392"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812392"><span class="hs-identifier hs-var">tv2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680812391"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812391"><span class="hs-identifier hs-var">tvs2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2198"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#eqTypeX"><span class="hs-identifier hs-var">eqTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812395"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812394"><span class="hs-identifier hs-var">tv1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812392"><span class="hs-identifier hs-var">tv2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2199"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; [TyVar] -&gt; [TyVar] -&gt; Maybe RnEnv2
</span><a href="GHC.Core.Type.html#eqVarBndrs"><span class="hs-identifier hs-var">eqVarBndrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RnEnv2 -&gt; TyVar -&gt; TyVar -&gt; RnEnv2
</span><a href="GHC.Types.Var.Env.html#rnBndr2"><span class="hs-identifier hs-var">rnBndr2</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812395"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812394"><span class="hs-identifier hs-var">tv1</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812392"><span class="hs-identifier hs-var">tv2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812393"><span class="hs-identifier hs-var">tvs1</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812391"><span class="hs-identifier hs-var">tvs2</span></a></span><span>
</span><span id="line-2200"></span><span class="annot"><a href="GHC.Core.Type.html#eqVarBndrs"><span class="hs-identifier hs-var">eqVarBndrs</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><span class="hs-identifier">_</span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe RnEnv2
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2201"></span><span>
</span><span id="line-2202"></span><span class="hs-comment">-- Now here comes the real worker</span><span>
</span><span id="line-2203"></span><span>
</span><span id="line-2204"></span><span class="hs-comment">{-
Note [nonDetCmpType nondeterminism]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
nonDetCmpType is implemented in terms of nonDetCmpTypeX. nonDetCmpTypeX
uses nonDetCmpTc which compares TyCons by their Unique value. Using Uniques for
ordering leads to nondeterminism. We hit the same problem in the TyVarTy case,
comparing type variables is nondeterministic, note the call to nonDetCmpVar in
nonDetCmpTypeX.
See Note [Unique Determinism] for more details.
-}</span><span>
</span><span id="line-2214"></span><span>
</span><span id="line-2215"></span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpType"><span class="hs-identifier hs-type">nonDetCmpType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span>
</span><span id="line-2216"></span><span id="nonDetCmpType"><span class="annot"><span class="annottext">nonDetCmpType :: Type -&gt; Type -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpType"><span class="hs-identifier hs-var hs-var">nonDetCmpType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812389"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812389"><span class="hs-identifier hs-var">tc1</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812388"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812388"><span class="hs-identifier hs-var">tc2</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812389"><span class="hs-identifier hs-var">tc1</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; TyCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812388"><span class="hs-identifier hs-var">tc2</span></a></span><span>
</span><span id="line-2217"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-2218"></span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpType"><span class="hs-identifier hs-var">nonDetCmpType</span></a></span><span> </span><span id="local-6989586621680812387"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812387"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680812386"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812386"><span class="hs-identifier hs-var">t2</span></a></span></span><span>
</span><span id="line-2219"></span><span>  </span><span class="hs-comment">-- we know k1 and k2 have the same kind, because they both have kind *.</span><span>
</span><span id="line-2220"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpTypeX"><span class="hs-identifier hs-var">nonDetCmpTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812385"><span class="hs-identifier hs-var">rn_env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812387"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812386"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2221"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2222"></span><span>    </span><span id="local-6989586621680812385"><span class="annot"><span class="annottext">rn_env :: RnEnv2
</span><a href="#local-6989586621680812385"><span class="hs-identifier hs-var hs-var">rn_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; RnEnv2
</span><a href="GHC.Types.Var.Env.html#mkRnEnv2"><span class="hs-identifier hs-var">mkRnEnv2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812387"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812386"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2223"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpType"><span class="hs-pragma hs-type">nonDetCmpType</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2224"></span><span>
</span><span id="line-2225"></span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpTypes"><span class="hs-identifier hs-type">nonDetCmpTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span>
</span><span id="line-2226"></span><span id="nonDetCmpTypes"><span class="annot"><span class="annottext">nonDetCmpTypes :: [Type] -&gt; [Type] -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpTypes"><span class="hs-identifier hs-var hs-var">nonDetCmpTypes</span></a></span></span><span> </span><span id="local-6989586621680812383"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812383"><span class="hs-identifier hs-var">ts1</span></a></span></span><span> </span><span id="local-6989586621680812382"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812382"><span class="hs-identifier hs-var">ts2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; [Type] -&gt; [Type] -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpTypesX"><span class="hs-identifier hs-var">nonDetCmpTypesX</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812381"><span class="hs-identifier hs-var">rn_env</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812383"><span class="hs-identifier hs-var">ts1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812382"><span class="hs-identifier hs-var">ts2</span></a></span><span>
</span><span id="line-2227"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2228"></span><span>    </span><span id="local-6989586621680812381"><span class="annot"><span class="annottext">rn_env :: RnEnv2
</span><a href="#local-6989586621680812381"><span class="hs-identifier hs-var hs-var">rn_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; RnEnv2
</span><a href="GHC.Types.Var.Env.html#mkRnEnv2"><span class="hs-identifier hs-var">mkRnEnv2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812383"><span class="hs-identifier hs-var">ts1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812382"><span class="hs-identifier hs-var">ts2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2229"></span><span>
</span><span id="line-2230"></span><span class="hs-comment">-- | An ordering relation between two 'Type's (known below as @t1 :: k1@</span><span>
</span><span id="line-2231"></span><span class="hs-comment">-- and @t2 :: k2@)</span><span>
</span><span id="line-2232"></span><span class="hs-keyword">data</span><span> </span><span id="TypeOrdering"><span class="annot"><a href="GHC.Core.Type.html#TypeOrdering"><span class="hs-identifier hs-var">TypeOrdering</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TLT"><span class="annot"><a href="GHC.Core.Type.html#TLT"><span class="hs-identifier hs-var">TLT</span></a></span></span><span>  </span><span class="hs-comment">-- ^ @t1 &lt; t2@</span><span>
</span><span id="line-2233"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="TEQ"><span class="annot"><a href="GHC.Core.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span></span><span>  </span><span class="hs-comment">-- ^ @t1 ~ t2@ and there are no casts in either,</span><span>
</span><span id="line-2234"></span><span>                         </span><span class="hs-comment">-- therefore we can conclude @k1 ~ k2@</span><span>
</span><span id="line-2235"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="TEQX"><span class="annot"><a href="GHC.Core.Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a></span></span><span> </span><span class="hs-comment">-- ^ @t1 ~ t2@ yet one of the types contains a cast so</span><span>
</span><span id="line-2236"></span><span>                         </span><span class="hs-comment">-- they may differ in kind.</span><span>
</span><span id="line-2237"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="TGT"><span class="annot"><a href="GHC.Core.Type.html#TGT"><span class="hs-identifier hs-var">TGT</span></a></span></span><span>  </span><span class="hs-comment">-- ^ @t1 &gt; t2@</span><span>
</span><span id="line-2238"></span><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812373"><span id="local-6989586621680812375"><span class="annot"><span class="annottext">TypeOrdering -&gt; TypeOrdering -&gt; Bool
(TypeOrdering -&gt; TypeOrdering -&gt; Bool)
-&gt; (TypeOrdering -&gt; TypeOrdering -&gt; Bool) -&gt; Eq TypeOrdering
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TypeOrdering -&gt; TypeOrdering -&gt; Bool
$c/= :: TypeOrdering -&gt; TypeOrdering -&gt; Bool
== :: TypeOrdering -&gt; TypeOrdering -&gt; Bool
$c== :: TypeOrdering -&gt; TypeOrdering -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812353"><span id="local-6989586621680812355"><span id="local-6989586621680812358"><span id="local-6989586621680812361"><span id="local-6989586621680812364"><span id="local-6989586621680812366"><span id="local-6989586621680812368"><span class="annot"><span class="annottext">Eq TypeOrdering
Eq TypeOrdering
-&gt; (TypeOrdering -&gt; TypeOrdering -&gt; Ordering)
-&gt; (TypeOrdering -&gt; TypeOrdering -&gt; Bool)
-&gt; (TypeOrdering -&gt; TypeOrdering -&gt; Bool)
-&gt; (TypeOrdering -&gt; TypeOrdering -&gt; Bool)
-&gt; (TypeOrdering -&gt; TypeOrdering -&gt; Bool)
-&gt; (TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering)
-&gt; (TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering)
-&gt; Ord TypeOrdering
TypeOrdering -&gt; TypeOrdering -&gt; Bool
TypeOrdering -&gt; TypeOrdering -&gt; Ordering
TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
$cmin :: TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
max :: TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
$cmax :: TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
&gt;= :: TypeOrdering -&gt; TypeOrdering -&gt; Bool
$c&gt;= :: TypeOrdering -&gt; TypeOrdering -&gt; Bool
&gt; :: TypeOrdering -&gt; TypeOrdering -&gt; Bool
$c&gt; :: TypeOrdering -&gt; TypeOrdering -&gt; Bool
&lt;= :: TypeOrdering -&gt; TypeOrdering -&gt; Bool
$c&lt;= :: TypeOrdering -&gt; TypeOrdering -&gt; Bool
&lt; :: TypeOrdering -&gt; TypeOrdering -&gt; Bool
$c&lt; :: TypeOrdering -&gt; TypeOrdering -&gt; Bool
compare :: TypeOrdering -&gt; TypeOrdering -&gt; Ordering
$ccompare :: TypeOrdering -&gt; TypeOrdering -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812317"><span id="local-6989586621680812319"><span id="local-6989586621680812323"><span id="local-6989586621680812327"><span id="local-6989586621680812329"><span id="local-6989586621680812338"><span id="local-6989586621680812344"><span id="local-6989586621680812350"><span class="annot"><span class="annottext">Int -&gt; TypeOrdering
TypeOrdering -&gt; Int
TypeOrdering -&gt; [TypeOrdering]
TypeOrdering -&gt; TypeOrdering
TypeOrdering -&gt; TypeOrdering -&gt; [TypeOrdering]
TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering -&gt; [TypeOrdering]
(TypeOrdering -&gt; TypeOrdering)
-&gt; (TypeOrdering -&gt; TypeOrdering)
-&gt; (Int -&gt; TypeOrdering)
-&gt; (TypeOrdering -&gt; Int)
-&gt; (TypeOrdering -&gt; [TypeOrdering])
-&gt; (TypeOrdering -&gt; TypeOrdering -&gt; [TypeOrdering])
-&gt; (TypeOrdering -&gt; TypeOrdering -&gt; [TypeOrdering])
-&gt; (TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering -&gt; [TypeOrdering])
-&gt; Enum TypeOrdering
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering -&gt; [TypeOrdering]
$cenumFromThenTo :: TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering -&gt; [TypeOrdering]
enumFromTo :: TypeOrdering -&gt; TypeOrdering -&gt; [TypeOrdering]
$cenumFromTo :: TypeOrdering -&gt; TypeOrdering -&gt; [TypeOrdering]
enumFromThen :: TypeOrdering -&gt; TypeOrdering -&gt; [TypeOrdering]
$cenumFromThen :: TypeOrdering -&gt; TypeOrdering -&gt; [TypeOrdering]
enumFrom :: TypeOrdering -&gt; [TypeOrdering]
$cenumFrom :: TypeOrdering -&gt; [TypeOrdering]
fromEnum :: TypeOrdering -&gt; Int
$cfromEnum :: TypeOrdering -&gt; Int
toEnum :: Int -&gt; TypeOrdering
$ctoEnum :: Int -&gt; TypeOrdering
pred :: TypeOrdering -&gt; TypeOrdering
$cpred :: TypeOrdering -&gt; TypeOrdering
succ :: TypeOrdering -&gt; TypeOrdering
$csucc :: TypeOrdering -&gt; TypeOrdering
</span><a href="../../base/src/GHC.Enum.html#Enum"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812312"><span id="local-6989586621680812314"><span class="annot"><span class="annottext">TypeOrdering
TypeOrdering -&gt; TypeOrdering -&gt; Bounded TypeOrdering
forall a. a -&gt; a -&gt; Bounded a
maxBound :: TypeOrdering
$cmaxBound :: TypeOrdering
minBound :: TypeOrdering
$cminBound :: TypeOrdering
</span><a href="../../base/src/GHC.Enum.html#Bounded"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-2239"></span><span>
</span><span id="line-2240"></span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpTypeX"><span class="hs-identifier hs-type">nonDetCmpTypeX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span>  </span><span class="hs-comment">-- Main workhorse</span><span>
</span><span id="line-2241"></span><span>    </span><span class="hs-comment">-- See Note [Non-trivial definitional equality] in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-2242"></span><span id="nonDetCmpTypeX"><span class="annot"><span class="annottext">nonDetCmpTypeX :: RnEnv2 -&gt; Type -&gt; Type -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpTypeX"><span class="hs-identifier hs-var hs-var">nonDetCmpTypeX</span></a></span></span><span> </span><span id="local-6989586621680812309"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812309"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680812308"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812308"><span class="hs-identifier hs-var">orig_t1</span></a></span></span><span> </span><span id="local-6989586621680812307"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812307"><span class="hs-identifier hs-var">orig_t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2243"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812309"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812308"><span class="hs-identifier hs-var">orig_t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812307"><span class="hs-identifier hs-var">orig_t2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2244"></span><span>      </span><span class="hs-comment">-- If there are casts then we also need to do a comparison of the kinds of</span><span>
</span><span id="line-2245"></span><span>      </span><span class="hs-comment">-- the types being compared</span><span>
</span><span id="line-2246"></span><span>      </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeOrdering -&gt; Ordering
</span><a href="#local-6989586621680812305"><span class="hs-identifier hs-var">toOrdering</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeOrdering -&gt; Ordering) -&gt; TypeOrdering -&gt; Ordering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812309"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812304"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812303"><span class="hs-identifier hs-var">k2</span></a></span><span>
</span><span id="line-2247"></span><span>      </span><span id="local-6989586621680812302"><span class="annot"><span class="annottext">TypeOrdering
</span><a href="#local-6989586621680812302"><span class="hs-identifier hs-var">ty_ordering</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeOrdering -&gt; Ordering
</span><a href="#local-6989586621680812305"><span class="hs-identifier hs-var">toOrdering</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="#local-6989586621680812302"><span class="hs-identifier hs-var">ty_ordering</span></a></span><span>
</span><span id="line-2248"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2249"></span><span>    </span><span id="local-6989586621680812304"><span class="annot"><span class="annottext">k1 :: Type
</span><a href="#local-6989586621680812304"><span class="hs-identifier hs-var hs-var">k1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812308"><span class="hs-identifier hs-var">orig_t1</span></a></span><span>
</span><span id="line-2250"></span><span>    </span><span id="local-6989586621680812303"><span class="annot"><span class="annottext">k2 :: Type
</span><a href="#local-6989586621680812303"><span class="hs-identifier hs-var hs-var">k2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812307"><span class="hs-identifier hs-var">orig_t2</span></a></span><span>
</span><span id="line-2251"></span><span>
</span><span id="line-2252"></span><span>    </span><span class="annot"><a href="#local-6989586621680812305"><span class="hs-identifier hs-type">toOrdering</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span>
</span><span id="line-2253"></span><span>    </span><span id="local-6989586621680812305"><span class="annot"><span class="annottext">toOrdering :: TypeOrdering -&gt; Ordering
</span><a href="#local-6989586621680812305"><span class="hs-identifier hs-var hs-var">toOrdering</span></a></span></span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TLT"><span class="hs-identifier hs-var">TLT</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-2254"></span><span>    </span><span class="annot"><a href="#local-6989586621680812305"><span class="hs-identifier hs-var">toOrdering</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-2255"></span><span>    </span><span class="annot"><a href="#local-6989586621680812305"><span class="hs-identifier hs-var">toOrdering</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-2256"></span><span>    </span><span class="annot"><a href="#local-6989586621680812305"><span class="hs-identifier hs-var">toOrdering</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TGT"><span class="hs-identifier hs-var">TGT</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-2257"></span><span>
</span><span id="line-2258"></span><span>    </span><span class="annot"><a href="#local-6989586621680812299"><span class="hs-identifier hs-type">liftOrdering</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a></span><span>
</span><span id="line-2259"></span><span>    </span><span id="local-6989586621680812299"><span class="annot"><span class="annottext">liftOrdering :: Ordering -&gt; TypeOrdering
</span><a href="#local-6989586621680812299"><span class="hs-identifier hs-var hs-var">liftOrdering</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TLT"><span class="hs-identifier hs-var">TLT</span></a></span><span>
</span><span id="line-2260"></span><span>    </span><span class="annot"><a href="#local-6989586621680812299"><span class="hs-identifier hs-var">liftOrdering</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span><span>
</span><span id="line-2261"></span><span>    </span><span class="annot"><a href="#local-6989586621680812299"><span class="hs-identifier hs-var">liftOrdering</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TGT"><span class="hs-identifier hs-var">TGT</span></a></span><span>
</span><span id="line-2262"></span><span>
</span><span id="line-2263"></span><span>    </span><span class="annot"><a href="#local-6989586621680812298"><span class="hs-identifier hs-type">thenCmpTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a></span><span>
</span><span id="line-2264"></span><span>    </span><span id="local-6989586621680812298"><span class="annot"><span class="annottext">thenCmpTy :: TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
</span><a href="#local-6989586621680812298"><span class="hs-identifier hs-var hs-var">thenCmpTy</span></a></span></span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span><span>  </span><span id="local-6989586621680812297"><span class="annot"><span class="annottext">TypeOrdering
</span><a href="#local-6989586621680812297"><span class="hs-identifier hs-var">rel</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="#local-6989586621680812297"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-2265"></span><span>    </span><span class="annot"><a href="#local-6989586621680812298"><span class="hs-identifier hs-var">thenCmpTy</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a></span><span> </span><span id="local-6989586621680812296"><span class="annot"><span class="annottext">TypeOrdering
</span><a href="#local-6989586621680812296"><span class="hs-identifier hs-var">rel</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering -&gt; TypeOrdering
</span><a href="#local-6989586621680812295"><span class="hs-identifier hs-var">hasCast</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="#local-6989586621680812296"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-2266"></span><span>    </span><span class="annot"><a href="#local-6989586621680812298"><span class="hs-identifier hs-var">thenCmpTy</span></a></span><span> </span><span id="local-6989586621680812294"><span class="annot"><span class="annottext">TypeOrdering
</span><a href="#local-6989586621680812294"><span class="hs-identifier hs-var">rel</span></a></span></span><span>  </span><span class="annot"><span class="annottext">TypeOrdering
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="#local-6989586621680812294"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-2267"></span><span>
</span><span id="line-2268"></span><span>    </span><span class="annot"><a href="#local-6989586621680812295"><span class="hs-identifier hs-type">hasCast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a></span><span>
</span><span id="line-2269"></span><span>    </span><span id="local-6989586621680812295"><span class="annot"><span class="annottext">hasCast :: TypeOrdering -&gt; TypeOrdering
</span><a href="#local-6989586621680812295"><span class="hs-identifier hs-var hs-var">hasCast</span></a></span></span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a></span><span>
</span><span id="line-2270"></span><span>    </span><span class="annot"><a href="#local-6989586621680812295"><span class="hs-identifier hs-var">hasCast</span></a></span><span> </span><span id="local-6989586621680812293"><span class="annot"><span class="annottext">TypeOrdering
</span><a href="#local-6989586621680812293"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="#local-6989586621680812293"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-2271"></span><span>
</span><span id="line-2272"></span><span>    </span><span class="hs-comment">-- Returns both the resulting ordering relation between the two types</span><span>
</span><span id="line-2273"></span><span>    </span><span class="hs-comment">-- and whether either contains a cast.</span><span>
</span><span id="line-2274"></span><span>    </span><span class="annot"><a href="#local-6989586621680812306"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a></span><span>
</span><span id="line-2275"></span><span>    </span><span id="local-6989586621680812306"><span class="annot"><span class="annottext">go :: RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680812292"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812292"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680812291"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812291"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680812290"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812290"><span class="hs-identifier hs-var">t2</span></a></span></span><span>
</span><span id="line-2276"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812289"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812289"><span class="hs-identifier hs-var">t1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812291"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812292"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812289"><span class="hs-identifier hs-var">t1'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812290"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2277"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812288"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812288"><span class="hs-identifier hs-var">t2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812290"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812292"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812291"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812288"><span class="hs-identifier hs-var">t2'</span></a></span><span>
</span><span id="line-2278"></span><span>
</span><span id="line-2279"></span><span>    </span><span class="annot"><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812287"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812287"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680812286"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812286"><span class="hs-identifier hs-var">tv1</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680812285"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812285"><span class="hs-identifier hs-var">tv2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2280"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; TypeOrdering
</span><a href="#local-6989586621680812299"><span class="hs-identifier hs-var">liftOrdering</span></a></span><span> </span><span class="annot"><span class="annottext">(Ordering -&gt; TypeOrdering) -&gt; Ordering -&gt; TypeOrdering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; TyVar -&gt; TyVar
</span><a href="GHC.Types.Var.Env.html#rnOccL"><span class="hs-identifier hs-var">rnOccL</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812287"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812286"><span class="hs-identifier hs-var">tv1</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TyVar -&gt; Ordering
</span><a href="GHC.Types.Var.html#nonDetCmpVar"><span class="hs-operator hs-var">`nonDetCmpVar`</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; TyVar -&gt; TyVar
</span><a href="GHC.Types.Var.Env.html#rnOccR"><span class="hs-identifier hs-var">rnOccR</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812287"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812285"><span class="hs-identifier hs-var">tv2</span></a></span><span>
</span><span id="line-2281"></span><span>    </span><span class="annot"><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812281"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812281"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812280"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812280"><span class="hs-identifier hs-var">tv1</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812279"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812279"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812278"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812278"><span class="hs-identifier hs-var">tv2</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812277"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812277"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2282"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812281"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812280"><span class="hs-identifier hs-var">tv1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812278"><span class="hs-identifier hs-var">tv2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2283"></span><span>        </span><span class="annot"><span class="annottext">TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
</span><a href="#local-6989586621680812298"><span class="hs-operator hs-var">`thenCmpTy`</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RnEnv2 -&gt; TyVar -&gt; TyVar -&gt; RnEnv2
</span><a href="GHC.Types.Var.Env.html#rnBndr2"><span class="hs-identifier hs-var">rnBndr2</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812281"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812280"><span class="hs-identifier hs-var">tv1</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812278"><span class="hs-identifier hs-var">tv2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812279"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812277"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2284"></span><span>        </span><span class="hs-comment">-- See Note [Equality on AppTys]</span><span>
</span><span id="line-2285"></span><span>    </span><span class="annot"><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812276"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812276"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680812275"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812275"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621680812274"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812274"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812273"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812273"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-2286"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812272"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812272"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812271"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812271"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (Type, Type)
Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812273"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-2287"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812276"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812275"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812272"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
</span><a href="#local-6989586621680812298"><span class="hs-operator hs-var">`thenCmpTy`</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812276"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812274"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812271"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2288"></span><span>    </span><span class="annot"><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812270"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812270"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680812269"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812269"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680812268"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812268"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span id="local-6989586621680812267"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812267"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2289"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812266"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812266"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812265"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812265"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (Type, Type)
Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812269"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2290"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812270"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812266"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812268"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
</span><a href="#local-6989586621680812298"><span class="hs-operator hs-var">`thenCmpTy`</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812270"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812265"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812267"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2291"></span><span>    </span><span class="annot"><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812264"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812264"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812263"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812263"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span id="local-6989586621680812262"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812262"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621680812261"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812261"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812260"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812260"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span id="local-6989586621680812259"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812259"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span id="local-6989586621680812258"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812258"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2292"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812264"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812262"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812259"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
</span><a href="#local-6989586621680812298"><span class="hs-operator hs-var">`thenCmpTy`</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812264"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812261"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812258"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
</span><a href="#local-6989586621680812298"><span class="hs-operator hs-var">`thenCmpTy`</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812264"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812263"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812260"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-2293"></span><span>        </span><span class="hs-comment">-- Comparing multiplicities last because the test is usually true</span><span>
</span><span id="line-2294"></span><span>    </span><span class="annot"><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812257"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812257"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812256"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812256"><span class="hs-identifier hs-var">tc1</span></a></span></span><span> </span><span id="local-6989586621680812255"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812255"><span class="hs-identifier hs-var">tys1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812254"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812254"><span class="hs-identifier hs-var">tc2</span></a></span></span><span> </span><span id="local-6989586621680812253"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812253"><span class="hs-identifier hs-var">tys2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2295"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; TypeOrdering
</span><a href="#local-6989586621680812299"><span class="hs-identifier hs-var">liftOrdering</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812256"><span class="hs-identifier hs-var">tc1</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; TyCon -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpTc"><span class="hs-operator hs-var">`nonDetCmpTc`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812254"><span class="hs-identifier hs-var">tc2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
</span><a href="#local-6989586621680812298"><span class="hs-operator hs-var">`thenCmpTy`</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; [Type] -&gt; [Type] -&gt; TypeOrdering
</span><a href="#local-6989586621680812252"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812257"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812255"><span class="hs-identifier hs-var">tys1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812253"><span class="hs-identifier hs-var">tys2</span></a></span><span>
</span><span id="line-2296"></span><span>    </span><span class="annot"><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621680812251"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680812251"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621680812250"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680812250"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; TypeOrdering
</span><a href="#local-6989586621680812299"><span class="hs-identifier hs-var">liftOrdering</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyLit -&gt; TyLit -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680812251"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680812250"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2297"></span><span>    </span><span class="annot"><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812248"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812248"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680812247"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812247"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span id="local-6989586621680812246"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812246"><span class="hs-identifier hs-var">t2</span></a></span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering -&gt; TypeOrdering
</span><a href="#local-6989586621680812295"><span class="hs-identifier hs-var">hasCast</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeOrdering -&gt; TypeOrdering) -&gt; TypeOrdering -&gt; TypeOrdering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812248"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812247"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812246"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2298"></span><span>    </span><span class="annot"><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812245"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812245"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680812244"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812244"><span class="hs-identifier hs-var">t1</span></a></span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680812243"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812243"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering -&gt; TypeOrdering
</span><a href="#local-6989586621680812295"><span class="hs-identifier hs-var">hasCast</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeOrdering -&gt; TypeOrdering) -&gt; TypeOrdering -&gt; TypeOrdering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812245"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812244"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812243"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2299"></span><span>
</span><span id="line-2300"></span><span>    </span><span class="annot"><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span><span>
</span><span id="line-2301"></span><span>
</span><span id="line-2302"></span><span>        </span><span class="hs-comment">-- Deal with the rest: TyVarTy &lt; CoercionTy &lt; AppTy &lt; LitTy &lt; TyConApp &lt; ForAllTy</span><span>
</span><span id="line-2303"></span><span>    </span><span class="annot"><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812242"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812242"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621680812241"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812241"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-2304"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; TypeOrdering
</span><a href="#local-6989586621680812299"><span class="hs-identifier hs-var">liftOrdering</span></a></span><span> </span><span class="annot"><span class="annottext">(Ordering -&gt; TypeOrdering) -&gt; Ordering -&gt; TypeOrdering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Int
</span><a href="#local-6989586621680812240"><span class="hs-identifier hs-var">get_rank</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812242"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Int
</span><a href="#local-6989586621680812240"><span class="hs-identifier hs-var">get_rank</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812241"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2305"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="#local-6989586621680812240"><span class="hs-identifier hs-type">get_rank</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-2306"></span><span>            </span><span id="local-6989586621680812240"><span class="annot"><span class="annottext">get_rank :: Type -&gt; Int
</span><a href="#local-6989586621680812240"><span class="hs-identifier hs-var hs-var">get_rank</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2307"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Int
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nonDetCmpTypeX.get_rank&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812242"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812241"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2308"></span><span>            </span><span class="annot"><a href="#local-6989586621680812240"><span class="hs-identifier hs-var">get_rank</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2309"></span><span>            </span><span class="annot"><a href="#local-6989586621680812240"><span class="hs-identifier hs-var">get_rank</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2310"></span><span>            </span><span class="annot"><a href="#local-6989586621680812240"><span class="hs-identifier hs-var">get_rank</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-2311"></span><span>            </span><span class="annot"><a href="#local-6989586621680812240"><span class="hs-identifier hs-var">get_rank</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-2312"></span><span>            </span><span class="annot"><a href="#local-6989586621680812240"><span class="hs-identifier hs-var">get_rank</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-2313"></span><span>            </span><span class="annot"><a href="#local-6989586621680812240"><span class="hs-identifier hs-var">get_rank</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-2314"></span><span>            </span><span class="annot"><a href="#local-6989586621680812240"><span class="hs-identifier hs-var">get_rank</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-2315"></span><span>
</span><span id="line-2316"></span><span>    </span><span class="annot"><a href="#local-6989586621680812252"><span class="hs-identifier hs-type">gos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a></span><span>
</span><span id="line-2317"></span><span>    </span><span id="local-6989586621680812252"><span class="annot"><span class="annottext">gos :: RnEnv2 -&gt; [Type] -&gt; [Type] -&gt; TypeOrdering
</span><a href="#local-6989586621680812252"><span class="hs-identifier hs-var hs-var">gos</span></a></span></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span><span>
</span><span id="line-2318"></span><span>    </span><span class="annot"><a href="#local-6989586621680812252"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TLT"><span class="hs-identifier hs-var">TLT</span></a></span><span>
</span><span id="line-2319"></span><span>    </span><span class="annot"><a href="#local-6989586621680812252"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrdering
</span><a href="GHC.Core.Type.html#TGT"><span class="hs-identifier hs-var">TGT</span></a></span><span>
</span><span id="line-2320"></span><span>    </span><span class="annot"><a href="#local-6989586621680812252"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span id="local-6989586621680812239"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812239"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812238"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812238"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680812237"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812237"><span class="hs-identifier hs-var">tys1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812236"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812236"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680812235"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812235"><span class="hs-identifier hs-var">tys2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; TypeOrdering
</span><a href="#local-6989586621680812306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812239"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812238"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812236"><span class="hs-identifier hs-var">ty2</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrdering -&gt; TypeOrdering -&gt; TypeOrdering
</span><a href="#local-6989586621680812298"><span class="hs-operator hs-var">`thenCmpTy`</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; [Type] -&gt; [Type] -&gt; TypeOrdering
</span><a href="#local-6989586621680812252"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812239"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812237"><span class="hs-identifier hs-var">tys1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812235"><span class="hs-identifier hs-var">tys2</span></a></span><span>
</span><span id="line-2321"></span><span>
</span><span id="line-2322"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-2323"></span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpTypesX"><span class="hs-identifier hs-type">nonDetCmpTypesX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span>
</span><span id="line-2324"></span><span id="nonDetCmpTypesX"><span class="annot"><span class="annottext">nonDetCmpTypesX :: RnEnv2 -&gt; [Type] -&gt; [Type] -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpTypesX"><span class="hs-identifier hs-var hs-var">nonDetCmpTypesX</span></a></span></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-2325"></span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpTypesX"><span class="hs-identifier hs-var">nonDetCmpTypesX</span></a></span><span> </span><span id="local-6989586621680812234"><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812234"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812233"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812233"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680812232"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812232"><span class="hs-identifier hs-var">tys1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812231"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812231"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621680812230"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812230"><span class="hs-identifier hs-var">tys2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnEnv2 -&gt; Type -&gt; Type -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpTypeX"><span class="hs-identifier hs-var">nonDetCmpTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812234"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812233"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812231"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2326"></span><span>                                          </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Ordering
</span><a href="GHC.Utils.Misc.html#thenCmp"><span class="hs-operator hs-var">`thenCmp`</span></a></span><span>
</span><span id="line-2327"></span><span>                                          </span><span class="annot"><span class="annottext">RnEnv2 -&gt; [Type] -&gt; [Type] -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpTypesX"><span class="hs-identifier hs-var">nonDetCmpTypesX</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><a href="#local-6989586621680812234"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812232"><span class="hs-identifier hs-var">tys1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812230"><span class="hs-identifier hs-var">tys2</span></a></span><span>
</span><span id="line-2328"></span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpTypesX"><span class="hs-identifier hs-var">nonDetCmpTypesX</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-2329"></span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpTypesX"><span class="hs-identifier hs-var">nonDetCmpTypesX</span></a></span><span> </span><span class="annot"><span class="annottext">RnEnv2
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-2330"></span><span>
</span><span id="line-2331"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-2332"></span><span class="hs-comment">-- | Compare two 'TyCon's. NB: This should /never/ see 'Constraint' (as</span><span>
</span><span id="line-2333"></span><span class="hs-comment">-- recognized by Kind.isConstraintKindCon) which is considered a synonym for</span><span>
</span><span id="line-2334"></span><span class="hs-comment">-- 'Type' in Core.</span><span>
</span><span id="line-2335"></span><span class="hs-comment">-- See Note [Kind Constraint and kind Type] in &quot;GHC.Core.Type&quot;.</span><span>
</span><span id="line-2336"></span><span class="hs-comment">-- See Note [nonDetCmpType nondeterminism]</span><span>
</span><span id="line-2337"></span><span class="annot"><a href="GHC.Core.Type.html#nonDetCmpTc"><span class="hs-identifier hs-type">nonDetCmpTc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span>
</span><span id="line-2338"></span><span id="nonDetCmpTc"><span class="annot"><span class="annottext">nonDetCmpTc :: TyCon -&gt; TyCon -&gt; Ordering
</span><a href="GHC.Core.Type.html#nonDetCmpTc"><span class="hs-identifier hs-var hs-var">nonDetCmpTc</span></a></span></span><span> </span><span id="local-6989586621680812228"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812228"><span class="hs-identifier hs-var">tc1</span></a></span></span><span> </span><span id="local-6989586621680812227"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812227"><span class="hs-identifier hs-var">tc2</span></a></span></span><span>
</span><span id="line-2339"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isConstraintKindCon</span><span> </span><span class="hs-identifier">tc1</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isConstraintKindCon</span><span> </span><span class="hs-identifier">tc2</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-2340"></span><span>    </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680812226"><span class="hs-identifier hs-var">u1</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Ordering
</span><a href="GHC.Types.Unique.html#nonDetCmpUnique"><span class="hs-operator hs-var">`nonDetCmpUnique`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680812225"><span class="hs-identifier hs-var">u2</span></a></span><span>
</span><span id="line-2341"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2342"></span><span>    </span><span id="local-6989586621680812226"><span class="annot"><span class="annottext">u1 :: Unique
</span><a href="#local-6989586621680812226"><span class="hs-identifier hs-var hs-var">u1</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique
</span><a href="GHC.Core.TyCon.html#tyConUnique"><span class="hs-identifier hs-var hs-var">tyConUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812228"><span class="hs-identifier hs-var">tc1</span></a></span><span>
</span><span id="line-2343"></span><span>    </span><span id="local-6989586621680812225"><span class="annot"><span class="annottext">u2 :: Unique
</span><a href="#local-6989586621680812225"><span class="hs-identifier hs-var hs-var">u2</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique
</span><a href="GHC.Core.TyCon.html#tyConUnique"><span class="hs-identifier hs-var hs-var">tyConUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812227"><span class="hs-identifier hs-var">tc2</span></a></span><span>
</span><span id="line-2344"></span><span>
</span><span id="line-2345"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
        The kind of a type
*                                                                      *
************************************************************************

Note [typeKind vs tcTypeKind]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We have two functions to get the kind of a type

  * typeKind   ignores  the distinction between Constraint and *
  * tcTypeKind respects the distinction between Constraint and *

tcTypeKind is used by the type inference engine, for which Constraint
and * are different; after that we use typeKind.

See also Note [coreView vs tcView]

Note [Kinding rules for types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In typeKind we consider Constraint and (TYPE LiftedRep) to be identical.
We then have

         t1 : TYPE rep1
         t2 : TYPE rep2
   (FUN) ----------------
         t1 -&gt; t2 : Type

         ty : TYPE rep
         `a` is not free in rep
(FORALL) -----------------------
         forall a. ty : TYPE rep

In tcTypeKind we consider Constraint and (TYPE LiftedRep) to be distinct:

          t1 : TYPE rep1
          t2 : TYPE rep2
    (FUN) ----------------
          t1 -&gt; t2 : Type

          t1 : Constraint
          t2 : TYPE rep
  (PRED1) ----------------
          t1 =&gt; t2 : Type

          t1 : Constraint
          t2 : Constraint
  (PRED2) ---------------------
          t1 =&gt; t2 : Constraint

          ty : TYPE rep
          `a` is not free in rep
(FORALL1) -----------------------
          forall a. ty : TYPE rep

          ty : Constraint
(FORALL2) -------------------------
          forall a. ty : Constraint

Note that:
* The only way we distinguish '-&gt;' from '=&gt;' is by the fact
  that the argument is a PredTy.  Both are FunTys

Note [Phantom type variables in kinds]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider

  type K (r :: RuntimeRep) = Type   -- Note 'r' is unused
  data T r :: K r                   -- T :: forall r -&gt; K r
  foo :: forall r. T r

The body of the forall in foo's type has kind (K r), and
normally it would make no sense to have
   forall r. (ty :: K r)
because the kind of the forall would escape the binding
of 'r'.  But in this case it's fine because (K r) exapands
to Type, so we explicitly /permit/ the type
   forall r. T r

To accommodate such a type, in typeKind (forall a.ty) we use
occCheckExpand to expand any type synonyms in the kind of 'ty'
to eliminate 'a'.  See kinding rule (FORALL) in
Note [Kinding rules for types]

See also
 * GHC.Core.Type.occCheckExpand
 * GHC.Core.Utils.coreAltsType
 * GHC.Tc.Validity.checkEscapingKind
all of which grapple with the same problem.

See #14939.
-}</span><span>
</span><span id="line-2438"></span><span>
</span><span id="line-2439"></span><span class="hs-comment">-----------------------------</span><span>
</span><span id="line-2440"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-type">typeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>
</span><span id="line-2441"></span><span class="hs-comment">-- No need to expand synonyms</span><span>
</span><span id="line-2442"></span><span id="typeKind"><span class="annot"><span class="annottext">typeKind :: HasDebugCallStack =&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var hs-var">typeKind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812215"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812215"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680812214"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812214"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier hs-var hs-var">tyConKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812215"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812214"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2443"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621680812213"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680812213"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><a href="GHC.Core.Type.html#typeLiteralKind"><span class="hs-identifier hs-var">typeLiteralKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680812213"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-2444"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span>
</span><span id="line-2445"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680812211"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812211"><span class="hs-identifier hs-var">tyvar</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812211"><span class="hs-identifier hs-var">tyvar</span></a></span><span>
</span><span id="line-2446"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680812210"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812210"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span id="local-6989586621680812209"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812209"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionRKind"><span class="hs-identifier hs-var">coercionRKind</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812209"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2447"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621680812208"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812208"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812208"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2448"></span><span>
</span><span id="line-2449"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680812207"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812207"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621680812206"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812206"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2450"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621680812205"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812207"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812206"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2451"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2452"></span><span>    </span><span class="hs-comment">-- Accumulate the type arguments, so we can call piResultTys,</span><span>
</span><span id="line-2453"></span><span>    </span><span class="hs-comment">-- rather than a succession of calls to piResultTy (which is</span><span>
</span><span id="line-2454"></span><span>    </span><span class="hs-comment">-- asymptotically costly as the number of arguments increases)</span><span>
</span><span id="line-2455"></span><span>    </span><span id="local-6989586621680812205"><span class="annot"><span class="annottext">go :: Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621680812205"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680812202"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812202"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621680812201"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812201"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812200"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812200"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621680812205"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812202"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812201"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812200"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2456"></span><span>    </span><span class="annot"><a href="#local-6989586621680812205"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812199"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812199"><span class="hs-identifier hs-var">fun</span></a></span></span><span>             </span><span id="local-6989586621680812198"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812198"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812199"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812198"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2457"></span><span>
</span><span id="line-2458"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span id="local-6989586621680812197"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680812197"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2459"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#occCheckExpand"><span class="hs-identifier hs-var">occCheckExpand</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812196"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812195"><span class="hs-identifier hs-var">body_kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2460"></span><span>      </span><span class="hs-comment">-- We must make sure tv does not occur in kind</span><span>
</span><span id="line-2461"></span><span>      </span><span class="hs-comment">-- As it is already out of scope!</span><span>
</span><span id="line-2462"></span><span>      </span><span class="hs-comment">-- See Note [Phantom type variables in kinds]</span><span>
</span><span id="line-2463"></span><span>      </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812194"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812194"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812194"><span class="hs-identifier hs-var">k'</span></a></span><span>
</span><span id="line-2464"></span><span>      </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typeKind&quot;</span></span><span>
</span><span id="line-2465"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812197"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812196"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812193"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812195"><span class="hs-identifier hs-var">body_kind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2466"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2467"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680812196"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812196"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812193"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812193"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TyVar], Type)
</span><a href="GHC.Core.Type.html#splitTyVarForAllTys"><span class="hs-identifier hs-var">splitTyVarForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812197"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2468"></span><span>    </span><span id="local-6989586621680812195"><span class="annot"><span class="annottext">body_kind :: Type
</span><a href="#local-6989586621680812195"><span class="hs-identifier hs-var hs-var">body_kind</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812193"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-2469"></span><span>
</span><span id="line-2470"></span><span class="hs-comment">---------------------------------------------</span><span>
</span><span id="line-2471"></span><span class="hs-comment">-- Utilities to be used in GHC.Core.Unify,</span><span>
</span><span id="line-2472"></span><span class="hs-comment">-- which uses &quot;tc&quot; functions</span><span>
</span><span id="line-2473"></span><span class="hs-comment">---------------------------------------------</span><span>
</span><span id="line-2474"></span><span>
</span><span id="line-2475"></span><span class="annot"><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-type">tcTypeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>
</span><span id="line-2476"></span><span class="hs-comment">-- No need to expand synonyms</span><span>
</span><span id="line-2477"></span><span id="tcTypeKind"><span class="annot"><span class="annottext">tcTypeKind :: HasDebugCallStack =&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-var hs-var">tcTypeKind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812182"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812182"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680812181"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812181"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier hs-var hs-var">tyConKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812182"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812181"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2478"></span><span class="annot"><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-var">tcTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621680812180"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680812180"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><a href="GHC.Core.Type.html#typeLiteralKind"><span class="hs-identifier hs-var">typeLiteralKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621680812180"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-2479"></span><span class="annot"><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-var">tcTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680812179"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812179"><span class="hs-identifier hs-var">tyvar</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812179"><span class="hs-identifier hs-var">tyvar</span></a></span><span>
</span><span id="line-2480"></span><span class="annot"><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-var">tcTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680812178"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812178"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span id="local-6989586621680812177"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812177"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionRKind"><span class="hs-identifier hs-var">coercionRKind</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812177"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2481"></span><span class="annot"><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-var">tcTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621680812176"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812176"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812176"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2482"></span><span>
</span><span id="line-2483"></span><span class="annot"><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-var">tcTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; AnonArgFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812175"><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680812175"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812174"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812174"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2484"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="GHC.Types.Var.html#InvisArg"><span class="hs-identifier hs-var">InvisArg</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621680812175"><span class="hs-identifier hs-var">af</span></a></span><span>
</span><span id="line-2485"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#tcIsConstraintKind"><span class="hs-identifier hs-var">tcIsConstraintKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-var">tcTypeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812174"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2486"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#constraintKind"><span class="hs-identifier hs-var">constraintKind</span></a></span><span>     </span><span class="hs-comment">-- Eq a =&gt; Ord a         :: Constraint</span><span>
</span><span id="line-2487"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>          </span><span class="hs-comment">-- Eq a =&gt; a -&gt; a        :: TYPE LiftedRep</span><span>
</span><span id="line-2488"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span>     </span><span class="hs-comment">-- Eq a =&gt; Array# Int    :: Type LiftedRep (not TYPE PtrRep)</span><span>
</span><span id="line-2489"></span><span>
</span><span id="line-2490"></span><span class="annot"><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-var">tcTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680812173"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812173"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621680812172"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812172"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2491"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621680812171"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812173"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812172"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2492"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2493"></span><span>    </span><span class="hs-comment">-- Accumulate the type arguments, so we can call piResultTys,</span><span>
</span><span id="line-2494"></span><span>    </span><span class="hs-comment">-- rather than a succession of calls to piResultTy (which is</span><span>
</span><span id="line-2495"></span><span>    </span><span class="hs-comment">-- asymptotically costly as the number of arguments increases)</span><span>
</span><span id="line-2496"></span><span>    </span><span id="local-6989586621680812171"><span class="annot"><span class="annottext">go :: Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621680812171"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680812168"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812168"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621680812167"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812167"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812166"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812166"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621680812171"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812168"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812167"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812166"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2497"></span><span>    </span><span class="annot"><a href="#local-6989586621680812171"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812165"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812165"><span class="hs-identifier hs-var">fun</span></a></span></span><span>             </span><span id="local-6989586621680812164"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812164"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-var">tcTypeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812165"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812164"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2498"></span><span>
</span><span id="line-2499"></span><span class="annot"><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-var">tcTypeKind</span></a></span><span> </span><span id="local-6989586621680812163"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680812163"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2500"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#tcIsConstraintKind"><span class="hs-identifier hs-var">tcIsConstraintKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812162"><span class="hs-identifier hs-var">body_kind</span></a></span><span>
</span><span id="line-2501"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#constraintKind"><span class="hs-identifier hs-var">constraintKind</span></a></span><span>
</span><span id="line-2502"></span><span>
</span><span id="line-2503"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2504"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#occCheckExpand"><span class="hs-identifier hs-var">occCheckExpand</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812161"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812162"><span class="hs-identifier hs-var">body_kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2505"></span><span>      </span><span class="hs-comment">-- We must make sure tv does not occur in kind</span><span>
</span><span id="line-2506"></span><span>      </span><span class="hs-comment">-- As it is already out of scope!</span><span>
</span><span id="line-2507"></span><span>      </span><span class="hs-comment">-- See Note [Phantom type variables in kinds]</span><span>
</span><span id="line-2508"></span><span>      </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812160"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812160"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812160"><span class="hs-identifier hs-var">k'</span></a></span><span>
</span><span id="line-2509"></span><span>      </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcTypeKind&quot;</span></span><span>
</span><span id="line-2510"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812163"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812161"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812159"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812162"><span class="hs-identifier hs-var">body_kind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2511"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2512"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680812161"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812161"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812159"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812159"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TyVar], Type)
</span><a href="GHC.Core.Type.html#splitTyVarForAllTys"><span class="hs-identifier hs-var">splitTyVarForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812163"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2513"></span><span>    </span><span id="local-6989586621680812162"><span class="annot"><span class="annottext">body_kind :: Type
</span><a href="#local-6989586621680812162"><span class="hs-identifier hs-var hs-var">body_kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-var">tcTypeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812159"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-2514"></span><span>
</span><span id="line-2515"></span><span>
</span><span id="line-2516"></span><span class="annot"><a href="GHC.Core.Type.html#isPredTy"><span class="hs-identifier hs-type">isPredTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2517"></span><span class="hs-comment">-- See Note [Types for coercions, predicates, and evidence] in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-2518"></span><span id="isPredTy"><span class="annot"><span class="annottext">isPredTy :: HasDebugCallStack =&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isPredTy"><span class="hs-identifier hs-var hs-var">isPredTy</span></a></span></span><span> </span><span id="local-6989586621680812155"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812155"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#tcIsConstraintKind"><span class="hs-identifier hs-var">tcIsConstraintKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#tcTypeKind"><span class="hs-identifier hs-var">tcTypeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812155"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2519"></span><span>
</span><span id="line-2520"></span><span class="hs-comment">-- tcIsConstraintKind stuff only makes sense in the typechecker</span><span>
</span><span id="line-2521"></span><span class="hs-comment">-- After that Constraint = Type</span><span>
</span><span id="line-2522"></span><span class="hs-comment">-- See Note [coreView vs tcView]</span><span>
</span><span id="line-2523"></span><span class="hs-comment">-- Defined here because it is used in isPredTy and tcRepSplitAppTy_maybe (sigh)</span><span>
</span><span id="line-2524"></span><span class="annot"><a href="GHC.Core.Type.html#tcIsConstraintKind"><span class="hs-identifier hs-type">tcIsConstraintKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2525"></span><span id="tcIsConstraintKind"><span class="annot"><span class="annottext">tcIsConstraintKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#tcIsConstraintKind"><span class="hs-identifier hs-var hs-var">tcIsConstraintKind</span></a></span></span><span> </span><span id="local-6989586621680812154"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812154"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2526"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812153"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812153"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812152"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812152"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812154"><span class="hs-identifier hs-var">ty</span></a></span><span>    </span><span class="hs-comment">-- Note: tcSplit here</span><span>
</span><span id="line-2527"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isConstraintKindCon"><span class="hs-identifier hs-var">isConstraintKindCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812153"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2528"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">args</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-2529"></span><span>
</span><span id="line-2530"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2531"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2532"></span><span>
</span><span id="line-2533"></span><span class="hs-comment">-- | Is this kind equivalent to @*@?</span><span>
</span><span id="line-2534"></span><span class="hs-comment">--</span><span>
</span><span id="line-2535"></span><span class="hs-comment">-- This considers 'Constraint' to be distinct from @*@. For a version that</span><span>
</span><span id="line-2536"></span><span class="hs-comment">-- treats them as the same type, see 'isLiftedTypeKind'.</span><span>
</span><span id="line-2537"></span><span class="annot"><a href="GHC.Core.Type.html#tcIsLiftedTypeKind"><span class="hs-identifier hs-type">tcIsLiftedTypeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2538"></span><span id="tcIsLiftedTypeKind"><span class="annot"><span class="annottext">tcIsLiftedTypeKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#tcIsLiftedTypeKind"><span class="hs-identifier hs-var hs-var">tcIsLiftedTypeKind</span></a></span></span><span> </span><span id="local-6989586621680812151"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812151"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2539"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812150"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812150"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680812149"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812149"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812151"><span class="hs-identifier hs-var">ty</span></a></span><span>    </span><span class="hs-comment">-- Note: tcSplit here</span><span>
</span><span id="line-2540"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812150"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#tYPETyConKey"><span class="hs-identifier hs-var">tYPETyConKey</span></a></span><span>
</span><span id="line-2541"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedRuntimeRep"><span class="hs-identifier hs-var">isLiftedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812149"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2542"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2543"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2544"></span><span>
</span><span id="line-2545"></span><span class="hs-comment">-- | Is this kind equivalent to @TYPE r@ (for some unknown r)?</span><span>
</span><span id="line-2546"></span><span class="hs-comment">--</span><span>
</span><span id="line-2547"></span><span class="hs-comment">-- This considers 'Constraint' to be distinct from @*@.</span><span>
</span><span id="line-2548"></span><span class="annot"><a href="GHC.Core.Type.html#tcIsRuntimeTypeKind"><span class="hs-identifier hs-type">tcIsRuntimeTypeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2549"></span><span id="tcIsRuntimeTypeKind"><span class="annot"><span class="annottext">tcIsRuntimeTypeKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#tcIsRuntimeTypeKind"><span class="hs-identifier hs-var hs-var">tcIsRuntimeTypeKind</span></a></span></span><span> </span><span id="local-6989586621680812148"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812148"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2550"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680812147"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812147"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812148"><span class="hs-identifier hs-var">ty</span></a></span><span>    </span><span class="hs-comment">-- Note: tcSplit here</span><span>
</span><span id="line-2551"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812147"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#tYPETyConKey"><span class="hs-identifier hs-var">tYPETyConKey</span></a></span><span>
</span><span id="line-2552"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2553"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2554"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2555"></span><span>
</span><span id="line-2556"></span><span class="annot"><a href="GHC.Core.Type.html#tcReturnsConstraintKind"><span class="hs-identifier hs-type">tcReturnsConstraintKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2557"></span><span class="hs-comment">-- True &lt;=&gt; the Kind ultimately returns a Constraint</span><span>
</span><span id="line-2558"></span><span class="hs-comment">--   E.g.  * -&gt; Constraint</span><span>
</span><span id="line-2559"></span><span class="hs-comment">--         forall k. k -&gt; Constraint</span><span>
</span><span id="line-2560"></span><span id="tcReturnsConstraintKind"><span class="annot"><span class="annottext">tcReturnsConstraintKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#tcReturnsConstraintKind"><span class="hs-identifier hs-var hs-var">tcReturnsConstraintKind</span></a></span></span><span> </span><span id="local-6989586621680812146"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812146"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-2561"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812145"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812145"><span class="hs-identifier hs-var">kind'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#tcView"><span class="hs-identifier hs-var">tcView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812146"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#tcReturnsConstraintKind"><span class="hs-identifier hs-var">tcReturnsConstraintKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812145"><span class="hs-identifier hs-var">kind'</span></a></span><span>
</span><span id="line-2562"></span><span class="annot"><a href="GHC.Core.Type.html#tcReturnsConstraintKind"><span class="hs-identifier hs-var">tcReturnsConstraintKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812144"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812144"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#tcReturnsConstraintKind"><span class="hs-identifier hs-var">tcReturnsConstraintKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812144"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2563"></span><span class="annot"><a href="GHC.Core.Type.html#tcReturnsConstraintKind"><span class="hs-identifier hs-var">tcReturnsConstraintKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680812143"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812143"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#tcReturnsConstraintKind"><span class="hs-identifier hs-var">tcReturnsConstraintKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812143"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2564"></span><span class="annot"><a href="GHC.Core.Type.html#tcReturnsConstraintKind"><span class="hs-identifier hs-var">tcReturnsConstraintKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812142"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812142"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isConstraintKindCon"><span class="hs-identifier hs-var">isConstraintKindCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812142"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2565"></span><span class="annot"><a href="GHC.Core.Type.html#tcReturnsConstraintKind"><span class="hs-identifier hs-var">tcReturnsConstraintKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2566"></span><span>
</span><span id="line-2567"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-2568"></span><span class="annot"><a href="GHC.Core.Type.html#typeLiteralKind"><span class="hs-identifier hs-type">typeLiteralKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>
</span><span id="line-2569"></span><span id="typeLiteralKind"><span class="annot"><span class="annottext">typeLiteralKind :: TyLit -&gt; Type
</span><a href="GHC.Core.Type.html#typeLiteralKind"><span class="hs-identifier hs-var hs-var">typeLiteralKind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NumTyLit"><span class="hs-identifier hs-type">NumTyLit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#typeNatKind"><span class="hs-identifier hs-var">typeNatKind</span></a></span><span>
</span><span id="line-2570"></span><span class="annot"><a href="GHC.Core.Type.html#typeLiteralKind"><span class="hs-identifier hs-var">typeLiteralKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#StrTyLit"><span class="hs-identifier hs-type">StrTyLit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#typeSymbolKind"><span class="hs-identifier hs-var">typeSymbolKind</span></a></span><span>
</span><span id="line-2571"></span><span>
</span><span id="line-2572"></span><span class="hs-comment">-- | Returns True if a type is levity polymorphic. Should be the same</span><span>
</span><span id="line-2573"></span><span class="hs-comment">-- as (isKindLevPoly . typeKind) but much faster.</span><span>
</span><span id="line-2574"></span><span class="hs-comment">-- Precondition: The type has kind (TYPE blah)</span><span>
</span><span id="line-2575"></span><span class="annot"><a href="GHC.Core.Type.html#isTypeLevPoly"><span class="hs-identifier hs-type">isTypeLevPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2576"></span><span id="isTypeLevPoly"><span class="annot"><span class="annottext">isTypeLevPoly :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTypeLevPoly"><span class="hs-identifier hs-var hs-var">isTypeLevPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621680812141"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-2577"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2578"></span><span>    </span><span id="local-6989586621680812141"><span class="annot"><span class="annottext">go :: Type -&gt; Bool
</span><a href="#local-6989586621680812141"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680812137"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680812137"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621680812136"><span class="hs-identifier hs-var">check_kind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812137"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2579"></span><span>    </span><span class="annot"><a href="#local-6989586621680812141"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812135"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680812135"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621680812136"><span class="hs-identifier hs-var">check_kind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812135"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2580"></span><span>    </span><span class="annot"><a href="#local-6989586621680812141"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812134"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680812134"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812133"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812133"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTcLevPoly"><span class="hs-identifier hs-var">isTcLevPoly</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812133"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2581"></span><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621680812136"><span class="hs-identifier hs-var">check_kind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812134"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2582"></span><span>    </span><span class="annot"><a href="#local-6989586621680812141"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812131"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812131"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621680812141"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812131"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2583"></span><span>    </span><span class="annot"><a href="#local-6989586621680812141"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2584"></span><span>    </span><span class="annot"><a href="#local-6989586621680812141"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2585"></span><span>    </span><span class="annot"><a href="#local-6989586621680812141"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812130"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680812130"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621680812136"><span class="hs-identifier hs-var">check_kind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812130"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2586"></span><span>    </span><span class="annot"><a href="#local-6989586621680812141"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812129"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680812129"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Bool
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;isTypeLevPoly co&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812129"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2587"></span><span>
</span><span id="line-2588"></span><span>    </span><span id="local-6989586621680812136"><span class="annot"><span class="annottext">check_kind :: Type -&gt; Bool
</span><a href="#local-6989586621680812136"><span class="hs-identifier hs-var hs-var">check_kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isKindLevPoly"><span class="hs-identifier hs-var">isKindLevPoly</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (Type -&gt; Type) -&gt; Type -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span>
</span><span id="line-2589"></span><span>
</span><span id="line-2590"></span><span class="hs-comment">-- | Looking past all pi-types, is the end result potentially levity polymorphic?</span><span>
</span><span id="line-2591"></span><span class="hs-comment">-- Example: True for (forall r (a :: TYPE r). String -&gt; a)</span><span>
</span><span id="line-2592"></span><span class="hs-comment">-- Example: False for (forall r1 r2 (a :: TYPE r1) (b :: TYPE r2). a -&gt; b -&gt; Type)</span><span>
</span><span id="line-2593"></span><span class="annot"><a href="GHC.Core.Type.html#resultIsLevPoly"><span class="hs-identifier hs-type">resultIsLevPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2594"></span><span id="resultIsLevPoly"><span class="annot"><span class="annottext">resultIsLevPoly :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#resultIsLevPoly"><span class="hs-identifier hs-var hs-var">resultIsLevPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTypeLevPoly"><span class="hs-identifier hs-var">isTypeLevPoly</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (Type -&gt; Type) -&gt; Type -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([TyCoBinder], Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><a href="../../base/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(([TyCoBinder], Type) -&gt; Type)
-&gt; (Type -&gt; ([TyCoBinder], Type)) -&gt; Type -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TyCoBinder], Type)
</span><a href="GHC.Core.Type.html#splitPiTys"><span class="hs-identifier hs-var">splitPiTys</span></a></span><span>
</span><span id="line-2595"></span><span>
</span><span id="line-2596"></span><span>
</span><span id="line-2597"></span><span class="hs-comment">{- **********************************************************************
*                                                                       *
           Occurs check expansion
%*                                                                      *
%********************************************************************* -}</span><span>
</span><span id="line-2602"></span><span>
</span><span id="line-2603"></span><span class="hs-comment">{- Note [Occurs check expansion]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
(occurCheckExpand tv xi) expands synonyms in xi just enough to get rid
of occurrences of tv outside type function arguments, if that is
possible; otherwise, it returns Nothing.

For example, suppose we have
  type F a b = [a]
Then
  occCheckExpand b (F Int b) = Just [Int]
but
  occCheckExpand a (F a Int) = Nothing

We don't promise to do the absolute minimum amount of expanding
necessary, but we try not to do expansions we don't need to.  We
prefer doing inner expansions first.  For example,
  type F a b = (a, Int, a, [a])
  type G b   = Char
We have
  occCheckExpand b (F (G b)) = Just (F Char)
even though we could also expand F to get rid of b.
-}</span><span>
</span><span id="line-2625"></span><span>
</span><span id="line-2626"></span><span class="annot"><a href="GHC.Core.Type.html#occCheckExpand"><span class="hs-identifier hs-type">occCheckExpand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-2627"></span><span class="hs-comment">-- See Note [Occurs check expansion]</span><span>
</span><span id="line-2628"></span><span class="hs-comment">-- We may have needed to do some type synonym unfolding in order to</span><span>
</span><span id="line-2629"></span><span class="hs-comment">-- get rid of the variable (or forall), so we also return the unfolded</span><span>
</span><span id="line-2630"></span><span class="hs-comment">-- version of the type, which is guaranteed to be syntactically free</span><span>
</span><span id="line-2631"></span><span class="hs-comment">-- of the given type variable.  If the type is already syntactically</span><span>
</span><span id="line-2632"></span><span class="hs-comment">-- free of the variable, then the same type is returned.</span><span>
</span><span id="line-2633"></span><span id="occCheckExpand"><span class="annot"><span class="annottext">occCheckExpand :: [TyVar] -&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#occCheckExpand"><span class="hs-identifier hs-var hs-var">occCheckExpand</span></a></span></span><span> </span><span id="local-6989586621680812127"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812127"><span class="hs-identifier hs-var">vs_to_avoid</span></a></span></span><span> </span><span id="local-6989586621680812126"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812126"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2634"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812127"><span class="hs-identifier hs-var">vs_to_avoid</span></a></span><span>  </span><span class="hs-comment">-- Efficient shortcut</span><span>
</span><span id="line-2635"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812126"><span class="hs-identifier hs-var">ty</span></a></span><span>           </span><span class="hs-comment">-- Can happen, eg. GHC.Core.Utils.mkSingleAltCase</span><span>
</span><span id="line-2636"></span><span>
</span><span id="line-2637"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2638"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#mkVarSet"><span class="hs-identifier hs-var">mkVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680812127"><span class="hs-identifier hs-var">vs_to_avoid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarEnv TyVar
forall a. VarEnv a
</span><a href="GHC.Types.Var.Env.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812126"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2639"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2640"></span><span>    </span><span class="annot"><a href="#local-6989586621680812125"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Set.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#VarEnv"><span class="hs-identifier hs-type">VarEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-2641"></span><span>          </span><span class="hs-comment">-- The VarSet is the set of variables we are trying to avoid</span><span>
</span><span id="line-2642"></span><span>          </span><span class="hs-comment">-- The VarEnv carries mappings necessary</span><span>
</span><span id="line-2643"></span><span>          </span><span class="hs-comment">-- because of kind expansion</span><span>
</span><span id="line-2644"></span><span>    </span><span id="local-6989586621680812125"><span class="annot"><span class="annottext">go :: (TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680812123"><span class="annot"><span class="annottext">cxt :: (TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812123"><span class="hs-identifier hs-var">cxt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621680812122"><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812122"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812121"><span class="annot"><span class="annottext">VarEnv TyVar
</span><a href="#local-6989586621680812121"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680812120"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812120"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2645"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812120"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TyCoVarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812122"><span class="hs-keyword hs-var">as</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2646"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812119"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812119"><span class="hs-identifier hs-var">tv''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VarEnv TyVar -&gt; TyVar -&gt; Maybe TyVar
forall a. VarEnv a -&gt; TyVar -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv TyVar
</span><a href="#local-6989586621680812121"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812120"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812119"><span class="hs-identifier hs-var">tv''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2647"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680812117"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812117"><span class="hs-identifier hs-var">tv''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; TyVar -&gt; Maybe TyVar
</span><a href="#local-6989586621680812116"><span class="hs-identifier hs-var">go_var</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812123"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812120"><span class="hs-identifier hs-var">tv'</span></a></span><span>
</span><span id="line-2648"></span><span>                                               </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812117"><span class="hs-identifier hs-var">tv''</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2649"></span><span>
</span><span id="line-2650"></span><span>    </span><span class="annot"><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621680812115"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680812115"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812115"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2651"></span><span>    </span><span class="annot"><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812114"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812114"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680812113"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812113"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621680812112"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812112"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680812111"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812111"><span class="hs-identifier hs-var">ty1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812114"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812113"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2652"></span><span>                                </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680812110"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812110"><span class="hs-identifier hs-var">ty2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812114"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812112"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-2653"></span><span>                                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812111"><span class="hs-identifier hs-var">ty1'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812110"><span class="hs-identifier hs-var">ty2'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2654"></span><span>    </span><span class="annot"><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812109"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812109"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621680812108"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680812108"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680812107"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812107"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680812106"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812106"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621680812105"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812105"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2655"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680812104"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812104"><span class="hs-identifier hs-var">w'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812109"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812107"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-2656"></span><span>            </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680812103"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812103"><span class="hs-identifier hs-var">ty1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812109"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812106"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2657"></span><span>            </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680812102"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812102"><span class="hs-identifier hs-var">ty2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812109"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812105"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-2658"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812108"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812104"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812103"><span class="hs-identifier hs-var">ty1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812102"><span class="hs-identifier hs-var">ty2'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2659"></span><span>    </span><span class="annot"><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812101"><span class="annot"><span class="annottext">cxt :: (TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812101"><span class="hs-identifier hs-var">cxt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621680812100"><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812100"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680812099"><span class="annot"><span class="annottext">VarEnv TyVar
</span><a href="#local-6989586621680812099"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680812098"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812098"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680812097"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812097"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680812096"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812096"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2660"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680812095"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812095"><span class="hs-identifier hs-var">ki'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812101"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812098"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2661"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680812094"><span class="annot"><span class="annottext">tv' :: TyVar
</span><a href="#local-6989586621680812094"><span class="hs-identifier hs-var hs-var">tv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type -&gt; TyVar
</span><a href="GHC.Types.Var.html#setVarType"><span class="hs-identifier hs-var">setVarType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812098"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812095"><span class="hs-identifier hs-var">ki'</span></a></span><span>
</span><span id="line-2662"></span><span>                  </span><span id="local-6989586621680812092"><span class="annot"><span class="annottext">env' :: VarEnv TyVar
</span><a href="#local-6989586621680812092"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarEnv TyVar -&gt; TyVar -&gt; TyVar -&gt; VarEnv TyVar
forall a. VarEnv a -&gt; TyVar -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv TyVar
</span><a href="#local-6989586621680812099"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812098"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812094"><span class="hs-identifier hs-var">tv'</span></a></span><span>
</span><span id="line-2663"></span><span>                  </span><span id="local-6989586621680812090"><span class="annot"><span class="annottext">as' :: TyCoVarSet
</span><a href="#local-6989586621680812090"><span class="hs-identifier hs-var hs-var">as'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812100"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyVar -&gt; TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#delVarSet"><span class="hs-operator hs-var">`delVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812098"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-2664"></span><span>            </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680812089"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812089"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680812090"><span class="hs-identifier hs-var">as'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarEnv TyVar
</span><a href="#local-6989586621680812092"><span class="hs-identifier hs-var">env'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812096"><span class="hs-identifier hs-var">body_ty</span></a></span><span>
</span><span id="line-2665"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ArgFlag -&gt; VarBndr TyVar ArgFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812094"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680812097"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812089"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2666"></span><span>
</span><span id="line-2667"></span><span>    </span><span class="hs-comment">-- For a type constructor application, first try expanding away the</span><span>
</span><span id="line-2668"></span><span>    </span><span class="hs-comment">-- offending variable from the arguments.  If that doesn't work, next</span><span>
</span><span id="line-2669"></span><span>    </span><span class="hs-comment">-- see if the type constructor is a type synonym, and if so, expand</span><span>
</span><span id="line-2670"></span><span>    </span><span class="hs-comment">-- it and try again.</span><span>
</span><span id="line-2671"></span><span>    </span><span class="annot"><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812088"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812088"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621680812087"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680812087"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680812086"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812086"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680812085"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812085"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2672"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe Type) -&gt; [Type] -&gt; Maybe [Type]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812088"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812085"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2673"></span><span>          </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812083"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812083"><span class="hs-identifier hs-var">tys'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680812086"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680812083"><span class="hs-identifier hs-var">tys'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2674"></span><span>          </span><span class="annot"><span class="annottext">Maybe [Type]
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680812082"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812082"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#tcView"><span class="hs-identifier hs-var">tcView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812087"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812088"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812082"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2675"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2676"></span><span>                      </span><span class="hs-comment">-- Failing that, try to expand a synonym</span><span>
</span><span id="line-2677"></span><span>
</span><span id="line-2678"></span><span>    </span><span class="annot"><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812081"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812081"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680812080"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812080"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680812079"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812079"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680812078"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812078"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812081"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812080"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2679"></span><span>                                </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680812077"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812077"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812081"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812079"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2680"></span><span>                                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812078"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812077"><span class="hs-identifier hs-var">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2681"></span><span>    </span><span class="annot"><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680812075"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812075"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621680812074"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812074"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680812073"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812073"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812075"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812074"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2682"></span><span>                                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCoercionTy"><span class="hs-identifier hs-var">mkCoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812073"><span class="hs-identifier hs-var">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2683"></span><span>
</span><span id="line-2684"></span><span>    </span><span class="hs-comment">------------------</span><span>
</span><span id="line-2685"></span><span>    </span><span id="local-6989586621680812116"><span class="annot"><span class="annottext">go_var :: (TyCoVarSet, VarEnv TyVar) -&gt; TyVar -&gt; Maybe TyVar
</span><a href="#local-6989586621680812116"><span class="hs-identifier hs-var hs-var">go_var</span></a></span></span><span> </span><span id="local-6989586621680812071"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812071"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621680812070"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812070"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe Type) -&gt; TyVar -&gt; Maybe TyVar
forall (m :: * -&gt; *).
Monad m =&gt;
(Type -&gt; m Type) -&gt; TyVar -&gt; m TyVar
</span><a href="GHC.Types.Var.html#updateVarTypeM"><span class="hs-identifier hs-var">updateVarTypeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812071"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680812070"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-2686"></span><span>           </span><span class="hs-comment">-- Works for TyVar and CoVar</span><span>
</span><span id="line-2687"></span><span>           </span><span class="hs-comment">-- See Note [Occurrence checking: look inside kinds]</span><span>
</span><span id="line-2688"></span><span>
</span><span id="line-2689"></span><span>    </span><span class="hs-comment">------------------</span><span>
</span><span id="line-2690"></span><span>    </span><span id="local-6989586621680812007"><span class="annot"><span class="annottext">go_mco :: (TyCoVarSet, VarEnv TyVar) -&gt; MCoercionN -&gt; Maybe MCoercionN
</span><a href="#local-6989586621680812007"><span class="hs-identifier hs-var hs-var">go_mco</span></a></span></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MCoercionN -&gt; Maybe MCoercionN
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>
</span><span id="line-2691"></span><span>    </span><span class="annot"><a href="#local-6989586621680812007"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span id="local-6989586621680812006"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812006"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621680812005"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812005"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-var">MCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; MCoercionN)
-&gt; Maybe KindCoercion -&gt; Maybe MCoercionN
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812006"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680812005"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2692"></span><span>
</span><span id="line-2693"></span><span>    </span><span class="hs-comment">------------------</span><span>
</span><span id="line-2694"></span><span>    </span><span id="local-6989586621680812076"><span class="annot"><span class="annottext">go_co :: (TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var hs-var">go_co</span></a></span></span><span> </span><span id="local-6989586621680812004"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812004"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span id="local-6989586621680812003"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812003"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680812002"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812002"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812004"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812003"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2695"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkNomReflCo"><span class="hs-identifier hs-var">mkNomReflCo</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680812002"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2696"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680812001"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812001"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span id="local-6989586621680812000"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680812000"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680811999"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811999"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680811998"><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621680811998"><span class="hs-identifier hs-var">mco</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811997"><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621680811997"><span class="hs-identifier hs-var">mco'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; MCoercionN -&gt; Maybe MCoercionN
</span><a href="#local-6989586621680812007"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812001"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621680811998"><span class="hs-identifier hs-var">mco</span></a></span><span>
</span><span id="line-2697"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680811996"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811996"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680812001"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811999"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2698"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; MCoercionN -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkGReflCo"><span class="hs-identifier hs-var">mkGReflCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680812000"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811996"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621680811997"><span class="hs-identifier hs-var">mco'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2699"></span><span>      </span><span class="hs-comment">-- Note: Coercions do not contain type synonyms</span><span>
</span><span id="line-2700"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811995"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811995"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span id="local-6989586621680811994"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680811994"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680811993"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811993"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680811992"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811992"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811991"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811991"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; Maybe KindCoercion)
-&gt; [KindCoercion] -&gt; Maybe [KindCoercion]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811995"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811992"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2701"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-var">mkTyConAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680811994"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811993"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811991"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2702"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811990"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811990"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621680811989"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811989"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621680811988"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811988"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811987"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811987"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811990"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811989"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2703"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680811986"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811986"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811990"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811988"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2704"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkAppCo"><span class="hs-identifier hs-var">mkAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811987"><span class="hs-identifier hs-var">co'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811986"><span class="hs-identifier hs-var">arg'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2705"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811985"><span class="annot"><span class="annottext">cxt :: (TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811985"><span class="hs-identifier hs-var">cxt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621680811984"><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811984"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811983"><span class="annot"><span class="annottext">VarEnv TyVar
</span><a href="#local-6989586621680811983"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span id="local-6989586621680811982"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811982"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680811981"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811981"><span class="hs-identifier hs-var">kind_co</span></a></span></span><span> </span><span id="local-6989586621680811980"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811980"><span class="hs-identifier hs-var">body_co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2706"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811979"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811979"><span class="hs-identifier hs-var">kind_co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811985"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811981"><span class="hs-identifier hs-var">kind_co</span></a></span><span>
</span><span id="line-2707"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680811978"><span class="annot"><span class="annottext">tv' :: TyVar
</span><a href="#local-6989586621680811978"><span class="hs-identifier hs-var hs-var">tv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type -&gt; TyVar
</span><a href="GHC.Types.Var.html#setVarType"><span class="hs-identifier hs-var">setVarType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811982"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TyVar) -&gt; Type -&gt; TyVar
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-2708"></span><span>                       </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionLKind"><span class="hs-identifier hs-var">coercionLKind</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811979"><span class="hs-identifier hs-var">kind_co'</span></a></span><span>
</span><span id="line-2709"></span><span>                 </span><span id="local-6989586621680811977"><span class="annot"><span class="annottext">env' :: VarEnv TyVar
</span><a href="#local-6989586621680811977"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarEnv TyVar -&gt; TyVar -&gt; TyVar -&gt; VarEnv TyVar
forall a. VarEnv a -&gt; TyVar -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv TyVar
</span><a href="#local-6989586621680811983"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811982"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811978"><span class="hs-identifier hs-var">tv'</span></a></span><span>
</span><span id="line-2710"></span><span>                 </span><span id="local-6989586621680811976"><span class="annot"><span class="annottext">as' :: TyCoVarSet
</span><a href="#local-6989586621680811976"><span class="hs-identifier hs-var hs-var">as'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811984"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyVar -&gt; TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#delVarSet"><span class="hs-operator hs-var">`delVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811982"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-2711"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680811975"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811975"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811976"><span class="hs-identifier hs-var">as'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarEnv TyVar
</span><a href="#local-6989586621680811977"><span class="hs-identifier hs-var">env'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811980"><span class="hs-identifier hs-var">body_co</span></a></span><span>
</span><span id="line-2712"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-var">ForAllCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811978"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811979"><span class="hs-identifier hs-var">kind_co'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811975"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2713"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811974"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811974"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span id="local-6989586621680811973"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680811973"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680811972"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811972"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680811971"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811971"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621680811970"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811970"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811969"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811969"><span class="hs-identifier hs-var">co1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811974"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811971"><span class="hs-identifier hs-var">co1</span></a></span><span>
</span><span id="line-2714"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680811968"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811968"><span class="hs-identifier hs-var">co2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811974"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811970"><span class="hs-identifier hs-var">co2</span></a></span><span>
</span><span id="line-2715"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680811967"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811967"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811974"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811972"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-2716"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role
-&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkFunCo"><span class="hs-identifier hs-var">mkFunCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680811973"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811967"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811969"><span class="hs-identifier hs-var">co1'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811968"><span class="hs-identifier hs-var">co2'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2717"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811966"><span class="annot"><span class="annottext">cxt :: (TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811966"><span class="hs-identifier hs-var">cxt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621680811965"><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811965"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680811964"><span class="annot"><span class="annottext">VarEnv TyVar
</span><a href="#local-6989586621680811964"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span id="local-6989586621680811963"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811963"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2718"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811963"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TyCoVarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811965"><span class="hs-keyword hs-var">as</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe KindCoercion
forall a. Maybe a
</span><a href="../../base/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2719"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680811962"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811962"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VarEnv TyVar -&gt; TyVar -&gt; Maybe TyVar
forall a. VarEnv a -&gt; TyVar -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv TyVar
</span><a href="#local-6989586621680811964"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811963"><span class="hs-identifier hs-var">c</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811962"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2720"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811961"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811961"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; TyVar -&gt; Maybe TyVar
</span><a href="#local-6989586621680812116"><span class="hs-identifier hs-var">go_var</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811966"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811963"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-2721"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811961"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2722"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811960"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811960"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span id="local-6989586621680811959"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621680811959"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811958"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811958"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; TyVar -&gt; Maybe TyVar
</span><a href="#local-6989586621680812116"><span class="hs-identifier hs-var">go_var</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811960"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoercionHole -&gt; TyVar
</span><a href="GHC.Core.TyCo.Rep.html#ch_co_var"><span class="hs-identifier hs-var hs-var">ch_co_var</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621680811959"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2723"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoercionHole -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-var">HoleCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621680811959"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ch_co_var :: TyVar
</span><a href="GHC.Core.TyCo.Rep.html#ch_co_var"><span class="hs-identifier hs-var">ch_co_var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811958"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2724"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811956"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811956"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomInstCo"><span class="hs-identifier hs-type">AxiomInstCo</span></a></span><span> </span><span id="local-6989586621680811955"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621680811955"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621680811954"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680811954"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621680811953"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811953"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811952"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811952"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; Maybe KindCoercion)
-&gt; [KindCoercion] -&gt; Maybe [KindCoercion]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811956"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811953"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2725"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; Int -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkAxiomInstCo"><span class="hs-identifier hs-var">mkAxiomInstCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621680811955"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680811954"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811952"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2726"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811951"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811951"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span id="local-6989586621680811950"><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680811950"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680811949"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680811949"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680811948"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811948"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621680811947"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811947"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811946"><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680811946"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
-&gt; UnivCoProvenance -&gt; Maybe UnivCoProvenance
</span><a href="#local-6989586621680811945"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811951"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680811950"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-2727"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680811944"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811944"><span class="hs-identifier hs-var">ty1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811951"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811948"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2728"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680811943"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811943"><span class="hs-identifier hs-var">ty2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621680812125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811951"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811947"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-2729"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; Role -&gt; Type -&gt; Type -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkUnivCo"><span class="hs-identifier hs-var">mkUnivCo</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680811946"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680811949"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811944"><span class="hs-identifier hs-var">ty1'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811943"><span class="hs-identifier hs-var">ty2'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2730"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811942"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811942"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621680811941"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811941"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811940"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811940"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811942"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811941"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2731"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811940"><span class="hs-identifier hs-var">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2732"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811939"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811939"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621680811938"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811938"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621680811937"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811937"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811936"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811936"><span class="hs-identifier hs-var">co1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811939"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811938"><span class="hs-identifier hs-var">co1</span></a></span><span>
</span><span id="line-2733"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680811935"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811935"><span class="hs-identifier hs-var">co2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811939"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811937"><span class="hs-identifier hs-var">co2</span></a></span><span>
</span><span id="line-2734"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811936"><span class="hs-identifier hs-var">co1'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811935"><span class="hs-identifier hs-var">co2'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2735"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811934"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811934"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NthCo"><span class="hs-identifier hs-type">NthCo</span></a></span><span> </span><span id="local-6989586621680811933"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680811933"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680811932"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680811932"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680811931"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811931"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811930"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811930"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811934"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811931"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2736"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Role -&gt; Int -&gt; KindCoercion -&gt; KindCoercion
Role -&gt; Int -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkNthCo"><span class="hs-identifier hs-var">mkNthCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621680811933"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680811932"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811930"><span class="hs-identifier hs-var">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2737"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811929"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811929"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span id="local-6989586621680811928"><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621680811928"><span class="hs-identifier hs-var">lr</span></a></span></span><span> </span><span id="local-6989586621680811927"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811927"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811926"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811926"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811929"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811927"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2738"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftOrRight -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkLRCo"><span class="hs-identifier hs-var">mkLRCo</span></a></span><span> </span><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621680811928"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811926"><span class="hs-identifier hs-var">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2739"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811925"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811925"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621680811924"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811924"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621680811923"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811923"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811922"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811922"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811925"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811924"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2740"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621680811921"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811921"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811925"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811923"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2741"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkInstCo"><span class="hs-identifier hs-var">mkInstCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811922"><span class="hs-identifier hs-var">co'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811921"><span class="hs-identifier hs-var">arg'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2742"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811920"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811920"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621680811919"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811919"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811918"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811918"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811920"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811919"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2743"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkKindCo"><span class="hs-identifier hs-var">mkKindCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811918"><span class="hs-identifier hs-var">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2744"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811917"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811917"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621680811916"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811916"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811915"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811915"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811917"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811916"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2745"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkSubCo"><span class="hs-identifier hs-var">mkSubCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811915"><span class="hs-identifier hs-var">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2746"></span><span>    </span><span class="annot"><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621680811914"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811914"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomRuleCo"><span class="hs-identifier hs-type">AxiomRuleCo</span></a></span><span> </span><span id="local-6989586621680811913"><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621680811913"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621680811912"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811912"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680811911"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811911"><span class="hs-identifier hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; Maybe KindCoercion)
-&gt; [KindCoercion] -&gt; Maybe [KindCoercion]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811914"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811912"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-2747"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiomRule -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkAxiomRuleCo"><span class="hs-identifier hs-var">mkAxiomRuleCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621680811913"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811911"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2748"></span><span>
</span><span id="line-2749"></span><span>    </span><span class="hs-comment">------------------</span><span>
</span><span id="line-2750"></span><span>    </span><span id="local-6989586621680811945"><span class="annot"><span class="annottext">go_prov :: (TyCoVarSet, VarEnv TyVar)
-&gt; UnivCoProvenance -&gt; Maybe UnivCoProvenance
</span><a href="#local-6989586621680811945"><span class="hs-identifier hs-var hs-var">go_prov</span></a></span></span><span> </span><span id="local-6989586621680811910"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811910"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PhantomProv"><span class="hs-identifier hs-type">PhantomProv</span></a></span><span> </span><span id="local-6989586621680811909"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811909"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; UnivCoProvenance)
-&gt; Maybe KindCoercion -&gt; Maybe UnivCoProvenance
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811910"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811909"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2751"></span><span>    </span><span class="annot"><a href="#local-6989586621680811945"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span id="local-6989586621680811908"><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811908"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ProofIrrelProv"><span class="hs-identifier hs-type">ProofIrrelProv</span></a></span><span> </span><span id="local-6989586621680811907"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811907"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; UnivCoProvenance)
-&gt; Maybe KindCoercion -&gt; Maybe UnivCoProvenance
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar) -&gt; KindCoercion -&gt; Maybe KindCoercion
</span><a href="#local-6989586621680812076"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><a href="#local-6989586621680811908"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811907"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2752"></span><span>    </span><span class="annot"><a href="#local-6989586621680811945"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621680811906"><span class="annot"><span class="annottext">p :: UnivCoProvenance
</span><a href="#local-6989586621680811906"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PluginProv"><span class="hs-identifier hs-type">PluginProv</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; Maybe UnivCoProvenance
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680811906"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-2753"></span><span>    </span><span class="annot"><a href="#local-6989586621680811945"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet, VarEnv TyVar)
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621680811905"><span class="annot"><span class="annottext">p :: UnivCoProvenance
</span><a href="#local-6989586621680811905"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#CorePrepProv"><span class="hs-identifier hs-var">CorePrepProv</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; Maybe UnivCoProvenance
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680811905"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-2754"></span><span>
</span><span id="line-2755"></span><span>
</span><span id="line-2756"></span><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
        Miscellaneous functions
%*                                                                      *
%************************************************************************

-}</span><span>
</span><span id="line-2764"></span><span class="hs-comment">-- | All type constructors occurring in the type; looking through type</span><span>
</span><span id="line-2765"></span><span class="hs-comment">--   synonyms, but not newtypes.</span><span>
</span><span id="line-2766"></span><span class="hs-comment">--  When it finds a Class, it returns the class TyCon.</span><span>
</span><span id="line-2767"></span><span class="annot"><a href="GHC.Core.Type.html#tyConsOfType"><span class="hs-identifier hs-type">tyConsOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Set.html#UniqSet"><span class="hs-identifier hs-type">UniqSet</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-2768"></span><span id="tyConsOfType"><span class="annot"><span class="annottext">tyConsOfType :: Type -&gt; UniqSet TyCon
</span><a href="GHC.Core.Type.html#tyConsOfType"><span class="hs-identifier hs-var hs-var">tyConsOfType</span></a></span></span><span> </span><span id="local-6989586621680811904"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811904"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2769"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811904"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2770"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2771"></span><span>     </span><span class="annot"><a href="#local-6989586621680811903"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Set.html#UniqSet"><span class="hs-identifier hs-type">UniqSet</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>  </span><span class="hs-comment">-- The UniqSet does duplicate elim</span><span>
</span><span id="line-2772"></span><span>     </span><span id="local-6989586621680811903"><span class="annot"><span class="annottext">go :: Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680811902"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811902"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680811901"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811901"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811902"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811901"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2773"></span><span>     </span><span class="annot"><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-2774"></span><span>     </span><span class="annot"><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-2775"></span><span>     </span><span class="annot"><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680811899"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811899"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680811898"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680811898"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; UniqSet TyCon
forall {a}. Uniquable a =&gt; a -&gt; UniqSet a
</span><a href="#local-6989586621680811897"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811899"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; UniqSet TyCon
forall {t :: * -&gt; *}. Foldable t =&gt; t Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811895"><span class="hs-identifier hs-var">go_s</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680811898"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2776"></span><span>     </span><span class="annot"><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680811894"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811894"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680811893"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811893"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811894"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811893"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2777"></span><span>     </span><span class="annot"><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811892"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811892"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680811891"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811891"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680811890"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811890"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811892"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span>
</span><span id="line-2778"></span><span>                                      </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811891"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811890"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; UniqSet TyCon
forall {a}. Uniquable a =&gt; a -&gt; UniqSet a
</span><a href="#local-6989586621680811897"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a></span><span>
</span><span id="line-2779"></span><span>     </span><span class="annot"><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680811889"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811889"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680811888"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811888"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811888"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811889"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2780"></span><span>     </span><span class="annot"><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680811887"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811887"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680811886"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811886"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811887"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811886"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2781"></span><span>     </span><span class="annot"><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621680811884"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811884"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811884"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2782"></span><span>
</span><span id="line-2783"></span><span>     </span><span id="local-6989586621680811885"><span class="annot"><span class="annottext">go_co :: KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var hs-var">go_co</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span id="local-6989586621680811881"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811881"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811881"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2784"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811880"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811880"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680811879"><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621680811879"><span class="hs-identifier hs-var">mco</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811880"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercionN -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811878"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621680811879"><span class="hs-identifier hs-var">mco</span></a></span><span>
</span><span id="line-2785"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811877"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811877"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680811876"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811876"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; UniqSet TyCon
forall {a}. Uniquable a =&gt; a -&gt; UniqSet a
</span><a href="#local-6989586621680811897"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811877"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion] -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811875"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811876"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2786"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621680811874"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811874"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621680811873"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811873"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811874"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811873"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2787"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811872"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811872"><span class="hs-identifier hs-var">kind_co</span></a></span></span><span> </span><span id="local-6989586621680811871"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811871"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811872"><span class="hs-identifier hs-var">kind_co</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811871"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2788"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811870"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811870"><span class="hs-identifier hs-var">co_mult</span></a></span></span><span> </span><span id="local-6989586621680811869"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811869"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621680811868"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811868"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811870"><span class="hs-identifier hs-var">co_mult</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811869"><span class="hs-identifier hs-var">co1</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811868"><span class="hs-identifier hs-var">co2</span></a></span><span>
</span><span id="line-2789"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomInstCo"><span class="hs-identifier hs-type">AxiomInstCo</span></a></span><span> </span><span id="local-6989586621680811867"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621680811867"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811866"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811866"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; UniqSet TyCon
forall {br :: BranchFlag}. CoAxiom br -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811865"><span class="hs-identifier hs-var">go_ax</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621680811867"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion] -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811875"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811866"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2790"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span id="local-6989586621680811864"><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680811864"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811863"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811863"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680811862"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811862"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811861"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621680811864"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811863"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811862"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2791"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-2792"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-2793"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621680811860"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811860"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811860"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2794"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621680811859"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811859"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621680811858"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811858"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811859"><span class="hs-identifier hs-var">co1</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811858"><span class="hs-identifier hs-var">co2</span></a></span><span>
</span><span id="line-2795"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NthCo"><span class="hs-identifier hs-type">NthCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811857"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811857"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811857"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2796"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span class="annot"><span class="annottext">LeftOrRight
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811856"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811856"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811856"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2797"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621680811855"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811855"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621680811854"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811854"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811855"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811854"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2798"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621680811853"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811853"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811853"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2799"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621680811852"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811852"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811852"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2800"></span><span>     </span><span class="annot"><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomRuleCo"><span class="hs-identifier hs-type">AxiomRuleCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811851"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811851"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[KindCoercion] -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811875"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811851"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-2801"></span><span>
</span><span id="line-2802"></span><span>     </span><span id="local-6989586621680811878"><span class="annot"><span class="annottext">go_mco :: MCoercionN -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811878"><span class="hs-identifier hs-var hs-var">go_mco</span></a></span></span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-2803"></span><span>     </span><span class="annot"><a href="#local-6989586621680811878"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621680811850"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811850"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811850"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2804"></span><span>
</span><span id="line-2805"></span><span>     </span><span id="local-6989586621680811861"><span class="annot"><span class="annottext">go_prov :: UnivCoProvenance -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811861"><span class="hs-identifier hs-var hs-var">go_prov</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PhantomProv"><span class="hs-identifier hs-type">PhantomProv</span></a></span><span> </span><span id="local-6989586621680811849"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811849"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811849"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2806"></span><span>     </span><span class="annot"><a href="#local-6989586621680811861"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ProofIrrelProv"><span class="hs-identifier hs-type">ProofIrrelProv</span></a></span><span> </span><span id="local-6989586621680811848"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811848"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811848"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2807"></span><span>     </span><span class="annot"><a href="#local-6989586621680811861"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PluginProv"><span class="hs-identifier hs-type">PluginProv</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-2808"></span><span>     </span><span class="annot"><a href="#local-6989586621680811861"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#CorePrepProv"><span class="hs-identifier hs-var">CorePrepProv</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-2809"></span><span>        </span><span class="hs-comment">-- this last case can happen from the tyConsOfType used from</span><span>
</span><span id="line-2810"></span><span>        </span><span class="hs-comment">-- checkTauTvUpdate</span><span>
</span><span id="line-2811"></span><span>
</span><span id="line-2812"></span><span>     </span><span id="local-6989586621680811895"><span class="annot"><span class="annottext">go_s :: t Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811895"><span class="hs-identifier hs-var hs-var">go_s</span></a></span></span><span> </span><span id="local-6989586621680811845"><span class="annot"><span class="annottext">t Type
</span><a href="#local-6989586621680811845"><span class="hs-identifier hs-var">tys</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; UniqSet TyCon -&gt; UniqSet TyCon)
-&gt; UniqSet TyCon -&gt; t Type -&gt; UniqSet TyCon
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a></span><span> </span><span class="annot"><span class="annottext">(UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon)
-&gt; (Type -&gt; UniqSet TyCon)
-&gt; Type
-&gt; UniqSet TyCon
-&gt; UniqSet TyCon
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811903"><span class="hs-identifier hs-var">go</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span> </span><span class="annot"><span class="annottext">t Type
</span><a href="#local-6989586621680811845"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2813"></span><span>     </span><span id="local-6989586621680811875"><span class="annot"><span class="annottext">go_cos :: [KindCoercion] -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811875"><span class="hs-identifier hs-var hs-var">go_cos</span></a></span></span><span> </span><span id="local-6989586621680811844"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811844"><span class="hs-identifier hs-var">cos</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; UniqSet TyCon -&gt; UniqSet TyCon)
-&gt; UniqSet TyCon -&gt; [KindCoercion] -&gt; UniqSet TyCon
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a></span><span> </span><span class="annot"><span class="annottext">(UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon)
-&gt; (KindCoercion -&gt; UniqSet TyCon)
-&gt; KindCoercion
-&gt; UniqSet TyCon
-&gt; UniqSet TyCon
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811885"><span class="hs-identifier hs-var">go_co</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621680811844"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-2814"></span><span>
</span><span id="line-2815"></span><span>     </span><span id="local-6989586621680811897"><span class="annot"><span class="annottext">go_tc :: a -&gt; UniqSet a
</span><a href="#local-6989586621680811897"><span class="hs-identifier hs-var hs-var">go_tc</span></a></span></span><span> </span><span id="local-6989586621680811841"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811841"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; UniqSet a
forall {a}. Uniquable a =&gt; a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unitUniqSet"><span class="hs-identifier hs-var">unitUniqSet</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811841"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2816"></span><span>     </span><span id="local-6989586621680811865"><span class="annot"><span class="annottext">go_ax :: CoAxiom br -&gt; UniqSet TyCon
</span><a href="#local-6989586621680811865"><span class="hs-identifier hs-var hs-var">go_ax</span></a></span></span><span> </span><span id="local-6989586621680811838"><span class="annot"><span class="annottext">CoAxiom br
</span><a href="#local-6989586621680811838"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; UniqSet TyCon
forall {a}. Uniquable a =&gt; a -&gt; UniqSet a
</span><a href="#local-6989586621680811897"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; UniqSet TyCon) -&gt; TyCon -&gt; UniqSet TyCon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom br -&gt; TyCon
forall (br :: BranchFlag). CoAxiom br -&gt; TyCon
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom br
</span><a href="#local-6989586621680811838"><span class="hs-identifier hs-var">ax</span></a></span><span>
</span><span id="line-2817"></span><span>
</span><span id="line-2818"></span><span class="hs-comment">-- | Find the result 'Kind' of a type synonym,</span><span>
</span><span id="line-2819"></span><span class="hs-comment">-- after applying it to its 'arity' number of type variables</span><span>
</span><span id="line-2820"></span><span class="hs-comment">-- Actually this function works fine on data types too,</span><span>
</span><span id="line-2821"></span><span class="hs-comment">-- but they'd always return '*', so we never need to ask</span><span>
</span><span id="line-2822"></span><span class="annot"><a href="GHC.Core.Type.html#synTyConResKind"><span class="hs-identifier hs-type">synTyConResKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>
</span><span id="line-2823"></span><span id="synTyConResKind"><span class="annot"><span class="annottext">synTyConResKind :: TyCon -&gt; Type
</span><a href="GHC.Core.Type.html#synTyConResKind"><span class="hs-identifier hs-var hs-var">synTyConResKind</span></a></span></span><span> </span><span id="local-6989586621680811837"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811837"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier hs-var hs-var">tyConKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811837"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [TyVar]
</span><a href="GHC.Core.TyCon.html#tyConTyVars"><span class="hs-identifier hs-var hs-var">tyConTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811837"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2824"></span><span>
</span><span id="line-2825"></span><span class="hs-comment">-- | Retrieve the free variables in this type, splitting them based</span><span>
</span><span id="line-2826"></span><span class="hs-comment">-- on whether they are used visibly or invisibly. Invisible ones come</span><span>
</span><span id="line-2827"></span><span class="hs-comment">-- first.</span><span>
</span><span id="line-2828"></span><span class="annot"><a href="GHC.Core.Type.html#splitVisVarsOfType"><span class="hs-identifier hs-type">splitVisVarsOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-2829"></span><span id="splitVisVarsOfType"><span class="annot"><span class="annottext">splitVisVarsOfType :: Type -&gt; Pair TyCoVarSet
</span><a href="GHC.Core.Type.html#splitVisVarsOfType"><span class="hs-identifier hs-var hs-var">splitVisVarsOfType</span></a></span></span><span> </span><span id="local-6989586621680811836"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811836"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyCoVarSet -&gt; Pair TyCoVarSet
forall a. a -&gt; a -&gt; Pair a
</span><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811834"><span class="hs-identifier hs-var">invis_vars</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811833"><span class="hs-identifier hs-var">vis_vars</span></a></span><span>
</span><span id="line-2830"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2831"></span><span>    </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621680811832"><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811832"><span class="hs-identifier hs-var">invis_vars1</span></a></span></span><span> </span><span id="local-6989586621680811833"><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811833"><span class="hs-identifier hs-var">vis_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811836"><span class="hs-identifier hs-var">orig_ty</span></a></span><span>
</span><span id="line-2832"></span><span>    </span><span id="local-6989586621680811834"><span class="annot"><span class="annottext">invis_vars :: TyCoVarSet
</span><a href="#local-6989586621680811834"><span class="hs-identifier hs-var hs-var">invis_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811832"><span class="hs-identifier hs-var">invis_vars1</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyCoVarSet -&gt; TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#minusVarSet"><span class="hs-operator hs-var">`minusVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811833"><span class="hs-identifier hs-var">vis_vars</span></a></span><span>
</span><span id="line-2833"></span><span>
</span><span id="line-2834"></span><span>    </span><span id="local-6989586621680811831"><span class="annot"><span class="annottext">go :: Type -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811831"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621680811816"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811816"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyCoVarSet -&gt; Pair TyCoVarSet
forall a. a -&gt; a -&gt; Pair a
</span><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TyCoVarSet) -&gt; Type -&gt; TyCoVarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811816"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#unitVarSet"><span class="hs-identifier hs-var">unitVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811816"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2835"></span><span>    </span><span class="annot"><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621680811814"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811814"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680811813"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811813"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811814"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Pair TyCoVarSet -&gt; Pair TyCoVarSet -&gt; Pair TyCoVarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Base.html#mappend"><span class="hs-operator hs-var">`mappend`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811813"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2836"></span><span>    </span><span class="annot"><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680811812"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811812"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680811811"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680811811"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811810"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811812"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680811811"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2837"></span><span>    </span><span class="annot"><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811809"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811809"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680811808"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811808"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680811807"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811807"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811809"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Pair TyCoVarSet -&gt; Pair TyCoVarSet -&gt; Pair TyCoVarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Base.html#mappend"><span class="hs-operator hs-var">`mappend`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811808"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Pair TyCoVarSet -&gt; Pair TyCoVarSet -&gt; Pair TyCoVarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Base.html#mappend"><span class="hs-operator hs-var">`mappend`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811807"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2838"></span><span>    </span><span class="annot"><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680811806"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811806"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680811805"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811805"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2839"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyVar -&gt; TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#delVarSet"><span class="hs-operator hs-var">`delVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811806"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet -&gt; TyCoVarSet) -&gt; Pair TyCoVarSet -&gt; Pair TyCoVarSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811805"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pair TyCoVarSet -&gt; Pair TyCoVarSet -&gt; Pair TyCoVarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Base.html#mappend"><span class="hs-operator hs-var">`mappend`</span></a></span><span>
</span><span id="line-2840"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVarSet -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811804"><span class="hs-identifier hs-var">invisible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TyCoVarSet) -&gt; Type -&gt; TyCoVarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811806"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2841"></span><span>    </span><span class="annot"><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pair TyCoVarSet
forall a. Monoid a =&gt; a
</span><a href="../../base/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-2842"></span><span>    </span><span class="annot"><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621680811803"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811803"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680811802"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811802"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811803"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Pair TyCoVarSet -&gt; Pair TyCoVarSet -&gt; Pair TyCoVarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Base.html#mappend"><span class="hs-operator hs-var">`mappend`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811804"><span class="hs-identifier hs-var">invisible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811802"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2843"></span><span>    </span><span class="annot"><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621680811801"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811801"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811804"><span class="hs-identifier hs-var">invisible</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVarSet -&gt; Pair TyCoVarSet) -&gt; TyCoVarSet -&gt; Pair TyCoVarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621680811801"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2844"></span><span>
</span><span id="line-2845"></span><span>    </span><span id="local-6989586621680811804"><span class="annot"><span class="annottext">invisible :: TyCoVarSet -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811804"><span class="hs-identifier hs-var hs-var">invisible</span></a></span></span><span> </span><span id="local-6989586621680811800"><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811800"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyCoVarSet -&gt; Pair TyCoVarSet
forall a. a -&gt; a -&gt; Pair a
</span><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811800"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-2846"></span><span>
</span><span id="line-2847"></span><span>    </span><span id="local-6989586621680811810"><span class="annot"><span class="annottext">go_tc :: TyCon -&gt; [Type] -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811810"><span class="hs-identifier hs-var hs-var">go_tc</span></a></span></span><span> </span><span id="local-6989586621680811799"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811799"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680811798"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680811798"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680811797"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680811797"><span class="hs-identifier hs-var">invis</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811796"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680811796"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; ([Type], [Type])
</span><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier hs-var">partitionInvisibleTypes</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811799"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680811798"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-2848"></span><span>                   </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811804"><span class="hs-identifier hs-var">invisible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680811797"><span class="hs-identifier hs-var">invis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pair TyCoVarSet -&gt; Pair TyCoVarSet -&gt; Pair TyCoVarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../base/src/GHC.Base.html#mappend"><span class="hs-operator hs-var">`mappend`</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Pair TyCoVarSet) -&gt; [Type] -&gt; Pair TyCoVarSet
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../base/src/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair TyCoVarSet
</span><a href="#local-6989586621680811831"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680811796"><span class="hs-identifier hs-var">vis</span></a></span><span>
</span><span id="line-2849"></span><span>
</span><span id="line-2850"></span><span class="annot"><a href="GHC.Core.Type.html#splitVisVarsOfTypes"><span class="hs-identifier hs-type">splitVisVarsOfTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-2851"></span><span id="splitVisVarsOfTypes"><span class="annot"><span class="annottext">splitVisVarsOfTypes :: [Type] -&gt; Pair TyCoVarSet
</span><a href="GHC.Core.Type.html#splitVisVarsOfTypes"><span class="hs-identifier hs-var hs-var">splitVisVarsOfTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Pair TyCoVarSet) -&gt; [Type] -&gt; Pair TyCoVarSet
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../base/src/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair TyCoVarSet
</span><a href="GHC.Core.Type.html#splitVisVarsOfType"><span class="hs-identifier hs-var">splitVisVarsOfType</span></a></span><span>
</span><span id="line-2852"></span><span>
</span><span id="line-2853"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Functions over Kinds
*                                                                      *
************************************************************************

Note [Kind Constraint and kind Type]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The kind Constraint is the kind of classes and other type constraints.
The special thing about types of kind Constraint is that
 * They are displayed with double arrow:
     f :: Ord a =&gt; a -&gt; a
 * They are implicitly instantiated at call sites; so the type inference
   engine inserts an extra argument of type (Ord a) at every call site
   to f.

However, once type inference is over, there is *no* distinction between
Constraint and Type. Indeed we can have coercions between the two. Consider
   class C a where
     op :: a -&gt; a
For this single-method class we may generate a newtype, which in turn
generates an axiom witnessing
    C a ~ (a -&gt; a)
so on the left we have Constraint, and on the right we have Type.
See #7451.

Bottom line: although 'Type' and 'Constraint' are distinct TyCons, with
distinct uniques, they are treated as equal at all times except
during type inference.
-}</span><span>
</span><span id="line-2884"></span><span>
</span><span id="line-2885"></span><span class="hs-comment">-- | Tests whether the given kind (which should look like @TYPE x@)</span><span>
</span><span id="line-2886"></span><span class="hs-comment">-- is something other than a constructor tree (that is, constructors at every node).</span><span>
</span><span id="line-2887"></span><span class="hs-comment">-- E.g.  True of   TYPE k, TYPE (F Int)</span><span>
</span><span id="line-2888"></span><span class="hs-comment">--       False of  TYPE 'LiftedRep</span><span>
</span><span id="line-2889"></span><span class="annot"><a href="GHC.Core.Type.html#isKindLevPoly"><span class="hs-identifier hs-type">isKindLevPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2890"></span><span id="isKindLevPoly"><span class="annot"><span class="annottext">isKindLevPoly :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isKindLevPoly"><span class="hs-identifier hs-var hs-var">isKindLevPoly</span></a></span></span><span> </span><span id="local-6989586621680811794"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811794"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isLiftedTypeKind</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">_is_type</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-2891"></span><span>                    </span><span class="hs-comment">-- the isLiftedTypeKind check is necessary b/c of Constraint</span><span>
</span><span id="line-2892"></span><span>                  </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811794"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-2893"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2894"></span><span>    </span><span id="local-6989586621680811792"><span class="annot"><span class="annottext">go :: Type -&gt; Bool
</span><a href="#local-6989586621680811792"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680811790"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811790"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680811789"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811789"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811790"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811789"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2895"></span><span>    </span><span class="annot"><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2896"></span><span>    </span><span class="annot"><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-comment">-- it can't be a TyConApp</span><span>
</span><span id="line-2897"></span><span>    </span><span class="annot"><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621680811788"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811788"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680811787"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680811787"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isFamilyTyCon"><span class="hs-identifier hs-var">isFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811788"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base/src/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680811787"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2898"></span><span>    </span><span class="annot"><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2899"></span><span>    </span><span class="annot"><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811784"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811784"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680811783"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811783"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680811782"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811782"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811784"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811783"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811782"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2900"></span><span>    </span><span class="annot"><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2901"></span><span>    </span><span class="annot"><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2902"></span><span>    </span><span class="annot"><a href="#local-6989586621680811792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2903"></span><span>
</span><span id="line-2904"></span><span>    </span><span id="local-6989586621680811793"><span class="annot"><span class="annottext">_is_type :: Bool
</span><a href="#local-6989586621680811793"><span class="hs-identifier hs-var hs-var">_is_type</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#classifiesTypeWithValues"><span class="hs-identifier hs-var">classifiesTypeWithValues</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811794"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-2905"></span><span>
</span><span id="line-2906"></span><span class="hs-comment">-----------------------------------------</span><span>
</span><span id="line-2907"></span><span class="hs-comment">--              Subkinding</span><span>
</span><span id="line-2908"></span><span class="hs-comment">-- The tc variants are used during type-checking, where ConstraintKind</span><span>
</span><span id="line-2909"></span><span class="hs-comment">-- is distinct from all other kinds</span><span>
</span><span id="line-2910"></span><span class="hs-comment">-- After type-checking (in core), Constraint and liftedTypeKind are</span><span>
</span><span id="line-2911"></span><span class="hs-comment">-- indistinguishable</span><span>
</span><span id="line-2912"></span><span>
</span><span id="line-2913"></span><span class="hs-comment">-- | Does this classify a type allowed to have values? Responds True to things</span><span>
</span><span id="line-2914"></span><span class="hs-comment">-- like *, #, TYPE Lifted, TYPE v, Constraint.</span><span>
</span><span id="line-2915"></span><span class="annot"><a href="GHC.Core.Type.html#classifiesTypeWithValues"><span class="hs-identifier hs-type">classifiesTypeWithValues</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2916"></span><span class="hs-comment">-- ^ True of any sub-kind of OpenTypeKind</span><span>
</span><span id="line-2917"></span><span id="classifiesTypeWithValues"><span class="annot"><span class="annottext">classifiesTypeWithValues :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#classifiesTypeWithValues"><span class="hs-identifier hs-var hs-var">classifiesTypeWithValues</span></a></span></span><span> </span><span id="local-6989586621680811781"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811781"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../base/src/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-var">kindRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811781"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2918"></span><span>
</span><span id="line-2919"></span><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
         Pretty-printing
%*                                                                      *
%************************************************************************

Most pretty-printing is either in GHC.Core.TyCo.Rep or GHC.Iface.Type.

-}</span><span>
</span><span id="line-2929"></span><span>
</span><span id="line-2930"></span><span class="hs-comment">-- | Does a 'TyCon' (that is applied to some number of arguments) need to be</span><span>
</span><span id="line-2931"></span><span class="hs-comment">-- ascribed with an explicit kind signature to resolve ambiguity if rendered as</span><span>
</span><span id="line-2932"></span><span class="hs-comment">-- a source-syntax type?</span><span>
</span><span id="line-2933"></span><span class="hs-comment">-- (See @Note [When does a tycon application need an explicit kind signature?]@</span><span>
</span><span id="line-2934"></span><span class="hs-comment">-- for a full explanation of what this function checks for.)</span><span>
</span><span id="line-2935"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppNeedsKindSig"><span class="hs-identifier hs-type">tyConAppNeedsKindSig</span></a></span><span>
</span><span id="line-2936"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- ^ Should specified binders count towards injective positions in</span><span>
</span><span id="line-2937"></span><span>           </span><span class="hs-comment">--   the kind of the TyCon? (If you're using visible kind</span><span>
</span><span id="line-2938"></span><span>           </span><span class="hs-comment">--   applications, then you want True here.</span><span>
</span><span id="line-2939"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-2940"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>   </span><span class="hs-comment">-- ^ The number of args the 'TyCon' is applied to.</span><span>
</span><span id="line-2941"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- ^ Does @T t_1 ... t_n@ need a kind signature? (Where @n@ is the</span><span>
</span><span id="line-2942"></span><span>           </span><span class="hs-comment">--   number of arguments)</span><span>
</span><span id="line-2943"></span><span id="tyConAppNeedsKindSig"><span class="annot"><span class="annottext">tyConAppNeedsKindSig :: Bool -&gt; TyCon -&gt; Int -&gt; Bool
</span><a href="GHC.Core.Type.html#tyConAppNeedsKindSig"><span class="hs-identifier hs-var hs-var">tyConAppNeedsKindSig</span></a></span></span><span> </span><span id="local-6989586621680811780"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680811780"><span class="hs-identifier hs-var">spec_inj_pos</span></a></span></span><span> </span><span id="local-6989586621680811779"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811779"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680811778"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680811778"><span class="hs-identifier hs-var">n_args</span></a></span></span><span>
</span><span id="line-2944"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TyConBinder] -&gt; Int -&gt; Ordering
forall a. [a] -&gt; Int -&gt; Ordering
</span><a href="GHC.Utils.Misc.html#listLengthCmp"><span class="hs-identifier hs-var">listLengthCmp</span></a></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621680811776"><span class="hs-identifier hs-var">tc_binders</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680811778"><span class="hs-identifier hs-var">n_args</span></a></span><span>
</span><span id="line-2945"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2946"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2947"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680811775"><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621680811775"><span class="hs-identifier hs-var">dropped_binders</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811774"><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621680811774"><span class="hs-identifier hs-var">remaining_binders</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2948"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [TyConBinder] -&gt; ([TyConBinder], [TyConBinder])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><a href="../../base/src/GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680811778"><span class="hs-identifier hs-var">n_args</span></a></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621680811776"><span class="hs-identifier hs-var">tc_binders</span></a></span><span>
</span><span id="line-2949"></span><span>        </span><span id="local-6989586621680811773"><span class="annot"><span class="annottext">result_kind :: Type
</span><a href="#local-6989586621680811773"><span class="hs-identifier hs-var hs-var">result_kind</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyConBinder] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCon.html#mkTyConKind"><span class="hs-identifier hs-var">mkTyConKind</span></a></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621680811774"><span class="hs-identifier hs-var">remaining_binders</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811771"><span class="hs-identifier hs-var">tc_res_kind</span></a></span><span>
</span><span id="line-2950"></span><span>        </span><span id="local-6989586621680811770"><span class="annot"><span class="annottext">result_vars :: TyCoVarSet
</span><a href="#local-6989586621680811770"><span class="hs-identifier hs-var hs-var">result_vars</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811773"><span class="hs-identifier hs-var">result_kind</span></a></span><span>
</span><span id="line-2951"></span><span>        </span><span id="local-6989586621680811769"><span class="annot"><span class="annottext">dropped_vars :: TyCoVarSet
</span><a href="#local-6989586621680811769"><span class="hs-identifier hs-var hs-var">dropped_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV -&gt; TyCoVarSet
</span><a href="GHC.Utils.FV.html#fvVarSet"><span class="hs-identifier hs-var">fvVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; TyCoVarSet) -&gt; FV -&gt; TyCoVarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-2952"></span><span>                       </span><span class="annot"><span class="annottext">(TyConBinder -&gt; FV) -&gt; [TyConBinder] -&gt; FV
forall a. (a -&gt; FV) -&gt; [a] -&gt; FV
</span><a href="GHC.Utils.FV.html#mapUnionFV"><span class="hs-identifier hs-var">mapUnionFV</span></a></span><span> </span><span class="annot"><span class="annottext">TyConBinder -&gt; FV
</span><a href="#local-6989586621680811766"><span class="hs-identifier hs-var">injective_vars_of_binder</span></a></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621680811775"><span class="hs-identifier hs-var">dropped_binders</span></a></span><span>
</span><span id="line-2953"></span><span>
</span><span id="line-2954"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyCoVarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#subVarSet"><span class="hs-identifier hs-var">subVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811770"><span class="hs-identifier hs-var">result_vars</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621680811769"><span class="hs-identifier hs-var">dropped_vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2955"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2956"></span><span>    </span><span id="local-6989586621680811776"><span class="annot"><span class="annottext">tc_binders :: [TyConBinder]
</span><a href="#local-6989586621680811776"><span class="hs-identifier hs-var hs-var">tc_binders</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [TyConBinder]
</span><a href="GHC.Core.TyCon.html#tyConBinders"><span class="hs-identifier hs-var hs-var">tyConBinders</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811779"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2957"></span><span>    </span><span id="local-6989586621680811771"><span class="annot"><span class="annottext">tc_res_kind :: Type
</span><a href="#local-6989586621680811771"><span class="hs-identifier hs-var hs-var">tc_res_kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#tyConResKind"><span class="hs-identifier hs-var hs-var">tyConResKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811779"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2958"></span><span>
</span><span id="line-2959"></span><span>    </span><span class="hs-comment">-- Returns the variables that would be fixed by knowing a TyConBinder. See</span><span>
</span><span id="line-2960"></span><span>    </span><span class="hs-comment">-- Note [When does a tycon application need an explicit kind signature?]</span><span>
</span><span id="line-2961"></span><span>    </span><span class="hs-comment">-- for a more detailed explanation of what this function does.</span><span>
</span><span id="line-2962"></span><span>    </span><span class="annot"><a href="#local-6989586621680811766"><span class="hs-identifier hs-type">injective_vars_of_binder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-2963"></span><span>    </span><span id="local-6989586621680811766"><span class="annot"><span class="annottext">injective_vars_of_binder :: TyConBinder -&gt; FV
</span><a href="#local-6989586621680811766"><span class="hs-identifier hs-var hs-var">injective_vars_of_binder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621680811763"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811763"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680811762"><span class="annot"><span class="annottext">TyConBndrVis
</span><a href="#local-6989586621680811762"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2964"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyConBndrVis
</span><a href="#local-6989586621680811762"><span class="hs-identifier hs-var">vis</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2965"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCon.html#AnonTCB"><span class="hs-identifier hs-type">AnonTCB</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="GHC.Types.Var.html#VisArg"><span class="hs-identifier hs-var">VisArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#injectiveVarsOfType"><span class="hs-identifier hs-var">injectiveVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- conservative choice</span><span>
</span><span id="line-2966"></span><span>                                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811763"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2967"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCon.html#NamedTCB"><span class="hs-identifier hs-type">NamedTCB</span></a></span><span> </span><span id="local-6989586621680811760"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680811760"><span class="hs-identifier hs-var">argf</span></a></span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ArgFlag -&gt; Bool
</span><a href="#local-6989586621680811759"><span class="hs-identifier hs-var">source_of_injectivity</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621680811760"><span class="hs-identifier hs-var">argf</span></a></span><span>
</span><span id="line-2968"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; FV
</span><a href="GHC.Utils.FV.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811763"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span>
</span><span id="line-2969"></span><span>                          </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#injectiveVarsOfType"><span class="hs-identifier hs-var">injectiveVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621680811763"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2970"></span><span>        </span><span class="annot"><span class="annottext">TyConBndrVis
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="GHC.Utils.FV.html#emptyFV"><span class="hs-identifier hs-var">emptyFV</span></a></span><span>
</span><span id="line-2971"></span><span>
</span><span id="line-2972"></span><span>    </span><span id="local-6989586621680811759"><span class="annot"><span class="annottext">source_of_injectivity :: ArgFlag -&gt; Bool
</span><a href="#local-6989586621680811759"><span class="hs-identifier hs-var hs-var">source_of_injectivity</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="GHC.Types.Var.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2973"></span><span>    </span><span class="hs-comment">-- See Note [Explicit Case Statement for Specificity]</span><span>
</span><span id="line-2974"></span><span>    </span><span class="annot"><a href="#local-6989586621680811759"><span class="hs-identifier hs-var">source_of_injectivity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Invisible"><span class="hs-identifier hs-type">Invisible</span></a></span><span> </span><span id="local-6989586621680811755"><span class="annot"><span class="annottext">Specificity
</span><a href="#local-6989586621680811755"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Specificity
</span><a href="#local-6989586621680811755"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2975"></span><span>      </span><span class="annot"><span class="annottext">Specificity
</span><a href="GHC.Types.Var.html#SpecifiedSpec"><span class="hs-identifier hs-var">SpecifiedSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680811780"><span class="hs-identifier hs-var">spec_inj_pos</span></a></span><span>
</span><span id="line-2976"></span><span>      </span><span class="annot"><span class="annottext">Specificity
</span><a href="GHC.Types.Var.html#InferredSpec"><span class="hs-identifier hs-var">InferredSpec</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2977"></span><span>
</span><span id="line-2978"></span><span class="hs-comment">{-
Note [Explicit Case Statement for Specificity]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When pattern matching against an `ArgFlag`, you should not pattern match against
the pattern synonyms 'Specified' or 'Inferred', as this results in a
non-exhaustive pattern match warning.
Instead, pattern match against 'Invisible spec' and do another case analysis on
this specificity argument.
The issue has been fixed in GHC 8.10 (ticket #17876). This hack can thus be
dropped once version 8.10 is used as the minimum version for building GHC.

Note [When does a tycon application need an explicit kind signature?]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
There are a couple of places in GHC where we convert Core Types into forms that
more closely resemble user-written syntax. These include:

1. Template Haskell Type reification (see, for instance, GHC.Tc.Gen.Splice.reify_tc_app)
2. Converting Types to LHsTypes (such as in Haddock.Convert in haddock)

This conversion presents a challenge: how do we ensure that the resulting type
has enough kind information so as not to be ambiguous? To better motivate this
question, consider the following Core type:

  -- Foo :: Type -&gt; Type
  type Foo = Proxy Type

There is nothing ambiguous about the RHS of Foo in Core. But if we were to,
say, reify it into a TH Type, then it's tempting to just drop the invisible
Type argument and simply return `Proxy`. But now we've lost crucial kind
information: we don't know if we're dealing with `Proxy Type` or `Proxy Bool`
or `Proxy Int` or something else! We've inadvertently introduced ambiguity.

Unlike in other situations in GHC, we can't just turn on
-fprint-explicit-kinds, as we need to produce something which has the same
structure as a source-syntax type. Moreover, we can't rely on visible kind
application, since the first kind argument to Proxy is inferred, not specified.
Our solution is to annotate certain tycons with their kinds whenever they
appear in applied form in order to resolve the ambiguity. For instance, we
would reify the RHS of Foo like so:

  type Foo = (Proxy :: Type -&gt; Type)

We need to devise an algorithm that determines precisely which tycons need
these explicit kind signatures. We certainly don't want to annotate _every_
tycon with a kind signature, or else we might end up with horribly bloated
types like the following:

  (Either :: Type -&gt; Type -&gt; Type) (Int :: Type) (Char :: Type)

We only want to annotate tycons that absolutely require kind signatures in
order to resolve some sort of ambiguity, and nothing more.

Suppose we have a tycon application (T ty_1 ... ty_n). Why might this type
require a kind signature? It might require it when we need to fill in any of
T's omitted arguments. By &quot;omitted argument&quot;, we mean one that is dropped when
reifying ty_1 ... ty_n. Sometimes, the omitted arguments are inferred and
specified arguments (e.g., TH reification in GHC.Tc.Gen.Splice), and sometimes the
omitted arguments are only the inferred ones (e.g., in situations where
specified arguments are reified through visible kind application).
Regardless, the key idea is that _some_ arguments are going to be omitted after
reification, and the only mechanism we have at our disposal for filling them in
is through explicit kind signatures.

What do we mean by &quot;fill in&quot;? Let's consider this small example:

  T :: forall {k}. Type -&gt; (k -&gt; Type) -&gt; k

Moreover, we have this application of T:

  T @{j} Int aty

When we reify this type, we omit the inferred argument @{j}. Is it fixed by the
other (non-inferred) arguments? Yes! If we know the kind of (aty :: blah), then
we'll generate an equality constraint (kappa -&gt; Type) and, assuming we can
solve it, that will fix `kappa`. (Here, `kappa` is the unification variable
that we instantiate `k` with.)

Therefore, for any application of a tycon T to some arguments, the Question We
Must Answer is:

* Given the first n arguments of T, do the kinds of the non-omitted arguments
  fill in the omitted arguments?

(This is still a bit hand-wavey, but we'll refine this question incrementally
as we explain more of the machinery underlying this process.)

Answering this question is precisely the role that the `injectiveVarsOfType`
and `injective_vars_of_binder` functions exist to serve. If an omitted argument
`a` appears in the set returned by `injectiveVarsOfType ty`, then knowing
`ty` determines (i.e., fills in) `a`. (More on `injective_vars_of_binder` in a
bit.)

More formally, if
`a` is in `injectiveVarsOfType ty`
and  S1(ty) ~ S2(ty),
then S1(a)  ~ S2(a),
where S1 and S2 are arbitrary substitutions.

For example, is `F` is a non-injective type family, then

  injectiveVarsOfType(Either c (Maybe (a, F b c))) = {a, c}

Now that we know what this function does, here is a second attempt at the
Question We Must Answer:

* Given the first n arguments of T (ty_1 ... ty_n), consider the binders
  of T that are instantiated by non-omitted arguments. Do the injective
  variables of these binders fill in the remainder of T's kind?

Alright, we're getting closer. Next, we need to clarify what the injective
variables of a tycon binder are. This the role that the
`injective_vars_of_binder` function serves. Here is what this function does for
each form of tycon binder:

* Anonymous binders are injective positions. For example, in the promoted data
  constructor '(:):

    '(:) :: forall a. a -&gt; [a] -&gt; [a]

  The second and third tyvar binders (of kinds `a` and `[a]`) are both
  anonymous, so if we had '(:) 'True '[], then the kinds of 'True and
  '[] would contribute to the kind of '(:) 'True '[]. Therefore,
  injective_vars_of_binder(_ :: a) = injectiveVarsOfType(a) = {a}.
  (Similarly, injective_vars_of_binder(_ :: [a]) = {a}.)
* Named binders:
  - Inferred binders are never injective positions. For example, in this data
    type:

      data Proxy a
      Proxy :: forall {k}. k -&gt; Type

    If we had Proxy 'True, then the kind of 'True would not contribute to the
    kind of Proxy 'True. Therefore,
    injective_vars_of_binder(forall {k}. ...) = {}.
  - Required binders are injective positions. For example, in this data type:

      data Wurble k (a :: k) :: k
      Wurble :: forall k -&gt; k -&gt; k

  The first tyvar binder (of kind `forall k`) has required visibility, so if
  we had Wurble (Maybe a) Nothing, then the kind of Maybe a would
  contribute to the kind of Wurble (Maybe a) Nothing. Hence,
  injective_vars_of_binder(forall a -&gt; ...) = {a}.
  - Specified binders /might/ be injective positions, depending on how you
    approach things. Continuing the '(:) example:

      '(:) :: forall a. a -&gt; [a] -&gt; [a]

    Normally, the (forall a. ...) tyvar binder wouldn't contribute to the kind
    of '(:) 'True '[], since it's not explicitly instantiated by the user. But
    if visible kind application is enabled, then this is possible, since the
    user can write '(:) @Bool 'True '[]. (In that case,
    injective_vars_of_binder(forall a. ...) = {a}.)

    There are some situations where using visible kind application is appropriate
    and others where it is not (e.g., TH
    reification), so the `injective_vars_of_binder` function is parametrized by
    a Bool which decides if specified binders should be counted towards
    injective positions or not.

Now that we've defined injective_vars_of_binder, we can refine the Question We
Must Answer once more:

* Given the first n arguments of T (ty_1 ... ty_n), consider the binders
  of T that are instantiated by non-omitted arguments. For each such binder
  b_i, take the union of all injective_vars_of_binder(b_i). Is this set a
  superset of the free variables of the remainder of T's kind?

If the answer to this question is &quot;no&quot;, then (T ty_1 ... ty_n) needs an
explicit kind signature, since T's kind has kind variables leftover that
aren't fixed by the non-omitted arguments.

One last sticking point: what does &quot;the remainder of T's kind&quot; mean? You might
be tempted to think that it corresponds to all of the arguments in the kind of
T that would normally be instantiated by omitted arguments. But this isn't
quite right, strictly speaking. Consider the following (silly) example:

  S :: forall {k}. Type -&gt; Type

And suppose we have this application of S:

  S Int Bool

The Int argument would be omitted, and
injective_vars_of_binder(_ :: Type) = {}. This is not a superset of {k}, which
might suggest that (S Bool) needs an explicit kind signature. But
(S Bool :: Type) doesn't actually fix `k`! This is because the kind signature
only affects the /result/ of the application, not all of the individual
arguments. So adding a kind signature here won't make a difference. Therefore,
the fourth (and final) iteration of the Question We Must Answer is:

* Given the first n arguments of T (ty_1 ... ty_n), consider the binders
  of T that are instantiated by non-omitted arguments. For each such binder
  b_i, take the union of all injective_vars_of_binder(b_i). Is this set a
  superset of the free variables of the kind of (T ty_1 ... ty_n)?

Phew, that was a lot of work!

How can be sure that this is correct? That is, how can we be sure that in the
event that we leave off a kind annotation, that one could infer the kind of the
tycon application from its arguments? It's essentially a proof by induction: if
we can infer the kinds of every subtree of a type, then the whole tycon
application will have an inferrable kind--unless, of course, the remainder of
the tycon application's kind has uninstantiated kind variables.

What happens if T is oversaturated? That is, if T's kind has fewer than n
arguments, in the case that the concrete application instantiates a result
kind variable with an arrow kind? If we run out of arguments, we do not attach
a kind annotation. This should be a rare case, indeed. Here is an example:

   data T1 :: k1 -&gt; k2 -&gt; *
   data T2 :: k1 -&gt; k2 -&gt; *

   type family G (a :: k) :: k
   type instance G T1 = T2

   type instance F Char = (G T1 Bool :: (* -&gt; *) -&gt; *)   -- F from above

Here G's kind is (forall k. k -&gt; k), and the desugared RHS of that last
instance of F is (G (* -&gt; (* -&gt; *) -&gt; *) (T1 * (* -&gt; *)) Bool). According to
the algorithm above, there are 3 arguments to G so we should peel off 3
arguments in G's kind. But G's kind has only two arguments. This is the
rare special case, and we choose not to annotate the application of G with
a kind signature. After all, we needn't do this, since that instance would
be reified as:

   type instance F Char = G (T1 :: * -&gt; (* -&gt; *) -&gt; *) Bool

So the kind of G isn't ambiguous anymore due to the explicit kind annotation
on its argument. See #8953 and test th/T8953.
-}</span><span>
</span><span id="line-3209"></span><span>
</span><span id="line-3210"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Multiplicities
*                                                                      *
************************************************************************

These functions would prefer to be in GHC.Core.Multiplicity, but
they some are used elsewhere in this module, and wanted to bring
their friends here with them.
-}</span><span>
</span><span id="line-3221"></span><span>
</span><span id="line-3222"></span><span id="local-6989586621680814145"><span class="annot"><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier hs-type">unrestricted</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#linear"><span class="hs-identifier hs-type">linear</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tymult"><span class="hs-identifier hs-type">tymult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680814145"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680814145"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3223"></span><span>
</span><span id="line-3224"></span><span class="hs-comment">-- | Scale a payload by Many</span><span>
</span><span id="line-3225"></span><span id="unrestricted"><span class="annot"><span class="annottext">unrestricted :: forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier hs-var hs-var">unrestricted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; a -&gt; Scaled a
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#Many"><span class="hs-identifier hs-var">Many</span></a></span><span>
</span><span id="line-3226"></span><span>
</span><span id="line-3227"></span><span class="hs-comment">-- | Scale a payload by One</span><span>
</span><span id="line-3228"></span><span id="linear"><span class="annot"><span class="annottext">linear :: forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#linear"><span class="hs-identifier hs-var hs-var">linear</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; a -&gt; Scaled a
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#One"><span class="hs-identifier hs-var">One</span></a></span><span>
</span><span id="line-3229"></span><span>
</span><span id="line-3230"></span><span class="hs-comment">-- | Scale a payload by Many; used for type arguments in core</span><span>
</span><span id="line-3231"></span><span id="tymult"><span class="annot"><span class="annottext">tymult :: forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#tymult"><span class="hs-identifier hs-var hs-var">tymult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; a -&gt; Scaled a
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#Many"><span class="hs-identifier hs-var">Many</span></a></span><span>
</span><span id="line-3232"></span><span>
</span><span id="line-3233"></span><span id="local-6989586621680811752"><span class="annot"><a href="GHC.Core.Type.html#irrelevantMult"><span class="hs-identifier hs-type">irrelevantMult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811752"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680811752"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3234"></span><span id="irrelevantMult"><span class="annot"><span class="annottext">irrelevantMult :: forall a. Scaled a -&gt; a
</span><a href="GHC.Core.Type.html#irrelevantMult"><span class="hs-identifier hs-var hs-var">irrelevantMult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scaled a -&gt; a
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span>
</span><span id="line-3235"></span><span>
</span><span id="line-3236"></span><span id="local-6989586621680811751"><span class="annot"><a href="GHC.Core.Type.html#mkScaled"><span class="hs-identifier hs-type">mkScaled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680811751"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811751"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3237"></span><span id="mkScaled"><span class="annot"><span class="annottext">mkScaled :: forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#mkScaled"><span class="hs-identifier hs-var hs-var">mkScaled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; a -&gt; Scaled a
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span>
</span><span id="line-3238"></span><span>
</span><span id="line-3239"></span><span id="local-6989586621680814072"><span id="local-6989586621680814073"><span class="annot"><a href="GHC.Core.Type.html#scaledSet"><span class="hs-identifier hs-type">scaledSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680814073"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680814072"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680814072"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-3240"></span><span id="scaledSet"><span class="annot"><span class="annottext">scaledSet :: forall a b. Scaled a -&gt; b -&gt; Scaled b
</span><a href="GHC.Core.Type.html#scaledSet"><span class="hs-identifier hs-var hs-var">scaledSet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span id="local-6989586621680811750"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811750"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680811749"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680811749"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; b -&gt; Scaled b
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811750"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680811749"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3241"></span><span>
</span><span id="line-3242"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span>
</span><span id="line-3243"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24mOne"><span id="%24bOne"><span id="One"><span class="annot"><span class="annottext">$mOne :: forall {r}. Type -&gt; (Void# -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
$bOne :: Type
</span><a href="GHC.Core.Type.html#%24mOne"><span class="hs-identifier hs-var hs-var hs-var hs-var">One</span></a></span></span></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#isOneDataConTy"><span class="hs-identifier hs-type">isOneDataConTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-3244"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#oneDataConTy"><span class="hs-identifier hs-var">oneDataConTy</span></a></span><span>
</span><span id="line-3245"></span><span>
</span><span id="line-3246"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#Many"><span class="hs-identifier hs-type">Many</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span>
</span><span id="line-3247"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24mMany"><span id="%24bMany"><span id="Many"><span class="annot"><span class="annottext">$mMany :: forall {r}. Type -&gt; (Void# -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
$bMany :: Type
</span><a href="GHC.Core.Type.html#%24mMany"><span class="hs-identifier hs-var hs-var hs-var hs-var">Many</span></a></span></span></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#isManyDataConTy"><span class="hs-identifier hs-type">isManyDataConTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-3248"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#Many"><span class="hs-identifier hs-var">Many</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#manyDataConTy"><span class="hs-identifier hs-var">manyDataConTy</span></a></span><span>
</span><span id="line-3249"></span><span>
</span><span id="line-3250"></span><span class="annot"><a href="GHC.Core.Type.html#isManyDataConTy"><span class="hs-identifier hs-type">isManyDataConTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-3251"></span><span id="isManyDataConTy"><span class="annot"><span class="annottext">isManyDataConTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isManyDataConTy"><span class="hs-identifier hs-var hs-var">isManyDataConTy</span></a></span></span><span> </span><span id="local-6989586621680811744"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811744"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-3252"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680811743"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811743"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811744"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3253"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811743"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#manyDataConKey"><span class="hs-identifier hs-var">manyDataConKey</span></a></span><span>
</span><span id="line-3254"></span><span class="annot"><a href="GHC.Core.Type.html#isManyDataConTy"><span class="hs-identifier hs-var">isManyDataConTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3255"></span><span>
</span><span id="line-3256"></span><span class="annot"><a href="GHC.Core.Type.html#isOneDataConTy"><span class="hs-identifier hs-type">isOneDataConTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-3257"></span><span id="isOneDataConTy"><span class="annot"><span class="annottext">isOneDataConTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isOneDataConTy"><span class="hs-identifier hs-var hs-var">isOneDataConTy</span></a></span></span><span> </span><span id="local-6989586621680811741"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811741"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-3258"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680811740"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811740"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811741"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3259"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621680811740"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#oneDataConKey"><span class="hs-identifier hs-var">oneDataConKey</span></a></span><span>
</span><span id="line-3260"></span><span class="annot"><a href="GHC.Core.Type.html#isOneDataConTy"><span class="hs-identifier hs-var">isOneDataConTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3261"></span><span>
</span><span id="line-3262"></span><span class="annot"><a href="GHC.Core.Type.html#isLinearType"><span class="hs-identifier hs-type">isLinearType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-3263"></span><span class="hs-comment">-- ^ @isLinear t@ returns @True@ of a if @t@ is a type of (curried) function</span><span>
</span><span id="line-3264"></span><span class="hs-comment">-- where at least one argument is linear (or otherwise non-unrestricted). We use</span><span>
</span><span id="line-3265"></span><span class="hs-comment">-- this function to check whether it is safe to eta reduce an Id in CorePrep. It</span><span>
</span><span id="line-3266"></span><span class="hs-comment">-- is always safe to return 'True', because 'True' deactivates the optimisation.</span><span>
</span><span id="line-3267"></span><span id="isLinearType"><span class="annot"><span class="annottext">isLinearType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLinearType"><span class="hs-identifier hs-var hs-var">isLinearType</span></a></span></span><span> </span><span id="local-6989586621680811738"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811738"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811738"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3268"></span><span>                      </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#Many"><span class="hs-identifier hs-var">Many</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811737"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811737"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLinearType"><span class="hs-identifier hs-var">isLinearType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811737"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-3269"></span><span>                      </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3270"></span><span>                      </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ArgFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680811736"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811736"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLinearType"><span class="hs-identifier hs-var">isLinearType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680811736"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-3271"></span><span>                      </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3272"></span></pre></body></html>