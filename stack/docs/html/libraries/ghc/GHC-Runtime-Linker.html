<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>GHC.Runtime.Linker</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ghc-9.0.2: The GHC API</span><ul class="links" id="page-menu"><li><a href="src/GHC.Runtime.Linker.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">GHC.Runtime.Linker</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>The dynamic linker for GHCi.</p><p>This module deals with the top-level issues of dynamic linking,
 calling the object-code linker and the byte-code linker where
 necessary.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:getHValue">getHValue</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; <a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> <a href="GHC.html#t:ForeignHValue" title="GHC">ForeignHValue</a></li><li class="src short"><a href="#v:showLinkerState">showLinkerState</a> :: <a href="GHC-Runtime-Linker-Types.html#t:DynLinker" title="GHC.Runtime.Linker.Types">DynLinker</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> <a href="GHC-Utils-Outputable.html#t:SDoc" title="GHC.Utils.Outputable">SDoc</a></li><li class="src short"><a href="#v:linkExpr">linkExpr</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; <a href="GHC-Types-SrcLoc.html#t:SrcSpan" title="GHC.Types.SrcLoc">SrcSpan</a> -&gt; <a href="GHC-ByteCode-Types.html#t:UnlinkedBCO" title="GHC.ByteCode.Types">UnlinkedBCO</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> <a href="GHC.html#t:ForeignHValue" title="GHC">ForeignHValue</a></li><li class="src short"><a href="#v:linkDecls">linkDecls</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; <a href="GHC-Types-SrcLoc.html#t:SrcSpan" title="GHC.Types.SrcLoc">SrcSpan</a> -&gt; <a href="GHC-Driver-Types.html#t:CompiledByteCode" title="GHC.Driver.Types">CompiledByteCode</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> ()</li><li class="src short"><a href="#v:unload">unload</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; [<a href="GHC-Driver-Types.html#t:Linkable" title="GHC.Driver.Types">Linkable</a>] -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> ()</li><li class="src short"><a href="#v:withExtendedLinkEnv">withExtendedLinkEnv</a> :: <a href="GHC-Utils-Exception.html#t:ExceptionMonad" title="GHC.Utils.Exception">ExceptionMonad</a> m =&gt; <a href="GHC-Runtime-Linker-Types.html#t:DynLinker" title="GHC.Runtime.Linker.Types">DynLinker</a> -&gt; [(<a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a>, <a href="GHC.html#t:ForeignHValue" title="GHC">ForeignHValue</a>)] -&gt; m a -&gt; m a</li><li class="src short"><a href="#v:extendLinkEnv">extendLinkEnv</a> :: <a href="GHC-Runtime-Linker-Types.html#t:DynLinker" title="GHC.Runtime.Linker.Types">DynLinker</a> -&gt; [(<a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a>, <a href="GHC.html#t:ForeignHValue" title="GHC">ForeignHValue</a>)] -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> ()</li><li class="src short"><a href="#v:deleteFromLinkEnv">deleteFromLinkEnv</a> :: <a href="GHC-Runtime-Linker-Types.html#t:DynLinker" title="GHC.Runtime.Linker.Types">DynLinker</a> -&gt; [<a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a>] -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> ()</li><li class="src short"><a href="#v:extendLoadedPkgs">extendLoadedPkgs</a> :: <a href="GHC-Runtime-Linker-Types.html#t:DynLinker" title="GHC.Runtime.Linker.Types">DynLinker</a> -&gt; [<a href="GHC-Unit-Types.html#t:UnitId" title="GHC.Unit.Types">UnitId</a>] -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> ()</li><li class="src short"><a href="#v:linkPackages">linkPackages</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; [<a href="GHC-Unit-Types.html#t:UnitId" title="GHC.Unit.Types">UnitId</a>] -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> ()</li><li class="src short"><a href="#v:initDynLinker">initDynLinker</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> ()</li><li class="src short"><a href="#v:linkModule">linkModule</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; <a href="GHC-Unit-Types.html#t:Module" title="GHC.Unit.Types">Module</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> ()</li><li class="src short"><a href="#v:linkCmdLineLibs">linkCmdLineLibs</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> ()</li><li class="src short"><a href="#v:uninitializedLinker">uninitializedLinker</a> :: <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> <a href="GHC-Runtime-Linker-Types.html#t:DynLinker" title="GHC.Runtime.Linker.Types">DynLinker</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:getHValue" class="def">getHValue</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; <a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> <a href="GHC.html#t:ForeignHValue" title="GHC">ForeignHValue</a> <a href="src/GHC.Runtime.Linker.html#getHValue" class="link">Source</a> <a href="#v:getHValue" class="selflink">#</a></p><div class="doc"><p>Get the <code><a href="GHC.html#t:HValue" title="GHC">HValue</a></code> associated with the given name.</p><p>May cause loading the module that contains the name.</p><p>Throws a <code><a href="GHC-Utils-Panic.html#v:ProgramError" title="GHC.Utils.Panic">ProgramError</a></code> if loading fails or the name cannot be found.</p></div></div><div class="top"><p class="src"><a id="v:showLinkerState" class="def">showLinkerState</a> :: <a href="GHC-Runtime-Linker-Types.html#t:DynLinker" title="GHC.Runtime.Linker.Types">DynLinker</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> <a href="GHC-Utils-Outputable.html#t:SDoc" title="GHC.Utils.Outputable">SDoc</a> <a href="src/GHC.Runtime.Linker.html#showLinkerState" class="link">Source</a> <a href="#v:showLinkerState" class="selflink">#</a></p><div class="doc"><p>Display the persistent linker state.</p></div></div><div class="top"><p class="src"><a id="v:linkExpr" class="def">linkExpr</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; <a href="GHC-Types-SrcLoc.html#t:SrcSpan" title="GHC.Types.SrcLoc">SrcSpan</a> -&gt; <a href="GHC-ByteCode-Types.html#t:UnlinkedBCO" title="GHC.ByteCode.Types">UnlinkedBCO</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> <a href="GHC.html#t:ForeignHValue" title="GHC">ForeignHValue</a> <a href="src/GHC.Runtime.Linker.html#linkExpr" class="link">Source</a> <a href="#v:linkExpr" class="selflink">#</a></p><div class="doc"><p>Link a single expression, <em>including</em> first linking packages and
 modules that this expression depends on.</p><p>Raises an IO exception (<code><a href="GHC-Utils-Panic.html#v:ProgramError" title="GHC.Utils.Panic">ProgramError</a></code>) if it can't find a compiled
 version of the dependents to link.</p></div></div><div class="top"><p class="src"><a id="v:linkDecls" class="def">linkDecls</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; <a href="GHC-Types-SrcLoc.html#t:SrcSpan" title="GHC.Types.SrcLoc">SrcSpan</a> -&gt; <a href="GHC-Driver-Types.html#t:CompiledByteCode" title="GHC.Driver.Types">CompiledByteCode</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> () <a href="src/GHC.Runtime.Linker.html#linkDecls" class="link">Source</a> <a href="#v:linkDecls" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:unload" class="def">unload</a> <a href="src/GHC.Runtime.Linker.html#unload" class="link">Source</a> <a href="#v:unload" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; [<a href="GHC-Driver-Types.html#t:Linkable" title="GHC.Driver.Types">Linkable</a>]</td><td class="doc"><p>The linkables to *keep*.</p></td></tr><tr><td class="src">-&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Unloading old objects ready for a new compilation sweep.</p><p>The compilation manager provides us with a list of linkables that it
 considers &quot;stable&quot;, i.e. won't be recompiled this time around.  For
 each of the modules current linked in memory,</p><ul><li>if the linkable is stable (and it's the same one -- the user may have
     recompiled the module on the side), we keep it,</li><li>otherwise, we unload it.</li><li>we also implicitly unload all temporary bindings at this point.</li></ul></div></div><div class="top"><p class="src"><a id="v:withExtendedLinkEnv" class="def">withExtendedLinkEnv</a> :: <a href="GHC-Utils-Exception.html#t:ExceptionMonad" title="GHC.Utils.Exception">ExceptionMonad</a> m =&gt; <a href="GHC-Runtime-Linker-Types.html#t:DynLinker" title="GHC.Runtime.Linker.Types">DynLinker</a> -&gt; [(<a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a>, <a href="GHC.html#t:ForeignHValue" title="GHC">ForeignHValue</a>)] -&gt; m a -&gt; m a <a href="src/GHC.Runtime.Linker.html#withExtendedLinkEnv" class="link">Source</a> <a href="#v:withExtendedLinkEnv" class="selflink">#</a></p><div class="doc"><p>Temporarily extend the linker state.</p></div></div><div class="top"><p class="src"><a id="v:extendLinkEnv" class="def">extendLinkEnv</a> :: <a href="GHC-Runtime-Linker-Types.html#t:DynLinker" title="GHC.Runtime.Linker.Types">DynLinker</a> -&gt; [(<a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a>, <a href="GHC.html#t:ForeignHValue" title="GHC">ForeignHValue</a>)] -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> () <a href="src/GHC.Runtime.Linker.html#extendLinkEnv" class="link">Source</a> <a href="#v:extendLinkEnv" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:deleteFromLinkEnv" class="def">deleteFromLinkEnv</a> :: <a href="GHC-Runtime-Linker-Types.html#t:DynLinker" title="GHC.Runtime.Linker.Types">DynLinker</a> -&gt; [<a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a>] -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> () <a href="src/GHC.Runtime.Linker.html#deleteFromLinkEnv" class="link">Source</a> <a href="#v:deleteFromLinkEnv" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:extendLoadedPkgs" class="def">extendLoadedPkgs</a> :: <a href="GHC-Runtime-Linker-Types.html#t:DynLinker" title="GHC.Runtime.Linker.Types">DynLinker</a> -&gt; [<a href="GHC-Unit-Types.html#t:UnitId" title="GHC.Unit.Types">UnitId</a>] -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> () <a href="src/GHC.Runtime.Linker.html#extendLoadedPkgs" class="link">Source</a> <a href="#v:extendLoadedPkgs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:linkPackages" class="def">linkPackages</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; [<a href="GHC-Unit-Types.html#t:UnitId" title="GHC.Unit.Types">UnitId</a>] -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> () <a href="src/GHC.Runtime.Linker.html#linkPackages" class="link">Source</a> <a href="#v:linkPackages" class="selflink">#</a></p><div class="doc"><p>Link exactly the specified packages, and their dependents (unless of
 course they are already linked).  The dependents are linked
 automatically, and it doesn't matter what order you specify the input
 packages.</p></div></div><div class="top"><p class="src"><a id="v:initDynLinker" class="def">initDynLinker</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> () <a href="src/GHC.Runtime.Linker.html#initDynLinker" class="link">Source</a> <a href="#v:initDynLinker" class="selflink">#</a></p><div class="doc"><p>Initialise the dynamic linker.  This entails</p><p>a) Calling the C initialisation procedure,</p><p>b) Loading any packages specified on the command line,</p><p>c) Loading any packages specified on the command line, now held in the
     <code>-l</code> options in <code>v_Opt_l</code>,</p><p>d) Loading any <code>.o/.dll</code> files specified on the command line, now held
     in <code>ldInputs</code>,</p><p>e) Loading any MacOS frameworks.</p><p>NOTE: This function is idempotent; if called more than once, it does
 nothing.  This is useful in Template Haskell, where we call it before
 trying to link.</p></div></div><div class="top"><p class="src"><a id="v:linkModule" class="def">linkModule</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; <a href="GHC-Unit-Types.html#t:Module" title="GHC.Unit.Types">Module</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> () <a href="src/GHC.Runtime.Linker.html#linkModule" class="link">Source</a> <a href="#v:linkModule" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:linkCmdLineLibs" class="def">linkCmdLineLibs</a> :: <a href="GHC-Driver-Types.html#t:HscEnv" title="GHC.Driver.Types">HscEnv</a> -&gt; <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> () <a href="src/GHC.Runtime.Linker.html#linkCmdLineLibs" class="link">Source</a> <a href="#v:linkCmdLineLibs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:uninitializedLinker" class="def">uninitializedLinker</a> :: <a href="GHC-Prelude.html#t:IO" title="GHC.Prelude">IO</a> <a href="GHC-Runtime-Linker-Types.html#t:DynLinker" title="GHC.Runtime.Linker.Types">DynLinker</a> <a href="src/GHC.Runtime.Linker.html#uninitializedLinker" class="link">Source</a> <a href="#v:uninitializedLinker" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.25.1</p></div></body></html>