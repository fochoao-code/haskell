<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>GHC.Event.Windows.FFI</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">base-4.15.1.0: Basic libraries</span><ul class="links" id="page-menu"><li><a href="src/GHC.Event.Windows.FFI.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Tamar Christina 2019</td></tr><tr><th>License</th><td>BSD-style (see the file libraries/base/LICENSE)</td></tr><tr><th>Maintainer</th><td>libraries@haskell.org</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>non-portable</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">GHC.Event.Windows.FFI</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">IOCP</a></li><li><a href="#g:2">Completion Data</a></li><li><a href="#g:3">Overlapped</a></li><li><a href="#g:4">Cancel pending I/O</a></li><li><a href="#g:5">Monotonic time</a><ul><li><a href="#g:6">GetTickCount</a></li><li><a href="#g:7">QueryPerformanceCounter</a></li><li><a href="#g:8">Miscellaneous</a></li></ul></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>WinIO Windows API Foreign Function imports</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">newtype</span> <a href="#t:IOCP">IOCP</a> = <a href="#v:IOCP">IOCP</a> <a href="GHC-Windows.html#t:HANDLE" title="GHC.Windows">HANDLE</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:CompletionKey">CompletionKey</a> = ULONG_PTR</li><li class="src short"><a href="#v:newIOCP">newIOCP</a> :: <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a></li><li class="src short"><a href="#v:associateHandleWithIOCP">associateHandleWithIOCP</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Windows.html#t:HANDLE" title="GHC.Windows">HANDLE</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:CompletionKey" title="GHC.Event.Windows.FFI">CompletionKey</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:getQueuedCompletionStatusEx">getQueuedCompletionStatusEx</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; Array <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> -&gt; <a href="GHC-Windows.html#t:DWORD" title="GHC.Windows">DWORD</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:postQueuedCompletionStatus">postQueuedCompletionStatus</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Windows.html#t:DWORD" title="GHC.Windows">DWORD</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:CompletionKey" title="GHC.Event.Windows.FFI">CompletionKey</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:getOverlappedResult">getOverlappedResult</a> :: <a href="GHC-Windows.html#t:HANDLE" title="GHC.Windows">HANDLE</a> -&gt; <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED" title="GHC.Event.Windows.FFI">OVERLAPPED</a> -&gt; <a href="GHC-Windows.html#t:BOOL" title="GHC.Windows">BOOL</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="GHC-Windows.html#t:DWORD" title="GHC.Windows">DWORD</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:CompletionData">CompletionData</a> = <a href="#v:CompletionData">CompletionData</a> {<ul class="subs"><li><a href="#v:cdHandle">cdHandle</a> :: !<a href="GHC-Windows.html#t:HANDLE" title="GHC.Windows">HANDLE</a></li><li><a href="#v:cdCallback">cdCallback</a> :: !IOCallback</li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:CompletionCallback">CompletionCallback</a> a = <a href="GHC-Windows.html#t:ErrCode" title="GHC.Windows">ErrCode</a> -&gt; <a href="GHC-Windows.html#t:DWORD" title="GHC.Windows">DWORD</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> a</li><li class="src short"><a href="#v:withRequest">withRequest</a> :: <a href="Data-Word.html#t:Word64" title="Data.Word">Word64</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; (<a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:HASKELL_OVERLAPPED" title="GHC.Event.Windows.FFI">HASKELL_OVERLAPPED</a> -&gt; <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> a) -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> a</li><li class="src short"><span class="keyword">data</span> <a href="#t:OVERLAPPED">OVERLAPPED</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:LPOVERLAPPED">LPOVERLAPPED</a> = <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED" title="GHC.Event.Windows.FFI">OVERLAPPED</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:OVERLAPPED_ENTRY">OVERLAPPED_ENTRY</a> = <a href="#v:OVERLAPPED_ENTRY">OVERLAPPED_ENTRY</a> {<ul class="subs"><li><a href="#v:lpCompletionKey">lpCompletionKey</a> :: ULONG_PTR</li><li><a href="#v:lpOverlapped">lpOverlapped</a> :: <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a></li><li><a href="#v:dwNumberOfBytesTransferred">dwNumberOfBytesTransferred</a> :: <a href="GHC-Windows.html#t:DWORD" title="GHC.Windows">DWORD</a></li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:LPOVERLAPPED_ENTRY">LPOVERLAPPED_ENTRY</a> = <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:HASKELL_OVERLAPPED">HASKELL_OVERLAPPED</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:LPHASKELL_OVERLAPPED">LPHASKELL_OVERLAPPED</a> = <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:HASKELL_OVERLAPPED" title="GHC.Event.Windows.FFI">HASKELL_OVERLAPPED</a></li><li class="src short"><a href="#v:allocOverlapped">allocOverlapped</a> :: <a href="Data-Word.html#t:Word64" title="Data.Word">Word64</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:HASKELL_OVERLAPPED" title="GHC.Event.Windows.FFI">HASKELL_OVERLAPPED</a>)</li><li class="src short"><a href="#v:zeroOverlapped">zeroOverlapped</a> :: <a href="GHC-Event-Windows-FFI.html#t:LPHASKELL_OVERLAPPED" title="GHC.Event.Windows.FFI">LPHASKELL_OVERLAPPED</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:pokeOffsetOverlapped">pokeOffsetOverlapped</a> :: <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a> -&gt; <a href="Data-Word.html#t:Word64" title="Data.Word">Word64</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:overlappedIOStatus">overlappedIOStatus</a> :: <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="GHC-Windows.html#t:NTSTATUS" title="GHC.Windows">NTSTATUS</a></li><li class="src short"><a href="#v:overlappedIONumBytes">overlappedIONumBytes</a> :: <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ULONG_PTR</li><li class="src short"><a href="#v:cancelIoEx">cancelIoEx</a> :: <a href="GHC-Windows.html#t:HANDLE" title="GHC.Windows">HANDLE</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:cancelIoEx-39-">cancelIoEx'</a> :: <a href="GHC-Windows.html#t:HANDLE" title="GHC.Windows">HANDLE</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:getTickCount64">getTickCount64</a> :: <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="Data-Word.html#t:Word64" title="Data.Word">Word64</a></li><li class="src short"><a href="#v:queryPerformanceCounter">queryPerformanceCounter</a> :: <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="Data-Int.html#t:Int64" title="Data.Int">Int64</a></li><li class="src short"><a href="#v:queryPerformanceFrequency">queryPerformanceFrequency</a> :: <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Data-Int.html#t:Int64" title="Data.Int">Int64</a>)</li><li class="src short"><a href="#v:throwWinErr">throwWinErr</a> :: <a href="Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="GHC-Windows.html#t:ErrCode" title="GHC.Windows">ErrCode</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> a</li><li class="src short"><a href="#v:setLastError">setLastError</a> :: <a href="GHC-Windows.html#t:ErrCode" title="GHC.Windows">ErrCode</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>IOCP</h1></a><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:IOCP" class="def">IOCP</a> <a href="src/GHC.Event.Windows.FFI.html#IOCP" class="link">Source</a> <a href="#t:IOCP" class="selflink">#</a></p><div class="doc"><p>An I/O completion port.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:IOCP" class="def">IOCP</a> <a href="GHC-Windows.html#t:HANDLE" title="GHC.Windows">HANDLE</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:IOCP">Instances</h4><details id="i:IOCP" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:IOCP:Show:1"></span> <a href="Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a></span> <a href="src/GHC.Event.Windows.FFI.html#line-92" class="link">Source</a> <a href="#t:IOCP" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:IOCP:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="GHC-Event-Windows-FFI.html">GHC.Event.Windows.FFI</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="src/GHC.Show.html#showsPrec" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="Data-String.html#t:String" title="Data.String">String</a> <a href="src/GHC.Show.html#show" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a>] -&gt; <a href="Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="src/GHC.Show.html#showList" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:IOCP:Eq:2"></span> <a href="Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a></span> <a href="src/GHC.Event.Windows.FFI.html#line-92" class="link">Source</a> <a href="#t:IOCP" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:IOCP:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="GHC-Event-Windows-FFI.html">GHC.Event.Windows.FFI</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim/src/GHC.Classes.html#%3D%3D" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim/src/GHC.Classes.html#%2F%3D" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:IOCP:Ord:3"></span> <a href="Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a></span> <a href="src/GHC.Event.Windows.FFI.html#line-92" class="link">Source</a> <a href="#t:IOCP" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:IOCP:Ord:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="GHC-Event-Windows-FFI.html">GHC.Event.Windows.FFI</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare">compare</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="Data-Ord.html#t:Ordering" title="Data.Ord">Ordering</a> <a href="../ghc-prim/src/GHC.Classes.html#compare" class="link">Source</a> <a href="#v:compare" class="selflink">#</a></p><p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim/src/GHC.Classes.html#%3C" class="link">Source</a> <a href="#v:-60-" class="selflink">#</a></p><p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim/src/GHC.Classes.html#%3C%3D" class="link">Source</a> <a href="#v:-60--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim/src/GHC.Classes.html#%3E" class="link">Source</a> <a href="#v:-62-" class="selflink">#</a></p><p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim/src/GHC.Classes.html#%3E%3D" class="link">Source</a> <a href="#v:-62--61-" class="selflink">#</a></p><p class="src"><a href="#v:max">max</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> <a href="../ghc-prim/src/GHC.Classes.html#max" class="link">Source</a> <a href="#v:max" class="selflink">#</a></p><p class="src"><a href="#v:min">min</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> <a href="../ghc-prim/src/GHC.Classes.html#min" class="link">Source</a> <a href="#v:min" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:CompletionKey" class="def">CompletionKey</a> = ULONG_PTR <a href="src/GHC.Event.Windows.FFI.html#CompletionKey" class="link">Source</a> <a href="#t:CompletionKey" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:newIOCP" class="def">newIOCP</a> :: <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> <a href="src/GHC.Event.Windows.FFI.html#newIOCP" class="link">Source</a> <a href="#v:newIOCP" class="selflink">#</a></p><div class="doc"><p>Create a new I/O completion port.</p></div></div><div class="top"><p class="src"><a id="v:associateHandleWithIOCP" class="def">associateHandleWithIOCP</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Windows.html#t:HANDLE" title="GHC.Windows">HANDLE</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:CompletionKey" title="GHC.Event.Windows.FFI">CompletionKey</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/GHC.Event.Windows.FFI.html#associateHandleWithIOCP" class="link">Source</a> <a href="#v:associateHandleWithIOCP" class="selflink">#</a></p><div class="doc"><p>Associate a HANDLE with an I/O completion port.</p></div></div><div class="top"><p class="src"><a id="v:getQueuedCompletionStatusEx" class="def">getQueuedCompletionStatusEx</a> <a href="src/GHC.Event.Windows.FFI.html#getQueuedCompletionStatusEx" class="link">Source</a> <a href="#v:getQueuedCompletionStatusEx" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Array <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="GHC-Windows.html#t:DWORD" title="GHC.Windows">DWORD</a></td><td class="doc"><p>Timeout in milliseconds (or
 <code><a href="GHC-Windows.html#v:iNFINITE" title="GHC.Windows">iNFINITE</a></code>)</p></td></tr><tr><td class="src">-&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Note [Completion Ports]
 When an I/O operation has been queued by an operation
 (ReadFile<em>WriteFile</em>etc) it is placed in a queue that the driver uses when
 servicing IRQs.  This queue has some important properties:</p><ol><li>) It is not an ordered queue.  Requests may be performed out of order as
     as the OS's native I/O manager may try to re-order requests such that as
     few random seeks as possible are needed to complete the pending
     operations.  As such do not assume a fixed order between something being
     queued and dequeued.</li><li>) Operations may skip the queue entirely.  In which case they do not end in
     in this function. (This is an optimization flag we have turned on. See
     <code>openFile</code>.)</li><li>) Across this call the specified OVERLAPPED_ENTRY buffer MUST remain live,
     and the buffer for an I/O operation cannot be freed or moved until
     <code><a href="GHC-Event-Windows-FFI.html#v:getOverlappedResult" title="GHC.Event.Windows.FFI">getOverlappedResult</a></code> says it's done.  The reason is the kernel may not
     have fully released the buffer, or finished writing to it when this
     operation returns.  Failure to adhere to this will cause your IRQs to be
     silently dropped and your program will never receive a completion for it.
     This means that the OVERLAPPED buffer must also remain valid for the
     duration of the call and as such must be allocated on the unmanaged heap.</li><li>) When a thread calls this method it is associated with the I/O manager's
     worker threads pool.  You should always use dedicated threads for this
     since the OS I/O manager will now monitor the threads.  If the thread
     becomes blocked for whatever reason, the Haskell I/O manager will wake up
     another threads from it's pool to service the remaining results.
     A new thread will also be woken up from the pool when the previous thread
     is busy servicing requests and new requests have finished.  For this
     reason the Haskell I<em>O manager multiplexes I</em>O operations from N haskell
     threads into 1 completion port, which is serviced by M native threads in
     an asynchronous method. This allows it to scale efficiently.</li></ol></div></div><div class="top"><p class="src"><a id="v:postQueuedCompletionStatus" class="def">postQueuedCompletionStatus</a> :: <a href="GHC-Event-Windows-FFI.html#t:IOCP" title="GHC.Event.Windows.FFI">IOCP</a> -&gt; <a href="GHC-Windows.html#t:DWORD" title="GHC.Windows">DWORD</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:CompletionKey" title="GHC.Event.Windows.FFI">CompletionKey</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/GHC.Event.Windows.FFI.html#postQueuedCompletionStatus" class="link">Source</a> <a href="#v:postQueuedCompletionStatus" class="selflink">#</a></p><div class="doc"><p>Manually post a completion to the specified I/O port.  This will wake up
 a thread waiting <code>GetQueuedCompletionStatusEx</code>.</p></div></div><div class="top"><p class="src"><a id="v:getOverlappedResult" class="def">getOverlappedResult</a> :: <a href="GHC-Windows.html#t:HANDLE" title="GHC.Windows">HANDLE</a> -&gt; <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED" title="GHC.Event.Windows.FFI">OVERLAPPED</a> -&gt; <a href="GHC-Windows.html#t:BOOL" title="GHC.Windows">BOOL</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="GHC-Windows.html#t:DWORD" title="GHC.Windows">DWORD</a>) <a href="src/GHC.Event.Windows.FFI.html#getOverlappedResult" class="link">Source</a> <a href="#v:getOverlappedResult" class="selflink">#</a></p><div class="doc"><p>Get the result of a single overlap operation without the IO manager</p></div></div><a href="#g:2" id="g:2"><h1>Completion Data</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:CompletionData" class="def">CompletionData</a> <a href="src/GHC.Event.Windows.FFI.html#CompletionData" class="link">Source</a> <a href="#t:CompletionData" class="selflink">#</a></p><div class="doc"><p>Structure that the I/O manager uses to associate callbacks with
 additional payload such as their OVERLAPPED structure and Win32 handle
 etc.  *Must* be kept in sync with that in `winio_structs.h` or horrible things
 happen.</p><p>We keep the handle around for the benefit of ghc-external libraries making
 use of the manager.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:CompletionData" class="def">CompletionData</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:cdHandle" class="def">cdHandle</a> :: !<a href="GHC-Windows.html#t:HANDLE" title="GHC.Windows">HANDLE</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:cdCallback" class="def">cdCallback</a> :: !IOCallback</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:CompletionData">Instances</h4><details id="i:CompletionData" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CompletionData:Storable:1"></span> <a href="Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a></span> <a href="src/GHC.Event.Windows.FFI.html#line-253" class="link">Source</a> <a href="#t:CompletionData" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CompletionData:Storable:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="GHC-Event-Windows-FFI.html">GHC.Event.Windows.FFI</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:sizeOf">sizeOf</a> :: <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/Foreign.Storable.html#sizeOf" class="link">Source</a> <a href="#v:sizeOf" class="selflink">#</a></p><p class="src"><a href="#v:alignment">alignment</a> :: <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/Foreign.Storable.html#alignment" class="link">Source</a> <a href="#v:alignment" class="selflink">#</a></p><p class="src"><a href="#v:peekElemOff">peekElemOff</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> <a href="src/Foreign.Storable.html#peekElemOff" class="link">Source</a> <a href="#v:peekElemOff" class="selflink">#</a></p><p class="src"><a href="#v:pokeElemOff">pokeElemOff</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Foreign.Storable.html#pokeElemOff" class="link">Source</a> <a href="#v:pokeElemOff" class="selflink">#</a></p><p class="src"><a href="#v:peekByteOff">peekByteOff</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> b -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> <a href="src/Foreign.Storable.html#peekByteOff" class="link">Source</a> <a href="#v:peekByteOff" class="selflink">#</a></p><p class="src"><a href="#v:pokeByteOff">pokeByteOff</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> b -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Foreign.Storable.html#pokeByteOff" class="link">Source</a> <a href="#v:pokeByteOff" class="selflink">#</a></p><p class="src"><a href="#v:peek">peek</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> <a href="src/Foreign.Storable.html#peek" class="link">Source</a> <a href="#v:peek" class="selflink">#</a></p><p class="src"><a href="#v:poke">poke</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Foreign.Storable.html#poke" class="link">Source</a> <a href="#v:poke" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:CompletionCallback" class="def">CompletionCallback</a> a <a href="src/GHC.Event.Windows.FFI.html#CompletionCallback" class="link">Source</a> <a href="#t:CompletionCallback" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">&nbsp;= <a href="GHC-Windows.html#t:ErrCode" title="GHC.Windows">ErrCode</a></td><td class="doc"><p>0 indicates success</p></td></tr><tr><td class="src">-&gt; <a href="GHC-Windows.html#t:DWORD" title="GHC.Windows">DWORD</a></td><td class="doc"><p>Number of bytes transferred</p></td></tr><tr><td class="src">-&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Called when the completion is delivered.</p></div></div><div class="top"><p class="src"><a id="v:withRequest" class="def">withRequest</a> :: <a href="Data-Word.html#t:Word64" title="Data.Word">Word64</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; (<a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:HASKELL_OVERLAPPED" title="GHC.Event.Windows.FFI">HASKELL_OVERLAPPED</a> -&gt; <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:CompletionData" title="GHC.Event.Windows.FFI">CompletionData</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> a) -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> a <a href="src/GHC.Event.Windows.FFI.html#withRequest" class="link">Source</a> <a href="#v:withRequest" class="selflink">#</a></p></div><a href="#g:3" id="g:3"><h1>Overlapped</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:OVERLAPPED" class="def">OVERLAPPED</a> <a href="src/GHC.Event.Windows.FFI.html#OVERLAPPED" class="link">Source</a> <a href="#t:OVERLAPPED" class="selflink">#</a></p><div class="doc"><p>Tag type for <code>LPOVERLAPPED</code>.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:LPOVERLAPPED" class="def">LPOVERLAPPED</a> = <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED" title="GHC.Event.Windows.FFI">OVERLAPPED</a> <a href="src/GHC.Event.Windows.FFI.html#LPOVERLAPPED" class="link">Source</a> <a href="#t:LPOVERLAPPED" class="selflink">#</a></p><div class="doc"><p>Identifies an I/O operation.  Used as the <code>LPOVERLAPPED</code> parameter
 for overlapped I/O functions (e.g. <code>ReadFile</code>, <code>WSASend</code>).</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:OVERLAPPED_ENTRY" class="def">OVERLAPPED_ENTRY</a> <a href="src/GHC.Event.Windows.FFI.html#OVERLAPPED_ENTRY" class="link">Source</a> <a href="#t:OVERLAPPED_ENTRY" class="selflink">#</a></p><div class="doc"><p>An array of these is passed to GetQueuedCompletionStatusEx as an output
 argument.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:OVERLAPPED_ENTRY" class="def">OVERLAPPED_ENTRY</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:lpCompletionKey" class="def">lpCompletionKey</a> :: ULONG_PTR</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:lpOverlapped" class="def">lpOverlapped</a> :: <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:dwNumberOfBytesTransferred" class="def">dwNumberOfBytesTransferred</a> :: <a href="GHC-Windows.html#t:DWORD" title="GHC.Windows">DWORD</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:OVERLAPPED_ENTRY">Instances</h4><details id="i:OVERLAPPED_ENTRY" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:OVERLAPPED_ENTRY:Storable:1"></span> <a href="Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a></span> <a href="src/GHC.Event.Windows.FFI.html#line-295" class="link">Source</a> <a href="#t:OVERLAPPED_ENTRY" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:OVERLAPPED_ENTRY:Storable:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="GHC-Event-Windows-FFI.html">GHC.Event.Windows.FFI</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:sizeOf">sizeOf</a> :: <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/Foreign.Storable.html#sizeOf" class="link">Source</a> <a href="#v:sizeOf" class="selflink">#</a></p><p class="src"><a href="#v:alignment">alignment</a> :: <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/Foreign.Storable.html#alignment" class="link">Source</a> <a href="#v:alignment" class="selflink">#</a></p><p class="src"><a href="#v:peekElemOff">peekElemOff</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> <a href="src/Foreign.Storable.html#peekElemOff" class="link">Source</a> <a href="#v:peekElemOff" class="selflink">#</a></p><p class="src"><a href="#v:pokeElemOff">pokeElemOff</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Foreign.Storable.html#pokeElemOff" class="link">Source</a> <a href="#v:pokeElemOff" class="selflink">#</a></p><p class="src"><a href="#v:peekByteOff">peekByteOff</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> b -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> <a href="src/Foreign.Storable.html#peekByteOff" class="link">Source</a> <a href="#v:peekByteOff" class="selflink">#</a></p><p class="src"><a href="#v:pokeByteOff">pokeByteOff</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> b -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Foreign.Storable.html#pokeByteOff" class="link">Source</a> <a href="#v:pokeByteOff" class="selflink">#</a></p><p class="src"><a href="#v:peek">peek</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> <a href="src/Foreign.Storable.html#peek" class="link">Source</a> <a href="#v:peek" class="selflink">#</a></p><p class="src"><a href="#v:poke">poke</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Foreign.Storable.html#poke" class="link">Source</a> <a href="#v:poke" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:LPOVERLAPPED_ENTRY" class="def">LPOVERLAPPED_ENTRY</a> = <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:OVERLAPPED_ENTRY" title="GHC.Event.Windows.FFI">OVERLAPPED_ENTRY</a> <a href="src/GHC.Event.Windows.FFI.html#LPOVERLAPPED_ENTRY" class="link">Source</a> <a href="#t:LPOVERLAPPED_ENTRY" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:HASKELL_OVERLAPPED" class="def">HASKELL_OVERLAPPED</a> <a href="src/GHC.Event.Windows.FFI.html#HASKELL_OVERLAPPED" class="link">Source</a> <a href="#t:HASKELL_OVERLAPPED" class="selflink">#</a></p><div class="doc"><p>Tag type for the extended version of <code>OVERLAPPED</code> containg some book
   keeping information.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:LPHASKELL_OVERLAPPED" class="def">LPHASKELL_OVERLAPPED</a> = <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:HASKELL_OVERLAPPED" title="GHC.Event.Windows.FFI">HASKELL_OVERLAPPED</a> <a href="src/GHC.Event.Windows.FFI.html#LPHASKELL_OVERLAPPED" class="link">Source</a> <a href="#t:LPHASKELL_OVERLAPPED" class="selflink">#</a></p><div class="doc"><p>Pointer to the extended HASKELL_OVERLAPPED function.</p></div></div><div class="top"><p class="src"><a id="v:allocOverlapped" class="def">allocOverlapped</a> <a href="src/GHC.Event.Windows.FFI.html#allocOverlapped" class="link">Source</a> <a href="#v:allocOverlapped" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Data-Word.html#t:Word64" title="Data.Word">Word64</a></td><td class="doc"><p>Offset/OffsetHigh</p></td></tr><tr><td class="src">-&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="GHC-Event-Windows-FFI.html#t:HASKELL_OVERLAPPED" title="GHC.Event.Windows.FFI">HASKELL_OVERLAPPED</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Allocate a new
 &lt;<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms684342%28v=vs.85%29.aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/ms684342%28v=vs.85%29.aspx</a>
 OVERLAPPED&gt; structure on the unmanaged heap. This also zeros the memory to
 prevent the values inside the struct to be incorrectlt interpreted as data
 payload.</p><p>We extend the overlapped structure with some extra book keeping information
 such that we don't have to do a lookup on the Haskell side.</p><p>Future: We can gain some performance here by using a pool instead of calling
         malloc for each request. A simple block allocator would be very
         useful here, especially when we implement sockets support.</p></div></div><div class="top"><p class="src"><a id="v:zeroOverlapped" class="def">zeroOverlapped</a> :: <a href="GHC-Event-Windows-FFI.html#t:LPHASKELL_OVERLAPPED" title="GHC.Event.Windows.FFI">LPHASKELL_OVERLAPPED</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/GHC.Event.Windows.FFI.html#zeroOverlapped" class="link">Source</a> <a href="#v:zeroOverlapped" class="selflink">#</a></p><div class="doc"><p>Zero-fill an HASKELL_OVERLAPPED structure.</p></div></div><div class="top"><p class="src"><a id="v:pokeOffsetOverlapped" class="def">pokeOffsetOverlapped</a> :: <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a> -&gt; <a href="Data-Word.html#t:Word64" title="Data.Word">Word64</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/GHC.Event.Windows.FFI.html#pokeOffsetOverlapped" class="link">Source</a> <a href="#v:pokeOffsetOverlapped" class="selflink">#</a></p><div class="doc"><p>Set the offset field in an OVERLAPPED structure.</p></div></div><div class="top"><p class="src"><a id="v:overlappedIOStatus" class="def">overlappedIOStatus</a> :: <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="GHC-Windows.html#t:NTSTATUS" title="GHC.Windows">NTSTATUS</a> <a href="src/GHC.Event.Windows.FFI.html#overlappedIOStatus" class="link">Source</a> <a href="#v:overlappedIOStatus" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:overlappedIONumBytes" class="def">overlappedIONumBytes</a> :: <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ULONG_PTR <a href="src/GHC.Event.Windows.FFI.html#overlappedIONumBytes" class="link">Source</a> <a href="#v:overlappedIONumBytes" class="selflink">#</a></p></div><a href="#g:4" id="g:4"><h1>Cancel pending I/O</h1></a><div class="top"><p class="src"><a id="v:cancelIoEx" class="def">cancelIoEx</a> :: <a href="GHC-Windows.html#t:HANDLE" title="GHC.Windows">HANDLE</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/GHC.Event.Windows.FFI.html#cancelIoEx" class="link">Source</a> <a href="#v:cancelIoEx" class="selflink">#</a></p><div class="doc"><p>Cancel all pending overlapped I/O for the given file that was initiated by
 the current OS thread.  Cancelling is just a request for cancellation and
 before the OVERLAPPED struct is freed we must make sure that the IRQ has been
 removed from the queue.  See <code><a href="GHC-Event-Windows-FFI.html#v:getOverlappedResult" title="GHC.Event.Windows.FFI">getOverlappedResult</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:cancelIoEx-39-" class="def">cancelIoEx'</a> :: <a href="GHC-Windows.html#t:HANDLE" title="GHC.Windows">HANDLE</a> -&gt; <a href="GHC-Event-Windows-FFI.html#t:LPOVERLAPPED" title="GHC.Event.Windows.FFI">LPOVERLAPPED</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/GHC.Event.Windows.FFI.html#cancelIoEx%27" class="link">Source</a> <a href="#v:cancelIoEx-39-" class="selflink">#</a></p></div><a href="#g:5" id="g:5"><h1>Monotonic time</h1></a><a href="#g:6" id="g:6"><h2>GetTickCount</h2></a><div class="top"><p class="src"><a id="v:getTickCount64" class="def">getTickCount64</a> :: <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="Data-Word.html#t:Word64" title="Data.Word">Word64</a> <a href="src/GHC.Event.Windows.FFI.html#getTickCount64" class="link">Source</a> <a href="#v:getTickCount64" class="selflink">#</a></p><div class="doc"><p>Call the <code>GetTickCount64</code> function, which returns a monotonic time in
 milliseconds.</p><p>Problems:</p><ul><li>Low resolution (10 to 16 milliseconds).</li></ul><p><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms724408%28v=vs.85%29.aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/ms724408%28v=vs.85%29.aspx</a></p></div></div><a href="#g:7" id="g:7"><h2>QueryPerformanceCounter</h2></a><div class="top"><p class="src"><a id="v:queryPerformanceCounter" class="def">queryPerformanceCounter</a> :: <a href="System-IO.html#t:IO" title="System.IO">IO</a> <a href="Data-Int.html#t:Int64" title="Data.Int">Int64</a> <a href="src/GHC.Event.Windows.FFI.html#queryPerformanceCounter" class="link">Source</a> <a href="#v:queryPerformanceCounter" class="selflink">#</a></p><div class="doc"><p>Call the <code>QueryPerformanceCounter</code> function.</p><p>Problems:</p><ul><li>Might not be available on some hardware.  Use <code><a href="GHC-Event-Windows-FFI.html#v:queryPerformanceFrequency" title="GHC.Event.Windows.FFI">queryPerformanceFrequency</a></code>
    to test for availability before calling this function.</li><li>On a multiprocessor computer, may produce different results on
    different processors due to hardware bugs.</li></ul><p>To get a monotonic time in seconds, divide the result of
 <code><a href="GHC-Event-Windows-FFI.html#v:queryPerformanceCounter" title="GHC.Event.Windows.FFI">queryPerformanceCounter</a></code> by that of <code><a href="GHC-Event-Windows-FFI.html#v:queryPerformanceFrequency" title="GHC.Event.Windows.FFI">queryPerformanceFrequency</a></code>.</p><p><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms644904%28v=vs.85%29.aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/ms644904%28v=vs.85%29.aspx</a></p></div></div><div class="top"><p class="src"><a id="v:queryPerformanceFrequency" class="def">queryPerformanceFrequency</a> :: <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Data-Int.html#t:Int64" title="Data.Int">Int64</a>) <a href="src/GHC.Event.Windows.FFI.html#queryPerformanceFrequency" class="link">Source</a> <a href="#v:queryPerformanceFrequency" class="selflink">#</a></p><div class="doc"><p>Call the <code>QueryPerformanceFrequency</code> function.  Return <code><a href="Data-Maybe.html#v:Nothing" title="Data.Maybe">Nothing</a></code> if the
 hardware does not provide a high-resolution performance counter.</p><p><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms644905%28v=vs.85%29.aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/ms644905%28v=vs.85%29.aspx</a></p></div></div><a href="#g:8" id="g:8"><h2>Miscellaneous</h2></a><div class="top"><p class="src"><a id="v:throwWinErr" class="def">throwWinErr</a> :: <a href="Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="GHC-Windows.html#t:ErrCode" title="GHC.Windows">ErrCode</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> a <a href="src/GHC.Event.Windows.FFI.html#throwWinErr" class="link">Source</a> <a href="#v:throwWinErr" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:setLastError" class="def">setLastError</a> :: <a href="GHC-Windows.html#t:ErrCode" title="GHC.Windows">ErrCode</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/GHC.Event.Windows.FFI.html#setLastError" class="link">Source</a> <a href="#v:setLastError" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.25.1</p></div></body></html>